var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);i.prototype=e.prototype,t.prototype=new i},__awaiter=this&&this.__awaiter||function(t,e,i,s){return new(i||(i=Promise))(function(n,o){function a(t){try{_(s.next(t))}catch(e){o(e)}}function r(t){try{_(s["throw"](t))}catch(e){o(e)}}function _(t){t.done?n(t.value):new i(function(e){e(t.value)}).then(a,r)}_((s=s.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function i(t){return function(e){return s([t,e])}}function s(i){if(n)throw new TypeError("Generator is already executing.");for(;_;)try{if(n=1,o&&(a=o[2&i[0]?"return":i[0]?"throw":"next"])&&!(a=a.call(o,i[1])).done)return a;switch(o=0,a&&(i=[0,a.value]),i[0]){case 0:case 1:a=i;break;case 4:return _.label++,{value:i[1],done:!1};case 5:_.label++,o=i[1],i=[0];continue;case 7:i=_.ops.pop(),_.trys.pop();continue;default:if(a=_.trys,!(a=a.length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){_=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){_.label=i[1];break}if(6===i[0]&&_.label<a[1]){_.label=a[1],a=i;break}if(a&&_.label<a[2]){_.label=a[2],_.ops.push(i);break}a[2]&&_.ops.pop(),_.trys.pop();continue}i=e.call(t,_)}catch(s){i=[6,s],o=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var n,o,a,r,_={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return r={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r},AvatarBase=function(t){function e(){var i=t.call(this)||this;return i.m_currentCountIdx=0,i.lockAction=!1,i.m_actionTextureDict={},i.m_actionUrlDict={},i.m_curDirection=5,i.m_curAction="null",i.isDestory=!1,i.m_isInit=!0,i.pathTransform="",i.m_currentCountIdx=e.avatarCount++,i.p_downLayer=new egret.DisplayObjectContainer,i.p_downLayer.name="avatar downLayer",i.addChildAt(i.p_downLayer,0),i.touchEnabled=!1,i}return __extends(e,t),e.prototype.setAvatarId=function(t){this.m_jsonAvatar&&this.m_jsonAvatar.id==t||(this.resetAvatar(),this.m_jsonAvatar=AvatarJson.getData(t),this.m_actionTextureDict={},this.setActionUrlDict(),this.m_isInit?this.shiftToAction(AvatarConfig.ACTION_stand,4):this.shiftToAction(this.m_curAction),this.m_isInit=!1)},e.prototype.setActionUrlDict=function(){this.m_actionUrlDict=AvatarJson.getActionUrlDict(this.m_jsonAvatar.id,TextureFrom.CHARACTER)},e.prototype.onloadComplete=function(t){if(!this.isDestory&&null!=this.m_jsonAvatar){var e=this.getActionNameByUrl(t);if(0!=e.length){for(var i=!0,s=[],n=[],o=0;o<e.length;o++){var a=e[o].split("_");s.push(a[0]),n.push(Number(a[1]))}if(0==t.match(/_(\d{1,2})\.png/g).length)i=!0;else{for(var r=TexturePool.instance.getTextureAtlas(t),_=0;_<s.length;_++)this.setDirectionAction(s[_],n[_],r);i=!1}(i&&-1!=s.indexOf(this.m_curAction)||!i&&-1!=s.indexOf(this.m_curAction)&&-1!=n.indexOf(this.getTextureIdxByDirection(this.m_curDirection)))&&this.shiftToActionAndDirection(this.m_curAction,this.m_curDirection)}}},e.prototype.setDirectionAction=function(t,e,i){GameManager.performanceRate!=PerformanceRateEnum.LOW&&this.addTexturesUse(i),this.m_actionTextureDict[this.pathTransform+"_"+t+"_"+e]=i},e.prototype.getActionNameByUrl=function(t){var e=[];for(var i in this.m_actionUrlDict){var s=this.m_actionUrlDict[i];""!=this.pathTransform&&(s=s.replace(this.m_jsonAvatar.folder_path,this.pathTransform)),s==t&&e.push(i)}return e},e.prototype.shiftToAction=function(t,e){return void 0===e&&(e=-1),this.lockAction||this.m_actionUrlDict&&!this.checkHaveAction(t,e)?void this.shiftToDirection(e):void((t!=this.m_curAction||-1==e||e!=this.m_curDirection)&&(-1!=e&&(this.m_curDirection=e),this.m_curAction=t,this.shiftToActionAndDirection(this.m_curAction,this.m_curDirection)))},e.prototype.shiftToDirection=function(t){-1!=t&&t!=this.m_curDirection&&(this.m_curDirection=t,this.shiftToActionAndDirection(this.m_curAction,this.m_curDirection))},e.prototype.shiftToActionAndDirection=function(t,e){var i=this.getAvatarTexutures(t,e);if(i&&i[0].name)this.resetAction(i),this.shiftActionHandle(),this.shiftDirectionHandle();else{var s=this.setPathAction(t,e);""!=s?TextureLoadManager.instance.requestLoadTextureAtlas(s,this,LoaderPriority.ROLEMOTION):this.shiftToAction(AvatarConfig.ACTION_stand)}},e.prototype.checkHaveAction=function(t,e){return""==this.setPathAction(t,e)?!1:!0},e.prototype.setPathAction=function(t,e){var i=this.m_actionUrlDict[t+"_"+this.getTextureIdxByDirection(-1==e?this.m_curDirection:e)];return null==i?"":(""!=this.pathTransform&&(i=i.replace(this.m_jsonAvatar.folder_path,this.pathTransform)),i)},Object.defineProperty(e.prototype,"isOtherPlayer",{get:function(){return!1},enumerable:!0,configurable:!0}),e.prototype.shiftDirectionHandle=function(){(PlayerManager.instance.p_playerIsShow||!this.isOtherPlayer)&&null!=this.m_mc&&(4==this.m_curDirection||5==this.m_curDirection||6==this.m_curDirection||7==this.m_curDirection?this.m_mc.scaleX=-1*this.m_jsonAvatar.scale:this.m_mc.scaleX=1*this.m_jsonAvatar.scale)},e.prototype.shiftActionHandle=function(){},e.prototype.getAvatarTexutures=function(t,e){var i=this.m_actionTextureDict[this.pathTransform+"_"+t+"_"+this.getTextureIdxByDirection(e)];return i},e.prototype.getTextureIdxByDirection=function(t){var e;switch(t){case 5:e=3;break;case 6:e=2;break;case 7:e=1;break;default:e=t}return e},e.prototype.resetAction=function(t){if(!this.isDestory&&(PlayerManager.instance.p_playerIsShow||!this.isOtherPlayer)){var e=12,i=this.m_curAction+"_"+this.getTextureIdxByDirection(this.m_curDirection);if(null!=this.m_jsonAvatar.fpsDict[i]&&(e=this.m_jsonAvatar.fpsDict[i]),null==this.m_mc)this.m_mc=new MovieClip(t,e),this.m_mc.name="avatar",this.m_mc.play();else{if(this.m_mc.removeEventListeners(),this.m_mc.removieAllFrameScript(),this.lockAction){var s=this.m_mc.CurrentTime;this.m_mc.resetTextures(t,e),this.m_mc.CurrentTime=s}else this.m_mc.resetTextures(t,e);this.m_mc.isPlay||this.m_mc.play()}null==this.m_mc.parent&&(this.m_mc.scaleY=this.jsonAvatar.scale,this.addChildAt(this.m_mc,this.getChildIndex(this.p_downLayer)+1)),this.resetPosition()}},e.prototype.resetPosition=function(){(PlayerManager.instance.p_playerIsShow||!this.isOtherPlayer)&&null!=this.m_mc&&(this.m_mc.anchorOffsetX=.5*this.m_mc.texture.textureWidth,this.m_mc.anchorOffsetY=.5*this.m_mc.texture.textureHeight,this.m_mc.x=this.m_jsonAvatar.offset_list[0],this.m_mc.y=this.m_jsonAvatar.offset_list[1])},e.prototype.testPosition=function(t){(PlayerManager.instance.p_playerIsShow||!this.isOtherPlayer)&&null!=this.m_mc&&(this.m_mc.anchorOffsetX=.5*this.m_mc.texture.textureWidth,this.m_mc.anchorOffsetY=.5*this.m_mc.texture.textureHeight,this.m_mc.x=this.m_jsonAvatar.offset_list[0]+(t&&t[0]?t[0]:0),this.m_mc.y=this.m_jsonAvatar.offset_list[1]+(t&&t[1]?t[1]:0))},e.prototype.destory=function(){this.m_curAction="null",this.isDestory=!0,this.m_jsonAvatar=null,this.m_mc&&(this.m_mc.removeEventListeners(),this.m_mc.removeFromParent(),this.m_mc.dispose(),this.m_mc.stop(),this.m_mc=null),this.p_downLayer&&(DisplayObjectUtils.removeFormParent(this.p_downLayer),this.p_downLayer=null),this.resetAvatar(),DisplayObjectUtils.removeFormParent(this)},e.prototype.resetAvatar=function(){if(this.clsoeLoadMc(),this.m_actionTextureDict){for(var t in this.m_actionTextureDict){var e=this.m_actionTextureDict[t];this.removeTexturesUse(e),e.length=0,this.m_actionTextureDict[t]=null}this.m_actionTextureDict=null,this.m_actionTextureDict={}}},e.prototype.clsoeLoadMc=function(){if(null!=this.m_actionUrlDict)for(var t in this.m_actionUrlDict){var e=this.m_actionUrlDict[t];TextureLoadManager.instance.closeLoad(e,this);var i=this.m_actionUrlDict[t];this.m_jsonAvatar&&""!=this.m_jsonAvatar.folder_transform_path&&(i=i.replace(this.m_jsonAvatar.folder_path,this.m_jsonAvatar.folder_transform_path),TextureLoadManager.instance.closeLoad(i,this))}},e.prototype.removeTexturesUse=function(t){if(null!=t&&t.length>0){var e=t[0];if(e.fromAtlas){var i=e.fromAtlas;i.removeUse(this.hashCode)}}},e.prototype.addTexturesUse=function(t){if(null!=t&&t.length>0){var e=t[0];if(e.fromAtlas){var i=e.fromAtlas;i.addUse(this.hashCode)}}},Object.defineProperty(e.prototype,"y",{get:function(){return this.$getY()+1e-6*this.m_currentCountIdx},set:function(t){this.$setY(Math.floor(t))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mc",{get:function(){return this.m_mc},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"jsonAvatar",{get:function(){return this.m_jsonAvatar},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"curDirection",{get:function(){return this.m_curDirection},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"curAction",{get:function(){return this.m_curAction},enumerable:!0,configurable:!0}),e.avatarCount=0,e}(egret.DisplayObjectContainer);__reflect(AvatarBase.prototype,"AvatarBase");var ComponentBase=function(t){function e(){var e=t.call(this)||this;return e.m_isComplete=!1,e.m_completeCallList=[],e.p_isDisposeTexture=!1,e.m_disposeUrlList=[],e.m_quoteUrlList=[],e}return __extends(e,t),e.prototype.registerEventClick=function(t,e,i,s,n,o){void 0===s&&(s=!1),void 0===n&&(n=SoundEnum.EFFECT_SOUND_1007),void 0===o&&(o=null),DisplayObjectUtils.registerEventClick(t,e,i,s,n,o)},e.prototype.removeEventClick=function(t){DisplayObjectUtils.removeEventClick(t)},e.prototype.onCompleted=function(){this.m_isComplete=!0;for(var t=0;t<this.m_completeCallList.length;t++)this.m_completeCallList[t].func.apply(this.m_completeCallList[t].thisArg,this.m_completeCallList[t].args),this.m_completeCallList[t].func=null,this.m_completeCallList[t].args=null;this.m_completeCallList.length=0},e.prototype.checkComplete=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(this.m_isComplete)return!0;var s=new callfunction;return s.thisArg=this,s.func=t,s.args=e,this.m_completeCallList.push(s),!1},e.prototype.disposeAllTexture=function(){if(1!=this.p_isDisposeTexture&&(this.setDestroyKey(),this.m_disposeUrlList.length>0)){for(var t=0;t<this.m_disposeUrlList.length;t++)this.isDestroyKey(this.m_disposeUrlList[t])&&RES.destroyRes(this.m_disposeUrlList[t]);this.p_isDisposeTexture=!0}},e.prototype.setDestroyKey=function(){if(this.m_quoteUrlList&&this.m_quoteUrlList.length>0)for(var t=0;t<this.m_quoteUrlList.length;t++){var e=PopupConfig.list_icon_haskey[this.m_quoteUrlList[t]];if(e&&e.length>0){var i=e.indexOf(this.hashCode);i>-1&&e.splice(i,1)}}},e.prototype.addDestroyKey=function(){if(this.m_quoteUrlList&&this.m_quoteUrlList.length>0)for(var t=0;t<this.m_quoteUrlList.length;t++){var e=PopupConfig.list_icon_haskey[this.m_quoteUrlList[t]];null==e&&(e=[],PopupConfig.list_icon_haskey[this.m_quoteUrlList[t]]=e),-1==e.indexOf(this.hashCode)&&e.push(this.hashCode)}},e.prototype.isDestroyKey=function(t){var e=PopupConfig.list_icon_haskey[t];return e&&e.length>0?!1:!0},e.prototype.recoverAllTexture=function(t,e){if(void 0===e&&(e=!1),0!=this.p_isDisposeTexture||0!=e){this.addDestroyKey();for(var i,s,n,o,a=t.numChildren,r=0;a>r;r++)i=t.getChildAt(r),i instanceof eui.Image?(n=i,s=n.source,n.source=null,n.source=s):i instanceof egret.DisplayObjectContainer?(o=i,this.recoverAllTexture(o,!0)):i instanceof eui.Group&&(o=i,this.recoverAllTexture(o,!0));this.p_isDisposeTexture=!1}},e}(eui.Component);__reflect(ComponentBase.prototype,"ComponentBase");var AvatarLive=function(t){function e(){var i=t.call(this)||this;return i.livePid=1,i.canJump=!0,i.m_moveSpeed=3.5,i.m_liveHeadType=LiveHeadType.ROLE_NAME,i.m_liveName="未知生物",i.m_hangingHeight=0,i.m_jumpHeight=0,i.m_loopActionBean=null,i.m_pos=new egret.Point,i.m_playActionCompleteFunc=null,i.p_moveDriection=0,i.m_skillData={},i.m_clonePoint=new egret.Point,i.m_self=i,i.m_liveHandleProxy=new LiveHandleProxy(i),i.livePid=e.LivePid++,i}return __extends(e,t),Object.defineProperty(e.prototype,"liveName",{get:function(){return this.m_liveName},set:function(t){this.m_liveName=t,this.name=this.m_liveName,this.setHead()},enumerable:!0,configurable:!0}),e.prototype.setHead=function(){this.m_liveHead?this.m_liveHead.refresh():(this.m_liveHead=LiveHeadFactory.getHeadByType(this.m_liveHeadType),this.m_liveHead.parentLive=this.m_self)},e.prototype.shiftToActionAndLoop=function(t,e,i,s,n){void 0===s&&(s=-1),void 0===n&&(n=null),this.m_playActionCompleteFunc=n,this.m_loopActionBean={action:t,loop:e,fps:i,direction:s},this.shiftToAction(t,s)},e.prototype.shiftActionHandle=function(){if((PlayerManager.instance.p_playerIsShow||!this.isOtherPlayer)&&null!=this.m_mc){switch(t.prototype.shiftActionHandle.call(this),this.m_curAction){case AvatarConfig.ACTION_stand:case AvatarConfig.ACTION_move:case AvatarConfig.ACTION_jump:case AvatarConfig.ACTION_jump01:case AvatarConfig.ACTION_jump02:case AvatarConfig.ACTION_jump03:case AvatarConfig.ACTION_jump04:case AvatarConfig.ACTION_jump05:break;case AvatarConfig.ACTION_die:this.m_mc.addFrameScript(this.m_mc.textures.length-1,this.onDie.bind(this));break;default:this.m_mc.addFrameScript(this.m_mc.textures.length-1,this.onActionComplete.bind(this))}this.m_loopActionBean&&(this.m_mc.removieAllFrameScript(),this.m_mc.removeEventListener(egret.Event.COMPLETE,this.onActionComplete,this),this.m_mc.loop=!0,this.m_mc.LoopNum=this.m_loopActionBean.loop,this.m_mc.fps=this.m_loopActionBean.fps,this.m_mc.addEventListener(egret.Event.COMPLETE,this.onActionComplete,this)),this.m_loopActionBean=null}},e.prototype.onActionComplete=function(){(PlayerManager.instance.p_playerIsShow||!this.isOtherPlayer)&&null!=this.m_mc&&(null!=this.m_playActionCompleteFunc&&this.m_playActionCompleteFunc(),this.m_mc.removeEventListeners(),this.m_mc.removeEventListener(egret.Event.COMPLETE,this.onActionComplete,this),this.shiftToAction(AvatarConfig.ACTION_stand))},e.prototype.onDie=function(){this.m_mc.removieAllFrameScript(),this.m_mc.removeEventListeners(),this.m_mc.stop()},e.prototype.drawHotRect=function(){this.m_hotImage||(this.m_hotImage=new egret.Bitmap(RES.getRes("commonUI_box")),this.m_hotImage.scale9Grid=UIModule.instance.getRectangle(),this.m_hotImage.alpha=0,GameManager.p_hotList.push(this.m_hotImage)),this.m_hotImgTile||(this.m_hotImgTile=new eui.Image("commonUI_box_0"),this.addChild(this.m_hotImgTile),this.m_hotImgTile.alpha=0,this.m_hotImgTile.touchEnabled=!1,GameManager.p_hotList.push(this.m_hotImgTile)),this.m_hotImage.x=.5*-this.jsonAvatar.hot_list[2]+this.jsonAvatar.hot_list[0],this.m_hotImage.y=-this.jsonAvatar.hot_list[3]+this.jsonAvatar.hot_list[1],this.m_hotImage.width=this.jsonAvatar.hot_list[2],this.m_hotImage.height=this.jsonAvatar.hot_list[3],this.m_hotImage.touchEnabled=!0,this.addChild(this.m_hotImage)},Object.defineProperty(e.prototype,"pointFoot",{get:function(){return[0,0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"xyFoot",{get:function(){var t=this.pointFoot;return[this.getPos().x+t[0],this.getPos().y+t[1]]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pointCentered",{get:function(){return[0,.5*-this.jsonAvatar.hot_list[3]]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"xyCentered",{get:function(){var t=this.pointCentered;return[this.getPos().x+t[0],this.getPos().y+t[1]]},enumerable:!0,configurable:!0}),e.prototype.getPointStage=function(t){void 0===t&&(t=1);var e;e=1==t?this.pointFoot:this.pointCentered;var i=this.localToGlobal(e[0],e[1]);return[i.x,i.y]},Object.defineProperty(e.prototype,"hotTouchable",{set:function(t){t?(this.drawHotRect(),null!=this.m_hotImage&&this.m_hotImage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this)):this.removeHotImg()},enumerable:!0,configurable:!0}),e.prototype.removeHotImg=function(){null!=this.m_hotImage&&(this.m_hotImage.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this),this.m_hotImage.parent&&this.m_hotImage.parent.removeChild(this.m_hotImage),this.m_hotImage.texture=null,this.m_hotImage=null)},e.prototype.onTouch=function(t){},e.prototype.destory=function(){this.hotTouchable=!1,this.m_pos=null,this.m_liveHead&&(this.m_liveHead.destory(),this.m_liveHead=null),MoveManager.instance.stopMove(this),this.m_hotImgTile&&(DisplayObjectUtils.removeFormParent(this.m_hotImgTile),this.m_hotImgTile=null),this.m_self=null,this.removeHotImg(),t.prototype.destory.call(this)},Object.defineProperty(e.prototype,"hangingHeight",{get:function(){return this.m_hangingHeight},set:function(t){this.m_hangingHeight=t,this.anchorOffsetY=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"jumpHeight",{get:function(){return this.m_jumpHeight},set:function(t){this.m_jumpHeight=t,this.anchorOffsetY=this.m_hangingHeight+this.m_jumpHeight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"curState",{get:function(){return this.m_curPreferentialState==StateType.CHUANSONG||this.m_curPreferentialState==StateType.XUAN_YUN||this.m_curPreferentialState==StateType.DEAD||this.m_curPreferentialState==StateType.ATTACK?this.m_curPreferentialState:this.m_curState},set:function(t){this.m_curState=t,this.m_liveHandleProxy.liveStateChange()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rCurState",{get:function(){return this.m_curState},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"curPreferentialState",{get:function(){return this.m_curPreferentialState},set:function(t){this.m_curPreferentialState=t,(this.m_curPreferentialState==StateType.CHUANSONG_END||this.m_curPreferentialState==StateType.XUAN_YUN_END||this.m_curPreferentialState==StateType.DEAD_END||this.m_curPreferentialState==StateType.SKILL_End||this.m_curPreferentialState==StateType.ATTACK_END)&&(this.m_curState=this.m_curPreferentialState),this.m_liveHandleProxy.liveStateChange()},enumerable:!0,configurable:!0}),e.prototype.doHandle=function(t){this.m_liveHandleProxy.doHandle(t)},e.prototype.setPos=function(t,i){this.x=t,this.y=i,Dispatch.dispatch(e.EVENT_POSITION_CHANGE+this.livePid),0==this.m_jumpHeight&&this.refreshMask()},e.prototype.getCurPosMapData=function(){return MyMapModule.instance.map.mapdata.getMapData(this.x,this.y)},e.prototype.getPos=function(){return null==this.m_pos?new egret.Point(this.x,this.y):(this.m_pos.x=this.x,this.m_pos.y=this.y,this.m_clonePoint.x=this.x,this.m_clonePoint.y=this.y,this.m_clonePoint)},e.prototype.refreshMask=function(){MoveManager.instance.mapTile.getMaskData(Math.floor(.025*this.x),Math.floor(.025*this.y))!=MyMapData.DATA_MASK?this.alpha=1:this.alpha=.4},Object.defineProperty(e.prototype,"moveSpeed",{get:function(){return this.m_moveSpeed},set:function(t){this.m_moveSpeed=t,Dispatch.dispatch(e.EVENT_MOVESPEED_CHANGE+this.livePid)},enumerable:!0,configurable:!0}),e.prototype.shiftToAction=function(e,i){void 0===i&&(i=-1),this.isDestory||(t.prototype.shiftToAction.call(this,e,i),this.p_moveDriection=i)},e.prototype.shiftToDirection=function(e){this.isDestory||(t.prototype.shiftToDirection.call(this,e),this.p_moveDriection=e)},e.prototype.setAttackSkill=function(t,e){void 0===e&&(e=0),0==e?delete this.m_skillData[t]:this.m_skillData[t]=e},e.prototype.getAttackSkillTime=function(t){return this.m_skillData[t]&&this.m_skillData[t]>ServerTimeManager.instance.timer?this.m_skillData[t]:0},e.EVENT_MOVESPEED_CHANGE="EVENT_MOVESPEED_CHANGE",e.EVENT_POSITION_CHANGE="EVENT_POSITION_CHANGE",e.LivePid=0,e}(AvatarBase);__reflect(AvatarLive.prototype,"AvatarLive");var DisplayBase=function(t){function e(){var e=t.call(this)||this;return e.m_iniViewOver=!1,e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){},e.prototype.initEvent=function(){},e.prototype.startShowLoad=function(t,e){void 0===e&&(e=null),this.m_baseData=t,this.m_parentMc=e,this.m_disposeUrlList&&this.m_disposeUrlList.length>0?this.startLoadUI():this.setLoadAddStage()},e.prototype.startLoadUI=function(){RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onPreloadDisplayComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceDisplayLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceDisplayProgress,this);for(var t=0;t<this.m_disposeUrlList.length;t++)RES.hasRes(this.m_disposeUrlList[t])||RES.$addResourceData({name:this.m_disposeUrlList[t],type:RES.ResourceItem.TYPE_IMAGE,url:this.m_disposeUrlList[t]});RES.createGroup("dislayBaseUI"+this.hashCode,this.m_disposeUrlList),RES.loadGroup("dislayBaseUI"+this.hashCode)},e.prototype.onPreloadDisplayComplete=function(t){void 0===t&&(t=null),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onPreloadDisplayComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceDisplayLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceDisplayProgress,this),this.setLoadAddStage()},e.prototype.setLoadAddStage=function(){this.m_iniViewOver||(this.m_iniViewOver=!0,""!=this.skinNameUrl?(this.once(egret.Event.COMPLETE,this.onCompleted,this),this.skinName=this.skinNameUrl):this.onCompleted()),this.addStageThis(),this.showView(this.m_baseData)},e.prototype.showView=function(t){void 0===t&&(t=null),this.checkComplete(this.showView,t)&&this.recoverAllTexture(this,this.isRecursion)},e.prototype.addStageThis=function(){this.m_parentMc&&this.m_parentMc.addChild(this)},e.prototype.closeLoad=function(){RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onPreloadDisplayComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceDisplayLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceDisplayProgress,this)},Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isRecursion",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.onResourceDisplayLoadError=function(t){console.warn("popup LoadError："+t.groupName)},e.prototype.onResourceDisplayProgress=function(t){},e.prototype.onloadComplete=function(t){},e.prototype.onloadError=function(t){},e}(ComponentBase);__reflect(DisplayBase.prototype,"DisplayBase",["ITextureLoadEvent"]);var PopupBase=function(t){function e(){var e=t.call(this)||this;return e.m_effectOpenType=1,e.m_effectCloseType=1,e.m_showGuideKeyList=[],e.m_openHideType=[],e.m_functionConfigId=-1,e.m_point=new egret.Point,e}return __extends(e,t),e.prototype.setId=function(t,e){void 0===e&&(e=null),this.m_baseId=t,this.startShowLoad(e)},e.prototype.addStageThis=function(){PopupModule.instance.addPopup(this)},e.prototype.setCloseBtn=function(t){this.registerEventClick(t,this.close,this,!0)},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),Dispatch.register(this.guideConfigId,this.onGuideClose,this),Dispatch.register(StageManager.EVENT_STAGE_RESIZE,this.stageResize,this,!0),e&&e.c_funcEffectOpenType&&Number(e.c_funcEffectOpenType)>-1?(this.m_openHideType[0]=this.m_effectOpenType,this.m_effectOpenType=e.c_funcEffectOpenType):this.m_openHideType[0]&&(this.m_effectOpenType=this.m_openHideType[0]),e&&e.c_funcEffectCloseType&&Number(e.c_funcEffectCloseType)>-1?(this.m_openHideType[1]=this.m_effectOpenType,this.m_effectCloseType=e.c_funcEffectCloseType):this.m_openHideType[1]&&(this.m_effectOpenType=this.m_openHideType[1]),this.m_functionConfigId=-1,e&&e.c_functionConfigId&&(this.m_functionConfigId=e.c_functionConfigId),this.m_funcBack=null,e&&e.c_funcBack&&(this.m_funcBack=e.c_funcBack),this.setOpenShow())},e.prototype.setOpenShow=function(){1==this.m_effectOpenType?this.showEffect1():2==this.m_effectOpenType?this.showEffect2():3==this.m_effectOpenType?this.showEffect3():4==this.m_effectOpenType?this.showEffect4():5==this.m_effectOpenType?this.showEffect5():this.showEffectOver()},e.prototype.showEffect1=function(){var t=Math.floor(.5*(StageManager.instance.p_stageWidth-this.width)),e=Math.floor(.5*(StageManager.instance.p_stageHeight-this.height+StageManager.instance.p_liuHeight));this.alpha=.2,this.x=t-.3*this.width/2,this.y=e-.3*this.height/2,this.scaleX=1.3,this.scaleY=1.3,TweenLite.killTweensOf(this);var i=this.tweenShowTime>0?this.tweenShowTime:.2;TweenLite.to(this,i,{alpha:1,scaleX:1,scaleY:1,x:t,y:e,ease:Quad.easeIn,onComplete:this.showEffectOver.bind(this)})},e.prototype.showEffect2=function(){var t=Math.floor(.5*(StageManager.instance.p_stageWidth-this.width)),e=Math.floor(.5*(StageManager.instance.p_stageHeight-this.height+StageManager.instance.p_liuHeight));this.alpha=.2;var i=this.showPoint();this.x=i.x-.3*this.width/2,this.y=i.y-.3*this.height/2,this.scaleX=.1,this.scaleY=.1,TweenLite.killTweensOf(this);var s=this.tweenShowTime>0?this.tweenShowTime:.3;TweenLite.to(this,s,{scaleX:1,scaleY:1,x:t,y:e,onComplete:this.showEffectOver.bind(this)})},e.prototype.showEffect3=function(){var t=Math.floor(.5*(StageManager.instance.p_stageWidth-this.width)),e=Math.floor(.5*(StageManager.instance.p_stageHeight-this.height+StageManager.instance.p_liuHeight));this.x=t,this.y=-this.height,TweenLite.killTweensOf(this);var i=this.tweenShowTime>0?this.tweenShowTime:.3;TweenLite.to(this,i,{x:t,y:e,onComplete:this.showEffectOver.bind(this)})},e.prototype.showEffect4=function(){this.scaleX=.1,this.scaleY=.1,this.x=.9*StageManager.instance.p_stageWidth*.5,this.y=-500,this.alpha=0,TweenLite.killTweensOf(this);var t=this.tweenShowTime>0?this.tweenShowTime:.3;TweenLite.to(this,t,{y:.9*StageManager.instance.p_stageHeight*.5,alpha:1,onComplete:this.showEffect4Sure.bind(this)})},e.prototype.showEffect5=function(){var t=Math.floor(.5*(StageManager.instance.p_stageWidth-this.width)),e=Math.floor(.5*(StageManager.instance.p_stageHeight-this.height+StageManager.instance.p_liuHeight));this.x=-this.width;var i=this.showPoint();this.y=i.y-.3*this.height/2,this.scaleX=0,this.scaleY=0,TweenLite.killTweensOf(this);var s=this.tweenShowTime>0?this.tweenShowTime:.3;TweenLite.to(this,s,{scaleX:1,scaleY:1,x:t,y:e,onComplete:this.showEffectOver.bind(this)})},e.prototype.showEffect4Sure=function(){var t=Math.floor(.5*(StageManager.instance.p_stageWidth-this.width)),e=Math.floor(.5*(StageManager.instance.p_stageHeight-this.height+StageManager.instance.p_liuHeight)),i=this.tweenShowTime>0?this.tweenShowTime:.3;TweenLite.to(this,i,{scaleX:1,scaleY:1,x:t,y:e,onComplete:this.showEffectOver.bind(this)})},e.prototype.showEffectOver=function(){if(this.m_showGuideKeyList&&this.m_showGuideKeyList.length>0)for(var t=0;t<this.m_showGuideKeyList.length;t++)GuideModule.instance.executeNextGuide(this.m_showGuideKeyList[t]);this.stageResize()},e.prototype.close=function(t){void 0===t&&(t=null),PopupModule.instance.hidePop(this.m_baseId)},e.prototype.onGuideClose=function(t){t&&t.c_popup_id==this.m_baseId&&this.close()},e.prototype.hide=function(t,e){return this.closeLoad(),Dispatch.remove(this.guideConfigId,this.onGuideClose,this),Dispatch.remove(StageManager.EVENT_STAGE_RESIZE,this.stageResize,this),TweenLite.killTweensOf(this),e&&e.c_allClose?void this.sureHide():void this.onHideGather(t,e)},e.prototype.onHideGather=function(t,e){var i;if(1==this.m_effectCloseType)i=this.tweenHideTime>0?this.tweenHideTime:.2,TweenLite.to(this,i,{alpha:.5,scaleX:1.3,scaleY:1.3,x:this.x-.3*this.width/2,y:this.y-.3*this.height/2,ease:Quad.easeIn,onComplete:this.sureHide.bind(this),onCompleteParams:[t,e]});else if(2==this.m_effectCloseType){var s=this.closePoint();i=this.tweenHideTime>0?this.tweenHideTime:.3,TweenLite.to(this,i,{scaleX:0,scaleY:0,x:s.x,y:s.y,onComplete:this.sureHide.bind(this),onCompleteParams:[t,e]})}else if(3==this.m_effectCloseType)i=this.tweenHideTime>0?this.tweenHideTime:.3,TweenLite.to(this,i,{y:-this.height,ease:Back.easeIn,onComplete:this.sureHide.bind(this),onCompleteParams:[t,e]});else if(4==this.m_effectCloseType){var n=.9*StageManager.instance.p_stageWidth*.5,o=.9*StageManager.instance.p_stageHeight*.5;i=this.tweenHideTime>0?this.tweenHideTime:.3,TweenLite.to(this,i,{scaleX:.1,scaleY:.1,x:n,y:o,onComplete:this.hideEffect4.bind(this),onCompleteParams:[t,e]})}else if(5==this.m_effectCloseType){var s=this.closePoint();i=this.tweenHideTime>0?this.tweenHideTime:.3,TweenLite.to(this,i,{scaleX:0,scaleY:0,x:-this.width,y:s.y,ease:Back.easeIn,onComplete:this.sureHide.bind(this),onCompleteParams:[t,e]})}else this.sureHide(t,e)},e.prototype.hideEffect4=function(t,e){void 0===e&&(e=null);var i=this.tweenHideTime>0?this.tweenHideTime:.3;TweenLite.to(this,i,{y:-500,alpha:0,onComplete:this.sureHide.bind(this),onCompleteParams:[t,e]})},e.prototype.showPoint=function(){return this.m_point.x=.5*StageManager.instance.p_stageWidth,this.m_point.y=.5*StageManager.instance.p_stageHeight,this.m_point},e.prototype.closePoint=function(){return this.m_point.x=.5*StageManager.instance.p_stageWidth,this.m_point.y=.5*StageManager.instance.p_stageHeight,this.m_point},e.prototype.stageResize=function(){TweenLite.killTweensOf(this),this.scaleX=1,this.scaleY=1,this.alpha=1,this.x=Math.floor(.5*(StageManager.instance.p_stageWidth-this.width)),this.y=Math.floor(.5*(StageManager.instance.p_stageHeight-this.height))},e.prototype.sureHide=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),TweenLite.killTweensOf(this),this.m_functionConfigId>0&&FunctionManager.instance.executeFunction(this.m_functionConfigId),this.m_functionConfigId=-1,null!=this.m_funcBack&&this.m_funcBack.call(this,this.funcBackData),this.m_funcBack=null,this.disposeAllTexture(),DisplayObjectUtils.removeFormParent(this),null!=t&&"function"==typeof t&&t.apply(null,[this,e]),this.scaleX=1,this.scaleY=1,this.alpha=1},Object.defineProperty(e.prototype,"funcBackData",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tweenShowTime",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tweenHideTime",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"guideConfigId",{get:function(){return GuideConfig.guide_popup_close},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.m_baseId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isClickBMask",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isShowBMask",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alphaBMask",{get:function(){return.9},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return StageManager.MIN_STAGE_WIDTH},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return StageManager.MIN_STAGE_HEIGHT},enumerable:!0,configurable:!0}),e}(DisplayBase);__reflect(PopupBase.prototype,"PopupBase");var AvatarFighter=function(t){function e(){var e=t.call(this)||this;return e.p_isDie=!1,e.p_hp=1,e.p_buffEffectTypeList=[],e}return __extends(e,t),e.prototype.addBuffEffectType=function(t){this.p_buffEffectTypeList.push(t)},e.prototype.removeBuffEffectType=function(t){var e=this.p_buffEffectTypeList.indexOf(t);-1!=e&&this.p_buffEffectTypeList.splice(e,1)},e.prototype.haveBuffEffectType=function(t){return-1!=this.p_buffEffectTypeList.indexOf(t)},e.prototype.shiftToAction=function(e,i){return void 0===i&&(i=-1),this.p_isDie&&e!=AvatarConfig.ACTION_die?void(this.curAction!=AvatarConfig.ACTION_die&&t.prototype.shiftToAction.call(this,AvatarConfig.ACTION_die,i)):void t.prototype.shiftToAction.call(this,e,i)},e.prototype.refreshHP=function(t){this.p_hp=t,this.p_hp<=0&&this.die()},e.prototype.playSkill=function(t,e,i,s,n){if(!this.isDestory){this.curPreferentialState=StateType.ATTACK;var o=ActiveSkillJson.getData(t).action_res;"0"!=o&&(this.checkHaveAction(o,e)?this.shiftToAction(o,e):this.shiftToAction(AvatarConfig.ACTION_attack01,e));var a=ActiveSkillJson.getData(t),r=a.continue_time.split("|"),_=Number(r[0]);
TweenLite.delayedCall(.001*_,this.onAtkContinueEnd,null,this)}},e.prototype.onAtkContinueEnd=function(){this.curPreferentialState=StateType.ATTACK_END},e.prototype.die=function(){this.lockAction=!1,this.p_isDie=!0,this.curState=StateType.DEAD,MoveManager.instance.stopMove(this)},e}(AvatarLive);__reflect(AvatarFighter.prototype,"AvatarFighter");var HeadName=function(t){function e(){var e=t.call(this)||this;return e.m_name="",e.m_vip=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"parentLive",{set:function(t){this.m_avatarLive=t,this.refresh()},enumerable:!0,configurable:!0}),e.prototype.resetPosition=function(){if(null!=this.m_avatarLive&&null!=this.m_avatarLive.jsonAvatar){var t=this.m_avatarLive.jsonAvatar.name_off_list[0],e=this.m_avatarLive.jsonAvatar.name_off_list[1];this.m_nameLabel&&(this.m_nameLabel.anchorOffsetX=Math.floor(-t+.5*this.m_nameLabel.width),this.m_nameLabel.anchorOffsetY=Math.floor(-e+this.m_nameLabel.height+5)),this.m_vipImg&&(this.m_vipImg.x=t-.5*this.m_nameLabel.width-40,this.m_vipImg.y=e-.5*this.m_nameLabel.height-15)}},e.prototype.setTest=function(t){if(null!=this.m_avatarLive&&null!=this.m_avatarLive.jsonAvatar){var e=this.m_avatarLive.jsonAvatar.name_off_list[0]+(t&&t[0]?t[0]:0),i=this.m_avatarLive.jsonAvatar.name_off_list[1]+(t&&t[1]?t[1]:0);this.m_nameLabel&&(this.m_nameLabel.anchorOffsetX=Math.floor(-e+.5*this.m_nameLabel.width),this.m_nameLabel.anchorOffsetY=Math.floor(-i+this.m_nameLabel.height+5))}},e.prototype.refresh=function(){var t=!1;if(this.m_avatarLive instanceof AvatarPlayer&&this.m_avatarLive.playerData.vip_level>0&&this.m_avatarLive.playerData.vip_level!=this.m_vip&&(t=!0,this.m_vip=this.m_avatarLive.playerData.vip_level,this.m_vipImg||(this.m_vipImg=new eui.Image),this.m_vipImg.source="userMainUI_c_vip_"+this.m_vip,this.m_avatarLive.addChild(this.m_vipImg)),this.m_name!=this.m_avatarLive.liveName||t){this.m_name=this.m_avatarLive.liveName;var i=this.m_name;if(this.m_avatarLive instanceof AvatarMainPlayer){var s=Number(StaticDataJson.getData("main_player_name_color_id").data);i=TextUtil.setText(this.m_name,ColorJson.getColorNum(s))}if(VipLevelJson.getData(this.m_vip)&&VipLevelJson.getData(this.m_vip).name_color>0){var s=VipLevelJson.getData(this.m_vip).name_color;i=TextUtil.setText(this.m_name,ColorJson.getColorNum(s))}null==this.m_nameLabel?(this.m_nameLabel=e.getMsgLabel(i),this.m_nameLabel.touchEnabled=!1,this.m_avatarLive.addChild(this.m_nameLabel)):this.m_nameLabel.textFlow=HtmlUtil.setTextFlow(i)}this.setTitle(),this.resetPosition()},e.prototype.destory=function(){this.m_nameLabel&&this.m_nameLabel.parent&&(this.m_nameLabel.parent.removeChild(this.m_nameLabel),e.pushMsgLabel(this.m_nameLabel),this.m_nameLabel=null),this.m_avatarLive=null,this.removeMC(this.m_titleMC),this.m_titleMC=null},e.prototype.setTitle=function(){},e.prototype.hideEffect=function(){this.removeMC(this.m_titleMC)},e.prototype.showEffect=function(){this.setTitle()},e.prototype.removeMC=function(t){if(t){if(!t.parent)return;t.parent.removeChild(t),t.removeFromParent(),t.stop(),t.destory(),t=null}},e.getMsgLabel=function(t,e){void 0===e&&(e=16777215);var i;return i=this.nameLabelPool.length>0?this.nameLabelPool.shift():new BitmapLabel,i.size=16,i.fontFamily="Arial",i.textAlign=egret.HorizontalAlign.CENTER,i.textColor=e,i.strokeColor=0,i.stroke=1,i.touchEnabled=!1,i.textFlow=HtmlUtil.setTextFlow(t),i},e.pushMsgLabel=function(t){-1==this.nameLabelPool.indexOf(t)&&this.nameLabelPool.push(t)},e.nameLabelPool=[],e}(egret.HashObject);__reflect(HeadName.prototype,"HeadName",["ILiveHead"]);var MinMapBase=function(t){function e(){var e=t.call(this)||this;return e.m_livePid=0,e.initView(),e}return __extends(e,t),e.prototype.initView=function(){null==this.m_head&&(this.m_head=new eui.Image,this.addChild(this.m_head)),null==this.m_circle&&(this.m_circle=new eui.Image,this.addChild(this.m_circle))},e.prototype.initEvent=function(){},Object.defineProperty(e.prototype,"setLivePid",{set:function(t){this.m_livePid=t},enumerable:!0,configurable:!0}),e.prototype.setCircleAnchor=function(t,e){this.m_circle.anchorOffsetX=t,this.m_circle.anchorOffsetY=e},e.prototype.setCircleScale=function(t,e){this.m_circle.scaleX=t,this.m_circle.scaleY=e},Object.defineProperty(e.prototype,"width",{get:function(){return 36},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 36},enumerable:!0,configurable:!0}),e}(egret.DisplayObjectContainer);__reflect(MinMapBase.prototype,"MinMapBase");var SceneEffectBase=function(t){function e(){var e=t.call(this)||this;return e.m_mapEffectUrl="",e.isDestory=!1,e.m_isShow=!0,e.m_trueRect=new egret.Rectangle,e}return __extends(e,t),Object.defineProperty(e.prototype,"isShow",{get:function(){return this.m_isShow},set:function(t){this.m_isShow=t,this.m_isShow?null==TexturePool.instance.getTextureMap(this.m_mapEffectUrl)?TextureLoadManager.instance.requestLoadTextureAtlas(this.m_mapEffectUrl,this,LoaderPriority.MAPUNIT,!0):this.onloadComplete(this.m_mapEffectUrl):TextureLoadManager.instance.closeLoad(this.m_mapEffectUrl,this)},enumerable:!0,configurable:!0}),e.prototype.setSceneEffectId=function(t){this.name=egret.getQualifiedClassName(this)+":"+t,this.m_csvData=SceneEffectJson.getData(t),this.m_mapEffectUrl=TextureFrom.SCENEEFFECT+PublicCon.PATH_SCENE_EFFECT+this.m_csvData.folderPath+"/stand.png",TextureLoadManager.instance.requestLoadTextureAtlas(this.m_mapEffectUrl,this,LoaderPriority.MAPUNIT,!1),this.name=this.m_csvData.folderPath},e.prototype.onloadComplete=function(t){this.isDestory||this.m_mc||(this.m_mc=new MovieClip(TexturePool.instance.getTextureAtlas(t),this.m_csvData.fps),this.m_mc.anchorOffsetX=.5*this.m_mc.texture.textureWidth+this.m_csvData.offsetX,this.m_mc.anchorOffsetY=.5*this.m_mc.texture.textureHeight+this.m_csvData.offsetY,this.m_mc.blendMode=this.m_csvData.blendMode,this.m_mc.play(),this.m_mc.touchEnabled=!1,this.addChild(this.m_mc))},e.prototype.resetPosition=function(){this.m_mc.anchorOffsetX=.5*this.m_mc.width+this.m_csvData.offsetX,this.m_mc.anchorOffsetY=.5*this.m_mc.height+this.m_csvData.offsetY},e.prototype.destory=function(){TextureLoadManager.instance.closeLoad(this.m_mapEffectUrl,this),this.m_mc&&(this.isDestory=!0,this.m_csvData=null,this.m_mc.removeEventListeners(),this.m_mc.removeFromParent(),this.m_mc.dispose(),this.m_mc.stop(),this.m_mc=null)},Object.defineProperty(e.prototype,"hitRect",{get:function(){if(this.m_mc){var t=.5*this.m_mc.texture.textureWidth,e=.5*this.m_mc.texture.textureHeight;this.m_trueRect.x=this.x+(this.m_mc.x-t-this.csvData.offsetX),this.m_trueRect.y=this.y+(this.m_mc.y-e-this.csvData.offsetY),this.m_trueRect.width=t,this.m_trueRect.height=e}return this.m_trueRect},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this.$getX()},set:function(t){this.$setX(Math.floor(t))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.$getY()},set:function(t){this.$setY(Math.floor(t))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mc",{get:function(){return this.m_mc},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"csvData",{get:function(){return this.m_csvData},enumerable:!0,configurable:!0}),e.prototype.removeFromParent=function(){this.parent&&this.parent.removeChild(this)},e}(egret.DisplayObjectContainer);__reflect(SceneEffectBase.prototype,"SceneEffectBase",["ITextureLoadEvent"]);var JumpConfig=function(){function t(){}return t.JUMPSPEED=450,t.JUMPHEIGHT=200,t.JUMP_1=1,t.JUMP_2=2,t.JUMP_3=3,t.JUMP_4=4,t.JUMP_5=5,t.JUMP_DOGE=6,t}();__reflect(JumpConfig.prototype,"JumpConfig");var PublicCon=function(){function t(){}return t.DEL_FPS=60,t.DIRECTION_MAX=5,t.PATH_FPS_TIME_GAP=.016666,t.PATH_MAP="resource/assets/scene/map/",t.PATH_SCENE_EFFECT="resource/assets/scene/",t.PATH_ITEM_ICON="resource/assets/icon/item/",t.PATH_PERSONAL_ICON="resource/assets/icon/gexinghua/",t.PATH_REPLACE_URL="resource/assets/character/replaceMC/replaceMC.png",t.PATH_AVATAR="resource/assets/character/",t.PATH_BOSS_HEAD="resource/assets/icon/monster/icon/",t.PATH_MOUNT="resource/assets/mount/",t.PATH_SOUND_BJ="resource/assets/sound/backgroundSound/",t.PATH_SOUND_EFFECT="resource/assets/sound/soundEffect/",t.PATH_EFFECT="resource/assets/effect/",t.PATH_EFFECT_CHUANSONG=t.PATH_EFFECT+"chuansongEffect/",t.PATH_EFFECT_CLICK_STAGE=t.PATH_EFFECT+"clickStage/clickStage",t.PATH_EFFECT_MONSTER=t.PATH_EFFECT+"monster/",t.PATH_EFFECT_BINGDONG=t.PATH_EFFECT+"bingDong/",t.PATH_EFFECT_PLAYER=t.PATH_EFFECT+"player/",t.PATH_LIGHTNING="resource/assets/skills/lightning/",t.PATH_BINGDONG_SKILL="resource/assets/skills/forzen_skill_effect/",t.PATH_SCENE_WEAPON="resource/assets/role/weapon/scene/",t.PATH_SCENE_WING="resource/assets/role/wing/scene/",t.PATH_SCENE_MAGIC="resource/assets/role/magic/scene/",t.PATH_UI_ROLE="resource/assets/role/role/ui/",t.PATH_FLY_RES="resource/assets/effect/flyRes/",t.PATH_ENTRANCE_RES="resource/assets/icon/entrance/",t.PATH_SCENE_MAIN="resource/assets/icon/sceneMain/",t.PATH_SCENE_MONSTER_NAME="resource/assets/icon/monsterInfo/name/",t.PATH_SCENE_MONSTER="resource/assets/icon/monsterInfo/icon/",t.PATH_HERO="resource/assets/icon/hero/",t.PATH_CARDBOOK="resource/assets/icon/cardBook/",t.PATH_SCENE_SELECT="resource/assets/icon/sceneSelect/",t.PATH_TASK="resource/assets/icon/task/",t.PATH_BOSS_EVENT="resource/assets/icon/bossEvent/",t.PATH_MONSTER_HEAD="resource/assets/icon/headMonster/",t.PATH_VIPLEVEL_AWARD="resource/assets/icon/vip/",t.PATH_DRAGON_RES="resource/assets/dragon/bossEvents/",t.PATH_GEXINGHUA_RES="resource/assets/icon/gexinghua/",t}();__reflect(PublicCon.prototype,"PublicCon");var AvatarConfig=function(){function t(){}return t.getDirection=function(t,e){var i=180*Math.atan2(e,t)/Math.PI,s=1;return 0>i&&(i+=360),i>=337.5||22.5>i?s=2:i>=22.5&&67.5>i?s=3:i>=67.5&&112.5>i?s=4:i>=112.5&&157.5>i?s=5:i>=157.5&&202.5>i?s=6:i>=202.5&&247.5>i?s=7:i>=247.5&&292.5>i?s=0:i>=292.5&&337.5>i&&(s=1),s},t.getDireDistance=function(t,e,i){void 0===i&&(i=50);var s=this.getDirection(PlayerManager.instance.p_mainPlayer.x-t,PlayerManager.instance.p_mainPlayer.y-e);switch(s){case 0:return[t,e-i];case 1:return[t+i,e-i];case 2:return[t+i,e];case 3:return[t+i,e+i];case 4:return[t,e+i];case 5:return[t-i,e+i];case 6:return[t-i,e];case 7:return[t-i,e-i]}return[t,e]},t.getRealDrection=function(t){if(5>t)return t;switch(t){case 5:return 3;case 6:return 2;case 7:return 1}return 0},t.DIRECTION_MAX=5,t.ACTION_stand="stand",t.ACTION_move="move",t.ACTION_die="die",t.ACTION_attack="attack",t.ACTION_attack01="attack01",t.ACTION_attack02="attack02",t.ACTION_attack03="attack03",t.ACTION_attack04="attack04",t.ACTION_injure="injure",t.ACTION_jump="jump",t.ACTION_jump01="jump01",t.ACTION_jump02="jump02",t.ACTION_jump03="jump03",t.ACTION_jump04="jump04",t.ACTION_jump05="jump05",t.ACTION_skill01="skill01",t.ACTION_skill02="skill02",t.ACTION_skill03="skill03",t.ACTION_skill04="skill04",t.ACTION_skill05="skill05",t.ACTION_skill06="skill06",t.ACTION_skill07="skill07",t.ACTION_skill08="skill08",t}();__reflect(AvatarConfig.prototype,"AvatarConfig");var AvatarPlayer=function(t){function e(){var e=t.call(this)||this;return e.m_changeTime=-1,e.m_dashJiantou=null,e.touchEnabled=e.touchChildren=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"playerData",{get:function(){return this.m_playerData},set:function(t){this.m_playerData=t,this.p_isDie=!1,this.setSkillStateData(t),this.hotTouchable=!0,this.setName(),this.showAllEffect()},enumerable:!0,configurable:!0}),e.prototype.setSkillStateData=function(t){this.m_skillData={};var e=ServerTimeManager.instance.timer;t.huo_qiu_time>e&&(this.m_skillData[FightSkillManager.type_huoqiu]=t.huo_qiu_time),t.di_zhen_time>e&&(this.m_skillData[FightSkillManager.type_dizhen]=t.di_zhen_time),t.shen_long_time>e&&(this.m_skillData[FightSkillManager.type_shenlong]=t.shen_long_time),t.special_skill_id==FightSkillManager.type_lightning&&t.special_skill_expire_time>e&&(this.m_skillData[FightSkillManager.type_lightning]=t.special_skill_expire_time)},e.prototype.showHideAvatar=function(){PlayerManager.instance.p_playerIsShow?(this.showAllEffect(),SceneLayerModule.instance.liveThingsLayer.addChild(this)):(this.destoryOther(),DisplayObjectUtils.removeFormParent(this))},e.prototype.showHideEffect=function(){PlayerManager.instance.p_playerEffectIsShow?this.showAllEffect():this.setHideEffect()},e.prototype.showAllEffect=function(){this.setWeapon(),this.setMagicWeapon(),this.setShenLong(),this.setHuoqiu(),this.setDizhen(),this.setShandianlian(),this.m_liveHead&&this.m_liveHead.showEffect()},e.prototype.showBubbleLine=function(t,e){null==this.m_bubbleLine&&(this.m_bubbleLine=new BubbleLine,this.addChild(this.m_bubbleLine)),0==t?this.m_bubbleLine.showBubble(e):1==t&&this.m_bubbleLine.showSticker(e)},e.prototype.setChatBubble=function(){null==this.m_bubbleLine&&(this.m_bubbleLine=new BubbleLine,this.addChild(this.m_bubbleLine)),this.m_bubbleLine.setChatBubble()},e.prototype.playSkill=function(t,e,i,s,n){if(null!=this.m_actionUrlDict&&!(this.m_changeTime>0&&this.m_changeTime>ServerTimeManager.instance.timerValue)){var o=ActiveSkillJson.getData(t),a=o.continue_time.split("|"),r=Number(a.length>=2?a[this.playerData.sex]:a[0]);this.m_changeTime=ServerTimeManager.instance.timerValue+r;var _=ActiveSkillJson.getData(t).action_res;"0"!=_&&(this.checkHaveAction(_,e)?this.shiftToAction(_,e):this.shiftToAction(AvatarConfig.ACTION_attack01,e));var h=FightModule.instance.getAttackPathName(t);"0"!=h&&FightUIModule.instance.showDaoGuang(this,h,this.m_playerData.hero_arms_id,e,t)}},e.prototype.playMaxSkill=function(t,e,i,s,n){var o=this;if(null!=this.m_actionUrlDict&&this.curPreferentialState!=StateType.SKILL){this.curPreferentialState=StateType.SKILL;var a=AvatarConfig.ACTION_skill01;"0"!=a&&(this.checkHaveAction(a,e)?this.shiftToAction(a,e):this.shiftToAction(AvatarConfig.ACTION_attack01,e)),Skills.instance.playSkillAction(t,this,i,s,n),this instanceof AvatarMainPlayer?TweenLite.delayedCall(SkillJson.getData(t).ForceStorageRound,function(){o.curPreferentialState=StateType.SKILL_End},null,this):this.curPreferentialState=StateType.SKILL_End}},e.prototype.setYunXuan=function(t){var e=t-ServerTimeManager.instance.timer+1;if(!(0>=e)){MoveManager.instance.stopMove(this,!0),TweenLite.killTweensOf(this.onXuanyunHide,this),this.curPreferentialState=StateType.XUAN_YUN,TweenLite.delayedCall(e,this.onXuanyunHide,null,this);var i=this.pointCentered;this.m_xuanyunEffect||(this.m_xuanyunEffect=new EffectMovieClip,this.m_xuanyunEffect.setMC(PublicCon.PATH_EFFECT_PLAYER+"xuanyun")),this.m_xuanyunEffect.x=i[0],this.m_xuanyunEffect.y=i[1]-80,this.addChild(this.m_xuanyunEffect),this.m_xuanyunEffect.play()}},e.prototype.onXuanyunHide=function(){this.curPreferentialState=StateType.XUAN_YUN_END,this.m_xuanyunEffect&&(this.m_xuanyunEffect.stop(),DisplayObjectUtils.removeFormParent(this.m_xuanyunEffect),this.m_xuanyunEffect=null)},e.prototype.shiftActionHandle=function(){this.m_weapon&&(this.m_weapon.loopActionBean=this.m_loopActionBean,this.m_weapon.shiftToAction(this.curAction,this.curDirection)),t.prototype.shiftActionHandle.call(this)},e.prototype.shiftDirectionHandle=function(){t.prototype.shiftDirectionHandle.call(this)},e.prototype.setName=function(){this.m_liveName=this.m_playerData.nickname+(URIManager.isdebug?" id:"+this.m_playerData.player_id:""),this.liveName=this.m_liveName},e.prototype.setWeapon=function(){(PlayerManager.instance.p_playerIsShow||!this.isOtherPlayer)&&(HeroPartsJson.getData(this.m_playerData.hero_arms_id)?(this.m_weapon||(this.m_weapon=new Weapon,this.m_weapon.player=this),this.m_weapon.setWeapon(this.m_playerData.hero_arms_id)):null!=this.m_weapon&&(this.m_weapon.destory(),this.m_weapon=null))},e.prototype.changeWeapon=function(){this.m_weapon&&this.m_weapon.changeWeapon()},Object.defineProperty(e.prototype,"jumpHeight",{get:function(){return this.m_jumpHeight},set:function(t){this.m_jumpHeight=t,this.anchorOffsetY=this.m_hangingHeight+this.m_jumpHeight,this.m_magic&&(this.m_magic.y=t)},enumerable:!0,configurable:!0}),e.prototype.setMagicWeapon=function(){(PlayerManager.instance.p_playerIsShow||!this.isOtherPlayer)&&(PlayerManager.instance.p_playerEffectIsShow||!this.isOtherPlayer)&&(SysCommonJson.getData(this.playerData.magic_weapon_id)?(this.m_magic||(this.m_magic=new MagicWeapon),this.m_magic.setMagicWeapon(this,this.playerData.magic_weapon_id)):this.m_magic&&(this.m_magic.destory(),this.m_magic=null))},e.prototype.setShenLong=function(){if((PlayerManager.instance.p_playerIsShow||!this.isOtherPlayer)&&(PlayerManager.instance.p_playerEffectIsShow||!this.isOtherPlayer)){var t=this.getAttackSkillTime(FightSkillManager.type_shenlong);t>0?(this.m_shenLong||(this.m_shenLong=new ShenLongEffect(this.hideShenlong.bind(this))),this.m_shenLong.show(this,t)):this.m_shenLong&&(this.m_shenLong.destory(),this.m_shenLong=null)}},e.prototype.hideShenlong=function(){delete this.m_skillData[FightSkillManager.type_shenlong],this.m_shenLong&&(this.m_shenLong.destory(),this.m_shenLong=null)},e.prototype.setHuoqiu=function(){if((PlayerManager.instance.p_playerIsShow||!this.isOtherPlayer)&&(PlayerManager.instance.p_playerEffectIsShow||!this.isOtherPlayer)){var t=this.getAttackSkillTime(FightSkillManager.type_huoqiu);t>0?(this.m_huoqiu||(this.m_huoqiu=new HuoQiuEffect(this.hideHuoqiu.bind(this))),this.m_huoqiu.show(this,t)):this.m_huoqiu&&(this.m_huoqiu.destory(),this.m_huoqiu=null)}},e.prototype.hideHuoqiu=function(){delete this.m_skillData[FightSkillManager.type_huoqiu],this.m_huoqiu&&(this.m_huoqiu.destory(),this.m_huoqiu=null)},e.prototype.setDizhen=function(){if((PlayerManager.instance.p_playerIsShow||!this.isOtherPlayer)&&(PlayerManager.instance.p_playerEffectIsShow||!this.isOtherPlayer)){var t=this.getAttackSkillTime(FightSkillManager.type_dizhen);t>0?(this.m_dizhen||(this.m_dizhen=new DiZhenEffect(this.hideDizhen.bind(this))),this.m_dizhen.show(this,t)):this.m_dizhen&&(this.m_dizhen.destory(),this.m_dizhen=null)}},e.prototype.hideDizhen=function(){delete this.m_skillData[FightSkillManager.type_dizhen],this.m_dizhen&&(this.m_dizhen.destory(),this.m_dizhen=null)},e.prototype.setShandianlian=function(){if((PlayerManager.instance.p_playerIsShow||!this.isOtherPlayer)&&(PlayerManager.instance.p_playerEffectIsShow||!this.isOtherPlayer)){var t=this.getAttackSkillTime(FightSkillManager.type_lightning);t>0?(this.m_shandianlian||(this.m_shandianlian=new ShanDianLianEffect(this.hideShandianlian.bind(this))),this.m_shandianlian.show(this,t)):this.m_shandianlian&&(this.m_shandianlian.destory(),this.m_shandianlian=null)}},e.prototype.hideShandianlian=function(){delete this.m_skillData[FightSkillManager.type_lightning],this.m_shandianlian&&(this.m_shandianlian.destory(),this.m_shandianlian=null)},e.prototype.showDashJiantou=function(t){null==this.m_dashJiantou&&(this.m_dashJiantou=new eui.Image,this.m_dashJiantou.source="userMainUI_json.userMainUI_d_skill_power2",this.m_dashJiantou.scale9Grid=new egret.Rectangle(17,29,9,19),this.m_dashJiantou.height=120,this.m_dashJiantou.anchorOffsetX=21,this.m_dashJiantou.anchorOffsetY=130,this.m_dashJiantou.alpha=.6,this.addChildAt(this.m_dashJiantou,0)),this.m_dashJiantou.visible=!0,this.m_dashJiantou.rotation=t},e.prototype.hideDashJiantou=function(){this.m_dashJiantou&&(this.m_dashJiantou.visible=!1)},e.prototype.showDashEffectStart=function(t){void 0===t&&(t=null);var e=PublicCon.PATH_EFFECT_PLAYER+"shanxian";FightUIModule.instance.showEffect(e,this.xyCentered,SceneLayerModule.instance.upEffectLayer)},e.prototype.destory=function(){this.destoryOther(),this.m_xuanyunEffect&&(this.m_xuanyunEffect.stop(),DisplayObjectUtils.removeFormParent(this.m_xuanyunEffect),this.m_xuanyunEffect=null),TweenLite.killTweensOf(this.onXuanyunHide,this),t.prototype.destory.call(this)},e.prototype.destoryOther=function(){this.setHideEffect(),null!=this.m_weapon&&(this.m_weapon.destory(),this.m_weapon=null),this.m_liveHead&&this.m_liveHead.hideEffect()},e.prototype.setHideEffect=function(){this.m_magic&&(this.m_magic.destory(),this.m_magic=null),this.m_shenLong&&(this.m_shenLong.destory(),this.m_shenLong=null),this.m_huoqiu&&(this.m_huoqiu.destory(),this.m_huoqiu=null),this.m_dizhen&&(this.m_dizhen.destory(),this.m_dizhen=null),this.m_shandianlian&&(this.m_shandianlian.destory(),this.m_shandianlian=null)},Object.defineProperty(e.prototype,"magic",{get:function(){return this.m_magic},enumerable:!0,configurable:!0}),e}(AvatarFighter);__reflect(AvatarPlayer.prototype,"AvatarPlayer");var ItemRendererBase=function(t){function e(e){var i=t.call(this)||this;return i.m_isComplete=!1,i.m_completeCallList=[],i.m_tweenBool=!0,i.p_tweenFinishBool=!0,i.m_clickList={},i.once(egret.Event.COMPLETE,i.onCompleted,i),i.skinName=e,i}return __extends(e,t),e.prototype.registerEventClick=function(t,e,i,s,n,o){void 0===s&&(s=!1),void 0===n&&(n=SoundEnum.EFFECT_SOUND_1007),void 0===o&&(o=null),DisplayObjectUtils.registerEventClick(t,e,i,s,n,o)},e.prototype.removeEventClick=function(t){DisplayObjectUtils.removeEventClick(t)},e.prototype.onCompleted=function(){this.initView(),this.initEvent(),this.m_isComplete=!0;for(var t=0;t<this.m_completeCallList.length;t++)this.m_completeCallList[t].func.apply(this.m_completeCallList[t].thisArg,this.m_completeCallList[t].args),this.m_completeCallList[t].func=null,this.m_completeCallList[t].args=null;this.m_completeCallList.length=0},e.prototype.initView=function(){},e.prototype.initEvent=function(){this.addEventListener(egret.TouchEvent.REMOVED_FROM_STAGE,this.onRemoveStage,this),this.addEventListener(egret.TouchEvent.ADDED_TO_STAGE,this.onAddStage,this)},e.prototype.checkComplete=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(this.m_isComplete)return!0;var s=new callfunction;return s.thisArg=this,s.func=t,s.args=e,this.m_completeCallList.push(s),!1},e.prototype.onRemoveStage=function(t){this.m_tweenBool=!0,Dispatch.remove(GuideConfig.guide_render_click,this.onGuideCheck,this)},e.prototype.onAddStage=function(t){Dispatch.register(GuideConfig.guide_render_click,this.onGuideCheck,this)},e.prototype.dataChanged=function(){this.data&&this.checkComplete(this.dataChanged)&&this.tweenType>0&&this.m_tweenBool&&(this.p_tweenFinishBool=!1,this.m_tweenBool=!1,this.alpha=0,1==this.tweenType?this.scaleX=this.scaleValue:this.scaleY=this.scaleValue,TweenLite.to(this,this.toTime,{delay:this.lastTime+this.itemIndex*this.delayTime,scaleX:1,scaleY:1,alpha:1,onComplete:this.tweenFinish.bind(this)}))},e.prototype.tweenFinish=function(){this.p_tweenFinishBool=!0},e.prototype.onGuideCheck=function(t){},Object.defineProperty(e.prototype,"tweenType",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleValue",{get:function(){return.5},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"toTime",{get:function(){return.2},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lastTime",{get:function(){return.1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"delayTime",{get:function(){return.1},enumerable:!0,configurable:!0}),e}(eui.ItemRenderer);__reflect(ItemRendererBase.prototype,"ItemRendererBase");var PageBase=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e}return __extends(e,t),e.prototype.hide=function(t){void 0===t&&(t=null),this.parent&&this.parent.removeChild(this)},e.prototype.remveStageThis=function(){this.hide(),this.disposeAllTexture()},e.prototype.isCloseUI=function(t){return void 0===t&&(t=!0),!0},e}(DisplayBase);__reflect(PageBase.prototype,"PageBase");var UIBase=function(t){function e(){var e=t.call(this)||this;return e.m_currList=[],e}return __extends(e,t),e.prototype.initView=function(){this.m_effectOpenType=1,this.m_effectCloseType=1,this.m_pageContent||(this.m_pageContent=new egret.DisplayObjectContainer,this.addChild(this.m_pageContent)),this.m_currList&&this.m_currList.length>0&&!this.m_pageSelect&&(this.m_pageSelect=new SelectOptions(this,this.setSelectPage.bind(this)))},e.prototype.setSelectPage=function(t){this.m_currBase&&this.m_currBase.hide(),this.m_currBase=null;for(var e=0;e<this.m_currList.length;e++)if(this.m_currList[e].funcKey==t){this.m_currBase=this.m_currList[e].pageMc;break}this.m_currBase&&this.m_currBase.startShowLoad(this.m_currBase,this.pageContent)},e.prototype.addStageThis=function(){this.addMask(),UIModule.instance.addPopup(this)},e.prototype.addMask=function(){this.m_maskImg||(this.m_maskImg=new eui.Image("commonUI_box"),this.m_maskImg.scale9Grid=new egret.Rectangle(3,3,4,4),this.m_maskImg.alpha=0,this.m_maskImg.width=StageManager.instance.p_stageWidth,this.m_maskImg.height=StageManager.instance.p_stageHeight),UIModule.instance.middleUILayer.addChild(this.m_maskImg)},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_1009),this.m_pageSelect&&(e&&e.c_pageKey?this.m_pageSelect.setSelect(e.c_pageKey):this.m_pageSelect.setSelect(this.m_currList[0].funcKey)))},e.prototype.close=function(t){void 0===t&&(t=null),0!=this.isCloseUI()&&UIModule.instance.hideUI(this.m_baseId)},e.prototype.onGuideClose=function(t){t&&t.c_ui_id==this.m_baseId&&this.close()},e.prototype.sureHide=function(e,i){void 0===i&&(i=null),t.prototype.sureHide.call(this,e,i);for(var s in this.m_currList)this.m_currList[s].pageMc.remveStageThis();this.m_maskImg&&DisplayObjectUtils.removeFormParent(this.m_maskImg)},Object.defineProperty(e.prototype,"guideConfigId",{get:function(){return GuideConfig.guide_ui_close},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageContent",{get:function(){return this.m_pageContent},enumerable:!0,configurable:!0}),e.prototype.checkPageFunc=function(t){return!0},Object.defineProperty(e.prototype,"itemIdList",{get:function(){return[ItemEnum.GOLD,ItemEnum.RMB]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showNotice",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"uiTitle",{get:function(){if(!UIConfig.p_uiNameDic&&LanguageJson.getData("l_ui_name_list")){UIConfig.p_uiNameDic={};for(var t=LanguageJson.getText("l_ui_name_list"),e=t.split("|"),i=0;i<e.length;i++){var s=e[i].split("_");UIConfig.p_uiNameDic[s[0]]=s[1]}}return UIConfig.p_uiNameDic[this.m_baseId]?UIConfig.p_uiNameDic[this.m_baseId]:"语言表l_ui_name_list字段添加ID_"+this.m_baseId+"配置"},enumerable:!0,configurable:!0}),e.prototype.isCloseUI=function(t){return void 0===t&&(t=!0),this.m_currBase?this.m_currBase.isCloseUI(t):!0},Object.defineProperty(e.prototype,"outMissionAny",{get:function(){return null},enumerable:!0,configurable:!0}),e}(PopupBase);__reflect(UIBase.prototype,"UIBase");var callfunction=function(){function t(){}return t}();__reflect(callfunction.prototype,"callfunction");var FloatTipBase=function(t){function e(){var e=t.call(this)||this;return e.once(egret.Event.COMPLETE,e.onCompleted,e),e.touchChildren=!1,e.touchEnabled=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"displayObject",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"originY",{get:function(){return this.m_originY},set:function(t){this.m_originY=this.y=t},enumerable:!0,configurable:!0}),e.prototype.onCompleted=function(){null!=this.u_tipIcon&&(this.m_iconSrc=this.u_tipIcon.source),t.prototype.onCompleted.call(this)},e.prototype.setData=function(t,e,i,s){void 0===e&&(e=!0),null!=t&&this.checkComplete(this.setData,t,e,i,s)&&(this.u_tipLabel.width=0/0,null!=this.u_tipLabel&&(null!=t.p_text&&(this.u_tipLabel.text=t.p_text),null!=t.p_textFlow&&(this.u_tipLabel.textFlow=t.p_textFlow)),null!=this.u_tipIcon&&(this.u_tipIcon.visible=t.p_bHasIcon,null!=t.p_iconSrc&&this.u_tipIcon.source!=t.p_iconSrc&&(this.u_tipIcon.source=t.p_iconSrc)),this.reSize(e,i,s),this.reDraw())},e.prototype.reDraw=function(){return 0==GameManager.instance.p_isTexture?void(this.u_tipLabel.visible=!0):(null==this.m_viewImage&&(this.m_viewImage=new egret.Bitmap),null==this.m_renderTexture&&(this.m_renderTexture=new egret.RenderTexture),this.u_tipLabel.visible=!0,this.m_renderTexture.drawToTexture(this.u_tipLabel,null,1),this.m_viewImage.texture=this.m_renderTexture,this.m_viewImage.x=this.u_tipLabel.x,this.m_viewImage.y=this.u_tipLabel.y,this.u_tipLabel.visible=!1,void this.u_tipLabel.parent.addChild(this.m_viewImage))},e.prototype.reSize=function(t,e,i){void 0===t&&(t=!0),this.u_tipIcon&&1==this.u_tipIcon.visible?(null==this.u_tipInfoGroup&&(this.u_tipInfoGroup=new eui.Group,this.u_tipInfoGroup.verticalCenter=0,this.u_tipInfoGroup.horizontalCenter=0),this.u_tipInfoGroup.addChild(this.u_tipLabel),this.u_tipInfoGroup.addChild(this.u_tipIcon),this.u_tipGroup.addChild(this.u_tipInfoGroup),this.u_tipLabel.horizontalCenter=0/0,this.u_tipLabel.verticalCenter=this.m_tipLabelVC,this.u_tipLabel.x=this.m_tipLabelX,this.u_tipBG.width=this.u_tipLabel.width+2*FloatTipModule.offX+this.u_tipLabel.x):(this.u_tipLabel.x=Math.floor(.5*(640-this.u_tipLabel.width)),this.u_tipLabel.y=Math.floor(.5*(40-this.u_tipLabel.height)),this.u_tipBG.width=this.u_tipLabel.width+2*FloatTipModule.offX),this.u_tipBG.height=this.u_tipLabel.height+2*FloatTipModule.offY+20,t&&this.play(e,i)},e.prototype.play=function(t,e){if(this.checkComplete(this.play,t,e)){FloatTipModule.instance.calcPos(this.m_originY);var i=this.u_tipGroup;i.verticalCenter=i.height+this.m_tipLabelVC,i.alpha=1,TweenMax.killChildTweensOf(i),TweenMax.to(i,.2,{verticalCenter:0}),TweenMax.to(i,.5,{delay:1,alpha:0,onComplete:t.bind(e),onCompleteParams:[this]})}},e.prototype.onDestroy=function(){DisplayObjectUtils.removeFormParent(this),null!=this.u_tipIcon&&null!=this.m_iconSrc&&this.u_tipIcon.source!=this.m_iconSrc&&(this.u_tipIcon.source=this.m_iconSrc),this.u_tipLabel.x=this.m_tipLabelX,this.u_tipGroup.addChild(this.u_tipLabel),DisplayObjectUtils.removeFormParent(this.u_tipInfoGroup),null!=this.m_viewImage&&(this.m_viewImage.texture=null,this.m_viewImage.parent&&this.m_viewImage.parent.removeChild(this.m_viewImage)),null!=this.m_renderTexture&&(this.m_renderTexture.dispose(),this.m_renderTexture=null)},e}(ComponentBase);__reflect(FloatTipBase.prototype,"FloatTipBase");var FunctionIcon=function(t){function e(e){void 0===e&&(e=!0);var i=t.call(this)||this;return i.m_point=new egret.Point,i.touchEnabled=!1,i.m_isSkin=e,i.m_isSkin&&(i.once(egret.Event.COMPLETE,i.onCompleted,i),i.skinName="resource/eui_skins/commonsUI/entrance/EntranceIconSkin.exml"),i}return __extends(e,t),e.prototype.onCompleted=function(){this.u_btnClick.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),t.prototype.onCompleted.call(this)},e.prototype.setData=function(t){if(this.checkComplete(this.setData,t)){this.m_json=t;var e=this.m_json.effect_list;e&&e.length>0&&(this.m_effects||(this.m_effects=new EffectMovieClip,this.m_effects.touchEnabled=!1,this.m_effects.touchChildren=!1,this.m_effects.x=52,this.m_effects.y=44,this.m_effects.blendMode=egret.BlendMode.ADD),this.m_effects.setMC("resource/assets/uiEffect/entrance/"+e[0]),this.m_effects.play(),this.addChildAt(this.m_effects,this.getChildIndex(this.u_imgName)-1),e[1]&&(this.m_effects.x+=Number(e[1])),e[2]&&(this.m_effects.y+=Number(e[2]))),this.u_imgIcon&&(this.u_imgIcon.source=this.m_json.icon+"_icon_ent",this.u_imgName.source=this.m_json.icon+"_name_ent"),this.setLabelMsg(),this.regiestRedView()}},e.prototype.regiestRedView=function(){1==this.m_json.bubble_type?RedNoticeManager.instance.registerRedBubbleTipMsg(this,this.m_json.bubble_data,this.m_json.enter_type,!0,null,EntranceConfig.getBubbleRedEnum(this.m_json.function_id)):2==this.m_json.bubble_type&&RedNoticeManager.instance.registerRedBubbleTipImage(this,this.m_json.bubble_data,this.m_json.enter_type,!0,null,EntranceConfig.getBubbleRedEnum(this.m_json.function_id)),this.m_json.is_init_red>0?RedNoticeManager.instance.registerRed(this,[RedNoticeConfig.RED_GAME_INIT],this.redPos):EntranceConfig.iconRedEnumDic[this.m_json.function_id]?RedNoticeManager.instance.registerRed(this,EntranceConfig.iconRedEnumDic[this.m_json.function_id],this.redPos):RedNoticeManager.instance.registerRed(this,[],this.redPos)
},e.prototype.setLabelMsg=function(t){void 0===t&&(t=""),this.checkComplete(this.setLabelMsg,t)&&null!=this.u_btnClick&&(""!=t?this.u_btnClick.height=90:this.u_btnClick.height=76,this.u_txtDesc.textFlow=TextUtil.setTextFlow(t))},e.prototype.onClick=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this.m_json&&FunctionManager.instance.executeFunction(this.m_json.function_config_id,e)},e.prototype.setPost=function(t,e,i,s){void 0===i&&(i=!1),void 0===s&&(s=null),this.checkComplete(this.setPost,t,e,i,s)&&(this.m_pox=t,this.m_poy=e,i?(TweenLite.killTweensOf(this),s.enter_type==this.m_json.enter_type&&s.index==this.m_json.index?(this.alpha=0,TweenLite.to(this,.6,{x:t,y:e,alpha:1,ease:Cubic.easeIn})):TweenLite.to(this,.6,{x:t,y:e,ease:Cubic.easeIn})):(this.x=this.m_pox,this.y=this.m_poy))},e.prototype.show=function(){this.checkComplete(this.show)&&(Dispatch.register(GuideConfig.guide_function_icon,this.guideClick,this),this.m_effects&&null==this.m_effects.parent&&(this.addChild(this.m_effects),this.m_effects.play()))},e.prototype.hide=function(){Dispatch.remove(GuideConfig.guide_function_icon,this.guideClick,this),this.m_effects&&(this.m_effects.stop(),DisplayObjectUtils.removeFormParent(this.m_effects)),DisplayObjectUtils.removeFormParent(this)},e.prototype.guideClick=function(t){t&&this.m_json&&this.m_json.function_id==t.c_function_id&&this.onClick()},Object.defineProperty(e.prototype,"dataVo",{get:function(){return this.m_json},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pointXY",{get:function(){return null==this.parent?null:(this.parent?(this.m_point.x=this.parent.x+this.width/2,this.m_point.y=(this.parent.y+this.height/2)/2):(this.m_point.x=this.m_pox,this.m_point.y=this.m_poy),this.m_point=this.localToGlobal(this.m_point.x,this.m_point.y),this.m_point)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return 90},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.u_txtDesc&&""!=this.u_txtDesc.text?100:90},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redPos",{get:function(){return[71,4]},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(FunctionIcon.prototype,"FunctionIcon");var MissionShishiPro=function(t){function e(){var e=t.call(this)||this;return e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/missionShishiUI/view/MissionShishiProSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.touchEnabled=!1,this.touchChildren=!1,this.m_numberView||(this.m_numberView=new NumberView("num_mission_",0,0),this.m_numberView.horizontalCenter=0,this.m_numberView.p_isDoller=!0,this.m_numberView.y=-17,this.u_grpPro.addChild(this.m_numberView))},e.prototype.show=function(t){void 0===t&&(t=null),this.checkComplete(this.show,t)&&(Dispatch.register(StageManager.EVENT_STAGE_RESIZE,this.stageResize,this,!0),Dispatch.register(MissionShiShiManager.EVENT_SHISHI_TOTAL,this.changeValue,this,!0))},e.prototype.changeValue=function(){this.m_numberView.numValue=MissionShiShiManager.instance.p_total},e.prototype.stageResize=function(){this.x=(StageManager.instance.p_stageWidth-this.width)/2},e.prototype.hide=function(){DisplayObjectUtils.removeFormParent(this),Dispatch.remove(StageManager.EVENT_STAGE_RESIZE,this.stageResize,this),Dispatch.remove(MissionShiShiManager.EVENT_SHISHI_TOTAL,this.changeValue,this)},Object.defineProperty(e.prototype,"width",{get:function(){return 370},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 102},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(MissionShishiPro.prototype,"MissionShishiPro");var UIConfig=function(){function t(){}return t.initUI=function(){this.p_uiClassDict[t.ID_ROLE]=RoleListUI,this.p_uiClassDict[t.ID_ROLE_INFO]=RoleUI,this.p_uiClassDict[t.ID_BAG]=BagUI,this.p_uiClassDict[t.ID_WELFARE]=WelfareUI,this.p_uiClassDict[t.ID_SHARE]=ShareUI,this.p_uiClassDict[t.ID_VIP]=VipUI,this.p_uiClassDict[t.ID_CHARGE]=ShopHallUI,this.p_uiClassDict[t.ID_TUJIAN]=CardBookUI,this.p_uiClassDict[t.ID_SCENE_SELECT]=SceneSelectUI,this.p_uiClassDict[t.ID_BOSS_GUESS]=GuessUI,this.p_uiClassDict[t.ID_MONSTER_INFO]=MonsterInfoUI,this.p_uiClassDict[t.ID_PASS_TICKET]=PassTicketUI},t.ID_ROLE=1,t.ID_BAG=2,t.ID_WELFARE=4,t.ID_SHARE=5,t.ID_VIP=7,t.ID_CHARGE=8,t.ID_TUJIAN=10,t.ID_SCENE_SELECT=12,t.ID_BOSS_GUESS=13,t.ID_MONSTER_INFO=14,t.ID_ROLE_INFO=15,t.ID_PASS_TICKET=16,t.p_uiDict=[],t.p_uiClassDict=[],t}();__reflect(UIConfig.prototype,"UIConfig");var CostJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},t.getCostByLevel=function(t){var e=[];for(var i in this.jsonData){var s=this.jsonData[i];s&&t>=s.conditions_limit_list[1]&&e.push(s.cost)}return ArrayUtils.setSortNum(e),e},t.getCostByLevelAndValue=function(t,e){for(var i=[],s=this.getCostByLevel(t),n=0;n<s.length;n++)s[n]>=e&&i.push(s[n]);return i},t.getCostByLevelAndList=function(t,e){for(var i=[],s=this.getCostByLevel(t),n=0;n<s.length;n++)s[n]>=e[0]&&s[n]<=e[1]&&i.push(s[n]);return i},t.getAttackSpeed=function(t){var e=this.getData(t);return e?e.attack_speed:150},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="cost",t}();__reflect(CostJson.prototype,"CostJson"),window.CostJson=CostJson;var DailyTaskJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},t.getDailyTaskIdList=function(){if(0==this.m_dailyTaskIdList.length){for(var t in this.jsonData)if(this.jsonData[t]){var e=this.jsonData[t];this.m_dailyTaskIdList.push(e.id)}ArrayUtils.setSortNum(this.m_dailyTaskIdList,0)}return this.m_dailyTaskIdList},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="daily_task",t.m_dailyTaskIdList=[],t}();__reflect(DailyTaskJson.prototype,"DailyTaskJson"),window.DailyTaskJson=DailyTaskJson;var DrawMoneyJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},t.getDrawMoneyIdList=function(){var t=[];for(var e in this.m_jsonData){var i=this.m_jsonData[e];i&&1==i.is_show&&t.push(i.id)}return ArrayUtils.setSortNum(t),t},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="draw_money",t}();__reflect(DrawMoneyJson.prototype,"DrawMoneyJson"),window.DrawMoneyJson=DrawMoneyJson;var EffectTypeJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},t.FileName="effect_type",t}();__reflect(EffectTypeJson.prototype,"EffectTypeJson"),window.EffectTypeJson=EffectTypeJson;var EverydaySignJson=function(){function t(){}return t.getData=function(t,e){var i=String(t+"_"+e),s=this.jsonData[i];return s||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),s},t.FileName="everyday_sign",t}();__reflect(EverydaySignJson.prototype,"EverydaySignJson"),window.EverydaySignJson=EverydaySignJson;var FirstRechargeJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},t.isRed=function(t){var e=this.getData(t);return e&&e.is_red>0?!0:!1},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="first_recharge",t}();__reflect(FirstRechargeJson.prototype,"FirstRechargeJson"),window.FirstRechargeJson=FirstRechargeJson;var FunctionConfigJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="function_config",t}();__reflect(FunctionConfigJson.prototype,"FunctionConfigJson"),window.FunctionConfigJson=FunctionConfigJson;var FunctionIconJson=function(){function t(){}return t.getData=function(t,e){var i=t+"_"+e,s=this.jsonData[i];return s||egret.log(this.FileName+" :不存在["+t+"_"+e+"]项！"),s},t.getListByType=function(t){var e=[];for(var i in this.jsonData){var s=this.jsonData[i];s&&s.enter_type==t&&e.push(s)}return ArrayUtils.setSortArr(e,["index"],[0]),e},t.getDataByFuncIdAcId=function(t,e){void 0===e&&(e=-1);var i=[];for(var s in this.jsonData){var n=this.jsonData[s];n&&n.function_id==t&&(e>0?n.activity_id==e&&i.push(n):i.push(n))}return i},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="function_icon",t}();__reflect(FunctionIconJson.prototype,"FunctionIconJson"),window.FunctionIconJson=FunctionIconJson;var FunctionJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||Trace.log(this.FileName+" :不存在["+t+"]项！"),i},t.getFuncIdList=function(t){var e=[];for(var i in this.jsonData){var s=this.jsonData[i].enter_list;if(s)for(var n=0;n<s.length;n++)Number(s[n])==t&&-1==e.indexOf(this.jsonData[i].id)&&e.push(this.jsonData[i].id)}return e},t.FileName="function",t}();__reflect(FunctionJson.prototype,"FunctionJson"),window.FunctionJson=FunctionJson;var GeXingHuaJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||egret.log(this.FileName+" :不存在["+t+"]项！"),i},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.getJsonWithItemId=function(t){var e;for(var i in this.jsonData)if(this.jsonData[i].item_id==t){e=this.jsonData[i];break}return e},t.FileName="ge_xing_hua",t}();__reflect(GeXingHuaJson.prototype,"GeXingHuaJson"),window.GeXingHuaJson=GeXingHuaJson;var GuideJson=function(){function t(){}return t.getData=function(t,e){var i=String(t+"_"+e),s=this.jsonData[i];return s||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),s},t.getNextStepId=function(t,e){if(null==this.jsonData||void 0==this.jsonData)return 0;var i=this.getData(t,e);return i?i.next_step:0},t.getNextGuide=function(t,e){return null==this.jsonData||void 0==this.jsonData?null:this.getData(t,this.getNextStepId(t,e))},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="guide",t}();__reflect(GuideJson.prototype,"GuideJson"),window.GuideJson=GuideJson;var HeadJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||egret.log(this.FileName+" :不存在["+t+"]项！"),i},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="head",t}();__reflect(HeadJson.prototype,"HeadJson"),window.HeadJson=HeadJson;var HeroJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||egret.log(this.FileName+" :不存在["+t+"]项！"),i},t.getHeroIdList=function(){if(0==this.m_heroIdList.length){for(var t in this.jsonData){var e=this.jsonData[t];e&&this.m_heroIdList.push(e)}ArrayUtils.setSortArr(this.m_heroIdList,["order"],[0])}return this.m_heroIdList},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="hero",t.m_heroIdList=[],t}();__reflect(HeroJson.prototype,"HeroJson"),window.HeroJson=HeroJson;var HeroPartsJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||egret.log(this.FileName+" :不存在["+t+"]项！"),i},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="hero_parts",t}();__reflect(HeroPartsJson.prototype,"HeroPartsJson"),window.HeroPartsJson=HeroPartsJson;var HeroStarJson=function(){function t(){}return t.getData=function(t,e){var i=t+"_"+e,s=this.jsonData[i];return s||egret.log(this.FileName+" :不存在["+t+"_"+e+"]项！"),s},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="hero_star",t}();__reflect(HeroStarJson.prototype,"HeroStarJson"),window.HeroStarJson=HeroStarJson;var HitEffectJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},t.FileName="hit_effect",t}();__reflect(HitEffectJson.prototype,"HitEffectJson"),window.HitEffectJson=HitEffectJson;var ItemJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},t.getListByType=function(t){var e=[];for(var i in this.jsonData)this.jsonData[i].type==t&&e.push(this.jsonData[i]);return e},t.getName=function(e){var i=t.getData(e);return i?i.name:""},t.getIconId=function(e){var i=t.getData(e);return i?i.icon:0},t.getIconPath=function(e){var i=t.getData(e);return PublicCon.PATH_ITEM_ICON+i.icon+".png"},t.getSource=function(e,i){void 0===i&&(i="|n");var s=t.getData(e),n=[];if(s&&s.output_list)for(var o=0;o<s.output_list.length;o++){var a=FunctionConfigJson.getData(s.output_list[o]);a&&n.push(a.item_access)}var r=n.join(i);return r},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="item",t}();__reflect(ItemJson.prototype,"ItemJson"),window.ItemJson=ItemJson;var ItemTypeJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="item_type",t}();__reflect(ItemTypeJson.prototype,"ItemTypeJson"),window.ItemTypeJson=ItemTypeJson;var LanguageJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||""==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},t.getText=function(t){var e=this.jsonData[t];return e?e.content:(egret.log(this.FileName+" :不存在["+t+"]项！"),"文本"+t)},t.getHtmlTextFlow=function(t,e){void 0===e&&(e=null);var i=this.jsonData[t];return i?HtmlUtil.setTextFlow(i.content,e):(egret.log(this.FileName+" :不存在["+t+"]项！"),(new egret.HtmlTextParser).parser("文本"+t+(e?e.toString():"")))},t.getHtmlText=function(t,e){void 0===e&&(e=null);var i=this.jsonData[t];return i?HtmlUtil.setText(i.content,e):(egret.log(this.FileName+" :不存在["+t+"]项！"),"")},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="language",t}();__reflect(LanguageJson.prototype,"LanguageJson"),window.LanguageJson=LanguageJson;var LogTypeJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},t.FileName="log_type",t}();__reflect(LogTypeJson.prototype,"LogTypeJson"),window.LogTypeJson=LogTypeJson;var MailJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||egret.log(this.FileName+" :不存在["+t+"]项！"),i},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="mail",t}();__reflect(MailJson.prototype,"MailJson"),window.MailJson=MailJson;var MergeJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},t.getItemMergeId=function(t){if(!this.m_useItemList){this.m_useItemList={};for(var e in this.jsonData)for(var i=this.jsonData[e],s=0;s<i.item_list.length;s++)this.m_useItemList[i.item_list[s][0]+"_"+i.item_list[s][1]]=[i.id,i.item_list[s][2]]}return this.m_useItemList[t]?this.m_useItemList[t]:null},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="merge",t}();__reflect(MergeJson.prototype,"MergeJson"),window.MergeJson=MergeJson;var MessageJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},t.FileName="message",t}();__reflect(MessageJson.prototype,"MessageJson"),window.MessageJson=MessageJson;var MissionBraveOneJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},t.getDataByTip=function(t){var e=[];for(var i in this.jsonData){var s=this.jsonData[i];s&&s.tips==t&&e.push(s)}return e},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="mission_brave_one",t}();__reflect(MissionBraveOneJson.prototype,"MissionBraveOneJson"),window.MissionBraveOneJson=MissionBraveOneJson;var MissionGuessBossSkillJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||egret.log(this.FileName+" :不存在["+t+"]项！"),i},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="mission_guess_boss_skill",t}();__reflect(MissionGuessBossSkillJson.prototype,"MissionGuessBossSkillJson"),window.MissionGuessBossSkillJson=MissionGuessBossSkillJson;var MissionJson=function(){function t(){}return t.getData=function(t,e){var i=t+"_"+e,s=this.jsonData[i];return s||egret.log(this.FileName+" :不存在["+t+"_"+e+"]项！"),s},t.getListByType=function(t){if(!this.m_jsonList[t]){var e=[];for(var i in this.jsonData){var s=this.jsonData[i];s&&s.mission_type==t&&e.push(s)}ArrayUtils.setSortArr(e,["id"],[0]),this.m_jsonList[t]=e}return this.m_jsonList[t]},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="mission",t.m_jsonList={},t}();__reflect(MissionJson.prototype,"MissionJson"),window.MissionJson=MissionJson;var MissionManyPeopleBossJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},t.getMultiBossList=function(){var t=[];for(var e in this.jsonData)if(this.jsonData[e]){var i=this.jsonData[e];t.push(i.id)}return ArrayUtils.setSortNum(t,0),t},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="mission_many_people_boss",t}();__reflect(MissionManyPeopleBossJson.prototype,"MissionManyPeopleBossJson"),window.MissionManyPeopleBossJson=MissionManyPeopleBossJson;var MissionTypeJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},t.FileName="mission_type",t}();__reflect(MissionTypeJson.prototype,"MissionTypeJson"),window.MissionTypeJson=MissionTypeJson;var MonsterDropJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},t.FileName="monster_drop",t}();__reflect(MonsterDropJson.prototype,"MonsterDropJson"),window.MonsterDropJson=MonsterDropJson;var MonsterFunctionFanpaiJson=function(){function t(){}return t.getData=function(t,e){var i=t+"_"+e,s=this.jsonData[i];return s||egret.log(this.FileName+" :不存在["+t+"_"+e+"]项！"),s},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.getJsonDatas=function(t){var e=this.jsonData,i=[];for(var s in e)s.indexOf(t+"_")>=0&&i.push(e[s]);return i},t.FileName="monster_function_fanpai",t}();__reflect(MonsterFunctionFanpaiJson.prototype,"MonsterFunctionFanpaiJson"),window.MonsterFunctionFanpaiJson=MonsterFunctionFanpaiJson;var MonsterFunctionLabaJson=function(){function t(){}return t.getData=function(t,e){var i=t+"_"+e,s=this.jsonData[i];return s||egret.log(this.FileName+" :不存在["+t+"_"+e+"]项！"),s},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="monster_function_laba",t}();__reflect(MonsterFunctionLabaJson.prototype,"MonsterFunctionLabaJson"),window.MonsterFunctionLabaJson=MonsterFunctionLabaJson;var MonsterFunctionShenlongzhufuJson=function(){function t(){}return t.getData=function(t,e){var i=t+"_"+e,s=this.jsonData[i];return s||egret.log(this.FileName+" :不存在["+t+"_"+e+"]项！"),s},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="monster_function_shenlongzhufu",t}();__reflect(MonsterFunctionShenlongzhufuJson.prototype,"MonsterFunctionShenlongzhufuJson"),window.MonsterFunctionShenlongzhufuJson=MonsterFunctionShenlongzhufuJson;var MonsterFunctionZhuanpanJson=function(){function t(){}return t.getData=function(t,e){var i=t+"_"+e,s=this.jsonData[i];return s||egret.log(this.FileName+" :不存在["+t+"_"+e+"]项！"),s},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="monster_function_zhuanpan",t}();__reflect(MonsterFunctionZhuanpanJson.prototype,"MonsterFunctionZhuanpanJson"),window.MonsterFunctionZhuanpanJson=MonsterFunctionZhuanpanJson;var MonsterInfoJson=function(){function t(){}return t.getData=function(t,e){var i=t+"_"+e,s=this.jsonData[i];return s||egret.log(this.FileName+" :不存在["+t+"_"+e+"]项！"),s},t.getDataByScene=function(t,e){var i=[];for(var s in this.jsonData){var n=this.jsonData[s];t==n.scene_id&&e==n.type&&i.push(n)}return i},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="monster_info",t}();__reflect(MonsterInfoJson.prototype,"MonsterInfoJson"),window.MonsterInfoJson=MonsterInfoJson;var MonsterJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||egret.log(this.FileName+" :不存在["+t+"]项！"),i},t.getAvatarPath=function(t,e,i){void 0===e&&(e="stand"),void 0===i&&(i=4);var s=this.getData(t);if(null==s)return"";var n=AvatarJson.getData(s.avatar_id);return null==n?"":PublicCon.PATH_AVATAR+n.folder_path+e+"_"+i},t.getMonsterHeadPath=function(t){var e=this.getData(t);return null==e?"":PublicCon.PATH_BOSS_HEAD+e.icon_id+".png"},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="monster",t}();__reflect(MonsterJson.prototype,"MonsterJson"),window.MonsterJson=MonsterJson;var NoticeJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="notice",t}();__reflect(NoticeJson.prototype,"NoticeJson"),window.NoticeJson=NoticeJson;var NpcJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},t.FileName="npc",t}();__reflect(NpcJson.prototype,"NpcJson"),window.NpcJson=NpcJson;var OnlineAwardJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},t.getDataList=function(){if(!this.jsonDataList){this.jsonDataList=[];for(var t in this.jsonData)this.jsonDataList.push(this.jsonData[t]);ArrayUtils.setSortArr(this.jsonDataList,["time"],[0])}return this.jsonDataList},t.FileName="online_award",t}();__reflect(OnlineAwardJson.prototype,"OnlineAwardJson"),window.OnlineAwardJson=OnlineAwardJson;var PlatformChargeJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||egret.log(this.FileName+" :不存在["+t+"]项！"),i},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="platform_charge",t}();__reflect(PlatformChargeJson.prototype,"PlatformChargeJson"),window.PlatformChargeJson=PlatformChargeJson;var PopupMsgJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="popup_msg",t}();__reflect(PopupMsgJson.prototype,"PopupMsgJson"),window.PopupMsgJson=PopupMsgJson;var PopupMsgTypeJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="popup_msg_type",t}();__reflect(PopupMsgTypeJson.prototype,"PopupMsgTypeJson"),window.PopupMsgTypeJson=PopupMsgTypeJson;var PromoteJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="promote",t}();__reflect(PromoteJson.prototype,"PromoteJson"),window.PromoteJson=PromoteJson;var QualityJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||egret.log(this.FileName+" :不存在["+t+"]项！"),i},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="quality",t}();__reflect(QualityJson.prototype,"QualityJson"),window.QualityJson=QualityJson;var RechargeJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||egret.log(this.FileName+" :不存在["+t+"]项！"),i},t.getRechargeData=function(t,e){void 0===e&&(e=0);var i=[];for(var s in this.jsonData){var n=this.jsonData[s];n&&n.recharge_type==t&&n.type==e&&i.push(n)}return ArrayUtils.setSortArr(i,["ID"],[0]),i},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="recharge",t}();__reflect(RechargeJson.prototype,"RechargeJson"),window.RechargeJson=RechargeJson;var RedConditionJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="red_condition",t}();__reflect(RedConditionJson.prototype,"RedConditionJson"),window.RedConditionJson=RedConditionJson;var RedPackageJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},t.getType=function(t){var e=this.getData(t);return e?e.type:0},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="red_package",t}();__reflect(RedPackageJson.prototype,"RedPackageJson"),window.RedPackageJson=RedPackageJson;var RewardJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},t.getPropListById=function(t,e){void 0===e&&(e=-1);var i,s=[];if(!this.jsonData[t])return[];for(var n=this.jsonData[t].random_reward_list,o=0;o<n.length&&(i=new proto.Prop,i.prop_id=Number(n[o][0]),i.num=Number(n[o][1]),s.push(i),!(e>0&&o+1>=e));o++);return s},t.getAnyListById=function(t,e){void 0===e&&(e=-1);for(var i=[],s=this.jsonData[t].random_reward_list,n=0;n<s.length&&(i.push([s[n][0],s[n][1],s[n][2]]),!(e>0&&n+1>=e));n++);return i},t.FileName="reward",t}();__reflect(RewardJson.prototype,"RewardJson"),window.RewardJson=RewardJson;var RoleExperienceJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},t.FileName="role_experience",t}();__reflect(RoleExperienceJson.prototype,"RoleExperienceJson"),window.RoleExperienceJson=RoleExperienceJson;var RoomMonsterOddsJson=function(){function t(){}return t.getData=function(t,e){var i=String(t+"_"+e),s=this.jsonData[i];return s||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),s},t.getDataByScene=function(t,e){if(!this.m_monsterListByScene[t+"_"+e]){this.m_monsterListByScene[t+"_"+e]=[];for(var i in this.jsonData){var s=this.jsonData[i];s&&s.scene_id==t&&s.type==e&&this.m_monsterListByScene[t+"_"+e].push(s)}ArrayUtils.setSortArr(this.m_monsterListByScene[t+"_"+e],["order_id"],[0])
}return this.m_monsterListByScene[t+"_"+e]},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="room_monster_odds",t.m_monsterListByScene={},t}();__reflect(RoomMonsterOddsJson.prototype,"RoomMonsterOddsJson"),window.RoomMonsterOddsJson=RoomMonsterOddsJson;var SceneEffectJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},t.FileName="scene_effect",t}();__reflect(SceneEffectJson.prototype,"SceneEffectJson"),window.SceneEffectJson=SceneEffectJson;var SceneJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},t.getDataList=function(){if(!this.m_arrList){this.m_arrList=[];for(var t in this.jsonData){var e=this.jsonData[t];e.drop_look_list&&e.drop_look_list.length>0&&e.type==SceneTypeEnum.WORLD_SCENE&&this.m_arrList.push(e)}ArrayUtils.setSortArr(this.m_arrList,["id"],[0])}return this.m_arrList},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="scene",t}();__reflect(SceneJson.prototype,"SceneJson"),window.SceneJson=SceneJson;var SceneMainJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="scene_main",t}();__reflect(SceneMainJson.prototype,"SceneMainJson"),window.SceneMainJson=SceneMainJson;var SevenLoginJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="seven_login",t}();__reflect(SevenLoginJson.prototype,"SevenLoginJson"),window.SevenLoginJson=SevenLoginJson;var SevenLoginLabaJson=function(){function t(){}return t.getData=function(t,e){var i=String(t+"_"+e),s=this.jsonData[i];return s||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),s},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="seven_login_laba",t}();__reflect(SevenLoginLabaJson.prototype,"SevenLoginLabaJson"),window.SevenLoginLabaJson=SevenLoginLabaJson;var ShareTaskJson=function(){function t(){}return t.getData=function(t,e){var i=String(t+"_"+e),s=this.jsonData[i];return s||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),s},t.getDataByShareType=function(t){var e=[];for(var i in this.jsonData){var s=this.jsonData[i];s&&s.task_type_id==t&&e.push(s)}return e},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="share_task",t}();__reflect(ShareTaskJson.prototype,"ShareTaskJson"),window.ShareTaskJson=ShareTaskJson;var ShareTaskTypeJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},t.FileName="share_task_type",t}();__reflect(ShareTaskTypeJson.prototype,"ShareTaskTypeJson"),window.ShareTaskTypeJson=ShareTaskTypeJson;var ShopJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},t.getAccessShopJson=function(t,e){void 0===e&&(e=1);for(var i in this.jsonData){var s=this.jsonData[i];if(s.type==e&&Number(s.item_list[0][0])==t)return s}return null},t.isShowSell=function(t){for(var e in this.jsonData){var i=this.jsonData[e];if(i&&i.item_list)for(var s in i.item_list)if(i.item_list[s][0]==t)return!0}return!1},t.getListByType=function(t){function e(t,e){return t.order_id-e.order_id}var i=[];for(var s in this.jsonData)this.jsonData[s].type==t&&i.push(this.jsonData[s]);i.sort(e);for(var n=0,o=Math.ceil(i.length/5),a=[],r=0;o>r;r++){for(var _=[],h=0;5>h&&i[n];h++)_.push(i[n]),n+=1;a.push(_)}return i},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="shop",t}();__reflect(ShopJson.prototype,"ShopJson"),window.ShopJson=ShopJson;var ShopMysteryJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},t.FileName="shop_mystery",t}();__reflect(ShopMysteryJson.prototype,"ShopMysteryJson"),window.ShopMysteryJson=ShopMysteryJson;var SkillAssemblyJson=function(){function t(){this.isSetData=!1,this.Note="new string",this.DirectionPos=!0,this.DirectionRotation=!0,this.DirectionType=0,this.shadowDelay=-1,this.shadowFps=-1,this.shadowAlphaTime=-1,this.shadowPlayer=!1,this.Transform="-1",this.HidePlayer=-1}return t.getData=function(t){var e=this.jsonData[t];return e||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),e},t.setData=function(e){this.jsonData=[];for(var i=1;i<e.length;i++){this.jsonData[e[i].Id]||(this.jsonData[e[i].Id]=[]);var s=new t;s.setData(e[i]),this.jsonData[e[i].Id][e[i].SkillCellIndex]=s}this.jsonData},t.prototype.setData=function(t){for(var e in t)this[e]=t[e];this.skillCellID=String(this.SkillCellID).split("|"),this.PlayAction=String(this.PlayAction).split("|"),this.PlayerMove=String(this.PlayerMove).split("|"),this.isSetData=!0},Object.defineProperty(t.prototype,"Shadow",{get:function(){return""},set:function(t){var e=t.split("|");e.length<3||(this.shadowDelay=Number(e[0]),this.shadowFps=Number(e[1]),this.shadowAlphaTime=Number(e[2]),e.length>=4&&(this.shadowPlayer=Boolean(e[3])))},enumerable:!0,configurable:!0}),t.FileName="skill_assembly",t}();__reflect(SkillAssemblyJson.prototype,"SkillAssemblyJson"),window.SkillAssemblyJson=SkillAssemblyJson;var SkillCellJson=function(){function t(){this.isSetData=!1,this.Note="new String",this.Dark=!1,this.LightRange=0,this.SoundResource=-1,this.OtherInVisible=1}return t.getData=function(e){var i=this.jsonData[e];if(!i&&0!=e)throw new Error(this.FileName+" :不存在["+e+"]项！");if(i&&!i.isSetData){var s=new t;s.setData(i),this.jsonData[e]=s,i=this.jsonData[e]}return i},t.prototype.setData=function(t){for(var e in t)this[e]=t[e];this.isSetData=!0},t.FileName="skill_cell",t}();__reflect(SkillCellJson.prototype,"SkillCellJson"),window.SkillCellJson=SkillCellJson;var SkillJson=function(){function t(){this.isSetData=!1,this.Name="new string"}return t.getData=function(e){var i=this.jsonData[e];if(!i&&0!=e)throw new Error(this.FileName+" :不存在["+e+"]项！");if(i&&!i.isSetData){var s=new t;s.setData(i),this.jsonData[e]=s,i=this.jsonData[e]}return i},t.prototype.setData=function(t){for(var e in t)this[e]=t[e];this.isSetData=!0},t.FileName="skill",t}();__reflect(SkillJson.prototype,"SkillJson"),window.SkillJson=SkillJson;var SkillResourceJson=function(){function t(){this.isSetData=!1,this.Note="new String",this.Address="new String",this.BlendMode="new String"}return t.getData=function(e){var i=this.jsonData[e];if(!i&&""!=e&&"-1"!=e&&"0"!=e)throw new Error(this.FileName+" :不存在["+e+"]项！");if(i&&!i.isSetData){var s=new t;s.setData(i),this.jsonData[e]=s,i=this.jsonData[e]}return i},t.prototype.setData=function(t){for(var e in t)this[e]=t[e];this.Address="resource/assets/"+this.Address,this.Alpha=this.Alpha/100,this.Rotation=this.Rotation/360*(2*Math.PI),this.isSetData=!0},t.FileName="skill_resource",t}();__reflect(SkillResourceJson.prototype,"SkillResourceJson"),window.SkillResourceJson=SkillResourceJson;var SoundJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},t.getBgSoundPath=function(t){var e=this.getData(t);return e&&1==e.sound_type?PublicCon.PATH_SOUND_BJ+e.sound_name+".mp3":""},t.getEffectSoundPath=function(t){var e=this.getData(t);return e&&2==e.sound_type&&e.sound_value>0?PublicCon.PATH_SOUND_EFFECT+e.sound_name+".mp3":""},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="sound",t}();__reflect(SoundJson.prototype,"SoundJson"),window.SoundJson=SoundJson;var StaticDataJson=function(){function t(){}return t.getData=function(t){var e=this.jsonData[t];return e||""==t||egret.log(this.FileName+" :不存在["+t+"]项！"),e},t.parseStrToList=function(e){var i=JSON.parse(t.getData(e).data);return i},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="static_data",t}();__reflect(StaticDataJson.prototype,"StaticDataJson"),window.StaticDataJson=StaticDataJson;var SysCommonJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i},t.getFuncIdById=function(t){var e=this.getData(t);return e?e.func_id:0},t.getHitEffectId=function(t){var e=this.getData(t);return e&&e.effect_list?e.effect_list[0]:201},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="sys_common",t}();__reflect(SysCommonJson.prototype,"SysCommonJson"),window.SysCommonJson=SysCommonJson;var TaskJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},t.getTaskList=function(){var t=[];for(var e in this.m_jsonData)t.push(this.m_jsonData[e]);return t},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="task",t}();__reflect(TaskJson.prototype,"TaskJson"),window.TaskJson=TaskJson;var TimesJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||egret.log(this.FileName+" :不存在["+t+"]项！"),i},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="times",t}();__reflect(TimesJson.prototype,"TimesJson"),window.TimesJson=TimesJson;var TongxingzhengDailyTaskJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||egret.log(this.FileName+" :不存在["+t+"]项！"),i},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="tongxingzheng_daily_task",t}();__reflect(TongxingzhengDailyTaskJson.prototype,"TongxingzhengDailyTaskJson"),window.TongxingzhengDailyTaskJson=TongxingzhengDailyTaskJson;var TongxingzhengJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||egret.log(this.FileName+" :不存在["+t+"]项！"),i},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="tongxingzheng",t}();__reflect(TongxingzhengJson.prototype,"TongxingzhengJson"),window.TongxingzhengJson=TongxingzhengJson;var TongxingzhengLevelJson=function(){function t(){}return t.getData=function(t,e){var i=t+"_"+e,s=this.jsonData[i];return s||egret.log(this.FileName+" :不存在["+t+"_"+e+"]项！"),s},t.getRewardList=function(t){var e=[];for(var i in this.jsonData){var s=this.jsonData[i];s&&s.id==t&&e.push(s)}return ArrayUtils.setSortArr(e,["level"],[0]),e},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="tongxingzheng_level",t}();__reflect(TongxingzhengLevelJson.prototype,"TongxingzhengLevelJson"),window.TongxingzhengLevelJson=TongxingzhengLevelJson;var TongxingzhengTaskJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||egret.log(this.FileName+" :不存在["+t+"]项！"),i},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="tongxingzheng_task",t}();__reflect(TongxingzhengTaskJson.prototype,"TongxingzhengTaskJson"),window.TongxingzhengTaskJson=TongxingzhengTaskJson;var TouZiJiHuaJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},t.getRewardList=function(){var t=[];for(var e in this.jsonData)this.jsonData[e]&&t.push(this.jsonData[e]);return t},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="tou_zi_ji_hua",t}();__reflect(TouZiJiHuaJson.prototype,"TouZiJiHuaJson"),window.TouZiJiHuaJson=TouZiJiHuaJson;var TreasureHuntJson=function(){function t(){}return t.getData=function(t,e){var i=t+"_"+e,s=this.jsonData[i];return s||egret.log(this.FileName+" :不存在["+t+"_"+e+"]项！"),s},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="treasure_hunt",t}();__reflect(TreasureHuntJson.prototype,"TreasureHuntJson"),window.TreasureHuntJson=TreasureHuntJson;var TreasureHuntTypeJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||egret.log(this.FileName+" :不存在["+t+"]项！"),i},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="treasure_hunt_type",t}();__reflect(TreasureHuntTypeJson.prototype,"TreasureHuntTypeJson"),window.TreasureHuntTypeJson=TreasureHuntTypeJson;var TurntableJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},t.getTurntableList=function(){var t=[];for(var e in this.jsonData){var i=this.jsonData[e];i&&t.push(i)}return ArrayUtils.setSortArr(t,["id"],[0]),t},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="turntable",t}();__reflect(TurntableJson.prototype,"TurntableJson"),window.TurntableJson=TurntableJson;var VipBoonJson=function(){function t(){}return t.getData=function(t,e){var i=String(t+"_"+e),s=this.jsonData[i];return s||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),s},t.FileName="vip_boon",t}();__reflect(VipBoonJson.prototype,"VipBoonJson"),window.VipBoonJson=VipBoonJson;var VipBoonTypeJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},t.getList=function(){var t=[];if(0==this.typeList.length){for(var e in this.jsonData)0!=this.jsonData[e].id&&t.push(this.jsonData[e]);t.sort(this.compare),this.typeList=t}return this.typeList},t.compare=function(t,e){return e.is_tequan==t.is_tequan?t.rank-e.rank:e.is_tequan-t.is_tequan},t.FileName="vip_boon_type",t.typeList=[],t}();__reflect(VipBoonTypeJson.prototype,"VipBoonTypeJson"),window.VipBoonTypeJson=VipBoonTypeJson;var VipLevelJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},t.getHighestVip=function(){var t=[];for(var e in this.m_jsonData)t.push(this.m_jsonData[e].level);return ArrayUtils.setSortNum(t,1),t[0]},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="vip_level",t}();__reflect(VipLevelJson.prototype,"VipLevelJson"),window.VipLevelJson=VipLevelJson;var ActivityInfoEnum=function(){function t(){}return t.WORLD_BOSS_1=101,t.WORLD_BOSS_2=102,t.WORLD_BOSS_3=103,t.WORLD_BOSS_4=104,t.WORLD_BOSS_5=105,t.WORLD_BOSS_6=106,t.WORLD_BOSS_7=107,t.WORLD_BOSS_8=108,t.GUESS_BOSS_1=501,t.SHISHI_BOSS_1=601,t.CLOSE_SEVER_SEVEN_LOGIN=4001,t}();__reflect(ActivityInfoEnum.prototype,"ActivityInfoEnum");var ActivityTimeTypeEnum=function(){function t(){}return t.ALL_DAY=1,t.DAY_TIME=2,t.CONFIRM_TIME=3,t.MULTI_TIME=6,t.MONTH_TIME=7,t.PLAYER_DAYS=21,t.PLAYER_RETURN_GAME_MULTI_DAY=22,t}();__reflect(ActivityTimeTypeEnum.prototype,"ActivityTimeTypeEnum");var ChannelEnum=function(){function t(){}return t.FB="fb",t.LOCAL_TEST="local_test",t.MOY="moy",t.TEST="test",t}();__reflect(ChannelEnum.prototype,"ChannelEnum");var ChargeGameEnum=function(){function t(){}return t.COMMON_CHARGE_DIAMOND=0,t.FIRST_CHARGE=1,t.ZHI_GOU=2,t.TOU_ZI_JI_HUA=3,t.COMMON_CHARGE_COIN=4,t}();__reflect(ChargeGameEnum.prototype,"ChargeGameEnum");var ClientLogEnum=function(){function t(){}return t.CHARGE_BUTTON_TIMES=1,t.FIRST_CHARGE_BUTTON_TIMES=2,t.VIP_BUTTON_TIMES=3,t.CHARGE_990=4,t.CHARGE_1000=5,t.CHARGE_2000=6,t.CHARGE_3000=7,t.CHARGE_4000=8,t.CHARGE_5000=9,t.CHARGE_6000=10,t.CHARGE_7000=11,t.CHARGE_8000=12,t.CHARGE_9000=13,t.FIRST_CHARGE_100=14,t.FIRST_CHARGE_200=15,t.FIRST_CHARGE_300=16,t.FIRST_CHARGE_400=17,t.GOOGLE_200001=18,t.GOOGLE_200011=19,t.GOOGLE_200021=20,t.GOOGLE_200031=21,t.GOOGLE_200041=22,t.GOOGLE_200051=23,t.GOOGLE_200061=24,t.GOOGLE_FIRST_20100=25,t.GOOGLE_FIRST_20200=26,t.GOOGLE_FIRST_20300=27,t.GOOGLE_FIRST_20400=28,t}();__reflect(ClientLogEnum.prototype,"ClientLogEnum");var CollectEnum=function(){function t(){}return t.TREASURE_MAP_1=16001,t.TREASURE_MAP_2=16002,t.TREASURE_MAP_3=16003,t}();__reflect(CollectEnum.prototype,"CollectEnum");var ColorEnum=function(){function t(){}return t.QUALITY_1=1,t.QUALITY_2=2,t.QUALITY_3=3,t.QUALITY_4=4,t.QUALITY_5=5,t.QUALITY_6=6,t.R_WRITE=101,t.R_GREEN=102,t.R_BLUE=103,t.R_PURPLE=104,t.R_GOLDEN=105,t.R_ORANGE=106,t.R_RED=107,t.R_GREEN_1=108,t.R_GREEN_2=109,t.C_WHITE=1e3,t.C_GREEN=1100,t.C_GREEN_DEEP=1101,t.C_RED=1200,t.C_BLUE=1300,t.C_ORANGE=1400,t}();__reflect(ColorEnum.prototype,"ColorEnum");var EffectTypeEnum=function(){function t(){}return t.ADD_BUFF="add_buff",t.ADD_HP_RATE="add_hp_rate",t.ATTR="attr",t.ATTR_RATE="attr_rate",t.CALL_MONSTER="call_monster",t.CHEN_MO="chen_mo",t.DIZZY="dizzy",t.EXTRA_HURT="extra_hurt",t.FENG_YIN_FA_BAO="feng_yin_fa_bao",t.FENG_YIN_PET="feng_yin_pet",t.HU_DUN="hu_dun",t.IMMUNE_DIZZY="immune_dizzy",t.KILL="kill",t.LIU_XUE="liu_xue",t.REBOUND_HURT="rebound_hurt",t.REDUCE_CD="reduce_cd",t.TRIGGER_SKILL="trigger_skill",t.XI_XUE="xi_xue",t}();__reflect(EffectTypeEnum.prototype,"EffectTypeEnum");var FunctionConfigEnum=function(){function t(){}return t.MAIL_SYS=1,t.SEVEN_LOGIN=3,t.SHARE_SHARE=4,t.SHARE_PROMOTE=5,t.SCENE_SCELECT=9,t.RECHANGE_SYS=10,t.VIP_SYS=15,t.FIRST_CHARGE=17,t.SHISHI_MULTI=18,t.TIXIAN_TASK=19,t.HERO_SYS=20,t.BAG_SYS=21,t.WELFARE_SYS=150,t.WELFARE_SIGN_IN=151,t.WELFARE_DUOBAO=152,t.WELFARE_CHOUKA=153,t.SHOP_SYS=160,t.MAIN_TASK=200,t.CARD_BOOK_1=201,t.ITEM_ACCESS1=1e3,t.ITEM_ACCESS2=1001,t.ITEM_ACCESS3=1002,t.ITEM_ACCESS4=1003,t}();__reflect(FunctionConfigEnum.prototype,"FunctionConfigEnum");var FunctionEnum=function(){function t(){}return t.ROLE_SYS=100,t.ROLE_ENT=101,t.ROLE_WEAPON=102,t.ROLE_WING=103,t.ROLE_CLOTHES=104,t.ROLE_MAGIC=105,t.SKILL_SYS=110,t.PASSIVE_SKILL_SYS=111,t.SCENE_SELECT_SYS=120,t.HE_CHENG_SYS=130,t.BAG_SYS=140,t.SHENLONG_SYS=150,t.TIYAN_SYS=160,t.WITHDRAWAL_SYS=170,t.DRAW_MONEY=171,t.SKILL_SPEED_COST=201,t.SKILL_FREEZE_COST=202,t.SKILL_AUTO_COST=203,t.SKILL_ANGER_COST=204,t.VIP_ENT=300,t.VIP_SYS=301,t.MISSION_SYS=400,t.MISSION_PAGODA=401,t.MISSION_WORD_BOSS=402,t.MISSION_MANY_PEOPLE_BOSS=404,t.MISSION_MANY_PEOPLE_BOSS_ROOM=405,t.MISSION_GUESS_BOSS=406,t.MISSION_SHISHI_BOSS=407,t.BRAVE_ONE_SYS_LIST=408,t.BRAVE_ONE_SYS_LIST_CREATE=409,t.MISSION_SHISHI_MULTI_LIST=410,t.MISSION_SHISHI_MULTI_CREATE=411,t.MISSION_EITHER_OR=415,t.TURNTABLE_SYS=501,t.TOU_ZI_JI_HUA=502,t.RECHARGE_SYS=600,t.FIRST_RECHARGE=610,t.SHARE_SYS=630,t.PROMOTE_SYS=640,t.KEFU=701,t.EXCHANGE_SYS=800,t.MAIN_TASK=900,t.CARD_BOOK_1=901,t.CARD_BOOK_2=902,t.MAIL_SYS=1011,t.ACHIEVEMENT_SYS=1031,t.RANK_SYS=1041,t.SHOP_SYS=1061,t.SHOP_ITEM_SYS=1062,t.SHOP_RESOURCE_SYS=1063,t.ACTIVITY_HALL=1070,t.EVERYDAY_SIGN_SYS=1071,t.DUOBAO_SYS=1072,t.CHOUKA_SYS=1073,t.REDEMPTION_CODE=1076,t.SEVEN_LOGIN_SYS=1081,t.TONGXINGZHENG_SYS=1100,t.NO_OPEN_FUNCTION=99999,t}();__reflect(FunctionEnum.prototype,"FunctionEnum");var ItemEnum=function(){function t(){}return t.GOLD=2,t.VIP_EXP=3,t.RMB=4,t.EXP=11,t.TONGXINGZHENG_EXP=19,t.SUIPIAN=50,t.BLESS_COIN=60,t.HERO_BOX_1=90,t.HERO_BOX_2=91,t.HERO_BOX_3=92,t.XUNBAOQUAN=100,t.BAOZANGJIEJING=101,t.SKILL_BOOK_1=201,t.SKILL_BOOK_2=202,t.SKILL_BOOK_3=203,t.MAGIC_1=601,t.MAGIC_2=602,t.MAGIC_3=603,t.MAGIC_4=604,t.MAGIC_5=605,t.MAGIC_6=606,t.HERO_PARTS1=701,t.HERO_PARTS2=702,t.HERO_PARTS3=703,t.HERO_PARTS4=704,t.HERO_PARTS5=705,t.HERO_PARTS6=706,t.HERO_PARTS7=707,t.HERO_PARTS8=708,t.HERO_PARTS9=709,t.HERO_PARTS10=710,t.HERO_PARTS11=711,t.HERO_PARTS12=712,t.HERO_PARTS13=713,t.HERO_PARTS14=714,t.HERO_PARTS15=715,t.HERO_PARTS16=716,t.HERO_PARTS17=717,t.HERO_PARTS18=718,t.HERO_PARTS19=719,t.HERO_PARTS20=720,t.HERO_PARTS21=721,t.HERO_PARTS22=722,t.HERO_PARTS23=723,t.HERO_PARTS24=724,t.HERO_PARTS25=725,t.HERO_PARTS26=726,t.HERO_PARTS27=727,t.HERO_PARTS28=728,t.HERO_PARTS29=729,t.HERO_PARTS30=730,t.HERO_PARTS31=731,t.HERO_PARTS32=732,t.HERO_PARTS33=733,t.HERO_PARTS34=734,t.HERO_PARTS35=735,t.HERO_PARTS36=736,t.HERO_PARTS37=737,t.HERO_PARTS38=738,t.HERO_PARTS39=739,t.HERO_PARTS40=740,t.HERO_PARTS41=741,t.HERO_PARTS42=742,t.HERO_PARTS43=743,t.HERO_PARTS44=744,t.HERO_PARTS45=745,t.HERO_PARTS46=746,t.HERO_PARTS47=747,t.HERO_PARTS48=748,t.HERO1=901,t.HERO2=902,t.HERO3=903,t.HERO4=904,t.HERO5=905,t.HERO6=906,t.HERO7=907,t.HERO8=908,t.HERO9=909,t.HERO10=910,t.HERO11=911,t.HERO12=912,t.HERO_CHIP1=1001,t.HERO_CHIP2=1002,t.HERO_CHIP3=1003,t.HERO_CHIP4=1004,t.HERO_CHIP5=1005,t.HERO_CHIP6=1006,t.HERO_CHIP7=1007,t.HERO_CHIP8=1008,t.HERO_CHIP9=1009,t.HERO_CHIP10=1010,t.HERO_CHIP11=1011,t.HERO_CHIP12=1012,t.HEAD1=2e3,t.HEAD2=2001,t.HEAD3=2101,t.HEAD4=2102,t.HEAD5=2103,t.HEAD6=2104,t.HEAD7=2105,t.HEAD8=2106,t.HEAD9=2107,t.HEAD10=2108,t.HEAD11=2109,t.HEAD12=2110,t.HEAD13=2111,t.HEAD14=2112,t.HEAD_FRAME1=6001,t.HEAD_FRAME2=6002,t.HEAD_FRAME3=6003,t.HEAD_FRAME4=6004,t.HEAD_FRAME5=6005,t.HEAD_FRAME6=6006,t.HEAD_FRAME7=6007,t.HEAD_FRAME8=6008,t.HEAD_FRAME9=6009,t.HEAD_FRAME10=6010,t.CHAT_BUBBLES1=6201,t.CHAT_BUBBLES2=6202,t.CHAT_BUBBLES3=6203,t.CHAT_BUBBLES4=6204,t.CHAT_BUBBLES5=6205,t.CHAT_BUBBLES6=6206,t.CHAT_BUBBLES7=6207,t.CHAT_BUBBLES8=6208,t.CHAT_BUBBLES9=6209,t.CHAT_BUBBLES10=6210,t.STICKER1=7001,t.STICKER2=7002,t.STICKER3=7003,t.STICKER4=7004,t.STICKER5=7005,t.STICKER6=7006,t.STICKER7=7007,t.STICKER8=7008,t.STICKER9=7009,t.STICKER10=7010,t.STICKER11=7011,t.STICKER12=7012,t.STICKER13=7013,t.STICKER14=7014,t.STICKER15=7015,t.STICKER16=7016,t.STICKER17=7017,t.STICKER18=7018,t.STICKER19=7019,t.STICKER20=7020,t.STICKER21=7021,t.STICKER22=7022,t.STICKER23=7023,t.STICKER24=7024,t.STICKER25=7025,t.STICKER26=7026,t.STICKER27=7027,t.STICKER28=7028,t.STICKER29=7029,t.STICKER30=7030,t.CARD1=8101,t.CARD2=8102,t.CARD3=8103,t.CARD4=8104,t.CARD5=8105,t.CARD6=8106,t.CARD7=8107,t.CARD8=8108,t.CARD9=8109,t.CARD10=8110,t.CARD11=8111,t.CARD12=8112,t.CARD13=8201,t.CARD14=8202,t.CARD15=8203,t.CARD16=8204,t.CARD17=8205,t.CARD18=8206,t.CARD19=8207,t.CARD20=8208,t.CARD21=8209,t.CARD22=8210,t.CARD23=8211,t.CARD24=8212,t.CARD25=8213,t.CARD26=8214,t.CARD27=8301,t.CARD28=8302,t.CARD29=8303,t.CARD30=8304,t.CARD31=8305,t.CARD32=8306,t.CARD33=8307,t.CARD34=8308,t.CARD35=8309,t.CARD36=8310,t.CARD37=8311,t.CARD38=8312,t.CARD39=8313,t.CARD40=8314,t.CARD41=8315,t.CARD42=8401,t.CARD43=8402,t.CARD44=8403,t.CARD45=8404,t.CARD46=8405,t.CARD47=8406,t.CARD48=8407,t.CARD49=8408,t.CARD50=8409,t.CARD51=8410,t.CARD52=8411,t.CARD53=8412,t.CARD54=8413,t.CARD55=8414,t.CARD56=8415,t.CARD57=8416,t.CARD58=8501,t.CARD59=8502,t.CARD60=8503,t.CARD61=8504,t.CARD62=8505,t.CARD63=8506,t.CARD64=8507,t.CARD65=8508,t.CARD66=8509,t.CARD67=8510,t.CARD68=8511,t.CARD69=8512,t.CARD70=8513,t.CARD71=8514,t.CARD72=8515,t.CARD73=8516,t.CARD74=8517,t.CARD75=8601,t.CARD76=8602,t.CARD77=8603,t.CARD78=8604,t.CARD79=8605,t.CARD80=8606,t.CARD81=8607,t.CARD82=8608,t.CARD83=8609,t.CARD84=8610,t.CARD85=8611,t.CARD86=8612,t.CARD87=8613,t.CARD88=8614,t.CARD89=8615,t.CARD90=8616,t.CARD91=8617,t.CARD92=8618,t.CARD93=9e3,t.CARD94=9001,t.CARD95=9002,t.CARD96=9003,t.CARD97=9004,t.CARD98=9005,t.CARD99=9006,t.CARD100=9007,t.CARD101=9008,t.CARD102=9009,t.CARD103=9010,t.CARD104=9301,t.CARD105=9302,t.CARD106=9303,t.CARD107=9304,t.CARD108=9305,t.CARD109=9306,t.CARD110=9307,t.CARD111=9308,t.CARD112=9309,t.CARD113=9310,t.CARD114=9311,t.CARD115=9312,t}();__reflect(ItemEnum.prototype,"ItemEnum");var ItemTypeEnum=function(){function t(){}return t.ITEM=1,t.SKILL_BOOK=2,t.SYS_COMMON=3,t.BULLION_FRAGMENTS=4,t.BULLION=5,t.TITLE=7,t.GIFT_PACKAGE=8,t.RESOURCE=9,t.HERO_PARTS=10,t.HERO=11,t.CARD=12,t.HERO_CHIP=13,t.BLESS_COIN=14,t.HEAD=15,t.HEAD_FRAME=16,t.CHAT_BUBBLES=17,t.STICKER=18,t.TONGXINGZHENG_EXP=19,t}();__reflect(ItemTypeEnum.prototype,"ItemTypeEnum");var LogTypeEnum=function(){function t(){}return t.GM=1,t.CHARGE_GET=2,t.CHARGE_SEND=3,t.FINISH_TASK=4,t.OFFLINE_AWARD=5,t.BUY_TIMES=6,t.GATHER_GET=7,t.SWEEP=8,t.MAIL_GET_ITEM=9,t.MAIL_GET_ALL_ITEM=10,t.TITLE_UPGRADE=11,t.ACHIEVEMENT_AWARD=12,t.ACHIEVEMENT_AIM_AWARD=13,t.SHOP_BUY=14,t.MYSTERY_SHOP_BUY=15,t.ADD_TITLE=16,t.HONE_LEVEL=17,t.USE_ITEM=18,t.EVERYDAY_SIGN=19,t.HOOK=20,t.SEVEN_LOGIN=21,t.ONLINE_AWARD=22,t.TREASURE_HOUSE_OPEN=23,t.GET_MISSION_RATE_AWARD=24,t.PREROGATIVE_CARD=25,t.PREROGATIVE_CARD_AWARD=26,t.VIP_AWARD=27,t.TIME_LIMIT_TASK_GIVE=28,t.SYSTEM_SEND=29,t.UPGRADE_SKILL=30,t.ACTIVITY_POWER_INVESTMENT=31,t.ACTIVITY_CONSUME_EVERYDAY=32,t.ACTIVITY_CONSUME_RANK_GET=33,t.ACTIVITY_CONSUME_RANK_GIVE=34,t.ACTIVITY_SKILL_BOOK_GET=35,t.ACTIVITY_SKILL_BOOK_BUY=36,t.ACTIVITY_SKILL_BOOK_CLOSE_GIVE=37,t.TREASURE_HOUSE_CLOSE_GIVE=38,t.SHOP_LIMIT_TIME_BUY=39,t.OPEN_SERVICE_GOALS_AWARD=40,t.MAGIC_WEAPON_UPGRADE_LEVEL=41,t.GOSSIP_COMPETITION=42,t.RANK_CALC_AWARD=43,t.COLLECT_GAME=44,t.SHARE_DAY_GAME=45,t.SHARE_FRIEND_AWARD=46,t.CLOTHES=47,t.UPDATE_COMPENSATE=48,t.COMPOUND_PROP=49,t.EVERYDAY_MULTIPLE_RECHARGE_BOX_GET=50,t.MAGIC_THUNDER_LEVEL=51,t.EVERYDAY_MULTIPLE_RECHARGE_GET=52,t.ACTIVITY_TASK_AWARD=53,t.GIFT_CODE=54,t.PLATFORM_CONCERN_AWARD=55,t.PLATFORM_CERTIFICATION_AWARD=56,t.ACTIVITY_SEVEN_LOGIN_CLOSE_MAIL=57,t.SHARE_TASK_AWARD=58,t.BOSS_REBIRTH=59,t.PROP_EXPIRE=60,t.SELL_ITEM=61,t.ANSWER_ENROLL=62,t.ANSWER_INSPIRE=63,t.ANSWER_RESURRECTION=64,t.ANSWER_REMOVER_ERRORS=65,t.ANSWER_CLEARING=66,t.VIDEO=67,t.RESOURCE_GET_BAK=68,t.ZHOU_NIAN_QING_AWARD=69,t.HE_CHANG_ITEM=70,t.MANY_PEOPLE_BOSS=71,t.PAGODA_SWEEP=72,t.FIGHT=74,t.DAILY_TASK=75,t.MISSION_WORLD_BOSS=76,t.PROMOTE_AWARD=77,t.SHOP_BUY_ITEM_SHOP=78,t.SHOP_BUY_RESOURCE_SHOP=79,t.VIP_BU_QIAN=80,t.ZHU_XIAN=81,t.PAGODA=82,t.WORLD_BOSS=83,t.GUESS_BOSS=85,t.SHISHI_BOSS=86,t.ACTIVITY_IMPACT_TASK_AWARD=87,t.ACTIVITY_IMPACT_RANK_AWARD_CLOSE=88,t.MERGE=89,t.PAGODA_RANK_AWARD=90,t.SHEN_LONG=91,t.GOODS_SHOP_TIMES=92,t.FIRST_CHARGE=93,t.BRAVE_ONE_SYS=94,t.STEP_BY_STEP_SYS=95,t.TURN_TABLE=96,t.MANY_PEOPLE_SHISHI=97,t.RED_PACKET_AWARD=98,t.MISSION_STEP_BY_STEP_SY_FIGHT=99,t.INVETS_AWARD=100,t.MISSION_EITHER_OR=101,t.TI_XIAN=102,t.DRAW_MONEY=103,t.HERO_UP_STAR=104,t.CARD_AWARD=105,t.MISSION_SCENE_BOSS_LOCATION=106,t.MISSION_SCENE_BOSS_TIME_AND_COUNT=107,t.HERO_UNLOCK=108,t.FUNCTION_MONSTER_FANPAI=109,t.FUNCTION_MONSTER_LABA=110,t.FUNCTION_MONSTER_ZHUANPAN=111,t.DUOBAO_SHOP=112,t.SEIZE_TREASURE=113,t.SEIZE_EXTRA_AWARD=114,t.CARD_SUMMON_AWARD=115,t.ITEM_OPEN_BOX=116,t.FUNCTION_MONSTER_ZHADAN=117,t.CHARGE_DIAMOND_SHOP=118,t.CESHI=999,t.UPDATE_VERSION_REPAIR1=1e3,t}();__reflect(LogTypeEnum.prototype,"LogTypeEnum");var MissionTypeEnum=function(){function t(){}return t.ZHU_XIAN=1,t.PAGODA=99,t.WORLD_BOSS=100,t.MANY_PEOPLE_BOSS=101,t.GUESS_BOSS=102,t.SHISHI_BOSS=103,t.BRAVE_ONE_SYS=104,t.STEP_BY_STEP_SYS=105,t.MANY_PEOPLE_SHISHI=106,t.MISSION_EITHER_OR=107,t.MISSION_SCENE_BOSS_LOCATION=201,t.MISSION_SCENE_BOSS_TIME_AND_COUNT=202,t.CESHI=999,t}();__reflect(MissionTypeEnum.prototype,"MissionTypeEnum");var PkModeEnum=function(){function t(){}return t.PK_PEACE=0,t.PK_FACTION=1,t.PK_BATTLE=2,t.PK_WORLD=3,t}();__reflect(PkModeEnum.prototype,"PkModeEnum");var PlatformEnum=function(){function t(){}return t.CAMBODIA="cambodia",t.INDONESIA="indonesia",t.LAOS="laos",t.LOCAL="local",t.MALAYSIA="malaysia",t.MOY="moy",t.MYANMAR="myanmar",t.SINGAPORE="singapore",t.TAIWAN="taiwan",t.TEST="test",t.THAILAND="thailand",t.VIETNAM="vietnam",t}();__reflect(PlatformEnum.prototype,"PlatformEnum");var PopupMsgEnum=function(){function t(){}return t.PUP_BACK_MAINSCENE=1,t.PUP_GO_LAST_SCENE=2,t.TRAINING_SCENE=3,t.GOLD_NO_ENOUGH=4,t.RMB_NO_ENOUGH=5,t}();__reflect(PopupMsgEnum.prototype,"PopupMsgEnum");var PopupMsgTypeEnum=function(){function t(){}return t.PUP_MSG_TYPE_1=1,t.PUP_MSG_TYPE_2=2,t}();__reflect(PopupMsgTypeEnum.prototype,"PopupMsgTypeEnum");var RechargeEnum=function(){function t(){}return t.FIRST_CHARGE_100=100,t.CHARGE_990=990,t.CHARGE_1000=1e3,t.CHARGE_2000=2e3,t.CHARGE_3000=3e3,t.CHARGE_4000=4e3,t.CHARGE_5000=5e3,t.CHARGE_6000=6e3,t.CHARGE_7000=7e3,t.CHARGE_8000=8e3,t.CHARGE_9000=9e3,t.GOOGLE_FIRST_20100=20100,t.APPLE_FIRST_30100=30100,t.TEST_CHARGE=99999,t.TOU_ZI_JI_HUA=100001,t.GOOGLE_200001=200002,t.GOOGLE_200011=200011,t.GOOGLE_200021=200021,t.GOOGLE_200031=200031,t.GOOGLE_200041=200041,t.GOOGLE_200051=200051,t.GOOGLE_200061=200061,t.APPLE_300001=300002,t.APPLE_300011=300011,t.APPLE_300021=300021,t.APPLE_300031=300031,t.APPLE_300041=300041,t.APPLE_300051=300051,t.APPLE_300061=300061,t}();__reflect(RechargeEnum.prototype,"RechargeEnum");var SceneTypeEnum=function(){function t(){}return t.WORLD_SCENE=1,t.MISSION=2,t.BATTLE_GROUND=3,t}();__reflect(SceneTypeEnum.prototype,"SceneTypeEnum");var ShareTaskTypeEnum=function(){function t(){}return t.SHARE_TASK=101,t.SHARE_TASK_LEVEL1=201,t.SHARE_TASK_2=301,t.SHARE_RECHARGE=501,t.SHARE_RECHARGE1=502,t.SHARE_RECHARGE2=503,t}();__reflect(ShareTaskTypeEnum.prototype,"ShareTaskTypeEnum");var ShopTypeEnum=function(){function t(){}return t.ITEM_SHOP=1,t.RESOURCE_SHOP=2,t.CHARGE_DIAMOND_SHOP=3,t.DUOBAO_SHOP_1=101,t.DUOBAO_SHOP_2=102,t}();__reflect(ShopTypeEnum.prototype,"ShopTypeEnum");var SoundEnum=function(){function t(){}return t.BG_SOUND_901=901,t.BG_SOUND_902=902,t.BG_SOUND_903=903,t.BG_SOUND_904=904,t.BG_SOUND_905=905,t.BG_SOUND_906=906,t.BG_SOUND_907=907,t.BG_SOUND_999=999,t.EFFECT_SOUND_1001=1001,t.EFFECT_SOUND_1002=1002,t.EFFECT_SOUND_1003=1003,t.EFFECT_SOUND_1004=1004,t.EFFECT_SOUND_1005=1005,t.EFFECT_SOUND_1006=1006,t.EFFECT_SOUND_1007=1007,t.EFFECT_SOUND_1008=1008,t.EFFECT_SOUND_1009=1009,t.EFFECT_SOUND_1011=1011,t.EFFECT_SOUND_1012=1012,t.EFFECT_SOUND_1013=1013,t.EFFECT_SOUND_1014=1014,t.EFFECT_SOUND_1015=1015,t.EFFECT_SOUND_1016=1016,t.EFFECT_SOUND_1017=1017,t.EFFECT_SOUND_2001=2001,t.EFFECT_SOUND_2002=2002,t.EFFECT_SOUND_2003=2003,t.EFFECT_SOUND_2004=2004,t.EFFECT_SOUND_2005=2005,t.EFFECT_SOUND_2006=2006,t.EFFECT_SOUND_2007=2007,t.EFFECT_SOUND_2008=2008,t.EFFECT_SOUND_2101=2101,t.EFFECT_SOUND_2102=2102,t.EFFECT_SOUND_2103=2103,t.EFFECT_SOUND_3001=3001,t.EFFECT_SOUND_3002=3002,t.EFFECT_SOUND_3003=3003,t.EFFECT_SOUND_3004=3004,t.EFFECT_SOUND_3050=3050,t.EFFECT_SOUND_3500=3500,t.EFFECT_SOUND_3501=3501,t.EFFECT_SOUND_3601=3601,t.EFFECT_SOUND_3602=3602,t.EFFECT_SOUND_3603=3603,t.EFFECT_SOUND_4001=4001,t.EFFECT_SOUND_4002=4002,t.EFFECT_SOUND_4003=4003,t.EFFECT_SOUND_4004=4004,t.EFFECT_SOUND_4101=4101,t.EFFECT_SOUND_4102=4102,t.EFFECT_SOUND_4103=4103,t.EFFECT_SOUND_4201=4201,t.EFFECT_SOUND_4202=4202,t.EFFECT_SOUND_9999=9999,t
}();__reflect(SoundEnum.prototype,"SoundEnum");var TimesEnum=function(){function t(){}return t.DRAW_MONEY=101,t.GOODS_SHOP_TIMES=1001,t.VIP_EVERYDAY_TIMES=1008,t.CARD_SUMMON_TIMES=2e3,t}();__reflect(TimesEnum.prototype,"TimesEnum");var EnumAttrType;!function(t){t[t.RESOURCE=1]="RESOURCE",t[t.ITEM=2]="ITEM",t[t.EQUIP=3]="EQUIP",t[t.STUFF=6]="STUFF"}(EnumAttrType||(EnumAttrType={}));var EnumDungeonEventType;!function(t){t[t.NONE=0]="NONE",t[t.MONSTER=1]="MONSTER",t[t.BOSS=2]="BOSS",t[t.REWARD=3]="REWARD"}(EnumDungeonEventType||(EnumDungeonEventType={}));var EnumRewardType;!function(t){t[t.REWARD_MSG_DUNGEON_NODE_NONE=1001]="REWARD_MSG_DUNGEON_NODE_NONE",t[t.REWARD_MSG_DUNGEON_NODE_FIGHT=1002]="REWARD_MSG_DUNGEON_NODE_FIGHT",t[t.REWARD_MSG_DUNGEON_NODE_SPECIAL=1003]="REWARD_MSG_DUNGEON_NODE_SPECIAL",t[t.REWARD_MSG_DUNGEON_FIGHT=1004]="REWARD_MSG_DUNGEON_FIGHT",t[t.REWARD_MSG_DUNGEON_SWEEP=1005]="REWARD_MSG_DUNGEON_SWEEP",t[t.REWARD_MSG_TREASURE_NODE=1006]="REWARD_MSG_TREASURE_NODE",t[t.REWARD_MSG_ITEM_USE=1007]="REWARD_MSG_ITEM_USE",t[t.REWARD_MSG_ACHIEVEMENT=1008]="REWARD_MSG_ACHIEVEMENT",t[t.REWARD_MSG_TREASURE_HANG=1009]="REWARD_MSG_TREASURE_HANG",t[t.REWARD_MSG_SIGNIN=1010]="REWARD_MSG_SIGNIN",t[t.REWARD_MSG_LODE_FIGHT=1011]="REWARD_MSG_LODE_FIGHT"}(EnumRewardType||(EnumRewardType={}));var EnumMainUIState;!function(t){t[t.NORMAL=0]="NORMAL",t[t.DUNGEON=1]="DUNGEON",t[t.CREATEROLE=2]="CREATEROLE",t[t.FUNCTIONBAR=3]="FUNCTIONBAR"}(EnumMainUIState||(EnumMainUIState={}));var EnumUserAttr;!function(t){t[t.GOLD=1]="GOLD",t[t.DIAMOND=2]="DIAMOND",t[t.EXP=3]="EXP",t[t.VITALITY=4]="VITALITY"}(EnumUserAttr||(EnumUserAttr={}));var EnumDlgType;!function(t){t[t.OK=0]="OK",t[t.CANCEL=1]="CANCEL",t[t.OKCANCEL=2]="OKCANCEL"}(EnumDlgType||(EnumDlgType={}));var EnumBtnType;!function(t){t[t.EDIT=0]="EDIT",t[t.SAVE=1]="SAVE",t[t.SEE=2]="SEE",t[t.GETAWARD=3]="GETAWARD",t[t.LIKE=4]="LIKE",t[t.ASKSTRATEGY=5]="ASKSTRATEGY",t[t.UNLOCKED=6]="UNLOCKED"}(EnumBtnType||(EnumBtnType={}));var EnumNoticeType;!function(t){t[t.SEARCH=0]="SEARCH",t[t.NOTICE=1]="NOTICE"}(EnumNoticeType||(EnumNoticeType={}));var AchievementType;!function(t){t[t.PROGRESS=0]="PROGRESS",t[t.REWARD=1]="REWARD",t[t.FINISH=2]="FINISH"}(AchievementType||(AchievementType={}));var EquipHintType;!function(t){t[t.NULL=0]="NULL",t[t.SKILL=1]="SKILL",t[t.NOSKILL=2]="NOSKILL"}(EquipHintType||(EquipHintType={}));var LodeRewardType;!function(t){t[t.NOHOLD=0]="NOHOLD",t[t.HOLD=1]="HOLD",t[t.HELP=2]="HELP",t[t.HOLDAndHELP=3]="HOLDAndHELP",t[t.CHANGE=4]="CHANGE",t[t.CHANGEAndHELP=5]="CHANGEAndHELP"}(LodeRewardType||(LodeRewardType={}));var LogType;!function(t){t[t.SOCKETLOG=0]="SOCKETLOG",t[t.FIGHTLOG=1]="FIGHTLOG",t[t.NORMAL=2]="NORMAL",t[t.NULL=3]="NULL"}(LogType||(LogType={}));var CameraModule=function(){function t(){if(this.shake_coefficient=40,this.cameraShakeType=0,this.isShake=!1,this.shakeFlag=!0,this.isCamearScale=!1,t.m_instance)throw new Error("CamearModule 是一个单例！")}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){},t.prototype.updateFocus=function(e,i,s){void 0===s&&(s=!1),(null==this.cameraMoveBean||0!=s)&&(MyMapModule.instance.map.upDateMapFocus(e,i),Dispatch.dispatch(t.EVENT_UPDATE_FOCUS))},t.prototype.cameraMove=function(t,e,i,s,n,o){void 0===o&&(o=null)},t.prototype.setCameraShake=function(e,i,s,n){void 0===e&&(e=0),void 0===i&&(i=260),void 0===s&&(s=40),void 0===n&&(n=t.SHAKE_NULL),this.cameraShakeType=n,this.cameraShake=e,TweenLite.killDelayedCallsTo(this.shakeEnd),TweenLite.killDelayedCallsTo(this.shakeDone),this.shakeAnimation(i,s)},t.prototype.shakeAnimation=function(t,e){void 0===t&&(t=260),void 0===e&&(e=40);var i=t/e;this.shakeTimes=this.cameraShake/i;for(var s=0;i+1>s;s++)i>s?TweenLite.delayedCall(e*s*.001,this.shakeDone,null,this):TweenLite.delayedCall(e*s*.001,this.shakeEnd,null,this)},t.prototype.shakeDone=function(){this.cameraShake=this.cameraShake-this.shakeTimes,this.shakeFlag=!this.shakeFlag;var e=[0,0];this.isCamearScale&&(e=[StageManager.instance.p_stageWidth/2,StageManager.instance.p_stageHeight/2]),(this.cameraShakeType==t.SHAKE_NULL||this.cameraShakeType==t.SHAKE_X)&&(StageManager.instance.scenelayer.x=e[0]+Math.random()*this.cameraShake*.5+.5*this.cameraShake*-.5),(this.cameraShakeType==t.SHAKE_NULL||this.cameraShakeType==t.SHAKE_Y)&&(StageManager.instance.scenelayer.y=e[1]+(this.shakeFlag?1:-1)*this.cameraShake*.5)},t.prototype.shakeEnd=function(){var t=[0,0];this.isCamearScale&&(t=[StageManager.instance.p_stageWidth/2,StageManager.instance.p_stageHeight/2]),StageManager.instance.scenelayer.x=t[0],StageManager.instance.scenelayer.y=t[1],this.cameraShake=0},t.prototype.setCameraSize=function(t,e){void 0===e&&(e=1);var i=MyMapModule.instance.root,s=i.localToGlobal(.5*StageManager.instance.p_stageWidth,.5*StageManager.instance.p_stageHeight);i.x=i.anchorOffsetX=s.x,i.y=i.anchorOffsetY=s.y,TweenMax.to(i,e,{scaleX:t,scaleY:t})},t.prototype.setCameraReply=function(t){void 0===t&&(t=1)},t.EVENT_UPDATE_FOCUS="EVENT_UPDATE_FOCUS",t.EVENT_UPDATE_CAMERA_POINT="CAMEARMODULE.EVENT_UPDATE_CAMERA_POINT",t.SHAKE_NULL=0,t.SHAKE_X=1,t.SHAKE_Y=2,t}();__reflect(CameraModule.prototype,"CameraModule");var DartCar=function(t){function e(){var e=t.call(this)||this;return e.m_quality=-1,e.canJump=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"player",{get:function(){return this.m_player},set:function(t){this.m_player=t,this.moveSpeed=this.m_player.moveSpeed,this.m_player instanceof AvatarMainPlayer||Dispatch.register(AvatarLive.EVENT_POSITION_CHANGE+this.m_player.livePid,this.playerMoveHandler,this)},enumerable:!0,configurable:!0}),e.prototype.playerMoveHandler=function(){this.m_player},Object.defineProperty(e.prototype,"quality",{get:function(){return this.m_quality},set:function(t){this.m_quality=t,this.setAvatarId(4e3+t)},enumerable:!0,configurable:!0}),e.prototype.destory=function(){t.prototype.destory.call(this),this.m_player=null},e}(AvatarLive);__reflect(DartCar.prototype,"DartCar");var FightAutoAI=function(t){function e(){var e=t.call(this)||this;return e.m_lengthPoint=new egret.Point,e.m_tempPoint1=new egret.Point,e.m_tempPoint2=new egret.Point,e.m_playerPoint=new egret.Point,e.m_angleDistancePt=new egret.Point,e.m_targetRid=0,e.p_isAutoFight=!1,e.p_attackTime=0,e.m_fightMonsterId=-1,e.m_isMove=!1,e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.m_instance||(this.m_instance=new e),this.m_instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){Dispatch.register(SceneItemModule.EVENT_MONSTER_REMOVE,this.removeMonsterAvatar,this)},e.prototype.removeMonsterAvatar=function(t){this.m_targetRid==t&&(this.m_targetRid=0)},e.prototype.attackArrow=function(){this.isAttackTarget?this.attack(this.m_targetRid):(this.m_targetRid=SceneItemModule.instance.getNearMonsterRid(100),this.attack(this.m_targetRid))},e.prototype.attack=function(t){SceneModule.instance.isMissionScene&&MissionManager.instance.missionType==MissionTypeEnum.GUESS_BOSS||FightSkillManager.instance.getIsAttackTimes(!0)&&(this.m_targetRid=t,this.isAttackTarget&&this.setLockMonster(this.m_targetRid),this.p_attackTime>0&&ServerTimeManager.instance.timerValue<this.p_attackTime+FightSkillManager.instance.p_attackSpeed||this.attackMonster())},e.prototype.stopAutoFight=function(){this.m_targetRid=0,this.p_isAutoFight=!1,PlayerManager.instance.p_mainPlayer.setAutoFight(!1),DelayCallUtils.killDelayedCallsTo(this.startAutoFight,this),this.setLockMonster(this.m_targetRid)},e.prototype.startAutoFight=function(){return this.p_isAutoFight=!0,FightSkillManager.instance.getIsAttackTimes(!1)?UIModule.instance.getCdTime(FightSkillManager.type_auto)<=0?void this.stopAutoFight():(PlayerManager.instance.p_mainPlayer.setAutoFight(!0),DelayCallUtils.killDelayedCallsTo(this.startAutoFight,this),DelayCallUtils.delayedCall(.001*FightSkillManager.instance.p_attackSpeed,this.startAutoFight,this),void this.attackMonster()):(Dispatch.dispatch(FightSkillManager.EVENT_FIGHT_SKILL_STOP+FightSkillManager.type_auto),DelayCallUtils.killDelayedCallsTo(this.startAutoFight,this),void BagManager.instance.noEnoughGold())},e.prototype.attackMonster=function(t){void 0===t&&(t=!1),this.p_attackTime=ServerTimeManager.instance.timerValue;var e=PlayerManager.instance.p_mainPlayer;if(e.p_isDie)return void this.stopAutoFight();if(e.curState!=StateType.JUMP&&e.curState!=StateType.XUAN_YUN&&e.curState!=StateType.DEAD&&e.curState!=StateType.CHUANSONG&&!FightModule.instance.p_mainFighter.haveBuffEffectType(EffectTypeEnum.DIZZY)){var i=FightModule.instance.getAttackId(),s=i[1];e.lockAction&&(s=3);var n,o=0;if(this.m_playerPoint.x=e.x,this.m_playerPoint.y=e.y,this.isAttackTarget&&!t){var a=this.targetMonster;o=a.jsonMonster.allow_hurt_distance;var r=s*MyMapData.GRID_SIZE+o*MyMapData.GRID_SIZE;if(this.m_lengthPoint.x=a.x-this.m_playerPoint.x,this.m_lengthPoint.y=a.y-this.m_playerPoint.y,this.m_lengthPoint.length>r)return this.m_tempPoint1.x=a.x,this.m_tempPoint1.y=a.y,n=this.getAngleDistance(this.m_playerPoint,this.m_tempPoint1,r-40),MyMapModule.instance.map.mapdata.getMapData(n.x,n.y)==MyMapData.DATA_BLOCK&&(n.x=a.x,n.y=a.y),void MoveManager.instance.quickMove(n.x,n.y,this.playerMoveEnd.bind(this))}this.isAttackTarget||this.p_isAutoFight&&(this.m_targetRid=SceneItemModule.instance.getNearMonsterRid(s),this.isAttackTarget&&this.setLockMonster(this.targetMonster.dataMonster.scene_monster_id)),this.isAttackTarget?FightModule.instance.playFight(i[0],this.targetMonster.dataMonster.scene_monster_id,ObjTypeEnum.MONSTER):this.checkMonsterQuick(s)}},e.prototype.checkMonsterQuick=function(t){var e,i=0;if(this.p_isAutoFight&&(this.m_targetRid=SceneItemModule.instance.getNearMonsterRid(100),this.isAttackTarget?this.setLockMonster(this.targetMonster.dataMonster.scene_monster_id):SceneManager.instance.s_notice_monster_list()),this.isAttackTarget){var s=this.targetMonster;DelayCallUtils.killDelayedCallsTo(this.checkMonsterQuick,this),i=s.jsonMonster.allow_hurt_distance,this.m_tempPoint2.x=s.x,this.m_tempPoint2.y=s.y,e=this.getAngleDistance(this.m_playerPoint,this.m_tempPoint2,t*MyMapData.GRID_SIZE+i*MyMapData.GRID_SIZE-MyMapData.GRID_SIZE),MyMapModule.instance.map.mapdata.getMapData(e.x,e.y)==MyMapData.DATA_BLOCK&&(e.x=s.x,e.y=s.y),MoveManager.instance.quickMove(e.x,e.y,this.playerMoveEnd.bind(this))}},e.prototype.setLockMonster=function(t){var e=SceneItemModule.instance.monsterDict[this.m_fightMonsterId];e&&this.m_fightMonsterId!=t&&e.setLockMonster(!1),this.m_fightMonsterId=t,e=SceneItemModule.instance.monsterDict[this.m_fightMonsterId],e&&e.setLockMonster(!0)},e.prototype.playerMoveEnd=function(){FightSkillManager.instance.getIsAttackTimes(!0)&&this.attackMonster(!0)},e.prototype.getAngleDistance=function(t,e,i){void 0===i&&(i=100);var s=e.x-t.x,n=e.y-t.y,o=i/egret.Point.distance(t,e);return s=o*s,n=o*n,this.m_angleDistancePt.x=e.x-s,this.m_angleDistancePt.y=e.y-n,this.m_angleDistancePt},Object.defineProperty(e.prototype,"isAttackTarget",{get:function(){var t=this.targetMonster;return t&&!t.isDestory&&t.jsonMonster&&!t.p_isDie?!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"targetMonster",{get:function(){return SceneItemModule.instance.getMonster(this.m_targetRid)},enumerable:!0,configurable:!0}),e}(egret.HashObject);__reflect(FightAutoAI.prototype,"FightAutoAI");var FightAutoHandle=function(){function t(t,e,i,s,n){this.m_skillId=t,this.m_tragetId=e,this.m_tragetType=i,this.m_attack_type=s,this.m_manaValue=n}return Object.defineProperty(t.prototype,"handleId",{get:function(){return 0},enumerable:!0,configurable:!0}),t.prototype.execHandle=function(){FightManager.instance.s_fight_fight(this.m_skillId,this.m_tragetId,this.m_tragetType,this.m_attack_type,this.m_manaValue)},t.prototype.endHandle=function(t){void 0===t&&(t=null)},t.prototype.cancelHandle=function(){},t}();__reflect(FightAutoHandle.prototype,"FightAutoHandle",["IHandle"]);var FighterVo=function(){function t(t,e,i,s){this.fighterName="未设置的名字",this.fighterType=t,this.fighterId=e,this.fighterName=i,this.fighterInstance=s}return t}();__reflect(FighterVo.prototype,"FighterVo");var FightHandle=function(t){function e(e){var i=t.call(this)||this;return i.onHandleTimeOut=1.5,i.m_initPoint=new egret.Point,i.m_goPoint=new egret.Point,i.m_msg=e,DelayCallUtils.delayedCall(i.onHandleTimeOut,i.onTimeOutdoHandle.bind(i),i),i}return __extends(e,t),e.prototype.onTimeOutdoHandle=function(){this.endHandle()},e.prototype.endHandle=function(t){if(void 0===t&&(t=null),TweenLite.killDelayedCallsTo(this.onTimeOutdoHandle),null!=this.m_msg)for(var e=FightModule.instance.getFighter(this.m_msg.attacker_type,this.m_msg.attacker_id),i=0;i<this.m_msg.defender_result_list.length;i++)this.showDefenderResult(this.m_msg.defender_result_list[i],e,this.m_msg.skill_id,this.m_msg.skill_level);this.m_msg=null},e.prototype.execHandle=function(){if(TweenLite.killDelayedCallsTo(this.onTimeOutdoHandle),null!=this.m_msg){var t,e=this.m_msg,i=FightModule.instance.getFighter(e.attacker_type,e.attacker_id),s=FightModule.instance.getFighter(e.target_type,e.target_id),n=e.defender_result_list;if(null==i||!PlayerManager.instance.p_playerIsShow&&i instanceof AvatarOtherPlayer){for(t=0;t<n.length;t++)this.showDefenderResult(n[t],i,e.skill_id,e.skill_level);return void(this.m_msg=null)}switch(e.attacker_type){case ObjTypeEnum.MAGICWEAPON:default:if(e.skill_id!=FightSkillManager.type_dizhen&&e.skill_id!=FightSkillManager.type_huoqiu&&i.playSkill(e.skill_id,e.dir,n,s?s.getPos():null,s),i.curState==StateType.ATTACK)for(t=0;t<n.length;t++){this.m_initPoint.x=i.x,this.m_initPoint.y=i.y+i.jsonAvatar.name_off_list[1]/2;var o=300,a=FightModule.instance.getFighter(n[t].defender_type,n[t].defender_id);if(a){this.m_goPoint.x=a.x,this.m_goPoint.y=a.y+a.jsonAvatar.name_off_list[1]/2;var r=egret.Point.distance(this.m_goPoint,this.m_initPoint);o=e.skill_id==FightSkillManager.type_huoqiu?FightUIModule.instance.getAttackTime(r,FightSkillManager.huoQiu_speed):FightUIModule.instance.getAttackTime(r)}TweenLite.delayedCall(.001*o,this.showDefenderResult,[n[t],i,e.skill_id,e.skill_level],this)}}this.m_msg=null}},e.prototype.cancelHandle=function(){},e.prototype.showDefenderResult=function(t,e,i,s){FightHurtModule.instance.execHurt(t,e,i)},Object.defineProperty(e.prototype,"handleId",{get:function(){return 0},enumerable:!0,configurable:!0}),e}(egret.HashObject);__reflect(FightHandle.prototype,"FightHandle",["IHandle"]);var FightHurtModule=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.execHurt=function(t,e,i){var s=FightModule.instance.getFighter(t.defender_type,t.defender_id);if(null!=s){if(s.p_attackAvatar=e,null==e)return void s.refreshHP(t.hp);s instanceof AvatarPlayer||s instanceof AvatarMonster&&!s.isDestory&&(s.shiftToAction(AvatarConfig.ACTION_injure,AvatarConfig.getDirection(e.x-s.x,e.y-s.y)),e instanceof AvatarPlayer&&FightUIModule.instance.showShouJi(s,e,0,i),s instanceof AvatarMainPlayer&&SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_2005)),(t.x>0||t.y>0)&&1e3!=SceneManager.instance.p_sceneId&&this.hurtBeatBack(e,s,t),s.refreshHP(t.hp),t.type==proto.DefenderResult.ENUM.crit&&e instanceof AvatarMainPlayer&&CameraModule.instance.setCameraShake(10),t.type==proto.DefenderResult.ENUM.dodge&&EffectModule.instance.dodgeEffect(s)}},t.prototype.hurtBeatBack=function(t,e,i){function s(){e instanceof AvatarMainPlayer&&CameraModule.instance.updateFocus(e.x,e.y)}e instanceof AvatarPlayer&&(e.curState==StateType.MOVE||e.curState==StateType.FAST_MOVE||e.curState==StateType.JUMP||e.curState==StateType.REFRESH)||(e.shiftToAction(AvatarConfig.ACTION_injure,t?AvatarConfig.getDirection(t.x-e.x,t.y-e.y):-1),TweenLite.to(e,.2,{x:i.x,y:i.y,onUpdate:e instanceof AvatarMainPlayer?s.bind(this):null}))},t}();__reflect(FightHurtModule.prototype,"FightHurtModule");var FightModule=function(t){function e(){var e=t.call(this)||this;return e.m_attackIdList=[901,902,903],e.m_attackIdx=0,e.m_initPoint=new egret.Point,e.m_goPoint=new egret.Point,e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.m_instance||(this.m_instance=new e),this.m_instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){},e.prototype.getAttackId=function(){this.m_attackIdx+=1,this.m_attackIdList[this.m_attackIdx]||(this.m_attackIdx=0);var t=this.m_attackIdList[this.m_attackIdx];return[t,8]},e.prototype.getAttackPathName=function(t){return ActiveSkillJson.getData(t).action_res},e.prototype.playFight=function(t,i,s){e.instance.p_mainFighter.haveBuffEffectType(EffectTypeEnum.DIZZY)||e.instance.p_mainFighter.haveBuffEffectType(EffectTypeEnum.CHEN_MO)||PlayerManager.instance.p_mainPlayer.lockAction||FightSkillManager.instance.getIsAttackTimes(!0)&&PlayerManager.instance.p_mainPlayer.doHandle(new FightAutoHandle(t,i,s,1,FightSkillManager.instance.p_manaValue))},e.prototype.executeArgeResult=function(t){var i,s=t.defender_result_list,n=e.instance.getFighter(t.attacker_type,t.attacker_id);for(i=0;i<s.length;i++){var o=e.instance.getFighter(s[i].defender_type,s[i].defender_id);o&&o instanceof AvatarMonster&&s[i].hp<=0&&(o.p_isDie=!0),s[i].beat_times>0&&o instanceof AvatarMonster&&!o.isDestory&&DelayCallUtils.delayedCall(1.5,o.setArgeShowJi,o,[s[i].beat_times,n]),n&&o&&o instanceof AvatarMonster&&s[i].hp<=0&&s[i].mano_award>0&&(FightSkillManager.instance.p_goldDelayTime=1.5,TweenLite.delayedCall(FightSkillManager.p_rage_time-.5,this.showGoldMana.bind(this),[o,s[i].mano_award,s[i].exp,s[i].x,s[i].y]))}},e.prototype.showGoldMana=function(t,e,i,s,n){FightUIModule.instance.showMyMana(t,e,i),t.refreshHP(0),TweenLite.to(t,.2,{x:s,y:n})},e.prototype.setAttackPlayer=function(t,e){t.shiftToAction(AvatarConfig.ACTION_injure,t.p_moveDriection),FightUIModule.instance.showShouJi(t,null,e,-1),t instanceof AvatarMainPlayer&&SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_2005)},e.prototype.getRandFightId=function(){var t=Math.floor(Math.random()*FightManager.instance.fightAttackList.length);return FightManager.instance.fightAttackList[t]?FightManager.instance.fightAttackList[t]:FightManager.instance.fightAttackList[0]},e.prototype.executeFightResult=function(t){var i,s=e.instance.getFighter(t.attacker_type,t.attacker_id),n=e.instance.getFighter(t.target_type,t.target_id),o=t.defender_result_list;if(n&&n instanceof AvatarMonster&&(null==o||o.length<=0))return void FloatTipModule.instance.popTip("该怪物已死亡状态");var a=-1;if(s instanceof AvatarPlayer&&t.skill_id==FightSkillManager.type_rage&&(t.skill_id=this.getRandFightId(),a=FightSkillManager.type_rage),t.skill_id==FightSkillManager.type_huoqiu&&(a=FightSkillManager.type_huoqiu),t.skill_id==FightSkillManager.type_dizhen&&(a=FightSkillManager.type_dizhen),t.skill_id==FightSkillManager.type_baoza&&(a=FightSkillManager.type_baoza,console.log("战斗怪战报："+t.target_id+"_")),s instanceof AvatarPlayer&&t.skill_id==FightSkillManager.type_shenlong&&(t.skill_id=this.getRandFightId(),a=FightSkillManager.type_shenlong),s instanceof AvatarPlayer&&t.skill_id==FightSkillManager.type_lightning&&(t.skill_id=this.getRandFightId(),a=FightSkillManager.type_lightning,this.setDolighning(s,o)),s instanceof AvatarMainPlayer)switch(PlayerManager.instance.p_anger!=t.anger&&(PlayerManager.instance.p_anger=t.anger,Dispatch.dispatch(PlayerManager.EVENT_ANGER_SET)),t.skill_id){case 901:SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_2002);break;case 902:SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_2003);break;case 903:SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_2004);break;default:SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_2004)}if(s instanceof AvatarMainPlayer&&a==FightSkillManager.type_rage)return void this.executeArgeResult(t);var r=0,_=0;for(i=0;i<o.length;i++){var h=e.instance.getFighter(o[i].defender_type,o[i].defender_id);h&&s&&s instanceof AvatarPlayer&&(a==FightSkillManager.type_lightning&&(_+=1),1>=_&&a!=FightSkillManager.type_dizhen&&a!=FightSkillManager.type_baoza&&(a==FightSkillManager.type_huoqiu?FightUIModule.instance.showHuoQiu(s,h):FightUIModule.instance.showGuangBo(s,h,s.playerData.hero_arms_id))),h&&h instanceof AvatarMonster&&o[i].hp<=0&&(h.p_isDie=!0);var l=!1;if(s&&h&&h instanceof AvatarMonster&&o[i].hp<=0&&o[i].mano_award>0&&(s instanceof AvatarMainPlayer?(l=!0,r+=o[i].mano_award,FightSkillManager.instance.p_goldDelayTime=1.5,a==FightSkillManager.type_shenlong?TweenLite.delayedCall(.2,FightUIModule.instance.showMyMana.bind(FightUIModule.instance),[h,o[i].mano_award,o[i].exp,a]):TweenLite.delayedCall(.2,FightUIModule.instance.showMyMana.bind(FightUIModule.instance),[h,o[i].mano_award,o[i].exp])):s instanceof AvatarOtherPlayer&&(l=!0,TweenLite.delayedCall(.2,FightUIModule.instance.showOtherMana.bind(FightUIModule.instance),[s,h,o[i].mano_award,!1]))),!l&&s instanceof AvatarPlayer&&15==o[i].special_event&&o[i].mano_award>0){var c=h.jsonMonster.show_mana_type;c=0==c||1==c?1:2;var m="rmbAttack"+c;2==FightSkillManager.instance.p_typeScene&&(m="goldAttack"+c);var p=PublicCon.PATH_EFFECT_MONSTER+"goldMonster/"+m;FightUIModule.instance.showEffect(p,h.xyCentered,SceneLayerModule.instance.upEffectLayer),s instanceof AvatarMainPlayer?TweenLite.delayedCall(.2,FightUIModule.instance.showMyGold.bind(FightUIModule.instance),[h,o[i].mano_award]):s instanceof AvatarOtherPlayer&&TweenLite.delayedCall(.2,FightUIModule.instance.showOtherMana.bind(FightUIModule.instance),[s,h,o[i].mano_award])}if(URIManager.isdebug&&h&&h instanceof AvatarMonster&&s instanceof AvatarMainPlayer&&h.setManaNax(o[i].total_mano),h instanceof AvatarPlayer&&s instanceof AvatarMonster){o[i].dizzy_close_time>0&&h.setYunXuan(o[i].dizzy_close_time),FightUIModule.instance.showGuangBo(s,h),this.m_initPoint.x=s.x,this.m_initPoint.y=s.y+s.jsonAvatar.name_off_list[1]/2,this.m_goPoint.x=h.x,this.m_goPoint.y=h.y+h.jsonAvatar.name_off_list[1]/2;var u=egret.Point.distance(this.m_goPoint,this.m_initPoint),d=FightUIModule.instance.getAttackTime(u);TweenLite.delayedCall(.001*d,this.setAttackPlayer.bind(this),[h,o[i].hurt])}s&&h&&h instanceof AvatarMonster&&o[i].hp<=0&&12==o[i].special_event?(h.shiftToAction(AvatarConfig.ACTION_injure,AvatarConfig.getDirection(s.x-h.x,s.y-h.y)),s instanceof AvatarPlayer&&FightUIModule.instance.showShouJi(h,s,0,FightSkillManager.type_baoza),s instanceof AvatarMainPlayer?FightUIModule.instance.showZhaDan(h):s instanceof AvatarOtherPlayer&&FightUIModule.instance.showZhaDan(h)):s&&this.execDefender(t.skill_id,s,o[i])}if(a>0&&a!=FightSkillManager.type_rage&&r>0&&Dispatch.dispatch(FightSkillManager.EVENT_SKILL_GOLD_ADD,a,r),s instanceof AvatarOtherPlayer&&a==FightSkillManager.type_rage){if(o)for(i=0;i<o.length;i++){var h=e.instance.getFighter(o[i].defender_type,o[i].defender_id);h&&h.refreshHP(o[i].hp)}}else s&&t.skill_id!=FightSkillManager.type_dizhen&&t.skill_id!=FightSkillManager.type_huoqiu&&t.skill_id!=FightSkillManager.type_baoza&&s.playSkill(t.skill_id,t.dir,t.defender_result_list,n?n.getPos():null,n)},e.prototype.execDefender=function(t,i,s){this.m_initPoint.x=i.x,this.m_initPoint.y=i.y+i.jsonAvatar.name_off_list[1]/2;var n=300,o=e.instance.getFighter(s.defender_type,s.defender_id);if(o){this.m_goPoint.x=o.x,this.m_goPoint.y=o.y+o.jsonAvatar.name_off_list[1]/2;var a=egret.Point.distance(this.m_goPoint,this.m_initPoint);n=t==FightSkillManager.type_huoqiu?FightUIModule.instance.getAttackTime(a,FightSkillManager.huoQiu_speed):FightUIModule.instance.getAttackTime(a)}TweenLite.delayedCall(.001*n,FightHurtModule.instance.execHurt,[s,i,t],FightHurtModule.instance)},e.prototype.setDolighning=function(t,i){var s=[],n=t;n&&n.magic&&s.push(n.magic);for(var o=0;o<i.length;o++){var a=e.instance.getFighter(i[o].defender_type,i[o].defender_id);a&&s.push(a)}EffectModule.instance.doLightning3D(s)},e.prototype.addEffectList=function(t,e,i){for(var s=0;s<i.length;s++){var n=i[s],o=EffectTypeJson.getData(n.id),a=1==o.pos?e:t;o.hit_effect_id>0&&HitEffect.play(o.hit_effect_id,a)}},e.prototype.noticeObjHpChange=function(t){var i=this.getFighter(t.obj_type,t.obj_id);if(i){var s=e.instance.getFighter(t.release_obj_type,t.release_obj_id);i.p_attackAvatar=s,i.refreshHP(t.new_hp)}},e.prototype.getFighter=function(t,e){switch(t){case ObjTypeEnum.PLAYER:return SceneItemModule.instance.getPlayer(e);case ObjTypeEnum.MONSTER:return SceneItemModule.instance.getMonster(e);case ObjTypeEnum.MAGICWEAPON:return SceneItemModule.instance.getPlayer(e)}return null},e.prototype.testPlaySkill=function(t){var e=SceneItemModule.instance.monsterDict,i=null;for(var s in e)if(i=e[s])break;this.p_mainFighter.playMaxSkill(t,1,[],null,i)},e}(egret.HashObject);__reflect(FightModule.prototype,"FightModule"),window.testSkill=function(t){FightModule.instance.testPlaySkill(t)};var BuffBase=function(t){function e(e,i){var s=t.call(this)||this;s.buff_id=0,s.level=0,s.isfightBuff=!1,s.m_invalid_time=0,s.m_stime=0,s.m_buffData=[],s.m_buffeffectTypeList=[],s.m_buffEffects=[],s.fighter=e,s.buff_id=i.id,s.level=i.level,s.invalid_time=i.left_time;var n,o=BuffJson.getData(s.buff_id,1);s.isfightBuff=!0,o.buff_effect_id>0&&(n=new BuffEffect,n.setBuffEffect(o.buff_effect_id,s.fighter,o.pos),s.m_buffEffects.push(n));for(var a=0;a<o.arg_list.length;a++){var r=o.arg_list[a];r.length>0&&s.m_buffeffectTypeList.push(r[0])}return s.doBuffHandel(),s}return __extends(e,t),e.prototype.doBuffHandel=function(){if(!this.fighter||PlayerManager.instance.p_playerIsShow&&PlayerManager.instance.p_playerEffectIsShow){for(var t=0;t<this.m_buffeffectTypeList.length;t++)this.fighter.addBuffEffectType(this.m_buffeffectTypeList[t]);this.fighter.haveBuffEffectType(EffectTypeEnum.DIZZY)&&MoveManager.instance.stopMove(this.fighter)}},e.prototype.removeBuffHandel=function(){for(var t=0;t<this.m_buffeffectTypeList.length;t++)this.fighter.removeBuffEffectType(this.m_buffeffectTypeList[t])},e.prototype.updataBuff=function(t){this.removeBuffHandel(),this.buff_id=t.id,this.level=t.level,this.invalid_time=t.left_time,this.doBuffHandel()},Object.defineProperty(e.prototype,"invalid_time",{get:function(){return this.m_invalid_time-(ServerTimeManager.instance.timerValue-this.m_stime)},set:function(t){for(var e=0;e<this.m_buffEffects.length;e++)this.m_buffEffects[e].refresh();this.m_invalid_time=t,this.m_stime=ServerTimeManager.instance.timerValue,DelayCallUtils.killDelayedCallsTo(this.onTimeComplete,this),DelayCallUtils.delayedCall(.001*this.m_invalid_time,this.onTimeComplete,this)},enumerable:!0,configurable:!0}),e.prototype.onTimeComplete=function(){this.destory()},e.prototype.destory=function(){this.hide(),DelayCallUtils.killDelayedCallsTo(this.onTimeComplete,this)},e.prototype.hide=function(){if(this.removeBuffHandel(),this.m_buffData=[],this.m_buffeffectTypeList=[],this.m_buffEffects){for(;this.m_buffEffects.length>0;)this.m_buffEffects[0].hide(),this.m_buffEffects.splice(0,1);this.m_buffEffects=null}DelayCallUtils.killDelayedCallsTo(this.onTimeComplete,this),this.fighter&&(this.fighter=null)},e}(egret.HashObject);__reflect(BuffBase.prototype,"BuffBase");var BuffEffect=function(){function t(){this.m_buffResUrl="null",this.m_loopNum=-1}return t.prototype.setBuffEffect=function(t,e,i,s){void 0===s&&(s=-1),this.m_mainMC||"null"==this.m_buffResUrl&&(0>=t||(this.m_loopNum=s,this.m_pos=i,this.fighter=e,this.m_buffeffectId=t,this.m_buffCsv=BuffEffectJson.getData(this.m_buffeffectId),(""!=this.m_buffCsv.recouse_id||""!=this.m_buffCsv.recouse_id)&&(this.m_recouesCsv=SkillResourceJson.getData(this.m_buffCsv.recouse_id),this.m_buffResUrl=TextureFrom.BUFF+this.m_recouesCsv.Address,TextureLoadManager.instance.requestLoadTextureAtlas(this.m_buffResUrl,this,LoaderPriority.SKILL))))},t.prototype.onloadComplete=function(t){this.m_buffCsv&&(this.m_mainMC||(this.m_mainMC=new MovieClip(TexturePool.instance.getTextureAtlas(t),this.m_recouesCsv.Frames),this.m_mainMC.blendMode=this.m_recouesCsv.BlendMode,this.m_mainMC.alpha=this.m_recouesCsv.Alpha,this.m_mainMC.scaleX=this.m_recouesCsv.ScaleX,this.m_mainMC.scaleY=this.m_recouesCsv.ScaleY,this.m_mainMC.anchorOffsetX=.5*this.m_mainMC.texture.textureWidth+this.m_recouesCsv.OffsetX,this.m_mainMC.anchorOffsetY=.5*this.m_mainMC.texture.textureHeight+this.m_recouesCsv.OffsetY,this.m_mainMC.rotation=this.m_recouesCsv.Rotation,this.m_mainMC.touchEnabled=!1,-1!=this.m_loopNum&&this.m_mainMC.addEventListener(egret.Event.COMPLETE,this.hide,this),this.show()))},t.prototype.show=function(){if(null!=this.fighter.jsonAvatar&&!this.fighter.isDestory)if(-1!=this.m_buffCsv.assembly_id,this.m_mainMC&&this.m_mainMC.play(),1==this.m_pos)switch(this.m_buffCsv.position){case BuffEnum.BUFF_TOP:this.m_mainMC.x=this.fighter.jsonAvatar.name_off_list[0],this.m_mainMC.y=this.fighter.jsonAvatar.name_off_list[1],this.fighter.addChild(this.m_mainMC);break;case BuffEnum.BUFF_MIDDLE:this.m_mainMC.x=.5*this.fighter.jsonAvatar.name_off_list[0],this.m_mainMC.y=.5*this.fighter.jsonAvatar.name_off_list[1],this.fighter.addChild(this.m_mainMC);break;case BuffEnum.BUFF_BOTTON:this.m_mainMC.y=0,this.fighter.addChildAt(this.m_mainMC,0)}else if(2==this.m_pos){if(this.fighter instanceof AvatarPlayer){var t=this.fighter.magic;t&&(this.m_mainMC.x=0,this.m_mainMC.y=0,t.item.addChild(this.m_mainMC))}}else 3==this.m_pos&&this.fighter instanceof AvatarPlayer},t.prototype.refresh=function(){switch(this.m_buffCsv.position){case BuffEnum.BUFF_TOP:break;case BuffEnum.BUFF_MIDDLE:break;case BuffEnum.BUFF_BOTTON:}},t.prototype.hide=function(t){void 0===t&&(t=null),this.fighter&&(TextureLoadManager.instance.closeLoad(this.m_buffResUrl,this),this.m_mainMC&&(this.m_mainMC.stop(),this.m_mainMC.dispose(),this.m_mainMC.removeFromParent(),this.m_mainMC=null),this.m_buffCsv=null,this.m_recouesCsv=null,this.fighter=null)},t}();__reflect(BuffEffect.prototype,"BuffEffect",["ITextureLoadEvent"]);var BuffEnum=function(){function t(){}return t.BUFF_TOP=0,t.BUFF_MIDDLE=1,t.BUFF_BOTTON=2,t.BUFF_FLY=3,t}();__reflect(BuffEnum.prototype,"BuffEnum");var ForzenEffect=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=e.touchChildren=!1,e}return __extends(e,t),e.prototype.show=function(t){if(this.m_duration=3,this.m_roxy=t,this.u_gpsSnow1&&this.u_gpsSnow2&&this.u_gpsSmoke1&&this.u_gpsSmoke2){if(0==t[0]&&0==t[1])this.x=0,this.y=0;else{var e=PlayerManager.instance.p_mainPlayer.getPointStage();this.x=t[0]-e[0],this.y=t[1]-e[1]}this.width=StageManager.instance.p_stageWidth,this.height=StageManager.instance.p_stageHeight,StageManager.instance.sceneUILayer.addChild(this),this.u_gpsSnow1.emitterX=StageManager.instance.p_stageWidth/2+this.x,this.u_gpsSnow1.emitterY=StageManager.instance.p_stageHeight/2+this.y,this.addChild(this.u_gpsSnow1),this.u_gpsSnow1.start(),this.u_gpsSmoke1.emitterX=StageManager.instance.p_stageWidth/2+this.x,this.u_gpsSmoke1.emitterY=StageManager.instance.p_stageHeight/2+this.y,this.addChild(this.u_gpsSmoke1),this.u_gpsSmoke1.start(),this.u_gpsSnow2.emitterX=StageManager.instance.p_stageWidth/2+this.x,this.u_gpsSnow2.emitterY=StageManager.instance.p_stageHeight/2+this.y,this.addChild(this.u_gpsSnow2),this.u_gpsSnow2.start(),this.u_gpsSmoke2.emitterX=StageManager.instance.p_stageWidth/2+this.x,this.u_gpsSmoke2.emitterY=0,this.addChild(this.u_gpsSmoke2),this.u_gpsSmoke2.start(),this.u_imgBoom1||(this.u_imgBoom1=new eui.Image,this.u_imgBoom1.verticalCenter=0,this.u_imgBoom1.horizontalCenter=0,this.u_imgBoom1.blendMode=egret.BlendMode.ADD,this.addChild(this.u_imgBoom1)),this.u_imgBoom1.source=PublicCon.PATH_BINGDONG_SKILL+"fangshe_ef_00000.png",this.u_imgBoom2||(this.u_imgBoom2=new eui.Image,this.u_imgBoom2.verticalCenter=0,this.u_imgBoom2.horizontalCenter=0,this.u_imgBoom2.blendMode=egret.BlendMode.ADD,this.addChild(this.u_imgBoom2)),this.u_imgBoom2.source=PublicCon.PATH_BINGDONG_SKILL+"guangyun_ef_00000.png",this.u_imgBoom1.alpha=1,this.u_imgBoom2.alpha=1,this.u_imgBoom1.width=512,this.u_imgBoom1.height=512,this.u_imgBoom2.width=256,this.u_imgBoom2.height=256,this.m_effectFrozenTopLeft||0!=t[0]||0!=t[1]||(this.m_effectFrozenTopLeft=new EffectMovieClip,this.m_effectFrozenTopLeft.onCompleteFunc=this.complateEffectPlay.bind(this),this.m_effectFrozenTopLeft.setMC(PublicCon.PATH_BINGDONG_SKILL+"frozenEffect",1,5)),this.m_effectFrozenTopLeft&&(this.m_effectFrozenTopLeft.blendMode=egret.BlendMode.ADD,this.m_effectFrozenTopLeft.x=312,this.m_effectFrozenTopLeft.y=191,this.m_effectFrozenTopLeft.scaleY=-1,this.m_effectFrozenTopLeft.gotoAndPlay(7),this.addChild(this.m_effectFrozenTopLeft)),this.m_effectFrozenBottomLeft||0!=t[0]||0!=t[1]||(this.m_effectFrozenBottomLeft=new EffectMovieClip,this.m_effectFrozenBottomLeft.setMC(PublicCon.PATH_BINGDONG_SKILL+"frozenEffect",1,5)),this.m_effectFrozenBottomLeft&&(this.m_effectFrozenBottomLeft.blendMode=egret.BlendMode.ADD,this.m_effectFrozenBottomLeft.x=312,this.m_effectFrozenBottomLeft.y=StageManager.instance.p_stageHeight-191,this.m_effectFrozenBottomLeft.gotoAndPlay(7),this.addChild(this.m_effectFrozenBottomLeft)),this.m_effectFrozenTopRight||0!=t[0]||0!=t[1]||(this.m_effectFrozenTopRight=new EffectMovieClip,this.m_effectFrozenTopRight.setMC(PublicCon.PATH_BINGDONG_SKILL+"frozenEffect",1,5)),this.m_effectFrozenTopRight&&(this.m_effectFrozenTopRight.blendMode=egret.BlendMode.ADD,this.m_effectFrozenTopRight.x=StageManager.instance.p_stageWidth-312,this.m_effectFrozenTopRight.y=191,this.m_effectFrozenTopRight.rotation=180,this.m_effectFrozenTopRight.gotoAndPlay(7),this.addChild(this.m_effectFrozenTopRight)),this.m_effectFrozenBottomRight||0!=t[0]||0!=t[1]||(this.m_effectFrozenBottomRight=new EffectMovieClip,this.m_effectFrozenBottomRight.setMC(PublicCon.PATH_BINGDONG_SKILL+"frozenEffect",1,5),this.m_effectFrozenBottomRight.blendMode=egret.BlendMode.ADD),this.m_effectFrozenBottomRight&&(this.m_effectFrozenBottomRight.x=StageManager.instance.p_stageWidth-312,this.m_effectFrozenBottomRight.y=StageManager.instance.p_stageHeight-191,this.m_effectFrozenBottomRight.scaleX=-1,this.m_effectFrozenBottomRight.gotoAndPlay(7),this.addChild(this.m_effectFrozenBottomRight)),TweenMax.to(this.u_imgBoom1,.8,{width:1.5*StageManager.instance.p_stageWidth,height:1.5*StageManager.instance.p_stageWidth}),TweenMax.to(this.u_imgBoom1,.4,{delay:.4,alpha:0}),TweenMax.to(this.u_imgBoom2,.8,{width:2.2*StageManager.instance.p_stageWidth,height:2.2*StageManager.instance.p_stageWidth}),TweenMax.to(this.u_imgBoom2,.2,{delay:.25,alpha:0}),DelayCallUtils.delayedCall(.1,this.onStopSnow1,this),DelayCallUtils.delayedCall(.8,this.onStopSmoke1,this),DelayCallUtils.delayedCall(this.m_duration,this.onStopEffect,this)
}else this.loadRes()},e.prototype.loadRes=function(){var t=this.hashCode;-1==FightUIModule.instance.p_forzentUseList.indexOf(t)&&FightUIModule.instance.p_forzentUseList.push(t);for(var e=1;4>=e;e++)RES.getResByUrl(PublicCon.PATH_BINGDONG_SKILL+"particle_"+e+".png",this.onLoadComplete,this,RES.ResourceItem.TYPE_IMAGE),RES.getResByUrl(PublicCon.PATH_BINGDONG_SKILL+"particle_"+e+".json",this.onLoadComplete,this,RES.ResourceItem.TYPE_JSON)},e.prototype.onLoadComplete=function(t,e){var i=e.substring(e.length-3);if("png"==i){var s=e.substring(e.length-5,e.length-4);switch(s){case"1":this.m_textureSnow1=t;break;case"2":this.m_textureSnow2=t;break;case"3":this.m_textureSmoke1=t;break;case"4":this.m_textureSmoke2=t}}if("son"==i){var s=e.substring(e.length-6,e.length-5);switch(s){case"1":this.m_jsonSnow1=t;break;case"2":this.m_jsonSnow2=t;break;case"3":this.m_jsonSmoke1=t;break;case"4":this.m_jsonSmoke2=t}}this.m_textureSnow1&&this.m_jsonSnow1&&!this.u_gpsSnow1&&(this.u_gpsSnow1=new particle.GravityParticleSystem(this.m_textureSnow1,this.m_jsonSnow1),this.u_gpsSnow1.blendMode=egret.BlendMode.ADD),this.m_textureSnow2&&this.m_jsonSnow2&&!this.u_gpsSnow2&&(this.u_gpsSnow2=new particle.GravityParticleSystem(this.m_textureSnow2,this.m_jsonSnow2),this.u_gpsSnow2.blendMode=egret.BlendMode.ADD),this.m_textureSmoke1&&this.m_jsonSmoke1&&!this.u_gpsSmoke1&&(this.u_gpsSmoke1=new particle.GravityParticleSystem(this.m_textureSmoke1,this.m_jsonSmoke1),this.u_gpsSmoke1.blendMode=egret.BlendMode.ADD),this.m_textureSmoke2&&this.m_jsonSmoke2&&!this.u_gpsSmoke2&&(this.u_gpsSmoke2=new particle.GravityParticleSystem(this.m_textureSmoke2,this.m_jsonSmoke2),this.u_gpsSmoke2.blendMode=egret.BlendMode.ADD),this.u_gpsSnow1&&this.u_gpsSnow2&&this.u_gpsSmoke1&&this.u_gpsSmoke2&&this.show(this.m_roxy)},e.prototype.onStopSnow1=function(){this.u_gpsSnow1&&this.u_gpsSnow1.stop(),DelayCallUtils.killDelayedCallsTo(this.onStopSnow1,this)},e.prototype.onStopSmoke1=function(){this.u_gpsSmoke1&&this.u_gpsSmoke1.stop(),DelayCallUtils.killDelayedCallsTo(this.onStopSmoke1,this)},e.prototype.onStopEffect=function(){this.u_gpsSnow1&&(this.u_gpsSnow1.stop(!0),this.removeChild(this.u_gpsSnow1),this.u_gpsSnow1=null),this.u_gpsSmoke1&&(this.u_gpsSmoke1.stop(!0),this.removeChild(this.u_gpsSmoke1),this.u_gpsSmoke1=null),this.u_gpsSnow2&&(this.u_gpsSnow2.stop(!0),this.removeChild(this.u_gpsSnow2),this.u_gpsSnow2=null),this.u_gpsSmoke2&&(this.u_gpsSmoke2.stop(!0),this.removeChild(this.u_gpsSmoke2),this.u_gpsSmoke2=null),this.m_effectFrozenTopLeft&&(DisplayObjectUtils.removeFormParent(this.m_effectFrozenTopLeft),this.m_effectFrozenTopLeft.destory(),this.m_effectFrozenTopLeft=null),this.m_effectFrozenBottomLeft&&(DisplayObjectUtils.removeFormParent(this.m_effectFrozenBottomLeft),this.m_effectFrozenBottomLeft.destory(),this.m_effectFrozenBottomLeft=null),this.m_effectFrozenTopRight&&(DisplayObjectUtils.removeFormParent(this.m_effectFrozenTopRight),this.m_effectFrozenTopRight.destory(),this.m_effectFrozenTopRight=null),this.m_effectFrozenBottomRight&&(DisplayObjectUtils.removeFormParent(this.m_effectFrozenBottomRight),this.m_effectFrozenBottomRight.destory(),this.m_effectFrozenBottomRight=null),DelayCallUtils.killDelayedCallsTo(this.onStopEffect,this),DisplayObjectUtils.removeFormParent(this);var t=FightUIModule.instance.p_forzentUseList.indexOf(this.hashCode);if(t>-1&&FightUIModule.instance.p_forzentUseList.splice(t,1),-1==FightUIModule.instance.p_forzentList.indexOf(this)&&FightUIModule.instance.p_forzentList.push(this),this.m_textureSnow1=null,this.m_textureSnow2=null,this.m_textureSmoke1=null,this.m_textureSmoke2=null,this.m_jsonSnow1=null,this.m_jsonSnow2=null,this.m_jsonSmoke1=null,this.m_jsonSmoke2=null,this.u_imgBoom1.source=null,this.u_imgBoom2.source=null,0==FightUIModule.instance.p_forzentUseList.length){for(var e=1;4>=e;e++)RES.destroyRes(PublicCon.PATH_BINGDONG_SKILL+"particle_"+e+".png"),RES.destroyRes(PublicCon.PATH_BINGDONG_SKILL+"particle_"+e+".json");RES.destroyRes(PublicCon.PATH_BINGDONG_SKILL+"fangshe_ef_00000.png"),RES.destroyRes(PublicCon.PATH_BINGDONG_SKILL+"guangyun_ef_00000.png")}},e.prototype.complateEffectPlay=function(){TweenLite.killTweensOf(this.m_effectFrozenTopLeft),TweenLite.to(this.m_effectFrozenTopLeft,.3*this.m_duration,{alpha:0}),TweenLite.killTweensOf(this.m_effectFrozenBottomLeft),TweenLite.to(this.m_effectFrozenBottomLeft,.3*this.m_duration,{alpha:0}),TweenLite.killTweensOf(this.m_effectFrozenTopRight),TweenLite.to(this.m_effectFrozenTopRight,.3*this.m_duration,{alpha:0}),TweenLite.killTweensOf(this.m_effectFrozenBottomRight),TweenLite.to(this.m_effectFrozenBottomRight,.3*this.m_duration,{alpha:0})},e}(ComponentBase);__reflect(ForzenEffect.prototype,"ForzenEffect");var MinMapModule=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.createMiniMap=function(){this.m_minMapView||(this.m_minMapView=new MinMapView),this.m_minMapView.show()},t.prototype.removeMiniMap=function(){this.m_minMapView&&(this.m_minMapView.hide(),this.m_minMapView=null)},t.prototype.createPLayer=function(e){this.m_minMapView&&this.m_minMapView.parent&&(this.m_minMapView.createPLayer(e),Dispatch.dispatch(t.EVENT_MINMAP_PLAYER_CREATE,e))},t.prototype.removePlayer=function(e){this.m_minMapView&&this.m_minMapView.parent&&(this.m_minMapView.removePlayer(e),Dispatch.dispatch(t.EVENT_MINMAP_PLAYER_DELETE,e))},t.prototype.createMonster=function(e){this.m_minMapView&&this.m_minMapView.parent&&(this.m_minMapView.createMonster(e),Dispatch.dispatch(t.EVENT_MINMAP_MONSTER_CREATE,e))},t.prototype.removeMonster=function(e){this.m_minMapView&&this.m_minMapView.parent&&(this.m_minMapView.removeMonster(e),Dispatch.dispatch(t.EVENT_MINMAP_MONSTER_DELETE,e))},Object.defineProperty(t.prototype,"getMinMapView",{get:function(){return this.m_minMapView},enumerable:!0,configurable:!0}),t.EVENT_MINMAP_PLAYER_CREATE="EVENT_MINMAP_PLAYER_CREATE",t.EVENT_MINMAP_PLAYER_DELETE="EVENT_MINMAP_PLAYER_DELETE",t.EVENT_MINMAP_MONSTER_CREATE="EVENT_MINMAP_MONSTER_CREATE",t.EVENT_MINMAP_MONSTER_DELETE="EVENT_MINMAP_MONSTER_DELETE",t}();__reflect(MinMapModule.prototype,"MinMapModule");var SceneItemModule=function(){function t(){this.m_playerDict={},this.m_monsterDict={},this.m_itemDict={},this.m_sceneDoorDict={},this.m_collectDict={},this.m_npcDict={},this.m_npcOnlyDict={},this.m_sceneEffectDict={},this.m_trapDict={},this.m_dropItemPool=[],this.m_nearMonsterPoint=new egret.Point}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.createPlayer=function(t){var e,i=HeroJson.getData(t.hero_id).avatar_id;if(SceneModule.instance.isMissionScene&&MissionManager.instance.missionType==MissionTypeEnum.GUESS_BOSS)return void(t.player_id==PlayerManager.instance.playerId&&(this.m_playerDict[t.player_id]?e=this.m_playerDict[t.player_id]:(e=new AvatarMainPlayer,PlayerManager.instance.p_mainPlayer=e,FightModule.instance.p_mainFighter=e),TweenLite.killTweensOf(e),MoveManager.instance.stopMove(PlayerManager.instance.p_mainPlayer,!0),MoveManager.instance.killDelayMove(),CameraModule.instance.updateFocus(t.x,t.y)));if(t.player_id==PlayerManager.instance.playerId?(this.m_playerDict[t.player_id]?e=this.m_playerDict[t.player_id]:(e=new AvatarMainPlayer,PlayerManager.instance.p_mainPlayer=e,FightModule.instance.p_mainFighter=e),e.setAvatarId(i),TweenLite.killTweensOf(e),MoveManager.instance.stopMove(PlayerManager.instance.p_mainPlayer,!0),MoveManager.instance.killDelayMove(),e.setPos(t.x,t.y),MoveManager.instance.s_scene_player_stop_move_tos(),e.lockAction=!1,e.refreshPlayer(),e.shiftToAction(AvatarConfig.ACTION_stand,4),e.curState=StateType.REFRESH,PlayerManager.instance.p_anger=t.anger,CameraModule.instance.updateFocus(t.x,t.y)):(this.m_playerDict[t.player_id]&&this.removePlayer(t.player_id),e=new AvatarOtherPlayer,e.setAvatarId(i)),this.m_playerDict[t.player_id]=e,TweenLite.killTweensOf(e),e.jumpHeight=0,e.hangingHeight=0,e.alpha=1,e.playerData=t,e.setPos(t.x,t.y),e.moveSpeed=t.move_speed/100*5/10*MyMapData.GRID_SIZE/PublicCon.DEL_FPS,e.shiftToAction(e.curAction,t.dir),(t.player_id!=PlayerManager.instance.playerId&&PlayerManager.instance.p_playerIsShow||t.player_id==PlayerManager.instance.playerId)&&(SceneModule.instance.isMainScene||SceneLayerModule.instance.liveThingsLayer.addChild(e)),0!=t.move_path.length&&!SceneModule.instance.isMainScene){var s=t.move_path[t.move_path.length-1];MoveManager.instance.move(e,s.x,s.y)}t.dizzy_close_time>ServerTimeManager.instance.timer?e.setYunXuan(t.dizzy_close_time):(e.curState=StateType.REFRESH,TweenLite.to(e,0,{delay:.2,curState:StateType.STAND})),MinMapModule.instance.createPLayer(t.player_id),t.player_id==PlayerManager.instance.playerId&&FightSkillManager.instance.setAttackSpeed()},t.prototype.removePlayer=function(t){var e=this.m_playerDict[t];e instanceof AvatarMainPlayer||(e&&e.destory(),delete this.m_playerDict[t],MinMapModule.instance.removePlayer(t))},t.prototype.createMonster=function(e,i){void 0===i&&(i=!1);var s;if(s=null!=this.m_monsterDict[e.scene_monster_id]?this.m_monsterDict[e.scene_monster_id]:new AvatarMonster,s.setData(e),s.setPos(e.x,e.y),this.m_monsterDict[e.scene_monster_id]=s,s.moveSpeed=e.move_speed/100*5/10*MyMapData.GRID_SIZE/PublicCon.DEL_FPS,s.shiftToAction(s.curAction,e.dir),SceneLayerModule.instance.liveThingsLayer.addChild(s),s.setShowEffect(),e.move_path.length>0){var n=e.move_path[e.move_path.length-1];MoveManager.instance.move(s,n.x,n.y)}i&&SceneManager.instance.p_sceneJson.drop_look_list&&SceneManager.instance.p_sceneJson.drop_look_list.length>0&&s.isBoss&&Dispatch.dispatch(t.EVENT_BOSS_COMING,e.scene_monster_id),s.jsonMonster.effect_list&&s.jsonMonster.effect_list.length>0&&MinMapModule.instance.createMonster(e.scene_monster_id)},t.prototype.removeMonster=function(t){Dispatch.dispatch(MinMapModule.EVENT_MINMAP_MONSTER_DELETE,t);var e=this.m_monsterDict[t];e&&(this.deleteMonster(t),e.destory(),e=null)},t.prototype.deleteMonster=function(e){var i=this.m_monsterDict[e];i&&i.jsonMonster.effect_list&&i.jsonMonster.effect_list.length>0&&MinMapModule.instance.removeMonster(e),this.m_monsterDict[e]=null,delete this.m_monsterDict[e],Dispatch.dispatch(t.EVENT_MONSTER_REMOVE,e)},t.prototype.checkMonsterDie=function(){for(var t=[],e=SceneLayerModule.instance.liveThingsLayer.numChildren,i=0;e>i;i++){var s=SceneLayerModule.instance.liveThingsLayer.getChildAt(i);if(s&&s instanceof AvatarMonster&&s.dataMonster){var n=s.dataMonster.scene_monster_id;this.getMonster(n)||t.push(s)}}if(t){for(var i=0;i<t.length;i++)t[i].destory(),t[i]=null;t=null}},t.prototype.createNpc=function(t,e,i,s){void 0===s&&(s=0);var n=new AvatarNpc;n.npcId=t,this.m_npcDict[t]=n,this.m_npcOnlyDict[s]=n,n.only_id=s,n.setPos(e,i),SceneEffectModule.instance.checkNpc(!0)},t.prototype.removeNpc=function(t){var e=this.m_npcDict[t];e&&e.destory(),delete this.m_npcDict[t]},t.prototype.createItem=function(t){if(0==t.type){var e;if(t.owner_player_id!=PlayerManager.instance.playerId)return;null!=this.m_itemDict[t.id]?e=this.m_itemDict[t.id]:(e=this.getSceneItem(),this.m_itemDict[t.id]=e),e.setDropData(t)}},t.prototype.removeItem=function(t,e){if(0==t){var i=this.m_itemDict[e];i&&(i.remove(),delete this.m_itemDict[e])}},t.prototype.clearSceneItem=function(){var t=[];for(var e in this.m_itemDict)t.push(e);for(var i=0;i<t.length;i++)this.m_itemDict[t[i]].remove(!0),delete this.m_itemDict[t[i]]},t.prototype.getSceneItem=function(){return this.m_dropItemPool.length>0?this.m_dropItemPool.shift():new SceneItem},t.prototype.recoverSceneItem=function(t){var e=this.m_dropItemPool.indexOf(t);-1==e&&this.m_dropItemPool.push(t)},t.prototype.clearObjectDict=function(t){var e=[];for(var i in t)e.push(i);for(var s=0;s<e.length;s++)!t[e[s]]||t[e[s]]instanceof AvatarMainPlayer||(t[e[s]].destory(),delete t[e[s]])},t.prototype.clearLivethings=function(){if(t.instance.clearObjectDict(this.m_playerDict),t.instance.clearObjectDict(this.m_monsterDict),t.instance.clearObjectDict(this.m_npcOnlyDict),t.instance.clearObjectDict(this.m_npcDict),t.instance.clearObjectDict(this.m_collectDict),t.instance.clearObjectDict(this.m_trapDict),t.instance.clearObjectDict(this.m_sceneDoorDict),t.instance.clearSceneItem(),SceneLayerModule.instance.liveThingsLayer.numChildren>0)for(;SceneLayerModule.instance.liveThingsLayer.numChildren>0;){var e=SceneLayerModule.instance.liveThingsLayer.removeChildAt(0);e&&e instanceof AvatarBase&&!(e instanceof AvatarMainPlayer)&&(e.destory(),e=null)}},t.prototype.refreshMask=function(){function t(t){var e=[];for(var i in t)e.push(i);for(var s=0;s<e.length;s++)t[e[s]].refreshMask()}t(this.m_playerDict),t(this.m_monsterDict),t(this.m_npcDict)},t.prototype.getPlayer=function(t){return this.m_playerDict[t]},t.prototype.getMonster=function(t){return this.m_monsterDict[t]},t.prototype.getNpc=function(t){return this.m_npcDict[t]?this.m_npcDict[t]:null},t.prototype.getNearMonsterRid=function(t,e){if(void 0===t&&(t=4),void 0===e&&(e=null),null==e&&(e=PlayerManager.instance.p_mainPlayer),!PlayerManager.instance.p_mainPlayer)return null;var i,s=e.getPos(),n=t*MyMapData.GRID_SIZE;for(var o in this.m_monsterDict){var a=this.m_monsterDict[o];this.m_nearMonsterPoint.x=a.x-s.x,this.m_nearMonsterPoint.y=a.y-s.y,!a.p_isDie&&a.montserType!=AvatarMonster.MONSTER_TYPE_NPC&&this.m_nearMonsterPoint.length-a.jsonMonster.allow_hurt_distance*MyMapData.GRID_SIZE<n&&(i?this.m_nearMonsterPoint.length<i.lg&&(i={mc:a,lg:this.m_nearMonsterPoint.length}):i={mc:a,lg:this.m_nearMonsterPoint.length})}return i&&i.mc?i.mc.dataMonster.scene_monster_id:0},Object.defineProperty(t.prototype,"playerDict",{get:function(){return this.m_playerDict},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"monsterDict",{get:function(){return this.m_monsterDict},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"npcDict",{get:function(){return this.m_npcDict},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sceneDoorDict",{get:function(){return this.m_sceneDoorDict},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"itemDict",{get:function(){return this.m_itemDict},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"collectDict",{get:function(){return this.m_collectDict},enumerable:!0,configurable:!0}),t.EVENT_BOSS_COMING="EVENT_BOSS_COMING",t.EVENT_MONSTER_REMOVE="EVENT_MONSTER_REMOVE",t}();__reflect(SceneItemModule.prototype,"SceneItemModule");var SceneLayerModule=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(t,e){this.m_scene=t,this.m_stage3D=e,this.m_downEffectLayer=new egret.DisplayObjectContainer,this.m_upEffectLayer=new egret.DisplayObjectContainer,this.m_flyTextLayer=new egret.DisplayObjectContainer,this.m_liveThingsLayer=new egret.DisplayObjectContainer,this.m_weatherLayer=new egret.DisplayObjectContainer,this.m_weatherLayer.name="m_weatherLayer",this.m_scene.addChild(this.m_downEffectLayer),this.m_scene.addChild(this.m_liveThingsLayer),this.m_scene.addChild(this.m_upEffectLayer),this.m_scene.addChild(this.m_flyTextLayer),this.m_stage3D.addChild(this.m_weatherLayer),EnterFrameManager.instance.addEnterFrame(this.advanceTime,this)},Object.defineProperty(t.prototype,"downEffectLayer",{get:function(){return this.m_downEffectLayer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"upEffectLayer",{get:function(){return this.m_upEffectLayer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"flyTextLayer",{get:function(){return this.m_flyTextLayer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"liveThingsLayer",{get:function(){return this.m_liveThingsLayer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"weatherLayer",{get:function(){return this.m_weatherLayer},enumerable:!0,configurable:!0}),t.prototype.advanceTime=function(t){this.sortLayer()},t.prototype.sortLayer=function(){this.m_sceneObjLib=this.m_liveThingsLayer.$children,this.m_sceneObjLib.sort(function(t,e){return t.y-e.y})},t}();__reflect(SceneLayerModule.prototype,"SceneLayerModule");var SceneModule=function(t){function e(){var e=t.call(this)||this;return e.m_lastIsWorldMap=!1,e.m_mainSceneId=-1,e.p_hjStopTime=0,e.p_hjContinueTime=0,e.p_ycStopTime=0,e.p_ycContinueTime=0,e.p_yucaoCome=0,e.p_playerGoleList=[],e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.m_instance||(this.m_instance=new e),this.m_instance},enumerable:!0,configurable:!0}),e.prototype.init=function(t){MyMapModule.instance.init(t)},e.prototype.preloadScene=function(t){this.collectAllThings(),this.m_lastIsWorldMap=!1;var i=this.m_sceneJson;this.m_sceneJson=SceneJson.getData(t.scene_id),this.m_sceneJson.id!=e.instance.mainSceneId&&MyMapModule.instance.addTouchMap(),this.m_sceneJson.type!=SceneTypeEnum.MISSION&&this.m_sceneJson.id!=this.mainSceneId&&FightSkillManager.instance.setChangeScene(this.m_sceneJson.mana_attack_list),i&&i.id!=e.instance.mainSceneId&&(i.type!=SceneTypeEnum.MISSION||this.m_sceneJson.type!=SceneTypeEnum.MISSION)&&(this.m_lastIsWorldMap=!0),1==this.m_lastIsWorldMap?(PlayerManager.instance.p_mainPlayer.setChuangSong(),this.m_sceneJson.id==e.instance.mainSceneId?SceneMainModule.instance.setEffectEasing(this.mainSceneLoad.bind(this),.8):TweenLite.delayedCall(.8,MyMapModule.instance.loadScene,null,MyMapModule.instance)):this.m_sceneJson.type==SceneTypeEnum.MISSION?(TweenLite.delayedCall(.8,MyMapModule.instance.loadScene,null,MyMapModule.instance),LoadingUIModule.instance.showMissionLoading()):this.m_sceneJson.id==e.instance.mainSceneId?SceneMainModule.instance.setLoadUI():i&&i.id==e.instance.mainSceneId?(SceneMainModule.instance.setEffectBitmap(this.otherSceneLoad.bind(this)),this.cleanEventData()):MyMapModule.instance.loadScene(),MoveManager.instance.killDelayMove(),FightUIModule.instance.setResidualBlood(!1)},e.prototype.mainSceneLoad=function(t){1==t&&SceneMainModule.instance.setLoadUI()},e.prototype.otherSceneLoad=function(t){1==t&&MyMapModule.instance.loadScene()},e.prototype.checkMonsterDie=function(){SceneItemModule.instance.checkMonsterDie(),DelayCallUtils.delayedCall(5,this.checkMonsterDie,this)},e.prototype.loadScene=function(t){PlayerManager.instance.p_mainPlayer&&(PlayerManager.instance.p_mainPlayer.setSkillHide(),FightUIModule.instance.hideAttackSkill()),MyMapModule.instance.map.cleanMap(),EntranceModule.instance.refreshEntrance(),MinMapModule.instance.removeMiniMap();var e=!1;if(this.mainSceneId==t.scene_id){if(DelayCallUtils.killDelayedCallsTo(this.checkMonsterDie,this),e=!0,UIModule.instance.gotoMainScene(),PlayerManager.instance.p_mainPlayer)DisplayObjectUtils.removeFormParent(PlayerManager.instance.p_mainPlayer);else for(var i=0;i<t.scene_player_list.length;i++)if(t.scene_player_list[i].player_id==PlayerManager.instance.playerId){SceneItemModule.instance.createPlayer(t.scene_player_list[i]);break}}else UIModule.instance.leaveMainScene(),this.checkMonsterDie();var s;if(!e){for(s=0;s<t.scene_player_list.length;s++)SceneItemModule.instance.createPlayer(t.scene_player_list[s]);for(s=0;s<t.scene_item_list.length;s++)SceneItemModule.instance.createItem(t.scene_item_list[s]);var n=MyMapModule.instance.map.mapdata.npcArray;for(s=0;s<n.length;s++)n[s].hasOwnProperty("show")&&0==n[s].show||SceneItemModule.instance.createNpc(n[s].npc_id,n[s].x,n[s].y,n[s].only_id)}if(TextureLoadManager.enableIdleLoad=!0,!e)for(1==this.m_lastIsWorldMap&&PlayerManager.instance.p_mainPlayer.setChuangSong(!0),s=0;s<t.scene_monster_list.length;s++)SceneItemModule.instance.createMonster(t.scene_monster_list[s]);Dispatch.dispatch(SceneManager.EVENT_ENTER_SCENE),TweenLite.to(this,0,{delay:.2,onComplete:GuideModule.instance.sceneChange.bind(GuideModule.instance)})},e.prototype.syncScene=function(t){var e;for(e=0;e<t.remove_scene_player_id_list.length;e++)SceneItemModule.instance.removePlayer(t.remove_scene_player_id_list[e]);for(e=0;e<t.remove_scene_monster_id_list.length;e++)SceneItemModule.instance.removeMonster(t.remove_scene_monster_id_list[e]);for(e=0;e<t.remove_scene_item_id_list.length;e++)SceneItemModule.instance.removeItem(t.remove_scene_item_id_list[e].type,t.remove_scene_item_id_list[e].id);for(e=0;e<t.scene_player_list.length;e++)SceneItemModule.instance.createPlayer(t.scene_player_list[e]);for(e=0;e<t.scene_monster_list.length;e++)SceneItemModule.instance.createMonster(t.scene_monster_list[e],!0);for(e=0;e<t.scene_item_list.length;e++)SceneItemModule.instance.createItem(t.scene_item_list[e])},e.prototype.playerEnterScene=function(t){SceneItemModule.instance.createPlayer(t.scene_player)},e.prototype.playerLeaveScene=function(t){SceneItemModule.instance.removePlayer(t.player_id)},e.prototype.noticePlayerBubbleLine=function(t){var e=SceneItemModule.instance.getPlayer(t.player_id);e&&e.showBubbleLine(t.type,t.id)},e.prototype.noticePlayerMove=function(t){var e=SceneItemModule.instance.getPlayer(t.player_id);if(e){var i={x:t.go_x,y:t.go_y};if(2!=t.move_type){for(var s=0==t.move_path.length?!1:!0,n=[],o=0;o<t.move_path.length;o++)n.push(t.move_path[o].x),n.push(t.move_path[o].y);MoveManager.instance.move(e,i.x,i.y,null,-1,0,0==t.move_type?MoveType.MOVE:MoveType.QUICK_MOVE,s?n:null,!0)}else MoveManager.instance.skillMove(e,i.x,i.y,t.high,t.action_id,t.time)}},e.prototype.noticePlayerStopMove=function(t){var e=SceneItemModule.instance.getPlayer(t.player_id);if(e){var i=new egret.Point;i.x=t.x,i.y=t.y,egret.Point.distance(e.getPos(),i)>100?MoveManager.instance.move(e,t.x,t.y,null,-1,0,MoveType.MOVE,null,!0):MoveManager.instance.stopMove(e)}},e.prototype.correctPlayerPos=function(t){var e=PlayerManager.instance.p_mainPlayer;e&&(MoveManager.instance.stopMove(e),e.x=t.x,e.y=t.y)},e.prototype.doPlyerTeleport=function(t){var e=SceneItemModule.instance.getPlayer(t.player_id);e&&(MoveManager.instance.stopMove(e),e.showDashEffectStart(),e.x=t.x,e.y=t.y,e==PlayerManager.instance.p_mainPlayer&&MoveManager.instance.onUpDateMapPos(e.x,e.y),e.showDashEffectStart())},e.prototype.monsterEnterScene=function(t){for(var e=0;e<t.scene_monster_list.length;e++)SceneItemModule.instance.createMonster(t.scene_monster_list[e],!0)},e.prototype.monsterLeaveScene=function(t){var e=SceneItemModule.instance.getMonster(t.scene_monster_id);if(e){var i=PublicCon.PATH_EFFECT_MONSTER+"showAndLeave/leave";FightUIModule.instance.showEffect(i,e.xyCentered,SceneLayerModule.instance.upEffectLayer)}SceneItemModule.instance.removeMonster(t.scene_monster_id)},e.prototype.noticeMonsterMove=function(t){var e=SceneItemModule.instance.getMonster(t.scene_monster_id);if(e){for(var i=t.move_path[t.move_path.length-1],s=[],n=0;n<t.move_path.length;n++)s.push(t.move_path[n].x),s.push(t.move_path[n].y);MoveManager.instance.move(e,i.x,i.y,null,-1,0,MoveType.MOVE,s)}},e.prototype.noticeMonsterStopMove=function(t){var e=SceneItemModule.instance.getMonster(t.scene_monster_id);e&&(MoveManager.instance.stopMove(e),e.shiftToAction(AvatarConfig.ACTION_stand))},e.prototype.noticeMonsterTeleport=function(t){var e=SceneItemModule.instance.getMonster(t.scene_monster_id);e&&FightUIModule.instance.showShunyi(e,t.x,t.y)},e.prototype.noticItemEnterScene=function(t){for(var e=0;e<t.scene_item_list.length;e++)SceneItemModule.instance.createItem(t.scene_item_list[e])},e.prototype.noticItemLeaveScene=function(t){for(var e=0;e<t.scene_item_id_list.length;e++)SceneItemModule.instance.removeItem(t.type,t.scene_item_id_list[e])},e.prototype.noticeSceneItemOwnerChange=function(t){},Object.defineProperty(e.prototype,"isMainScene",{get:function(){return SceneManager.instance.p_sceneJson&&SceneManager.instance.p_sceneJson.id==this.mainSceneId?!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mainSceneId",{get:function(){return-1==this.m_mainSceneId&&(this.m_mainSceneId=1e4,StaticDataJson.getData("my_main_scene")&&(this.m_mainSceneId=Number(StaticDataJson.getData("my_main_scene").data))),this.m_mainSceneId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isMissionScene",{get:function(){return SceneManager.instance.p_sceneType==SceneTypeEnum.MISSION?!0:!1},enumerable:!0,configurable:!0}),e.prototype.collectAllThings=function(){var t=SceneItemModule.instance.itemDict,e=[];for(var i in t){var s=t[i],n=s.dropData;n.owner_player_id==PlayerManager.instance.playerId&&e.push(s.dropData.id)}e&&e.length>0&&SceneManager.instance.s_scene_player_collect_tos(e)},e.prototype.showHidePlayerEffect=function(){for(var t in SceneItemModule.instance.playerDict){var e=SceneItemModule.instance.playerDict[t];e instanceof AvatarOtherPlayer&&e.showHideEffect()}},e.prototype.showHideOtherPlayer=function(){for(var t in SceneItemModule.instance.playerDict){var e=SceneItemModule.instance.playerDict[t];e instanceof AvatarOtherPlayer&&e.showHideAvatar()}},e.prototype.isGotoScene=function(t,e){void 0===e&&(e=!1);var i="",s=SceneJson.getData(t);if(s){var n=BagManager.instance.gold;if(s.mana_attack_list[0]==ItemEnum.RMB&&(n=BagManager.instance.rmb),n>=s.mana_enter_list[0]){if(0==s.mana_enter_list[1])return"";if(n<=s.mana_enter_list[1])return"";i=s.mana_attack_list[0]==ItemEnum.RMB?LanguageJson.getHtmlText("l_scene_select_tips_5",[s.mana_enter_list[0]]):LanguageJson.getHtmlText("l_scene_select_tips_3",[s.mana_enter_list[0]+"~"+s.mana_enter_list[1]])}else i=s.mana_attack_list[0]==ItemEnum.RMB?LanguageJson.getHtmlText("l_scene_select_tips_5",[s.mana_enter_list[0]]):LanguageJson.getHtmlText("l_scene_select_tips_2",[s.mana_enter_list[0]])}return e&&""!=i&&FloatTipModule.instance.popTip(i),i},e.prototype.getRecommendScene=function(t){void 0===t&&(t=!1);for(var e=SceneJson.getDataList(),i=e[0],s=0;s<e.length;s++)if(""==this.isGotoScene(e[s].id,t)){i=e[s];break}return i},Object.defineProperty(e.prototype,"isBossEventShow",{get:function(){return null==this.p_bossInfo?!1:(1==this.p_bossInfo.state||2==this.p_bossInfo.state)&&MissionJson.getData(this.p_bossInfo.mission_type,this.p_bossInfo.mission_id)?!0:!1},enumerable:!0,configurable:!0}),e.prototype.cleanEventData=function(){this.p_bossInfo=null},Object.defineProperty(e.prototype,"isSceneWorld",{get:function(){return!this.isMainScene&&SceneManager.instance.p_sceneType==SceneTypeEnum.WORLD_SCENE&&SceneManager.instance.p_sceneJson.drop_look_list&&SceneManager.instance.p_sceneJson.drop_look_list.length>0?!0:!1},enumerable:!0,configurable:!0}),e}(egret.HashObject);__reflect(SceneModule.prototype,"SceneModule");var EffectModule=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.showBlackSceneEffect=function(t){void 0===t&&(t=1),null==this.m_maskImg&&(this.m_maskImg=new eui.Image("commonUI_box"),this.m_maskImg.scale9Grid=UIModule.instance.getRectangle(),this.m_maskImg.x=0,this.m_maskImg.y=0),this.m_maskImg.width=StageManager.instance.p_stageWidth,this.m_maskImg.height=StageManager.instance.p_stageHeight,this.m_maskImg.alpha=0,TweenMax.to(this.m_maskImg,.2,{alpha:1}),TweenMax.to(this.m_maskImg,.2,{delay:t-.4+.01,alpha:0,onComplete:this.hideMask.bind(this)}),UIModule.instance.downUILayer1.addChildAt(this.m_maskImg,0)},t.prototype.hideMask=function(){this.m_maskImg&&DisplayObjectUtils.removeFormParent(this.m_maskImg)},t.prototype.bezier=function(t,e,i,s,n,o){function a(){var e=r.value;t.x=(1-e)*(1-e)*_.x+2*e*(1-e)*h.x+e*e*l.x,t.y=(1-e)*(1-e)*_.y+2*e*(1-e)*h.y+e*e*l.y}void 0===n&&(n=Linear.easeNone),void 0===o&&(o=null);var r={value:0},_={x:t.x,y:t.y},h=i,l=s;TweenLite.to(r,.001*e,{value:1,onUpdate:a.bind(this),ease:n,onComplete:o})},t.prototype.bezier2=function(t,e,i,s,n,o){function a(){var e=r.value;t.x=(1-e)*(1-e)*_.x+2*e*(1-e)*h.x+e*e*l.x,t.y=(1-e)*(1-e)*_.y+2*e*(1-e)*h.y+e*e*l.y,t.x<h.x?t.rotation=c+-45*(.45-(1-e)):t.rotation=c+45*(.45-(1-e))}void 0===n&&(n=Linear.easeNone),void 0===o&&(o=null);var r={value:0},_={x:t.x,y:t.y},h=i,l=s,c=t.rotation;TweenLite.to(r,.001*e,{value:1,onUpdate:a.bind(this),ease:n,onComplete:o})},t.prototype.light=function(t,e,i){function s(){if(t)if(t.filters)o[4]=r.light,o[9]=r.light,o[14]=r.light,t.filters[0].matrix=o;else{var e=new egret.ColorMatrixFilter(o);t.filters=[e]}}function n(){t&&(t.filters&&(t.filters.length=0),t.filters=null)}if(void 0===e&&(e=400),void 0===i&&(i=null),null!=t){null!=i&&TweenLite.delayedCall(.001*e,i);var o=[1,0,0,0,100,0,1,0,0,100,0,0,1,0,100,0,0,0,1,0],a=new egret.ColorMatrixFilter;a.matrix=o,t.filters=[a];var r={light:200};o[4]=r.light,o[9]=r.light,o[14]=r.light,TweenLite.to(r,.001*e,{light:0,onUpdate:s.bind(this),onComplete:n.bind(this),ease:Quad.easeIn})}},t.prototype.doLightning3D=function(t,e){void 0===e&&(e=302),this._lightningList||(this._lightningList=[]);var i=new LightningEffect(1,t,this.onCloseLightning.bind(this),null,e);this._lightningList.push(i)},t.prototype.onCloseLightning=function(t){this._lightningList.splice(this._lightningList.indexOf(t),1),t=null},t.prototype.shaderTest=function(t){var e="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec2 aColor;\nuniform vec2 projectionVector;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nconst vec2 center = vec2(-1.0, 1.0);\nvoid main(void) {\n   gl_Position = vec4( (aVertexPosition / projectionVector) + center , 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n   vColor = vec4(aColor.x, aColor.x, aColor.x, aColor.x);\n}",i="precision lowp float;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nuniform sampler2D uSampler;\nuniform float customUniform;\nvoid main(void) {\nvec2 uvs = vTextureCoord.xy;\nvec4 fg = texture2D(uSampler, vTextureCoord);\nfg.rgb += sin(customUniform + uvs.x * 2. + uvs.y * 2.) * 0.2;\ngl_FragColor = fg * vColor;\n}",s=new egret.CustomFilter(e,i,{customUniform:0});t.filters=[s]},t.prototype.dodgeEffect=function(t){function e(){DisplayObjectUtils.removeFormParent(s),s.texture=null,s=null}if(t){var i=t.mc;if(i){var s=new egret.Bitmap;s.texture=i.texture,s.blendMode="add",s.alpha=.7,SceneLayerModule.instance.upEffectLayer.addChild(s),s.anchorOffsetX=t.mc.anchorOffsetX+t.anchorOffsetX,s.anchorOffsetY=t.mc.anchorOffsetY+t.anchorOffsetY,s.scaleX=t.mc.scaleX,s.x=t.x,s.y=t.y,TweenLite.to(s,.35,{delay:.12,alpha:.6,x:s.x-100*t.mc.scaleX,ease:Back.easeIn,onComplete:e.bind(this)}),i=null}}},t}();__reflect(EffectModule.prototype,"EffectModule");var HitEffect=function(){function t(){this.m_hitEffectId=-1,this.m_isRotation=!0,this.m_loopNum=-1}return t.play=function(e,i){if(!i||PlayerManager.instance.p_playerIsShow&&PlayerManager.instance.p_playerEffectIsShow){var s=t.getHitEffect(e);null!=s&&s.setHitEffect(e,i)}},t.getHitEffect=function(e){t.hitEffectDict||(t.hitEffectDict={});var i=t.hitEffectDict[e];return i||(i=[],t.hitEffectDict[e]=i),i.length>=1?i.shift():new t},t.recoverHitEffect=function(e,i){var s=t.hitEffectDict[e];s||(s=[],t.hitEffectDict[e]=s),s.push(i)},t.clearHitEffect=function(){for(var e in t.hitEffectDict)for(var i=t.hitEffectDict[e];i.length;)i.shift().destory()},t.prototype.setHitEffect=function(t,e){this.m_hitEffectId!=t&&(this.m_hitEffectId=t,this.m_hitEffectData=HitEffectJson.getData(this.m_hitEffectId),this.m_skillResourceData=SkillResourceJson.getData(this.m_hitEffectData.skill_resource_id),this.m_isRotation=Boolean(this.m_hitEffectData.is_rotation),this.m_url=TextureFrom.SKILL+this.m_skillResourceData.Address,this.m_loopNum=1,this.m_fps=this.m_skillResourceData.Frames,TextureLoadManager.instance.requestLoadTextureAtlas(this.m_url,this,LoaderPriority.EFFECT,!1)),this.m_target=e,this.playEffect()},t.prototype.playEffect=function(){this.m_showMC&&(this.m_showMC.currentFrame=0,this.m_showMC.play(),this.setPosition(),this.m_target.addChild(this.m_showMC))},t.prototype.onloadComplete=function(t){this.m_showMC?this.m_showMC.resetTextures(TexturePool.instance.getTextureAtlas(this.m_url),this.m_fps,this.m_loopNum):(this.m_showMC=new MovieClip(TexturePool.instance.getTextureAtlas(this.m_url),this.m_fps,this.m_loopNum),this.m_showMC.addEventListener(egret.Event.COMPLETE,this.onPlayComplete,this))
},t.prototype.setPosition=function(){this.m_showMC.blendMode=this.m_skillResourceData.BlendMode,this.m_showMC.alpha=this.m_skillResourceData.Alpha,this.m_showMC.scaleX=this.m_skillResourceData.ScaleX,this.m_showMC.scaleY=this.m_skillResourceData.ScaleY,this.m_showMC.rotation=this.m_skillResourceData.Rotation,this.m_showMC.anchorOffsetX=.5*this.m_showMC.texture.textureWidth+this.m_skillResourceData.OffsetX,this.m_showMC.anchorOffsetY=.5*this.m_showMC.texture.textureHeight+this.m_skillResourceData.OffsetY;var t=this.m_target;null!=t.mc&&(this.m_showMC.x=-t.jsonAvatar.offset_list[0]+40*Math.random()-40,this.m_showMC.y=-t.jsonAvatar.offset_list[1]+40*Math.random()-40)},t.prototype.onPlayComplete=function(e){this.m_showMC.stop(),this.m_showMC.removeFromParent(),this.m_target=null,t.recoverHitEffect(this.m_hitEffectId,this)},t.prototype.destory=function(){this.m_skillResourceData=null,this.m_hitEffectData=null,this.m_target=null,TextureLoadManager.instance.closeLoad(this.m_url,this),this.m_showMC.dispose(),this.m_showMC=null},t}();__reflect(HitEffect.prototype,"HitEffect",["ITextureLoadEvent"]);var ImageShadowEffect=function(t){function e(){var e=t.call(this)||this;return e.m_lastTime=0,e}return __extends(e,t),e.prototype.play=function(t,e,i,s,n,o){void 0===n&&(n=!1),void 0===o&&(o=!1),this.m_nowImageVec=[],this.m_target=t,this.m_fps=e,this.m_alpha=i,this.m_alphaTime=s,this.m_hasZoom=n,this.m_isAdd=o,this.m_gap=1e3/e,this.start()},e.prototype.start=function(){EnterFrameManager.instance.addEnterFrame(this.advanceTime,this),this.advanceTime(0)},e.prototype.advanceTime=function(t){t=egret.getTimer(),0==this.m_lastTime&&(this.m_lastTime=t,this.draw()),this.m_nowTime=t;var e=Math.floor((this.m_nowTime-this.m_lastTime)/this.m_gap);this.m_lastTime=this.m_lastTime+e*this.m_gap;for(var i=0;e>i;i++)this.draw()},e.prototype.draw=function(){function t(t){if(this.m_nowImageVec){var e=this.m_nowImageVec.indexOf(t);-1!=e&&this.m_nowImageVec.splice(e,1)}t.parent&&t.parent.removeChild(t),t.texture=null,t=null}if(!this.m_target||!this.m_target.parent)return void this.stop();var e=null;if(this.m_target instanceof AvatarBase){if(!this.m_target.mc)return;e=new egret.Bitmap,e.texture=this.m_target.mc.texture,SceneLayerModule.instance.liveThingsLayer.addChild(e)}else e=new egret.Bitmap,e.texture=this.m_target.texture,this.m_target.parent.addChildAt(e,this.m_target.parent.getChildIndex(this.m_target));null!=e&&(this.m_nowImageVec.push(e),e.alpha=this.m_alpha,e.anchorOffsetX=this.m_target.anchorOffsetX,e.anchorOffsetY=this.m_target.anchorOffsetY,e.x=this.m_target.x,e.y=this.m_target.y-1,this.m_target instanceof AvatarBase?(e.anchorOffsetX=this.m_target.mc.anchorOffsetX+this.m_target.anchorOffsetX,e.anchorOffsetY=this.m_target.mc.anchorOffsetY+this.m_target.anchorOffsetY,e.scaleX=this.m_target.mc.scaleX*this.m_target.scaleX,e.scaleY=this.m_target.mc.scaleY*this.m_target.scaleY):(e.scaleX=this.m_target.scaleX,e.scaleY=this.m_target.scaleY),e.rotation=this.m_target.rotation,e.blendMode=this.m_target.blendMode,this.m_isAdd&&(e.blendMode=egret.BlendMode.ADD),TweenLite.to(e,this.m_alphaTime,{alpha:0,scaleX:this.m_hasZoom?.5*e.scaleX:1*e.scaleX,scaleY:this.m_hasZoom?.5*e.scaleY:1*e.scaleY,rotation:this.m_hasZoom?e.rotation+3:e.rotation,ease:this.m_hasZoom?Cubic.easeIn:Linear.easeNone,onComplete:t,onCompleteParams:[e]}))},e.prototype.stop=function(){EnterFrameManager.instance.removeEnterFrame(this.advanceTime,this),this.destory()},e.prototype.destory=function(){this.m_target=null,this.m_nowImageVec&&(this.m_nowImageVec.length=0,this.m_nowImageVec=null)},e}(egret.HashObject);__reflect(ImageShadowEffect.prototype,"ImageShadowEffect");var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,i){function s(s){e.call(i,s,t)}if(RES.hasRes(t)){var n=RES.getRes(t);n?s(n):RES.getResAsync(t,s,this)}else RES.getResByUrl(t,s,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,i,s){function n(t){e.call(s,t)}function o(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),i.call(s))}var a=this;"undefined"!=typeof generateEUI?egret.callLater(function(){e.call(s,generateEUI)},this):"undefined"!=typeof generateEUI2?RES.getResByUrl("resource/gameEui.bin",function(t,i){var n=new JSZip(t),o=n.file("gameEui.json");window.JSONParseClass.setData(JSON.parse(o.asText())),egret.callLater(function(){e.call(s,generateEUI2)},a)},this,RES.ResourceItem.TYPE_BIN):(RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_TEXT))},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var AchievementJson=function(){function t(){}return t.getData=function(t,e){var i=String(t+"_"+e),s=this.jsonData[i];return s||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),s},t.getDataByClientsType=function(t){if(!this.m_idListByType[t]){this.m_idListByType[t]=[];for(var e in this.jsonData){var i=this.jsonData[e];i&&i.clients_type==t&&this.m_idListByType[t].indexOf(i.type)<=-1&&this.m_idListByType[t].push(i.type)}ArrayUtils.setSortNum(this.m_idListByType[t])}return this.m_idListByType[t]},t.getListByType=function(t){if(!this.m_typeIdList[t]){this.m_typeIdList[t]=[];for(var e in this.jsonData){var i=this.jsonData[e];i&&i.type==t&&this.m_typeIdList[t].push(i.id)}ArrayUtils.setSortNum(this.m_typeIdList[t])}return this.m_typeIdList[t]},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="achievement",t.m_idListByType={},t.m_typeIdList={},t}();__reflect(AchievementJson.prototype,"AchievementJson"),window.AchievementJson=AchievementJson;var AvatarMainPlayer=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e.touchChildren=!1,e}return __extends(e,t),e.prototype.setPos=function(e,i){if(t.prototype.setPos.call(this,e,i),this.m_pos&&this.jumpHeight<=0,null!=this.m_playerData){var s=this.getCurPosMapData();s==MyMapData.DATA_BLOCK}},e.prototype.refreshPlayer=function(){this.m_mc&&this.m_mc.play(),this.m_weapon&&this.m_weapon.mc&&this.m_weapon.mc.play()},e.prototype.shiftToAction=function(e,i){void 0===i&&(i=-1),GameManager.performanceRate==PerformanceRateEnum.LOW&&(i=AvatarOtherPlayer.direction2Arr[i]),t.prototype.shiftToAction.call(this,e,i)},e.prototype.setSkillHide=function(){this.m_skillData={}},e.prototype.setChuangSong=function(t){if(void 0===t&&(t=!1),MoveManager.instance.stopMove(this),this.curPreferentialState=StateType.CHUANSONG,DelayCallUtils.delayedCall(.6,this.chuanshongEnd.bind(this),this),t){var e=this.pointFoot;FightUIModule.instance.showEffect(PublicCon.PATH_EFFECT_CHUANSONG+"chuanSong",[e[0],e[1]-210],this)}else{var i=this.pointFoot;FightUIModule.instance.showEffect(PublicCon.PATH_EFFECT_CHUANSONG+"chuanjinUp",[i[0],i[1]-240],this),FightUIModule.instance.showEffect(PublicCon.PATH_EFFECT_CHUANSONG+"chuanjinDown",[i[0],i[1]-240],this.p_downLayer)}SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_1011)},e.prototype.chuanshongEnd=function(){this.curPreferentialState=StateType.CHUANSONG_END},e.prototype.upgradeLevel=function(){FightUIModule.instance.showEffect(PublicCon.PATH_EFFECT_PLAYER+"levelupEffectUp",this.pointCentered,this);var t=this.pointFoot;FightUIModule.instance.showEffect(PublicCon.PATH_EFFECT_PLAYER+"levelupEffectDown",[t[0],t[1]-50],this.p_downLayer)},e.prototype.setAutoFight=function(t){t?(this.m_autoEffect||(this.m_autoEffect=new EffectMovieClip,this.m_autoEffect.setMC(PublicCon.PATH_EFFECT_PLAYER+"autoFight")),null==this.m_autoEffect.parent&&(this.addChildAt(this.m_autoEffect,0),this.m_autoEffect.play())):this.m_autoEffect&&(this.m_autoEffect.stop(),DisplayObjectUtils.removeFormParent(this.m_autoEffect))},e}(AvatarPlayer);__reflect(AvatarMainPlayer.prototype,"AvatarMainPlayer");var AvatarMonster=function(t){function e(){var e=t.call(this)||this;return e.m_goldType=1,e.m_gStr="",e.p_manaMax=0,e.m_setBeatTime=0,e.m_mcPlay=!0,e.m_dieTime=0,e.m_tpoint=new egret.Point,e.m_liveHeadType=LiveHeadType.MONSTER,e.m_lift=e,e}return __extends(e,t),Object.defineProperty(e.prototype,"isShow",{set:function(t){this.mc&&(this.mc.visible=t,this.mc.visible?this.mc.play():this.mc.stop())},enumerable:!0,configurable:!0}),e.prototype.onSetAuto=function(t){t.stopImmediatePropagation(),t.stopPropagation(),DelayCallUtils.delayedCall(.3,this.autoAttackMonster,this)},e.prototype.onSetAutoEnd=function(t){t.stopImmediatePropagation(),t.stopPropagation(),DelayCallUtils.killDelayedCallsTo(this.autoAttackMonster,this)},e.prototype.autoAttackMonster=function(){this.dataMonster&&this.attackMonster(this.dataMonster.scene_monster_id),DelayCallUtils.killDelayedCallsTo(this.autoAttackMonster,this),DelayCallUtils.delayedCall(.001*FightSkillManager.instance.p_attackSpeed,this.autoAttackMonster,this)},Object.defineProperty(e.prototype,"isBoss",{get:function(){return this.m_jsonMonster&&this.m_jsonMonster.is_boss>0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"montserType",{get:function(){return this.m_jsonMonster?this.m_jsonMonster.kind:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataMonster",{get:function(){return this.m_dataMonster},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"jsonMonster",{get:function(){return this.m_jsonMonster},enumerable:!0,configurable:!0}),e.prototype.setData=function(t){if(this.p_manaMax=0,this.m_dataMonster=t,this.m_jsonMonster=MonsterJson.getData(this.m_dataMonster.monster_id),this.p_isDie=!1,this.setAvatarId(this.m_jsonMonster.avatar_id),this.hotTouchable=!0,this.m_gStr="",URIManager.isdebug&&this.m_jsonMonster.effect_list[0])switch(this.m_jsonMonster.effect_list[0]){case 5:this.m_gStr="闪电链_";break;case 9:this.m_gStr="翻牌_";break;case 10:this.m_gStr="拉霸_";break;case 11:this.m_gStr="转盘_";break;case 12:this.m_gStr="炸弹怪_";break;case 13:this.m_gStr="火球怪_";break;case 14:this.m_gStr="地震怪_";break;case 15:this.m_gStr="金币小妖_";break;case 16:this.m_gStr="神龙_"}this.liveName=""+(URIManager.isdebug?this.m_gStr+"id:"+this.dataMonster.scene_monster_id+" mid:"+this.dataMonster.monster_id+" mana:"+this.p_manaMax:""),this.m_liveHead.setLevelTime(t.destroy_time),this.m_hotImage&&(this.m_hotImage.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onSetAuto,this),this.m_hotImage.addEventListener(egret.TouchEvent.TOUCH_END,this.onSetAutoEnd,this),this.m_hotImage.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onSetAutoEnd,this)),this.jsonMonster.effect_list&&15==this.jsonMonster.effect_list[0]&&DelayCallUtils.delayedCall(.5+1*Math.random(),this.setGoldMonster,this),this.isBoss&&Dispatch.dispatch(e.EVENT_MONSTER_BOSS_COME_ON,this),Dispatch.register(GuideConfig.guide_scene_monster,this.onGuideClick,this),MissionManager.instance.missionType==MissionTypeEnum.GUESS_BOSS&&SceneModule.instance.isMissionScene&&this.showMonsterHP()},e.prototype.removeHotImg=function(){this.m_hotImage&&(this.m_hotImage.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onSetAuto,this),this.m_hotImage.removeEventListener(egret.TouchEvent.TOUCH_END,this.onSetAutoEnd,this),this.m_hotImage.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onSetAutoEnd,this)),t.prototype.removeHotImg.call(this)},e.prototype.setGoldMonster=function(){1==this.m_goldType?this.m_goldType=2:this.m_goldType=1;var t=PublicCon.PATH_EFFECT_MONSTER+"goldMonster/goldMonster"+this.m_goldType;FightUIModule.instance.showEffect(t,this.xyCentered,SceneLayerModule.instance.upEffectLayer);var e=.5+2*Math.random();DelayCallUtils.delayedCall(e,this.setGoldMonster,this)},e.prototype.testCC=function(t){this.m_liveHead.setTest(t)},e.prototype.testHot=function(t){if(this.m_hotImage){var e=t[0]?t[0]:0,i=t[1]?t[1]:0;this.m_hotImage.x=.5*-this.jsonAvatar.hot_list[2]+this.jsonAvatar.hot_list[0]+e,this.m_hotImage.y=-this.jsonAvatar.hot_list[3]+this.jsonAvatar.hot_list[1]+i}},e.prototype.setAvatarId=function(t){this.m_jsonAvatar&&this.m_jsonAvatar.id==t||(this.resetAvatar(),this.m_jsonAvatar=AvatarJson.getData(t),this.m_actionTextureDict=[],this.pathTransform="",this.setActionUrlDict(),this.m_isInit?this.shiftToAction(AvatarConfig.ACTION_stand,4):this.shiftToAction(this.m_curAction),this.m_isInit=!1)},e.prototype.showMonsterHP=function(){if(this.m_bossHP&&0==this.dataMonster.hp)return void this.m_bossHP.hide();this.m_bossHP||(this.m_bossHP=new LuckMonsterHp),this.addChild(this.m_bossHP);var t=this.jsonAvatar.name_off_list[0],e=this.jsonAvatar.name_off_list[1];this.m_bossHP.anchorOffsetX=Math.floor(-t+this.m_bossHP.width/2),this.m_bossHP.anchorOffsetY=Math.floor(-e+this.m_bossHP.height+30),this.m_bossHP.show(this.dataMonster)},e.prototype.refreshHP=function(e){t.prototype.refreshHP.call(this,e),this.resetHpShow(e)},e.prototype.resetHpShow=function(t){this.m_bossHP&&this.m_bossHP.refreshHP(t,this.dataMonster.max_hp)},e.prototype.guideAttack=function(t){},e.prototype.setArgeShowJi=function(t,e){this.m_setBeatTime=t,DelayCallUtils.killDelayedCallsTo(this.setArgeShowJi,this),this.m_setBeatTime<=0||(this.shiftToAction(AvatarConfig.ACTION_injure,AvatarConfig.getDirection(e.x-this.x,e.y-this.y)),FightUIModule.instance.showShouJi(this,e),this.m_setBeatTime-=1,this.m_setBeatTime>0&&DelayCallUtils.delayedCall(.3,this.setArgeShowJi,this,[this.m_setBeatTime,e]))},e.prototype.setMovieMc=function(){null!=this.m_mc&&(this.m_mcPlay?this.m_mc.play():this.m_mc.stop())},e.prototype.addBingDong=function(t){void 0===t&&(t=-1),t>0&&(this.m_dataMonster.destroy_time=t);var e=this.pointCentered;this.m_bDImage&&TweenLite.killTweensOf(this.m_bDImage),this.m_liveHead&&this.m_liveHead instanceof HeadMonster&&this.m_liveHead.resetTime(t),this.setMovieMc(),this.m_mcPlay=!1,this.m_bDImage||(this.m_bDImage=new eui.Image,this.m_bDImage.touchEnabled=!1,this.m_bDImage.anchorOffsetX=256,this.m_bDImage.anchorOffsetY=256,this.m_bDImage.source=PublicCon.PATH_BINGDONG_SKILL+"bingfeng_00000.png"),this.m_bDImage.x=e[0],this.m_bDImage.y=e[1],this.m_bDImage.scaleX=1,this.m_bDImage.scaleY=1,this.addChild(this.m_bDImage)},e.prototype.removeBingDong=function(){this.m_mcPlay=!0,this.m_bDImage&&TweenLite.to(this.m_bDImage,.2,{alpha:0,onComplete:this.removeBdImage.bind(this)}),this.m_liveHead&&this.m_liveHead instanceof HeadMonster&&this.m_liveHead.huifuTime(),this.setMovieMc()},e.prototype.removeBdImage=function(){DisplayObjectUtils.removeFormParent(this.m_bDImage),this.m_bDImage=null},e.prototype.setLockMonster=function(t,e){if(void 0===e&&(e=!1),t&&this.m_jsonMonster){this.m_lockMc||(this.m_lockMc=new DragonMovieClip);var i=this.pointFoot;if(this.m_lockMc.x=i[0],this.m_lockMc.y=i[1],this.m_lockMc.scaleX=1,this.m_lockMc.scaleY=1,this.jsonAvatar.lock_off_list&&this.jsonAvatar.lock_off_list[0]&&(this.m_lockMc.x+=this.jsonAvatar.lock_off_list[0]),this.jsonAvatar.lock_off_list&&this.jsonAvatar.lock_off_list[1]&&(this.m_lockMc.y+=this.jsonAvatar.lock_off_list[1]),this.jsonAvatar.lock_off_list&&this.jsonAvatar.lock_off_list[2]&&(this.m_lockMc.scaleX=this.jsonAvatar.lock_off_list[2],this.m_lockMc.scaleY=this.jsonAvatar.lock_off_list[2]),null==this.m_lockMc.parent&&(this.p_downLayer.addChild(this.m_lockMc),this.m_lockMc.setMC("resource/assets/dragon/monster_locking","monster_locking"),this.m_lockMc.play()),FightAutoAI.instance.p_isAutoFight||e){this.m_lockToMc||(this.m_lockToMc=new EffectMovieClip,this.m_lockToMc.setMC(PublicCon.PATH_EFFECT_MONSTER+"lockTo"));var s=this.pointCentered;this.m_lockToMc.x=s[0],this.m_lockToMc.y=s[1],this.m_lockToMc.scaleX=1,this.m_lockToMc.scaleY=1,this.jsonAvatar.lock_to_off_list&&this.jsonAvatar.lock_to_off_list[0]&&(this.m_lockToMc.x+=this.jsonAvatar.lock_to_off_list[0]),this.jsonAvatar.lock_to_off_list&&this.jsonAvatar.lock_to_off_list[1]&&(this.m_lockToMc.y+=this.jsonAvatar.lock_to_off_list[1]),this.jsonAvatar.lock_to_off_list&&this.jsonAvatar.lock_to_off_list[2]&&(this.m_lockToMc.scaleX=this.jsonAvatar.lock_to_off_list[2],this.m_lockToMc.scaleY=this.jsonAvatar.lock_to_off_list[2]),null==this.m_lockToMc.parent&&(this.addChild(this.m_lockToMc),this.m_lockToMc.play())}}else this.m_lockMc&&this.m_lockMc.parent&&(this.m_lockMc.stop(),DisplayObjectUtils.removeFormParent(this.m_lockMc)),this.m_lockToMc&&this.m_lockToMc.parent&&(this.m_lockToMc.stop(),DisplayObjectUtils.removeFormParent(this.m_lockToMc))},e.prototype.setManaNax=function(t){URIManager.isdebug&&(this.p_manaMax=t,this.liveName=URIManager.isdebug?this.m_gStr+"id:"+this.dataMonster.scene_monster_id+" mid:"+this.dataMonster.monster_id+" mana:"+this.p_manaMax:"")},e.prototype.setActionUrlDict=function(){this.m_actionUrlDict=AvatarJson.getActionUrlDict(this.m_jsonAvatar.id,TextureFrom.MONSTER)},e.prototype.onTouch=function(t){this.attackMonster(this.dataMonster.scene_monster_id),t.stopImmediatePropagation(),t.stopPropagation()},e.prototype.attackMonster=function(t){return SceneItemModule.instance.getMonster(t)?void(this.isDestory||this.p_isDie||FightAutoAI.instance.attack(t)):void this.destory()},e.prototype.onGuideClick=function(t){},e.prototype.die=function(){DelayCallUtils.killDelayedCallsTo(this.autoAttackMonster,this),DelayCallUtils.killDelayedCallsTo(this.setGoldMonster,this),Dispatch.dispatch(e.EVENT_MONSTER_DIE+this.m_dataMonster.scene_monster_id),Dispatch.dispatch(e.EVENT_MONSTER_DIE,this.m_dataMonster.scene_monster_id),0==this.m_dieTime&&(this.onDieTuDestory(),this.p_attackAvatar&&this.p_attackAvatar instanceof AvatarMainPlayer&&this.jsonMonster.death_sound>0&&SoundMoude.instance.playSoundEffect(this.jsonMonster.death_sound)),t.prototype.die.call(this)},e.prototype.timeGoto=function(){return this.m_dieTime<0?void this.timeOverDie():void(this.m_dieTime-=1)},e.prototype.onDieTuDestory=function(){if(this.m_dieTime=2,TimeManager.instance.doLoop(this.timeGoto,this),TweenLite.killTweensOf(this),this.p_attackAvatar)switch(this.m_tpoint?(this.m_tpoint.x=this.x-this.p_attackAvatar.x,this.m_tpoint.y=this.y-this.p_attackAvatar.y):this.m_tpoint=new egret.Point(this.x-this.p_attackAvatar.x,this.y-this.p_attackAvatar.y),this.jsonAvatar.die_type){case 1:var t=.85;this.m_tpoint.normalize(400),TweenMax.to(this,.25*t,{jumpHeight:JumpConfig.JUMPHEIGHT*(t>1?1:t)*.4,ease:Sine.easeOut}),TweenMax.to(this,.3*t,{delay:.25*t,ease:Sine.easeIn,jumpHeight:0}),TweenMax.to(this,t,{x:this.m_tpoint.x+this.x,y:this.m_tpoint.y+this.y}),TweenMax.to(this,.5,{delay:t,alpha:0,onComplete:this.timeOverDie.bind(this)});break;case 2:this.dieBaozha();break;default:this.dieMove()}else this.dieMove()},e.prototype.dieMove=function(){var t=.45;this.m_tpoint.normalize(150),TweenMax.to(this,t,{x:this.m_tpoint.x+this.x,y:this.m_tpoint.y+this.y}),TweenMax.to(this,.5,{delay:t,alpha:0,onComplete:this.timeOverDie.bind(this)})},e.prototype.dieBaozha=function(){var t=PublicCon.PATH_EFFECT_MONSTER+"showAndLeave/dieLeave";FightUIModule.instance.showEffect(t,this.xyCentered,SceneLayerModule.instance.upEffectLayer),TweenMax.to(this,.5,{delay:.5,alpha:0,onComplete:this.timeOverDie.bind(this)})},e.prototype.timeOverDie=function(){this.dataMonster&&SceneItemModule.instance.deleteMonster(this.dataMonster.scene_monster_id),this.destory()},e.prototype.destory=function(){t.prototype.destory.call(this),DelayCallUtils.killDelayedCallsTo(this.setGoldMonster,this),TimeManager.instance.clearTimer(this.timeGoto,this),this.m_dieTime=0,this.disposeEffect(),this.m_lift=null,this.m_tpoint=null,DisplayObjectUtils.removeFormParent(this)},e.prototype.disposeEffect=function(){this.m_jsonMonster=null,this.m_lockMc&&(this.m_lockMc.destory(),this.m_lockMc=null),this.m_lockToMc&&(this.m_lockToMc.destory(),this.m_lockToMc=null),this.m_bossHP&&(this.m_bossHP.hide(),this.m_bossHP=null),this.m_showEffect&&(this.m_showEffect.destory(),DisplayObjectUtils.removeFormParent(this.m_showEffect),this.m_showEffect=null),DelayCallUtils.killDelayedCallsTo(this.autoAttackMonster,this),Dispatch.remove(GuideConfig.guide_scene_monster,this.onGuideClick,this)},Object.defineProperty(e.prototype,"curState",{get:function(){return this.m_curPreferentialState==StateType.CHUANSONG||this.m_curPreferentialState==StateType.XUAN_YUN||this.m_curPreferentialState==StateType.DEAD||this.m_curPreferentialState==StateType.ATTACK?this.m_curPreferentialState:this.m_curState},set:function(t){this.m_curState=t,this.m_liveHandleProxy.liveStateChange()},enumerable:!0,configurable:!0}),e.prototype.setShowEffect=function(t){if(void 0===t&&(t=!1),this.alpha=0,SceneModule.instance.p_ycContinueTime>0||t){this.m_showEffect||(this.m_showEffect=new EffectMovieClip,this.m_showEffect.setMC(PublicCon.PATH_EFFECT_MONSTER+"showAndLeave/showYuchao"),this.m_showEffect.onCompleteFunc=this.compPlayFunc.bind(this),this.m_showEffect.regiestFrameFunc(4,this.stareShowYU.bind(this),!1));var e=this.pointFoot;this.m_showEffect.x=this.x+e[0],this.m_showEffect.y=this.y+e[1]-110,this.m_showEffect.scaleX=2,this.m_showEffect.scaleY=2,this.jsonAvatar.yuchao_off_list&&this.jsonAvatar.yuchao_off_list[0]&&(this.m_showEffect.x+=this.jsonAvatar.yuchao_off_list[0]),this.jsonAvatar.yuchao_off_list&&this.jsonAvatar.yuchao_off_list[1]&&(this.m_showEffect.y+=this.jsonAvatar.yuchao_off_list[1]),this.jsonAvatar.yuchao_off_list&&this.jsonAvatar.yuchao_off_list[2]&&(this.m_showEffect.scaleX=this.jsonAvatar.yuchao_off_list[2],this.m_showEffect.scaleY=this.jsonAvatar.yuchao_off_list[2]),this.m_showEffect.play(),SceneLayerModule.instance.upEffectLayer.addChild(this.m_showEffect),ServerTimeManager.instance.timer>SceneModule.instance.p_yucaoCome&&(SceneModule.instance.p_yucaoCome=ServerTimeManager.instance.timer+.2,SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_3500))}else{var i=this.xyCentered;FightUIModule.instance.showEffect(PublicCon.PATH_EFFECT_MONSTER+"showAndLeave/show_up",[i[0],i[1]+50],SceneLayerModule.instance.upEffectLayer),FightUIModule.instance.showEffect(PublicCon.PATH_EFFECT_MONSTER+"showAndLeave/show_down",this.xyFoot,SceneLayerModule.instance.downEffectLayer),TweenLite.to(this,.5,{alpha:1})}},e.prototype.stareShowYU=function(){TweenLite.to(this,.2,{alpha:1})},e.prototype.compPlayFunc=function(){this.m_showEffect&&(this.m_showEffect.destory(),DisplayObjectUtils.removeFormParent(this.m_showEffect),this.m_showEffect=null)},e.prototype.shiftDirectionHandle=function(){0==this.m_jsonAvatar.mirror&&-1!=[5,6,7].indexOf(this.m_curDirection)?this.m_mc.scaleX=1:t.prototype.shiftDirectionHandle.call(this)},e.MONSTER_TYPE_NPC=4,e.EVENT_MONSTER_DIE="EVENT_MONSTER_DIE",e.EVENT_MONSTER_BOSS_COME_ON="EVENT_MONSTER_BOSS_COME_ON",e}(AvatarFighter);__reflect(AvatarMonster.prototype,"AvatarMonster");var AvatarNpc=function(t){function e(){var e=t.call(this)||this;return e.m_isCreateView=!1,e.m_isShow=!1,e.m_liveHeadType=LiveHeadType.NPC,e}return __extends(e,t),Object.defineProperty(e.prototype,"isShow",{get:function(){return this.m_isShow},set:function(t){this.m_isShow=t,this.createView(),this.shiftToAction(AvatarConfig.ACTION_stand,this.m_jsonNpc.direction)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"only_id",{get:function(){return this.m_only_id},set:function(t){this.m_only_id=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"jsonNpc",{get:function(){return this.m_jsonNpc},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"npcId",{get:function(){return this.m_jsonNpc.id},set:function(t){this.m_jsonNpc=NpcJson.getData(t)},enumerable:!0,configurable:!0}),e.prototype.createView=function(){this.m_isCreateView||(this.setAvatarId(this.m_jsonNpc.avatar_id),this.liveName=this.m_jsonNpc.name+(URIManager.isdebug?" npcid:"+this.m_jsonNpc.id:""),this.hotTouchable=!0,this.m_isCreateView=!0,Dispatch.register(GuideConfig.guide_scene_npc_city,this.onGuideGo,this))},e.prototype.setActionUrlDict=function(){this.m_actionUrlDict=AvatarJson.getActionUrlDict(this.m_jsonAvatar.id,TextureFrom.NPC)},e.prototype.destory=function(){1!=this.isDestory&&(this.m_jsonNpc=null,t.prototype.destory.call(this),Dispatch.remove(GuideConfig.guide_scene_npc_city,this.onGuideGo,this))},e.prototype.onGuideGo=function(t){t&&t.c_npc_id==this.npcId&&this.moveEnd()},e.prototype.onTouch=function(t){t.stopImmediatePropagation(),t.stopPropagation();var e=PlayerManager.instance.p_mainPlayer.getPos(),i=300;if(egret.Point.distance(e,this.getPos())<=i)return void this.moveEnd();var s=AvatarConfig.getDireDistance(this.getPos().x,this.getPos().y,150);MoveManager.instance.movePlayer(s[0],s[1],this.moveEnd.bind(this))},e.prototype.moveEnd=function(){var t=NpcJson.getData(this.npcId);t&&0!=t.function_config_id&&FunctionManager.instance.executeFunction(t.function_config_id)},e}(AvatarLive);__reflect(AvatarNpc.prototype,"AvatarNpc");var AvatarOtherPlayer=function(t){function e(){var e=t.call(this)||this;return e.realDirection=0,e}return __extends(e,t),e.prototype.setAvatarId=function(e){t.prototype.setAvatarId.call(this,e)},e.prototype.onTouch=function(t){t.stopImmediatePropagation(),t.stopPropagation()},e.prototype.shiftToAction=function(i,s){var n=e.direction2Arr[s];t.prototype.shiftToAction.call(this,i,n),this.p_moveDriection=s},e.prototype.shiftToDirection=function(i){var s=e.direction2Arr[i];t.prototype.shiftToDirection.call(this,s),this.p_moveDriection=i},Object.defineProperty(e.prototype,"isOtherPlayer",{get:function(){return!0},enumerable:!0,configurable:!0}),e.direction2Arr=[1,1,1,3,5,5,7,7],e}(AvatarPlayer);__reflect(AvatarOtherPlayer.prototype,"AvatarOtherPlayer");var ActiveSkillJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},t.FileName="active_skill",t}();__reflect(ActiveSkillJson.prototype,"ActiveSkillJson"),window.ActiveSkillJson=ActiveSkillJson;var ObjTypeEnum=function(){function t(){}return t.NONE=0,t.PLAYER=1,t.MONSTER=2,t.PET=3,t.MAGICWEAPON=4,t.THUNDER=5,t}();__reflect(ObjTypeEnum.prototype,"ObjTypeEnum");var DiZhenEffect=function(t){function e(e){var i=t.call(this)||this;return i.m_refreshFunc=e,i}return __extends(e,t),e.prototype.show=function(t,e){if(this.m_avatarMc=t,!this.m_effect){this.m_effect=new EffectMovieClip,this.m_effect.setMC(PublicCon.PATH_EFFECT_PLAYER+"attackSkill/diZhen"),this.m_effect.onCompleteFunc=this.setNextPlay.bind(this);var i=this.m_avatarMc.pointFoot;this.m_effect.x=i[0],this.m_effect.y=i[1]-120,this.setPlayer()}DelayCallUtils.killDelayedCallsTo(this.hideShenlong,this);var s=e-ServerTimeManager.instance.timer;DelayCallUtils.delayedCall(s,this.hideShenlong,this)},e.prototype.setNextPlay=function(){this.m_effect&&(this.m_effect.stop(),DisplayObjectUtils.removeFormParent(this.m_effect)),DelayCallUtils.delayedCall(1,this.setPlayer,this)},e.prototype.setPlayer=function(){DelayCallUtils.killDelayedCallsTo(this.setPlayer,this),null!=this.m_avatarMc&&(this.m_avatarMc.p_downLayer.addChild(this.m_effect),this.m_effect.play())},e.prototype.hideShenlong=function(){null!=this.m_refreshFunc&&this.m_refreshFunc()},e.prototype.destory=function(){DelayCallUtils.killDelayedCallsTo(this.hideShenlong,this),DelayCallUtils.killDelayedCallsTo(this.setPlayer,this),this.m_refreshFunc=null,this.m_avatarMc=null,this.m_effect&&(this.m_effect.destory(),this.m_effect=null)},e}(egret.HashObject);__reflect(DiZhenEffect.prototype,"DiZhenEffect");var HuoQiuEffect=function(t){function e(e){var i=t.call(this)||this;return i.m_refreshFunc=e,i}return __extends(e,t),e.prototype.show=function(t,e){if(this.m_avatarMc=t,!this.m_effect){this.m_effect=new EffectMovieClip,this.m_effect.setMC(PublicCon.PATH_EFFECT_PLAYER+"attackSkill/huoQiu",-1,8);var i=this.m_avatarMc.pointCentered;this.m_effect.x=i[0],this.m_effect.y=i[1],this.m_avatarMc.addChild(this.m_effect),this.m_effect.play()}DelayCallUtils.killDelayedCallsTo(this.hideShenlong,this);var s=e-ServerTimeManager.instance.timer;DelayCallUtils.delayedCall(s,this.hideShenlong,this)},e.prototype.hideShenlong=function(){null!=this.m_refreshFunc&&this.m_refreshFunc()},e.prototype.destory=function(){DelayCallUtils.killDelayedCallsTo(this.hideShenlong,this),this.m_refreshFunc=null,this.m_avatarMc=null,this.m_effect&&(this.m_effect.destory(),this.m_effect=null)},e}(egret.HashObject);__reflect(HuoQiuEffect.prototype,"HuoQiuEffect");var ShanDianLianEffect=function(t){function e(e){var i=t.call(this)||this;return i.m_refreshFunc=e,i}return __extends(e,t),e.prototype.show=function(t,e){if(this.m_avatarMc=t,!this.m_effect){this.m_effect=new EffectMovieClip,this.m_effect.setMC(PublicCon.PATH_EFFECT_PLAYER+"attackSkill/shanDianLian");var i=this.m_avatarMc.pointCentered;this.m_effect.x=i[0],this.m_effect.y=i[1],this.m_avatarMc.addChild(this.m_effect),this.m_effect.play()}DelayCallUtils.killDelayedCallsTo(this.hideShenlong,this);var s=e-ServerTimeManager.instance.timer;DelayCallUtils.delayedCall(s,this.hideShenlong,this)},e.prototype.hideShenlong=function(){null!=this.m_refreshFunc&&this.m_refreshFunc()},e.prototype.destory=function(){DelayCallUtils.killDelayedCallsTo(this.hideShenlong,this),this.m_refreshFunc=null,this.m_avatarMc=null,this.m_effect&&(this.m_effect.destory(),this.m_effect=null)},e}(egret.HashObject);__reflect(ShanDianLianEffect.prototype,"ShanDianLianEffect");var ShenLongEffect=function(t){function e(e){var i=t.call(this)||this;return i.m_refreshFunc=e,i}return __extends(e,t),e.prototype.show=function(t,e){if(this.m_avatarMc=t,!this.m_effect){this.m_effect=new EffectMovieClip,this.m_effect.onCompleteFunc=this.setNextPlay.bind(this),this.m_effect.setMC(PublicCon.PATH_EFFECT_PLAYER+"attackSkill/shenLong",1,14);var i=this.m_avatarMc.pointCentered;this.m_effect.x=i[0],this.m_effect.y=i[1]+30,this.setPlayer()}DelayCallUtils.killDelayedCallsTo(this.hideShenlong,this);var s=e-ServerTimeManager.instance.timer;DelayCallUtils.delayedCall(s,this.hideShenlong,this)},e.prototype.hideShenlong=function(){null!=this.m_refreshFunc&&this.m_refreshFunc()},e.prototype.setPlayer=function(){DelayCallUtils.killDelayedCallsTo(this.setPlayer,this),null!=this.m_avatarMc&&(this.m_avatarMc.addChild(this.m_effect),this.m_effect.play())},e.prototype.setNextPlay=function(){this.m_effect&&(this.m_effect.stop(),DisplayObjectUtils.removeFormParent(this.m_effect)),DelayCallUtils.delayedCall(4,this.setPlayer,this)},e.prototype.destory=function(){DelayCallUtils.killDelayedCallsTo(this.hideShenlong,this),DelayCallUtils.killDelayedCallsTo(this.setPlayer,this),this.m_refreshFunc=null,this.m_avatarMc=null,this.m_effect&&(this.m_effect.destory(),this.m_effect=null)},e}(egret.HashObject);__reflect(ShenLongEffect.prototype,"ShenLongEffect");var BubbleLine=function(t){function e(){var e=t.call(this)||this;return e.visible=!1,e.y=-150,e}return __extends(e,t),e.prototype.showBubble=function(t){this.y=-150,this.visible=!0,null==this.m_bgImg&&(this.m_bgImg=new eui.Image,this.m_bgImg.scale9Grid=new egret.Rectangle(50,20,150,21),this.setChatBubble(),this.m_bgImg.height=57,this.m_bgImg.y=-this.m_bgImg.height+3,this.addChild(this.m_bgImg),this.m_text=new eui.Label,this.m_text.size=25,this.m_text.textColor=16567449,this.m_text.y=-40,this.addChild(this.m_text)),this.m_bgImg.visible=!0,this.m_text.visible=!0,this.m_effectSticker&&(DisplayObjectUtils.removeFormParent(this.m_effectSticker),this.m_effectSticker.destory(),this.m_effectSticker=null);var e=BubbleJson.getData(t);this.m_text.text=e.text,this.m_text.x=-this.m_text.width/2,this.m_bgImg.width=this.m_text.width+44,this.m_bgImg.x=-this.m_bgImg.width/2,DelayCallUtils.killDelayedCallsTo(this.hide,this),DelayCallUtils.delayedCall(4,this.hide,this),this.scaleX=this.scaleY=.1,TweenLite.to(this,.3,{scaleX:1,scaleY:1,ease:Back.easeOut})
},e.prototype.showSticker=function(t){this.y=-190,this.visible=!0,this.m_bgImg&&(this.m_bgImg.visible=!1),this.m_text&&(this.m_text.visible=!1),this.m_effectSticker||(this.m_effectSticker=new EffectMovieClip,this.m_effectSticker.scaleX=.4,this.m_effectSticker.scaleY=.4);var e=GeXingHuaJson.getData(t);this.m_effectSticker.setMC(PublicCon.PATH_GEXINGHUA_RES+e.item_id),this.m_effectSticker.blendMode=egret.BlendMode.ADD,this.m_effectSticker.play(),this.addChild(this.m_effectSticker),DelayCallUtils.killDelayedCallsTo(this.hide,this),DelayCallUtils.delayedCall(4,this.hide,this),this.scaleX=this.scaleY=.1,TweenLite.to(this,.3,{scaleX:1,scaleY:1,ease:Back.easeOut})},e.prototype.setChatBubble=function(){if(this.m_bgImg){var t=PlayerManager.instance.p_playerInfo.player_other_data.chat_qi_pao_id;this.m_bgImg.source=PublicCon.PATH_PERSONAL_ICON+t+".png"}},e.prototype.hide=function(){this.m_effectSticker&&(DisplayObjectUtils.removeFormParent(this.m_effectSticker),this.m_effectSticker.destory(),this.m_effectSticker=null),this.visible=!1},e}(egret.DisplayObjectContainer);__reflect(BubbleLine.prototype,"BubbleLine");var HeadMonster=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setLevelTime=function(t){if(null!=this.m_avatarLive&&null!=this.m_avatarLive.jsonAvatar)if(TimeManager.instance.clearTimer(this.timeDoGo,this),DelayCallUtils.killDelayedCallsTo(this.setStartTime,this),this.m_time=t,this.m_time-ServerTimeManager.instance.timer>10){var e=this.m_time-ServerTimeManager.instance.timer-10;DelayCallUtils.delayedCall(e,this.setStartTime,this)}else this.m_time>ServerTimeManager.instance.timer&&this.setStartTime()},e.prototype.setStartTime=function(){null!=this.m_avatarLive&&null!=this.m_avatarLive.jsonAvatar&&(this.m_numView||(this.m_numView=new NumberView("num_c_time_",0,-6),this.m_numView.p_isAnchorOffsetX=!0),this.m_avatarLive.addChild(this.m_numView),TimeManager.instance.doLoop(this.timeDoGo,this),this.resetPosition())},e.prototype.resetTime=function(t){t>0&&(this.m_time=t),TimeManager.instance.clearTimer(this.timeDoGo,this),DelayCallUtils.killDelayedCallsTo(this.setStartTime,this)},e.prototype.huifuTime=function(){this.setLevelTime(this.m_time)},e.prototype.setTitle=function(){if(this.m_avatarLive instanceof AvatarMonster){if(void 0==this.m_avatarLive.jsonMonster.effect_list[0])return;this.m_titleMC||(this.m_titleMC=new EffectMovieClip),this.m_titleMC.onLoadCompleteFunc=this.resetPosition.bind(this),this.m_titleUrl=PublicCon.PATH_EFFECT_MONSTER+"monsterTitle/"+this.m_avatarLive.jsonMonster.effect_list[0],this.m_titleMC.setMC(this.m_titleUrl),this.m_titleMC.play(),this.m_avatarLive.addChild(this.m_titleMC)}},e.prototype.resetPosition=function(){if(null==this.m_avatarLive||null==this.m_avatarLive.jsonAvatar)return void TimeManager.instance.clearTimer(this.timeDoGo,this);t.prototype.resetPosition.call(this);var e=this.m_avatarLive.jsonAvatar.name_off_list[0],i=this.m_avatarLive.jsonAvatar.name_off_list[1];this.m_numView&&this.m_numView.parent&&(i-=55,this.m_numView.x=e,this.m_numView.y=i),this.m_titleMC&&(this.m_titleMC.x=0,this.m_titleMC.y=i-40,this.m_nameLabel&&(this.m_nameLabel.anchorOffsetX=Math.floor(-e+.5*this.m_nameLabel.width),this.m_nameLabel.anchorOffsetY=Math.floor(-i+this.m_nameLabel.height-30)))},e.prototype.timeDoGo=function(){this.timeGoto()},e.prototype.timeGoto=function(){var t=this.m_time-ServerTimeManager.instance.timer;return-2>=t?(this.m_avatarLive&&this.m_avatarLive instanceof AvatarMonster&&SceneItemModule.instance.removeMonster(this.m_avatarLive.dataMonster.scene_monster_id),void TimeManager.instance.clearTimer(this.timeDoGo,this)):0>t?(DisplayObjectUtils.removeFormParent(this.m_numView),void this.resetPosition()):void(this.m_numView&&(this.m_numView.numValue=t,this.m_numView.scaleX=2.5,this.m_numView.scaleY=2.5,TweenLite.to(this.m_numView,.4,{scaleX:1,scaleY:1})))},e.prototype.destory=function(){t.prototype.destory.call(this),TimeManager.instance.clearTimer(this.timeDoGo,this),DelayCallUtils.killDelayedCallsTo(this.setStartTime,this),DisplayObjectUtils.removeFormParent(this.m_numView),this.m_numView=null},e}(HeadName);__reflect(HeadMonster.prototype,"HeadMonster");var ActiveSkillLevelMapJson=function(){function t(){}return t.getData=function(t,e){var i=String(t+"_"+e),s=this.jsonData[i];return s||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),s},t.getSkillMaxLevel=function(t){var e=0;for(var i in this.jsonData)if(this.jsonData[i].id==t&&0==this.jsonData[i].next_level){e=this.jsonData[i].level;break}return e},t.FileName="active_skill_level_map",t}();__reflect(ActiveSkillLevelMapJson.prototype,"ActiveSkillLevelMapJson"),window.ActiveSkillLevelMapJson=ActiveSkillLevelMapJson;var HeadNPC=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setTitle=function(){if(this.m_avatarLive instanceof AvatarNpc){if(""==this.m_avatarLive.jsonNpc.title_url)return;this.m_titleMC||(this.m_titleMC=new EffectMovieClip),this.m_titleMC.onLoadCompleteFunc=this.resetPosition.bind(this),this.m_titleUrl=this.m_avatarLive.jsonNpc.title_url,this.m_titleMC.setMC(this.m_titleUrl),this.m_titleMC.play(),this.m_avatarLive.addChild(this.m_titleMC)}},e.prototype.resetPosition=function(){if(t.prototype.resetPosition.call(this),this.m_titleMC){var e=this.m_nameLabel.anchorOffsetY,i=this.m_avatarLive.jsonNpc.set_off_list;i.length>0&&(e+=Number(i[1])),this.m_titleMC.anchorOffsetX=0,this.m_titleMC.anchorOffsetY=Math.floor(e+30)}},e}(HeadName);__reflect(HeadNPC.prototype,"HeadNPC");var LiveHeadFactory=function(){function t(){}return t.getHeadByType=function(t){var e;switch(t){case LiveHeadType.MONSTER:e=new HeadMonster;break;case LiveHeadType.NPC:e=new HeadNPC;break;default:e=new HeadName}return e},t}();__reflect(LiveHeadFactory.prototype,"LiveHeadFactory");var LiveHeadType=function(){function t(){}return t.PLAYER=0,t.FRIEND=1,t.MONSTER=2,t.NPC=3,t.FIGHT=4,t.ROLE_NAME=5,t.WORLD_BOSS=6,t.GATHER=7,t.DROP_ITEM=8,t.SECT_VEHICLE=9,t.SCENE_EFFECT=10,t}();__reflect(LiveHeadType.prototype,"LiveHeadType");var HandleType=function(){function t(){}return t.MOVE=1,t.JUMP=2,t.ATTACK=3,t}();__reflect(HandleType.prototype,"HandleType");var LiveHandleProxy=function(){function t(t){this.m_curHandleVo=null,this.m_preHandleVo=null,this.m_live=t}return t.prototype.liveStateChange=function(){(this.m_live.curState==StateType.JUMP_END||this.m_live.curState==StateType.ATTACK_END||this.m_live.curState==StateType.XUAN_YUN_END||this.m_live.curState==StateType.DEAD_END||this.m_live.curState==StateType.SKILL_End||this.m_live.curState==StateType.CHUANSONG_END)&&this.doHandle(this.m_preHandleVo)},t.prototype.doHandle=function(t){return t?null==this.m_curHandleVo?(this.m_curHandleVo=t,this.m_curHandleVo.execHandle(),this.m_preHandleVo=null,!0):1==this.checkDoHandle(t)?(null!=this.m_curHandleVo&&this.m_curHandleVo.endHandle(t),this.m_curHandleVo=t,this.m_curHandleVo.execHandle(),this.m_preHandleVo=null,!0):(this.m_preHandleVo=t,!1):!1},t.prototype.checkDoHandle=function(t){return this.m_live.curState==StateType.JUMP||this.m_live.curState==StateType.ATTACK||this.m_live.curState==StateType.XUAN_YUN||this.m_live.curState==StateType.CHUANSONG||this.m_live.curState==StateType.DEAD?!1:this.m_live.curState==StateType.MOVE||this.m_live.curState==StateType.STAND||this.m_live.curState==StateType.JUMP_END?!0:!0},Object.defineProperty(t.prototype,"preHandleVo",{get:function(){return this.m_preHandleVo},set:function(t){this.m_preHandleVo=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"curHandleVo",{get:function(){return this.m_curHandleVo},set:function(t){this.m_curHandleVo=t},enumerable:!0,configurable:!0}),t}();__reflect(LiveHandleProxy.prototype,"LiveHandleProxy");var StateType=function(){function t(){}return t.STAND=0,t.MOVE=1,t.ATTACK=3,t.ATTACK_END=301,t.SKILL=302,t.SKILL_End=303,t.FAST_MOVE=13,t.JUMP=14,t.JUMP_END=17,t.REFRESH=39,t.CHUANSONG=29,t.CHUANSONG_END=30,t.DEAD=33,t.DEAD_END=34,t.XUAN_YUN=42,t.XUAN_YUN_END=43,t}();__reflect(StateType.prototype,"StateType");var Weapon=function(t){function e(){var e=t.call(this)||this;return e.m_weaponId=-1,e.touchEnabled=!1,e.touchChildren=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"isShow",{set:function(t){this.m_mc&&(this.m_mc.visible=t,this.m_mc.visible?this.m_mc.play():this.m_mc.stop())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isWeapShow",{get:function(){return this.m_mc.visible},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"player",{get:function(){return this.m_player},set:function(t){this.m_player=t,this.m_player.addChild(this)},enumerable:!0,configurable:!0}),e.prototype.setActionUrlDict=function(){this.m_jsonAvatar&&(this.m_actionUrlDict=AvatarJson.getWeaponActionUrlDict(this.m_jsonAvatar.id,TextureFrom.CHARACTER_WEAPON,this.m_weaponId))},e.prototype.shiftActionHandle=function(){switch(t.prototype.shiftActionHandle.call(this),this.m_curAction){case AvatarConfig.ACTION_stand:case AvatarConfig.ACTION_move:case AvatarConfig.ACTION_jump01:case AvatarConfig.ACTION_jump02:case AvatarConfig.ACTION_jump03:case AvatarConfig.ACTION_jump04:case AvatarConfig.ACTION_jump05:break;case AvatarConfig.ACTION_die:this.m_mc.addFrameScript(this.m_mc.textures.length-1,this.onDie.bind(this))}this.m_loopActionBean=null},e.prototype.onActionComplete=function(){this.m_mc.removeEventListeners(),this.shiftToAction(AvatarConfig.ACTION_stand)},e.prototype.onDie=function(){this.m_mc.removieAllFrameScript(),this.m_mc.removeEventListeners(),this.m_mc.stop()},e.prototype.changeWeapon=function(){this.m_jsonAvatar=null,this.m_actionTextureDict=null,this.m_actionTextureDict=[],this.setAvatarId(this.m_player.jsonAvatar.id),this.shiftToAction(this.m_player.curAction,this.m_player.curDirection)},e.prototype.setWeapon=function(t){this.m_weaponId!=t&&(this.m_weaponId=t,this.changeWeapon())},e.prototype.shiftToAction=function(e,i){void 0===i&&(i=-1);var s=this.m_player.getChildIndex(this.m_player.mc);4==i?(s-=1,0>s&&(s=0),this.m_player.addChildAt(this,s)):this.m_player.addChildAt(this,s+1),t.prototype.shiftToAction.call(this,e,i)},e.prototype.resetAction=function(e){t.prototype.resetAction.call(this,e),!this.m_loopActionBean&&this.m_player&&void 0!=this.m_player.mc&&this.m_player.mc.copyMcFrameData(this.m_mc),this.m_loopActionBean&&(this.m_mc.fps=this.m_loopActionBean.fps,this.m_mc.loop=!0,this.m_mc.LoopNum=this.m_loopActionBean.loop)},e.prototype.destory=function(){this.m_player=null,t.prototype.destory.call(this)},Object.defineProperty(e.prototype,"loopActionBean",{get:function(){return this.m_loopActionBean},set:function(t){this.m_loopActionBean=t},enumerable:!0,configurable:!0}),e}(AvatarBase);__reflect(Weapon.prototype,"Weapon");var Wing=function(t){function e(){var i=t.call(this)||this;return i.m_wingUrl="",i.m_wingId=0,i.m_currentState="null",i.m_textureDict=[],i.m_isHide=!1,i.isback=!1,i.touchEnabled=!1,i.touchChildren=!1,null==e.wing_pos_setting&&(e.wing_pos_setting=JSON.parse(StaticDataJson.getData("wing_pos_setting").data)),i}return __extends(e,t),Object.defineProperty(e.prototype,"isHide",{get:function(){return this.m_isHide},set:function(t){this.m_isHide=t,this.m_mc&&(this.m_mc.visible=this.m_isHide)},enumerable:!0,configurable:!0}),e.prototype.isNoShowWing=function(t){this.m_wingPlayer instanceof AvatarPlayer&&this.m_wingPlayer&&this.m_wingPlayer.playerData.player_id==PlayerManager.instance.playerId&&(this.m_isHide=t,this.m_isHide?(TweenMax.killTweensOf(this),TextureLoadManager.instance.closeLoad(this.m_wingUrl,this),null!=this.m_mc&&(this.m_mc.removeEventListeners(),this.m_mc.removeFromParent(),this.m_mc.stop(),this.m_mc.dispose()),DisplayObjectUtils.removeFormParent(this)):(this.m_wingPlayer&&(7==this.m_wingPlayer.curDirection||0==this.m_wingPlayer.curDirection||1==this.m_wingPlayer.curDirection?this.isback=!0:this.isback=!1),this.changeDirection()))},e.prototype.setWing=function(t,i){this.m_wingId!=i&&(this.m_wingId=i,this.m_wingPlayer=t,this.m_currentState="null",this.currentState=e.STATE_OPEN,1==this.m_wingPlayer.playerData.sex?this.anchorOffsetY=110:this.anchorOffsetY=120)},e.prototype.onloadComplete=function(t){if(null!=this.m_wingPlayer&&this.m_wingUrl==t){for(var e,i=TexturePool.instance.getTextureAtlas(this.m_wingUrl),s=[],n=Math.floor(i.length/AvatarConfig.DIRECTION_MAX),o=0;o<AvatarConfig.DIRECTION_MAX;o++){e=o*n,i.length%AvatarConfig.DIRECTION_MAX!=0&&(e=0,n=i.length);var a=i.slice(e,e+n);s[o]=a}this.m_textureDict[this.m_currentState]=s,this.changeDirection(),this.m_mc&&(this.m_mc.alpha=0,TweenLite.to(this.m_mc,.2,{alpha:1}))}},e.prototype.changeDirection=function(){if(!this.m_isHide&&null!=this.m_textureDict[this.m_currentState]&&null!=this.m_textureDict[this.m_currentState][this.getTextureIdxByDirection(this.m_wingPlayer.curDirection)]){this.m_mc?this.m_mc.resetTextures(this.m_textureDict[this.m_currentState][this.getTextureIdxByDirection(this.m_wingPlayer.curDirection)],12):this.m_mc=new MovieClip(this.m_textureDict[this.m_currentState][this.getTextureIdxByDirection(this.m_wingPlayer.curDirection)],12),this.m_mc.scaleY=1,this.m_mc.touchEnabled=!1,this.m_mc.play(),this.m_mc.anchorOffsetX=.5*this.m_mc.texture.textureWidth,this.m_mc.anchorOffsetY=.5*this.m_mc.texture.textureHeight,this.addChild(this.m_mc),4==this.m_wingPlayer.curDirection||5==this.m_wingPlayer.curDirection||6==this.m_wingPlayer.curDirection||7==this.m_wingPlayer.curDirection?this.m_mc.scaleX=-1:this.m_mc.scaleX=1;var t=this.m_wingPlayer.curDirection;5==t&&(t=3),6==t&&(t=2),7==t&&(t=1),this.m_mc.anchorOffsetX-=e.wing_pos_setting[t][0],this.m_mc.anchorOffsetY-=e.wing_pos_setting[t][1],6==this.m_wingPlayer.curDirection||2==this.m_wingPlayer.curDirection,7==this.m_wingPlayer.curDirection||0==this.m_wingPlayer.curDirection||1==this.m_wingPlayer.curDirection?this.setFront():this.setBack()}},e.prototype.setBack=function(){1==this.isback&&this.parent||(this.isback=!0,this.m_wingPlayer.mc&&this.m_wingPlayer.addChildAt(this,this.m_wingPlayer.getChildIndex(this.m_wingPlayer.mc)))},e.prototype.setFront=function(){0==this.isback&&this.parent||(this.isback=!1,this.m_wingPlayer.mc&&this.m_wingPlayer.addChildAt(this,this.m_wingPlayer.getChildIndex(this.m_wingPlayer.mc)+1))},e.prototype.getTextureIdxByDirection=function(t){var e;switch(t){case 5:e=3;break;case 6:e=2;break;case 7:e=1;break;default:e=t}return e},e.prototype.destory=function(){TweenMax.killTweensOf(this),TextureLoadManager.instance.closeLoad(this.m_wingUrl,this),null!=this.m_mc&&(this.m_mc.removeEventListeners(),this.m_mc.removeFromParent(),this.m_mc.stop(),this.m_mc.dispose(),this.m_mc=null),DisplayObjectUtils.removeFormParent(this),this.m_wingPlayer=null},Object.defineProperty(e.prototype,"currentState",{get:function(){return this.m_currentState},set:function(t){this.m_currentState!=t&&(TextureLoadManager.instance.closeLoad(this.m_wingUrl,this),this.m_currentState=t,this.m_wingUrl=TextureFrom.MOUNT+PublicCon.PATH_SCENE_WING+SysCommonJson.getData(this.m_wingId).scene_icon+"/"+this.m_currentState+".png",this.m_mc?TweenLite.to(this.m_mc,.2,{alpha:0,onComplete:TextureLoadManager.instance.requestLoadTextureAtlas.bind(TextureLoadManager.instance),onCompleteParams:[this.m_wingUrl,this,LoaderPriority.EFFECT,!0]}):TextureLoadManager.instance.requestLoadTextureAtlas(this.m_wingUrl,this,LoaderPriority.EFFECT,!0))},enumerable:!0,configurable:!0}),e.STATE_CLOSE="close",e.STATE_OPEN="open",e}(egret.DisplayObjectContainer);__reflect(Wing.prototype,"Wing",["ITextureLoadEvent"]);var MagicWeapon=function(t){function e(){var e=t.call(this)||this;return e.MIN_DIS=-20,e.TARGET_POINT_X=95,e.TARGET_POINT_X2=170,e.gAngle=180,e.gHasReset=!1,e.gInitPos=!1,e.gScale=1,e.gapTime=1e4,e.touchEnabled=!1,e.touchChildren=!1,e.gFollowItem=new egret.DisplayObjectContainer,e.addChild(e.gFollowItem),e.gCenterPos=new egret.Point,e.gTurnItem=new egret.DisplayObjectContainer,e.gFollowItem.addChild(e.gTurnItem),e}return __extends(e,t),Object.defineProperty(e.prototype,"isShow",{set:function(t){this.m_mc&&(this.m_mc.visible=t,this.m_mc.visible?(EnterFrameManager.instance.addEnterFrame(this.advanceTime,this),this.gInitPos=!0,this.m_mc.play()):(this.m_mc.stop(),EnterFrameManager.instance.removeEnterFrame(this.advanceTime,this),this.gInitPos=!0))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"item",{get:function(){return this.gTurnItem},enumerable:!0,configurable:!0}),e.prototype.onUpdateChange=function(){},e.prototype.setMagicWeapon=function(t,i){this.gInitPos=!0,this.gOwner=t,this.gTurnTime=this.gapTime+this.gapTime*Math.random()+EnterFrameManager.getTimer,this.gAngle=e.STAR_ANGLE,this.gStopTime=0,this.m_magicWeaponPlayer=t;var s=TextureFrom.MOUNT+PublicCon.PATH_SCENE_MAGIC+SysCommonJson.getData(i).scene_icon+".png";this.m_magicWeaponUrl!=s&&(TextureLoadManager.instance.closeLoad(this.m_magicWeaponUrl,this),this.m_magicWeaponUrl=s,TextureLoadManager.instance.requestLoadTextureAtlas(this.m_magicWeaponUrl,this,LoaderPriority.EFFECT,!0),this.m_magicWeaponPlayer.addChild(this),this.anchorOffsetY=-t.jsonAvatar.name_off_list[1],EnterFrameManager.instance.addEnterFrame(this.advanceTime,this),this.onUpdateChange())},e.prototype.onloadComplete=function(t){this.m_mc?this.m_mc.resetTextures(TexturePool.instance.getTextureAtlas(this.m_magicWeaponUrl),12):this.m_mc=new MovieClip(TexturePool.instance.getTextureAtlas(this.m_magicWeaponUrl),12),this.m_mc.play(),this.m_mc.anchorOffsetX=.5*this.m_mc.texture.textureWidth,this.m_mc.anchorOffsetY=.5*this.m_mc.texture.textureHeight,this.m_mc.scaleX=this.m_mc.scaleY=.3,this.gBody=this.m_mc,this.gTurnItem.addChild(this.gBody),this.onUpdateChange()},e.prototype.destory=function(){EnterFrameManager.instance.removeEnterFrame(this.advanceTime,this),TweenMax.killTweensOf(this),TextureLoadManager.instance.closeLoad(this.m_magicWeaponUrl,this),null!=this.m_mc&&(this.m_mc.removeEventListeners(),this.m_mc.removeFromParent(),this.m_mc.stop(),this.m_mc.dispose()),this.gBody=null,DisplayObjectUtils.removeFormParent(this),DisplayObjectUtils.removeFormParent(this.gFollowItem),this.gFollowItem=null,DisplayObjectUtils.removeFormParent(this.gTurnItem),this.m_magicWeaponPlayer=null},e.prototype.updateTurnPos=function(){if(0!=this.gTurn){var t=Math.abs(this.gAngle-e.STAR_ANGLE);25>=t||t>=335?this.gAngleSpeed=.5:50>=t||t>=310?this.gAngleSpeed=1:this.gAngleSpeed=1.5,this.gAngle-e.STAR_ANGLE>=360?(this.gTurn=!1,this.gTurnTime=this.gapTime+this.gapTime*Math.random()+EnterFrameManager.getTimer,this.gTurnItem.x=0,this.gTurnItem.y=0,this.gAngle=e.STAR_ANGLE):(this.gAngle=this.gAngle+this.gAngleSpeed,this.gTurnItem.x=Math.abs(this.gCenterPos.x)*MathUtil.cos(this.gAngle)-this.gCenterPos.x,this.gTurnItem.y=.8*Math.abs(this.gCenterPos.x)*MathUtil.sin(this.gAngle),this.gTurnItem.x||(this.gTurnItem.x=this.gTurnItem.y=0))}},e.prototype.advanceTime=function(t){this.update()},e.prototype.update=function(){this.m_magicWeaponPlayer.getChildIndex(this)!=this.m_magicWeaponPlayer.numChildren-1&&this.m_magicWeaponPlayer.addChild(this),this.gHasReset||(this.gInitPos?(this.gFollowItem.x=1e4==this.gapTime?this.TARGET_POINT_X:this.TARGET_POINT_X2,this.gFollowItem.y=e.TARGET_POINT_Y,this.gInitPos=!1):(this.gFollowItem.x=this.gFollowItem.x-(this.gOwner.x-this.gOwnerLastX),this.gFollowItem.y=this.gFollowItem.y-(this.gOwner.y-this.gOwnerLastY)),this.gCenterPos.x=1e4==this.gapTime?this.TARGET_POINT_X:this.TARGET_POINT_X2,this.gCenterPos.y=e.TARGET_POINT_Y,EnterFrameManager.getTimer>this.gStopTime&&(this.moveCenterPoint(),EnterFrameManager.getTimer>this.gTurnTime&&this.gFollowItem.x==this.gCenterPos.x&&this.gFollowItem.y==this.gCenterPos.y&&(this.gTurn=!0),this.updateTurnPos()),this.gOwnerLastX=this.gOwner.x,this.gOwnerLastY=this.gOwner.y)},e.prototype.moveCenterPoint=function(){if(1!=this.gTurn){var t,i=this.gCenterPos.x-this.gFollowItem.x;0!=i&&(Math.abs(i)>e.MAX_DIS?i>0?this.gFollowItem.x=this.gCenterPos.x-e.MAX_DIS:this.gFollowItem.x=this.gCenterPos.x+e.MAX_DIS:Math.abs(i)<this.MIN_DIS?this.gFollowItem.x=this.gCenterPos.x:(t=Math.ceil(Math.abs(i)*e.SPEED_RATIO),i>0?i>t?this.gFollowItem.x=this.gFollowItem.x+t:this.gFollowItem.x=this.gCenterPos.x:0>i&&(Math.abs(i)>t?this.gFollowItem.x=this.gFollowItem.x-t:this.gFollowItem.x=this.gCenterPos.x)));var s=this.gCenterPos.y-this.gFollowItem.y;0!=s&&(Math.abs(s)>e.MAX_DIS?s>0?this.gFollowItem.y=this.gCenterPos.y-e.MAX_DIS:this.gFollowItem.y=this.gCenterPos.y+e.MAX_DIS:Math.abs(s)<this.MIN_DIS?this.gFollowItem.y=this.gCenterPos.y:(t=Math.ceil(Math.abs(s)*e.SPEED_RATIO),s>0?s>t?this.gFollowItem.y=this.gFollowItem.y+t:this.gFollowItem.y=this.gCenterPos.y:0>s&&(Math.abs(s)>t?this.gFollowItem.y=this.gFollowItem.y-t:this.gFollowItem.y=this.gCenterPos.y)))}},e.TARGET_POINT_Y=0,e.MAX_DIS=150,e.STAR_ANGLE=0,e.SPEED_RATIO=.01,e}(egret.DisplayObjectContainer);__reflect(MagicWeapon.prototype,"MagicWeapon",["ITextureLoadEvent","IAnimatable"]);var MathUtil=function(){function t(){}return t.cos=function(t){return t=t+.5>>0,0>t&&(t=360+t),this.COS_VALUE[t]},t.sin=function(t){return t=t+.5>>0,0>t&&(t=360+t),this.SIN_VALUE[t]},t.COS_VALUE=[1,.999847695156391,.999390827019096,.998629534754574,.997564050259824,.996194698091746,.994521895368273,.992546151641322,.99026806874157,.987688340595138,.984807753012208,.981627183447664,.978147600733806,.974370064785235,.970295726275996,.965925826289068,.961261695938319,.956304755963035,.951056516295154,.945518575599317,.939692620785908,.933580426497202,.927183854566787,.92050485345244,.913545457642601,.90630778703665,.898794046299167,.891006524188368,.882947592858927,.874619707139396,.866025403784439,.857167300702112,.848048096156426,.838670567945424,.829037572555042,.819152044288992,.809016994374947,.798635510047293,.788010753606722,.777145961456971,.766044443118978,.754709580222772,.743144825477394,.731353701619171,.719339800338651,.707106781186548,.694658370458997,.681998360062498,.669130606358858,.656059028990507,.642787609686539,.629320391049838,.615661475325658,.601815023152048,.587785252292473,.573576436351046,.559192903470747,.544639035015027,.529919264233205,.515038074910054,.5,.484809620246337,.469471562785891,.453990499739547,.438371146789077,.422618261740699,.4067366430758,.390731128489274,.374606593415912,.3583679495453,.342020143325669,.325568154457157,.309016994374947,.292371704722737,.275637355816999,.258819045102521,.241921895599668,.224951054343865,.207911690817759,.190808995376545,.17364817766693,.156434465040231,.139173100960066,.121869343405147,.104528463267653,.0871557427476581,.0697564737441255,.052335956242944,.0348994967025011,.0174524064372834,6.12303176911189e-17,-.0174524064372835,-.0348994967025007,-.0523359562429436,-.0697564737441253,-.0871557427476582,-.104528463267653,-.121869343405147,-.139173100960065,-.156434465040231,-.17364817766693,-.190808995376545,-.207911690817759,-.224951054343865,-.241921895599668,-.258819045102521,-.275637355816999,-.292371704722737,-.309016994374947,-.325568154457156,-.342020143325669,-.3583679495453,-.374606593415912,-.390731128489274,-.4067366430758,-.422618261740699,-.438371146789078,-.453990499739547,-.469471562785891,-.484809620246337,-.5,-.515038074910054,-.529919264233205,-.544639035015027,-.559192903470747,-.573576436351046,-.587785252292473,-.601815023152048,-.615661475325658,-.629320391049837,-.642787609686539,-.656059028990507,-.669130606358858,-.681998360062498,-.694658370458997,-.707106781186547,-.719339800338651,-.73135370161917,-.743144825477394,-.754709580222772,-.766044443118978,-.777145961456971,-.788010753606722,-.798635510047293,-.809016994374947,-.819152044288992,-.829037572555042,-.838670567945424,-.848048096156426,-.857167300702112,-.866025403784439,-.874619707139396,-.882947592858927,-.891006524188368,-.898794046299167,-.90630778703665,-.913545457642601,-.92050485345244,-.927183854566787,-.933580426497202,-.939692620785908,-.945518575599317,-.951056516295154,-.956304755963035,-.961261695938319,-.965925826289068,-.970295726275996,-.974370064785235,-.978147600733806,-.981627183447664,-.984807753012208,-.987688340595138,-.99026806874157,-.992546151641322,-.994521895368273,-.996194698091746,-.997564050259824,-.998629534754574,-.999390827019096,-.999847695156391,-1,-.999847695156391,-.999390827019096,-.998629534754574,-.997564050259824,-.996194698091746,-.994521895368273,-.992546151641322,-.99026806874157,-.987688340595138,-.984807753012208,-.981627183447664,-.978147600733806,-.974370064785235,-.970295726275996,-.965925826289068,-.961261695938319,-.956304755963036,-.951056516295154,-.945518575599317,-.939692620785908,-.933580426497202,-.927183854566787,-.92050485345244,-.913545457642601,-.90630778703665,-.898794046299167,-.891006524188368,-.882947592858927,-.874619707139396,-.866025403784439,-.857167300702112,-.848048096156426,-.838670567945424,-.829037572555042,-.819152044288992,-.809016994374948,-.798635510047293,-.788010753606722,-.777145961456971,-.766044443118978,-.754709580222772,-.743144825477394,-.731353701619171,-.719339800338651,-.707106781186548,-.694658370458998,-.681998360062499,-.669130606358858,-.656059028990508,-.642787609686539,-.629320391049837,-.615661475325658,-.601815023152048,-.587785252292473,-.573576436351046,-.559192903470747,-.544639035015027,-.529919264233205,-.515038074910054,-.5,-.484809620246337,-.469471562785891,-.453990499739547,-.438371146789078,-.4226182617407,-.4067366430758,-.390731128489274,-.374606593415912,-.358367949545301,-.342020143325669,-.325568154457157,-.309016994374948,-.292371704722737,-.275637355816999,-.258819045102521,-.241921895599668,-.224951054343865,-.20791169081776,-.190808995376545,-.17364817766693,-.156434465040231,-.139173100960065,-.121869343405147,-.104528463267653,-.0871557427476582,-.0697564737441256,-.0523359562429443,-.0348994967025016,-.0174524064372835,-1.83690953073357e-16,.0174524064372831,.0348994967025013,.0523359562429439,.0697564737441252,.0871557427476579,.104528463267653,.121869343405148,.139173100960065,.156434465040231,.17364817766693,.190808995376544,.207911690817759,.224951054343865,.241921895599667,.258819045102521,.275637355816999,.292371704722737,.309016994374947,.325568154457156,.342020143325668,.3583679495453,.374606593415912,.390731128489273,.406736643075801,.4226182617407,.438371146789077,.453990499739547,.46947156278589,.484809620246337,.5,.515038074910054,.529919264233205,.544639035015027,.559192903470746,.573576436351046,.587785252292473,.601815023152048,.615661475325659,.629320391049838,.642787609686539,.656059028990507,.669130606358858,.681998360062498,.694658370458997,.707106781186547,.719339800338651,.731353701619171,.743144825477394,.754709580222772,.766044443118978,.777145961456971,.788010753606722,.798635510047293,.809016994374947,.819152044288992,.829037572555041,.838670567945424,.848048096156425,.857167300702112,.866025403784438,.874619707139396,.882947592858927,.891006524188368,.898794046299167,.90630778703665,.913545457642601,.92050485345244,.927183854566787,.933580426497202,.939692620785908,.945518575599317,.951056516295154,.956304755963036,.961261695938319,.965925826289068,.970295726275996,.974370064785235,.978147600733806,.981627183447664,.984807753012208,.987688340595138,.99026806874157,.992546151641322,.994521895368273,.996194698091746,.997564050259824,.998629534754574,.999390827019096,.999847695156391],t.SIN_VALUE=[0,.0174524064372835,.034899496702501,.0523359562429438,.0697564737441253,.0871557427476582,.104528463267653,.121869343405147,.139173100960065,.156434465040231,.17364817766693,.190808995376545,.207911690817759,.224951054343865,.241921895599668,.258819045102521,.275637355816999,.292371704722737,.309016994374947,.325568154457157,.342020143325669,.3583679495453,.374606593415912,.390731128489274,.4067366430758,.422618261740699,.438371146789077,.453990499739547,.469471562785891,.484809620246337,.5,.515038074910054,.529919264233205,.544639035015027,.559192903470747,.573576436351046,.587785252292473,.601815023152048,.615661475325658,.629320391049837,.642787609686539,.656059028990507,.669130606358858,.681998360062498,.694658370458997,.707106781186547,.719339800338651,.73135370161917,.743144825477394,.754709580222772,.766044443118978,.777145961456971,.788010753606722,.798635510047293,.809016994374947,.819152044288992,.829037572555042,.838670567945424,.848048096156426,.857167300702112,.866025403784439,.874619707139396,.882947592858927,.891006524188368,.898794046299167,.90630778703665,.913545457642601,.92050485345244,.927183854566787,.933580426497202,.939692620785908,.945518575599317,.951056516295154,.956304755963035,.961261695938319,.965925826289068,.970295726275996,.974370064785235,.978147600733806,.981627183447664,.984807753012208,.987688340595138,.99026806874157,.992546151641322,.994521895368273,.996194698091746,.997564050259824,.998629534754574,.999390827019096,.999847695156391,1,.999847695156391,.999390827019096,.998629534754574,.997564050259824,.996194698091746,.994521895368273,.992546151641322,.99026806874157,.987688340595138,.984807753012208,.981627183447664,.978147600733806,.974370064785235,.970295726275996,.965925826289068,.961261695938319,.956304755963036,.951056516295154,.945518575599317,.939692620785908,.933580426497202,.927183854566787,.92050485345244,.913545457642601,.90630778703665,.898794046299167,.891006524188368,.882947592858927,.874619707139396,.866025403784439,.857167300702112,.848048096156426,.838670567945424,.829037572555042,.819152044288992,.809016994374947,.798635510047293,.788010753606722,.777145961456971,.766044443118978,.754709580222772,.743144825477394,.731353701619171,.719339800338651,.707106781186548,.694658370458997,.681998360062499,.669130606358858,.656059028990507,.642787609686539,.629320391049838,.615661475325658,.601815023152048,.587785252292473,.573576436351046,.559192903470747,.544639035015027,.529919264233205,.515038074910054,.5,.484809620246337,.469471562785891,.453990499739547,.438371146789077,.422618261740699,.4067366430758,.390731128489274,.374606593415912,.3583679495453,.342020143325669,.325568154457157,.309016994374948,.292371704722737,.275637355817,.258819045102521,.241921895599668,.224951054343865,.207911690817759,.190808995376545,.17364817766693,.156434465040231,.139173100960066,.121869343405148,.104528463267654,.0871557427476586,.0697564737441255,.0523359562429438,.0348994967025007,.0174524064372834,1.22460635382238e-16,-.0174524064372832,-.0348994967025009,-.0523359562429436,-.0697564737441248,-.0871557427476579,-.104528463267653,-.121869343405148,-.139173100960066,-.156434465040231,-.17364817766693,-.190808995376545,-.207911690817759,-.224951054343865,-.241921895599668,-.25881904510252,-.275637355816999,-.292371704722736,-.309016994374948,-.325568154457157,-.342020143325669,-.3583679495453,-.374606593415912,-.390731128489274,-.4067366430758,-.422618261740699,-.438371146789077,-.453990499739546,-.469471562785891,-.484809620246337,-.5,-.515038074910054,-.529919264233205,-.544639035015027,-.559192903470747,-.573576436351046,-.587785252292473,-.601815023152048,-.615661475325658,-.629320391049838,-.642787609686539,-.656059028990507,-.669130606358858,-.681998360062498,-.694658370458997,-.707106781186547,-.719339800338651,-.73135370161917,-.743144825477394,-.754709580222772,-.766044443118978,-.777145961456971,-.788010753606722,-.798635510047293,-.809016994374947,-.819152044288992,-.829037572555041,-.838670567945424,-.848048096156426,-.857167300702112,-.866025403784438,-.874619707139396,-.882947592858927,-.891006524188368,-.898794046299167,-.90630778703665,-.913545457642601,-.92050485345244,-.927183854566787,-.933580426497202,-.939692620785908,-.945518575599317,-.951056516295154,-.956304755963035,-.961261695938319,-.965925826289068,-.970295726275996,-.974370064785235,-.978147600733806,-.981627183447664,-.984807753012208,-.987688340595138,-.99026806874157,-.992546151641322,-.994521895368273,-.996194698091746,-.997564050259824,-.998629534754574,-.999390827019096,-.999847695156391,-1,-.999847695156391,-.999390827019096,-.998629534754574,-.997564050259824,-.996194698091746,-.994521895368273,-.992546151641322,-.99026806874157,-.987688340595138,-.984807753012208,-.981627183447664,-.978147600733806,-.974370064785235,-.970295726275997,-.965925826289068,-.961261695938319,-.956304755963035,-.951056516295154,-.945518575599317,-.939692620785909,-.933580426497202,-.927183854566787,-.92050485345244,-.913545457642601,-.90630778703665,-.898794046299167,-.891006524188368,-.882947592858927,-.874619707139396,-.866025403784439,-.857167300702112,-.848048096156426,-.838670567945424,-.829037572555042,-.819152044288992,-.809016994374948,-.798635510047293,-.788010753606722,-.777145961456971,-.766044443118978,-.754709580222772,-.743144825477395,-.731353701619171,-.719339800338652,-.707106781186548,-.694658370458998,-.681998360062498,-.669130606358858,-.656059028990507,-.64278760968654,-.629320391049838,-.615661475325659,-.601815023152048,-.587785252292473,-.573576436351046,-.559192903470747,-.544639035015027,-.529919264233206,-.515038074910054,-.5,-.484809620246337,-.469471562785891,-.453990499739547,-.438371146789077,-.4226182617407,-.4067366430758,-.390731128489275,-.374606593415912,-.358367949545301,-.342020143325669,-.325568154457158,-.309016994374948,-.292371704722736,-.275637355817,-.258819045102521,-.241921895599668,-.224951054343865,-.20791169081776,-.190808995376545,-.173648177666931,-.156434465040231,-.139173100960066,-.121869343405148,-.104528463267653,-.0871557427476583,-.0697564737441248,-.0523359562429444,-.0348994967025008,-.0174524064372844],t
}();__reflect(MathUtil.prototype,"MathUtil");var SceneItem=function(t){function e(){var e=t.call(this)||this;return e.initView(),e}return __extends(e,t),Object.defineProperty(e.prototype,"dropData",{get:function(){return this.m_dropData},enumerable:!0,configurable:!0}),e.prototype.initView=function(){this.m_nameLabel||(this.m_nameLabel=new BitmapLabel,this.m_nameLabel.size=16,this.m_nameLabel.fontFamily="Arial",this.m_nameLabel.textAlign=egret.HorizontalAlign.LEFT,this.m_nameLabel.textColor=16777215,this.m_nameLabel.strokeColor=0,this.m_nameLabel.stroke=1,this.m_nameLabel.touchEnabled=!1)},e.prototype.setDropData=function(t){var e=ItemJson.getData(t.base_id);if(null!=e){this.m_dropData=t,this.x=t.x,this.y=t.y,this.m_iconMC||(this.m_iconMC=new EffectMovieClip),this.m_player=SceneItemModule.instance.getPlayer(this.m_dropData.owner_player_id);var i=PublicCon.PATH_FLY_RES+e.icon;this.m_iconMC.setMC(i);var s=TextUtil.setTextColorByQuality(e.name+(t.num<=1?"":"×"+t.num),e.quality);this.m_nameLabel.textFlow=TextUtil.setTextFlow(s),this.m_nameLabel.anchorOffsetX=.5*this.m_nameLabel.width,Dispatch.register(AvatarMonster.EVENT_MONSTER_DIE+this.m_dropData.scene_monsrer_id,this.show,this),DelayCallUtils.delayedCall(1,this.show,this),DelayCallUtils.delayedCall(4,this.reseAll,this)}},e.prototype.show=function(){Dispatch.remove(AvatarMonster.EVENT_MONSTER_DIE+this.m_dropData.scene_monsrer_id,this.show,this),DelayCallUtils.killDelayedCallsTo(this.show,this),this.hotTouchable=!0,this.m_iconMC.play(),this.addChild(this.m_iconMC),this.addChild(this.m_nameLabel);var t=100,e=.3;this.anchorOffsetY=t,this.alpha=1,TweenMax.to(this,e,{anchorOffsetY:0,ease:Sine.easeIn}),TweenMax.to(this,.3*e,{delay:e,anchorOffsetY:.3*t,ease:Sine.easeOut}),TweenMax.to(this,.3*e,{delay:e+.3*e,anchorOffsetY:0,ease:Sine.easeIn}),SceneLayerModule.instance.liveThingsLayer.addChild(this)},e.prototype.drawHotRect=function(){this.m_hotImage||(this.m_hotImage=new egret.Bitmap(RES.getRes("commonUI_box")),this.m_hotImage.scale9Grid=UIModule.instance.getRectangle(),this.m_hotImage.alpha=0,GameManager.p_hotList.push(this.m_hotImage)),this.m_hotImage.x=-20,this.m_hotImage.y=-80,this.m_hotImage.width=40,this.m_hotImage.height=80,this.m_hotImage.touchEnabled=!0,this.addChild(this.m_hotImage)},Object.defineProperty(e.prototype,"hotTouchable",{set:function(t){t?(this.drawHotRect(),null!=this.m_hotImage&&this.m_hotImage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this)):null!=this.m_hotImage&&(this.m_hotImage.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this),this.m_hotImage.parent&&this.m_hotImage.parent.removeChild(this.m_hotImage),this.m_hotImage.texture=null,this.m_hotImage=null)},enumerable:!0,configurable:!0}),e.prototype.onTouch=function(t){SceneModule.instance.collectAllThings()},e.prototype.reseAll=function(){this.onTouch(null)},e.prototype.remove=function(t){void 0===t&&(t=!1),DelayCallUtils.killDelayedCallsTo(this.reseAll,this),0==t?this.hideEffect1():this.resets()},e.prototype.hideEffect=function(){if(null!=this.m_player){this.x=this.x-this.m_player.x,this.y=this.y-this.m_player.y-80,this.m_player.addChild(this),DisplayObjectUtils.removeFormParent(this.m_nameLabel);var t=.3+.4*Math.random(),e=.3;TweenMax.to(this,t,{x:0,y:-10}),TweenMax.to(this,e,{delay:t-e,alpha:0}),TweenMax.delayedCall(t,this.resets,[!0],this)}else this.resets(!0)},e.prototype.hideEffect1=function(){if(null!=this.m_player){this.m_player.addChild(this),this.flyEffect(),DisplayObjectUtils.removeFormParent(this.m_nameLabel);var t=.3+.4*Math.random(),e=.3;this.alpha=0,TweenMax.to(this,e,{delay:t-e,alpha:0}),TweenMax.delayedCall(t,this.resets,[!0],this)}else this.resets(!0)},e.prototype.flyEffect=function(){var t=SceneLayerModule.instance.liveThingsLayer.localToGlobal(this.x,this.y);if(this.dropData.base_id==ItemEnum.BLESS_COIN){var e=UIModule.instance.getBlessPoint(!0);FlyResModule.instance.playResEffect4([t.x,t.y],e,this.dropData.base_id,this.dropData.num,.3,UIModule.instance.downUILayer3)}else{var i=BagManager.instance.getPointByItem(this.dropData.base_id,!0);FlyResModule.instance.playResEffect4([t.x,t.y],i,this.dropData.base_id,this.dropData.num,.3,UIModule.instance.downUILayer3)}},e.prototype.resets=function(t){void 0===t&&(t=!1),Dispatch.remove(AvatarMonster.EVENT_MONSTER_DIE+this.m_dropData.scene_monsrer_id,this.show,this),DelayCallUtils.killDelayedCallsTo(this.show,this),DelayCallUtils.killDelayedCallsTo(this.reseAll,this),this.hotTouchable=!1,this.m_player=null,this.m_iconMC&&(this.m_iconMC.destory(),this.m_iconMC=null),this.m_nameLabel.dispose(),DisplayObjectUtils.removeFormParent(this),SceneItemModule.instance.recoverSceneItem(this)},e}(egret.DisplayObjectContainer);__reflect(SceneItem.prototype,"SceneItem");var SceneTip=function(t){function e(){var e=t.call(this)||this;return e.onCompleted(),e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.alpha=0;var t=new eui.Label;t.textColor=16702275,t.stroke=1,t.strokeColor=12200708,t.size=30,t.italic=!0,t.bold=!0,this.addChild(t),this.m_nameLb=t},e.prototype.initEvent=function(){},e.prototype.show=function(){this.checkComplete(this.show)&&(this.m_nameLb.text=SceneManager.instance.p_sceneJson.name,this.horizontalCenter=-100,this.y=70,TweenLite.to(this,.5,{delay:1.5,alpha:1,scaleX:3,scaleY:3,ease:Back.easeIn}),TweenLite.to(this,.5,{delay:3.5,alpha:0,scaleX:.2,scaleY:.2,ease:Back.easeOut}))},e.prototype.hide=function(){this.checkComplete(this.hide)&&TweenLite.killTweensOf(this)},e}(ComponentBase);__reflect(SceneTip.prototype,"SceneTip");var ActivityInfoJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},t.getListByType=function(t){var e=[];for(var i in this.jsonData){var s=this.jsonData[i];s&&s.show_type==t&&e.push(s)}return e},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="activity_info",t}();__reflect(ActivityInfoJson.prototype,"ActivityInfoJson"),window.ActivityInfoJson=ActivityInfoJson;var MinMapMonster=function(t){function e(){var e=t.call(this)||this;return e.initView(),e}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){Dispatch.register(AvatarLive.EVENT_POSITION_CHANGE+this.m_livePid,this.roleMoveHandler,this)},e.prototype.roleMoveHandler=function(){this.m_monsterObj&&(this.x=this.m_monsterObj.x*this.m_posX-10,this.y=this.m_monsterObj.y*this.m_posY-10)},Object.defineProperty(e.prototype,"setMonsterObj",{set:function(t){this.m_monsterObj=t;""==t.jsonMonster.icon_id?"301":t.jsonMonster.icon_id;this.m_head.source="resource/assets/icon/monsterInfo/icon/301.png",this.m_circle.source="userMainUI_t_head_br"},enumerable:!0,configurable:!0}),e.prototype.setScale=function(t){this.m_head&&(this.m_head.scaleX=this.m_head.scaleY=t)},e.prototype.setPosition=function(t,e){this.m_posX=t,this.m_posY=e,this.roleMoveHandler()},e}(MinMapBase);__reflect(MinMapMonster.prototype,"MinMapMonster");var MinMapPlayer=function(t){function e(){var e=t.call(this)||this;return e.initView(),e}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this),this.createFirstImg()},e.prototype.initEvent=function(){Dispatch.register(AvatarLive.EVENT_POSITION_CHANGE+this.m_livePid,this.roleMoveHandler,this)},e.prototype.createFirstImg=function(){null==this.m_rankIcon&&(this.m_rankIcon=new eui.Image("userMainUI_img_hg"),this.m_rankIcon.scaleX=this.m_rankIcon.scaleY=.6,this.m_rankIcon.x=this.m_rankIcon.y=-3,this.addChild(this.m_rankIcon))},e.prototype.setRankVisible=function(t){void 0===t&&(t=!1),this.m_rankIcon&&(this.m_rankIcon.visible=t)},e.prototype.roleMoveHandler=function(){this.m_playerObj&&(this.x=this.m_playerObj.x*this.m_posX-10,this.y=this.m_playerObj.y*this.m_posY-10)},Object.defineProperty(e.prototype,"setPlayerObj",{set:function(t){this.m_playerObj=t,t.playerData.player_id==PlayerManager.instance.playerId?this.m_circle.source="userMainUI_t_head_right":this.m_circle.source="userMainUI_t_head_br",this.m_head.source=PublicCon.PATH_PERSONAL_ICON+t.playerData.player_other_data.head_id+".png"},enumerable:!0,configurable:!0}),e.prototype.setRankIcon=function(){},e.prototype.setScale=function(t){this.m_head&&(this.m_head.scaleX=this.m_head.scaleY=t)},e.prototype.setPosition=function(t,e){this.m_posX=t,this.m_posY=e,this.roleMoveHandler()},e}(MinMapBase);__reflect(MinMapPlayer.prototype,"MinMapPlayer");var MinMapPopup=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/minMap/popup/MinMapPopupSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.m_imgBg=new eui.Image,this.addChild(this.m_imgBg)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this)},e.prototype.showView=function(e){if(void 0===e&&(e=null),this.checkComplete(this.showView,e)){t.prototype.showView.call(this,e),Dispatch.register(MinMapModule.EVENT_MINMAP_PLAYER_CREATE,this.createPLayer,this),Dispatch.register(MinMapModule.EVENT_MINMAP_PLAYER_DELETE,this.removePlayer,this),Dispatch.register(MinMapModule.EVENT_MINMAP_MONSTER_CREATE,this.createMonster,this),Dispatch.register(MinMapModule.EVENT_MINMAP_MONSTER_DELETE,this.removePlayer,this),this.m_minMapView||(this.m_minMapView=new MinMapView,this.m_minMapView.onOpenbigMap(),this.addChild(this.m_minMapView),this.m_minMapView.anchorOffsetX=50,this.m_minMapView.anchorOffsetY=50,this.m_minMapView.x=276,this.m_minMapView.y=276,this.m_minMapView.scaleX=2.94,this.m_minMapView.scaleY=2.88,this.m_minMapView.setMapBg("/minimap.jpg",1111,490));var i=MinMapModule.instance.getMinMapView.monsterList;for(var s in i)this.createMonster(Number(s));var n=MinMapModule.instance.getMinMapView.playerList;for(var s in n)this.createPLayer(Number(s));this.m_minMapView.show(this)}},e.prototype.createPLayer=function(t){this.checkComplete(this.createPLayer,t)&&this.m_minMapView&&this.m_minMapView.createPLayer(t)},e.prototype.removePlayer=function(t){this.checkComplete(this.removePlayer,t)&&this.m_minMapView&&this.m_minMapView.removePlayer(t)},e.prototype.createMonster=function(t){this.checkComplete(this.createMonster,t)&&this.m_minMapView&&this.m_minMapView.createMonster(t)},e.prototype.removeMonster=function(t){this.checkComplete(this.removeMonster,t)&&this.m_minMapView&&this.m_minMapView.removeMonster(t)},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i),Dispatch.remove(MinMapModule.EVENT_MINMAP_PLAYER_CREATE,this.createPLayer,this),Dispatch.remove(MinMapModule.EVENT_MINMAP_PLAYER_DELETE,this.removePlayer,this),Dispatch.remove(MinMapModule.EVENT_MINMAP_MONSTER_CREATE,this.createMonster,this),Dispatch.remove(MinMapModule.EVENT_MINMAP_MONSTER_DELETE,this.removePlayer,this)},Object.defineProperty(e.prototype,"alphaBMask",{get:function(){return.5},enumerable:!0,configurable:!0}),e}(PopupBase);__reflect(MinMapPopup.prototype,"MinMapPopup");var MinMapView=function(t){function e(){var e=t.call(this)||this;return e.m_monsterList={},e.m_playerList={},e.touchEnabled=!1,e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/userMainUI/view/MinMapViewSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.registerEventClick(this.u_btnMonsterInfo,this.onMonsterInfo,this,!0),this.registerEventClick(this.u_btnCheckMap,this.onMaxMap,this),this.registerEventClick(this.u_btnRank,this.onRankView,this)},e.prototype.initEvent=function(){},e.prototype.show=function(t){void 0===t&&(t=UIModule.instance.downUILayer1),this.checkComplete(this.show,t)&&(Dispatch.register(RankManager.EVENT_RANK_GOLD_INFO_UPDATE,this.openRankView,this),Dispatch.register(RankManager.EVENT_RANK_ONE_INFO,this.setRankOne,this),t.addChild(this),this.u_imgMap.source=PublicCon.PATH_MAP+SceneManager.instance.p_sceneId+"/minimap.jpg",this.u_imgMap.scaleX=300/this.u_imgMap.width,this.u_imgMap.scaleY=130/this.u_imgMap.height)},e.prototype.setMapBg=function(t,e,i){this.u_imgMap&&(this.u_imgMap.source=PublicCon.PATH_MAP+SceneManager.instance.p_sceneId+t,this.u_imgMap.scaleX=e/this.u_imgMap.width,this.u_imgMap.scaleY=i/this.u_imgMap.height)},e.prototype.onMonsterInfo=function(){UIModule.instance.showUI(UIConfig.ID_MONSTER_INFO)},e.prototype.onMaxMap=function(){PopupModule.instance.showPop(PopupConfig.ID_MINMAP)},e.prototype.onOpenbigMap=function(){this.u_mainInfo.visible=!1},e.prototype.onRankView=function(){RankManager.instance.s_scene_get_gold_ranking_tos()},e.prototype.openRankView=function(){var t=RankManager.instance.p_goldRankInfo.gold_ranking_list;PopupModule.instance.showPop(PopupConfig.ID_COMBAT_RANK,t,!1)},e.prototype.setRankOne=function(t){var e=t.first_gold_ranking,i=SceneItemModule.instance.getPlayer(e.model_head_figure.player_id);this.m_rankPlayer||(this.m_rankPlayer=new MinMapPlayer,this.u_mainInfo.addChild(this.m_rankPlayer)),this.m_rankPlayer.setLivePid=i.livePid,this.m_rankPlayer.setPlayerObj=i,this.m_rankPlayer.setCircleScale(.6,.6),this.m_rankPlayer.setCircleAnchor(-5,-5),this.m_rankPlayer.setScale(.2),this.m_rankPlayer.x=77,this.m_rankPlayer.y=135,this.m_rankPlayer.setRankVisible(!1),this.u_txtMoney0.text=NumberUtil.numberToString(e.gold_value,1),this.u_txtMoney1.text=NumberUtil.numberToString(e.money_value,1);for(var s in this.m_playerList){var n=SceneItemModule.instance.getPlayer(Number(s));this.m_playerList[s]&&n&&n.playerData&&(n.playerData.player_id==e.model_head_figure.player_id?this.m_playerList[s].setRankVisible(!0):this.m_playerList[s].setRankVisible(!1))}},e.prototype.createPLayer=function(t){if(this.checkComplete(this.createPLayer,t)){var e=SceneItemModule.instance.getPlayer(t);if(e&&!this.m_playerList[t]){var i=new MinMapPlayer;i.setLivePid=e.livePid,i.setPlayerObj=e,i.initEvent(),this.u_grpMap.addChild(i),i.setPosition(300/MyMapModule.instance.map.mapdata.mapWidth,130/MyMapModule.instance.map.mapdata.mapHeight),i.setCircleScale(.6,.6),i.setCircleAnchor(-5,-5),i.setScale(.2),i.setRankVisible(!1),this.m_playerList[t]=i}}},e.prototype.removePlayer=function(t){if(this.checkComplete(this.removePlayer,t)){var e=this.m_playerList[t];this.m_playerList[t]&&(DisplayObjectUtils.removeFormParent(e),delete this.m_playerList[t])}},e.prototype.createMonster=function(t){if(this.checkComplete(this.createMonster,t)){var e=SceneItemModule.instance.getMonster(t);if(e&&!this.m_monsterList[t]){var i=new MinMapMonster;i.setLivePid=e.livePid,i.setMonsterObj=e,i.initEvent(),this.u_grpMap.addChild(i),i.setPosition(300/MyMapModule.instance.map.mapdata.mapWidth,130/MyMapModule.instance.map.mapdata.mapHeight),i.setCircleScale(.6,.6),i.setCircleAnchor(7,5),i.setScale(.06),this.m_monsterList[t]=i}}},e.prototype.removeMonster=function(t){if(this.checkComplete(this.removeMonster,t)){var e=this.m_monsterList[t];this.m_monsterList[t]&&(DisplayObjectUtils.removeFormParent(e),delete this.m_monsterList[t])}},Object.defineProperty(e.prototype,"monsterList",{get:function(){return this.m_monsterList},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"playerList",{get:function(){return this.m_playerList},enumerable:!0,configurable:!0}),e.prototype.hide=function(){this.checkComplete(this.show)&&(Dispatch.remove(RankManager.EVENT_RANK_GOLD_INFO_UPDATE,this.openRankView,this),Dispatch.remove(RankManager.EVENT_RANK_ONE_INFO,this.setRankOne,this),DisplayObjectUtils.removeFormParent(this))},Object.defineProperty(e.prototype,"width",{get:function(){return 348},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 170},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(MinMapView.prototype,"MinMapView");var MapTouchControl=function(t){function e(e){var i=t.call(this)||this;return i.m_radius=85,i.m_angle=0,i.m_originalX=52,i.m_margin=137,i.m_playerPoint=new egret.Point,i.m_angleDistancePt=new egret.Point,i.m_root=e,i.m_root.addChild(i),i.anchorOffsetX=84.5,i.anchorOffsetY=84.5,i.x=i.m_originalX+i.m_radius,i.y=StageManager.instance.p_stageHeight-i.m_originalX-i.m_radius,i.m_bar=new eui.Image("userMainUI_maptouchControlBar"),i.m_bar.anchorOffsetX=84.5,i.m_bar.anchorOffsetY=84.5,i.addChild(i.m_bar),i.m_bar.x=i.m_radius,i.m_bar.y=i.m_radius,i.m_ball=new eui.Image("userMainUI_maptouchControlBall"),i.m_ball.anchorOffsetX=84.5,i.m_ball.anchorOffsetY=84.5,i.addChild(i.m_ball),i.m_ball.alpha=0,i.touchChildren=!1,i.touchEnabled=!1,i}return __extends(e,t),e.prototype.startTouchControl=function(t){this.m_startPoint=t;var e=t.x<this.m_margin&&t.y>StageManager.instance.p_stageHeight-this.m_margin;e||(this.alpha=0,TweenLite.killTweensOf(this),TweenLite.to(this,.2,{alpha:1,x:t.x,y:t.y})),this.m_ball.alpha=0,TweenLite.killTweensOf(this.m_ball),TweenLite.to(this.m_ball,.2,{alpha:1}),this.startTick()},e.prototype.startTick=function(){TweenLite.delayedCall(.2,this.tick,null,this),this.tick()},e.prototype.tick=function(){var t=PlayerManager.instance.p_mainPlayer.getPos();this.m_playerPoint.x=t.x,this.m_playerPoint.y=t.y;var e=this.m_radius*Math.cos(this.m_angle),i=this.m_radius*Math.sin(this.m_angle);this.m_playerPoint.x+=e,this.m_playerPoint.y+=i,MyMapModule.instance.map.startTouchMove(this.m_playerPoint.x,this.m_playerPoint.y),TweenLite.delayedCall(.2,this.tick,null,this)},e.prototype.endTick=function(){TweenLite.killDelayedCallsTo(this.tick)},e.prototype.moveTouchControl=function(t){this.m_movePoint=t;var e=0,i=0;if(egret.Point.distance(this.m_movePoint,this.m_startPoint)>60){var s=this.getAngleDistance(this.m_movePoint,this.m_startPoint);e=this.m_radius+s.x-this.m_startPoint.x,i=this.m_radius+s.y-this.m_startPoint.y}else e=this.m_radius+this.m_movePoint.x-this.m_startPoint.x,i=this.m_radius+this.m_movePoint.y-this.m_startPoint.y;this.m_ball.alpha>0&&(this.m_ball.x=e,this.m_ball.y=i),this.m_angle=Math.atan2(i-this.m_bar.y,e-this.m_bar.x)},e.prototype.endTouchControl=function(t){void 0===t&&(t=null),TweenLite.to(this.m_ball,.2,{alpha:0}),this.alpha=0,TweenLite.to(this,.2,{alpha:1,x:this.m_originalX+this.m_radius,y:StageManager.instance.p_stageHeight-this.m_originalX-this.m_radius}),this.endTick()},e.prototype.removeToParent=function(){DisplayObjectUtils.removeFormParent(this)},e.prototype.getAngleDistance=function(t,e,i){void 0===i&&(i=60);var s=e.x-t.x,n=e.y-t.y,o=i/egret.Point.distance(t,e);return s=o*s,n=o*n,this.m_angleDistancePt.x=e.x-s,this.m_angleDistancePt.y=e.y-n,this.m_angleDistancePt},e}(egret.DisplayObjectContainer);__reflect(MapTouchControl.prototype,"MapTouchControl");var MyMapData=function(){function t(){this.mapId=0,this.sceneId=0,this.sceneType=1,this.tileCol=0,this.tileRow=0,this.tileHeight=0,this.tileWidth=0,this.mapHeight=0,this.mapWidth=0,this.gridCol=0,this.gridRow=0,this.gridData=[],this.maskData=[],this.jumpCrossData=[],this.jumpAreaData=[],this.jumpAreaEffectPoint=[],this.miniMaptextureDict=[],this.npcArray=[],this.collectArray=[],this.mapEffectData=[],this.m_loadList=[],this.m_loadController=new LoadController,this.m_rectMiniMap=new egret.Rectangle}return t.prototype.setSceneId=function(t){this.sceneId=t,this.resetSceneData(),this.loadSceneData()},t.prototype.resetSceneData=function(){if(0!=this.sceneId&&Trace.log("resetSceneData",this.sceneId,RES.destroyRes("resource/assets/scene/scenedata/"+this.sceneId+"/scene_data.json"),RES.destroyRes(PublicCon.PATH_MAP+this.mapId+"/map_data.json"),RES.destroyRes(PublicCon.PATH_MAP+this.mapId+"/minimap.jpg")),this.miniMaptextureDict){for(var t in this.miniMaptextureDict)this.miniMaptextureDict[t].dispose(),this.miniMaptextureDict[t]=null;this.miniMaptextureDict=null,this.miniMaptextureDict=[]}this.miniMaptextureSheet&&(this.miniMaptextureSheet.dispose(),this.miniMaptextureSheet=null),this.gridData.length=0,this.maskData.length=0,this.jumpCrossData.length=0,this.jumpAreaData.length=0,this.jumpAreaEffectPoint.length=0,this.npcArray&&(this.npcArray.length=0),this.collectArray&&(this.collectArray.length=0)},t.prototype.loadSceneData=function(){var t="resource/assets/scene/scenedata/"+this.sceneId+"/scene_data.json";RES.getResByUrl(t,this.sceneDataComplete,this,RES.ResourceItem.TYPE_JSON)},t.prototype.sceneDataComplete=function(t,e){var i=t;this.mapId=i.map_id,this.npcArray=i.npcArray?i.npcArray:[],this.collectArray=i.gatherArray?i.gatherArray:[],this.mapEffectData=i.sceneEffectArray?i.sceneEffectArray:[],this.loadMapData()},t.prototype.loadMapData=function(){this.m_loadList.length=0,this.m_loadList.push(LoadTaskFactory.createImageItem(PublicCon.PATH_MAP+this.mapId+"/minimap.jpg",this.minimapComplete,this)),this.m_loadList.push(LoadTaskFactory.createJsonItem(PublicCon.PATH_MAP+this.mapId+"/map_data.json",this.mapDataComplete,this)),this.m_loadController.load(this,this.m_loadList,LoaderViewType.MAP)},t.prototype.minimapComplete=function(t,e){this.miniMaptexture=t},t.prototype.mapDataComplete=function(t,e){var i=t;this.hasBackground=i.hasBackground,this.mapHeight=i.mapHeight,this.mapWidth=i.mapWidth,this.tileHeight=i.tileHeight,this.tileWidth=i.tileWidth,this.tileCol=Math.ceil(this.mapWidth/this.tileWidth),this.tileRow=Math.ceil(this.mapHeight/this.tileHeight),this.gridCol=i.gridCol,this.gridRow=i.gridRow,this.gridData=i.dataArray,this.maskData=i.maskArray,this.jumpCrossData=i.jumpCrossArray,this.jumpAreaData=i.jumpAreaArray,this.sceneDoorData=null,this.sceneJumpData=null,this.sceneAutoJumpData=null,this.jumpAreaEffectPoint=null,this.sceneDoorData=[],this.sceneJumpData=[],this.sceneAutoJumpData=[],this.jumpAreaEffectPoint=[],this.praseSceneData()},t.prototype.onComplete=function(){this.praseMiniSceneData(),this.mapDataCompleteFunc.apply(this.callbackObj)},t.prototype.praseSceneData=function(){var e,i=this.jumpCrossData?this.jumpCrossData:[];for(e=0;e<i.length;e++){var s=i[e].x1,n=i[e].y1,o=i[e].x2,a=i[e].y2;null==this.sceneJumpData[s+"_"+n]&&(this.sceneJumpData[s+"_"+n]=[]),this.sceneJumpData[s+"_"+n].push([o,a]),this.setMapData(s,n,t.DATA_JUMPPOINT)}for(var r=this.jumpAreaData?this.jumpAreaData:[],_=0;_<r.length;_++){var h=[r[_].curPoint.x,r[_].curPoint.y],l=r[_].jumpArea,c=[r[_].tarPoint.x,r[_].tarPoint.y];null==this.sceneJumpData[h[0]+"_"+h[1]]&&(this.sceneJumpData[h[0]+"_"+h[1]]=[]),this.sceneJumpData[h[0]+"_"+h[1]].push(c),l.length>1&&this.jumpAreaEffectPoint.push(h),this.setMapData(h[0],h[1],t.DATA_JUMPPOINT);for(var m=0;m<l.length;m++){var p=l[m].toString().split("_");this.sceneAutoJumpData[l[m]]=c,this.setMapData(p[0],p[1],t.DATA_JUMPPOINT),null==this.sceneJumpData[l[m]]&&(this.sceneJumpData[l[m]]=[]),this.sceneJumpData[l[m]].push(c)}}},t.prototype.praseMiniSceneData=function(){this.miniMaptextureSheet=new egret.SpriteSheet(this.miniMaptexture)},t.prototype.getMiniMapData=function(e,i){var s=this.miniMaptextureDict[e+"_"+i];if(!s){var n=this.tileWidth*t.MINIMAP_SCALE;this.m_rectMiniMap.x=e*n,this.m_rectMiniMap.y=i*n,this.m_rectMiniMap.width=n,this.m_rectMiniMap.height=n,s=this.miniMaptextureSheet.createTexture(e+"_"+i,this.m_rectMiniMap.x,this.m_rectMiniMap.y,this.m_rectMiniMap.width,this.m_rectMiniMap.height),this.miniMaptextureDict[e+"_"+i]=s}return s},t.prototype.getCollectPosById=function(t){for(var e=0;e<this.collectArray.length;e++)if(this.collectArray[e].gather_id==t)return new egret.Point(this.collectArray[e].x,this.collectArray[e].y);return null},t.prototype.getNpcPosById=function(t){for(var e=0;e<this.npcArray.length;e++)if(this.npcArray[e].npc_id==t)return new egret.Point(this.npcArray[e].x,this.npcArray[e].y);return null},t.prototype.setMapData=function(t,e,i){var s=t+e*this.gridCol;this.gridData[s]=i},t.prototype.getMapData=function(e,i){if(null==this.gridData)return 0;var s=Math.floor(e/t.GRID_SIZE)+Math.floor(i/t.GRID_SIZE)*this.gridCol;return this.gridData[s]},t.prototype.getMapGridIdx=function(e,i){if(null==this.gridData)return 0;var s=Math.floor(e/t.GRID_SIZE)+Math.floor(i/t.GRID_SIZE)*this.gridCol;return s},t.GRID_SIZE=40,t.MINIMAP_SCALE=.0625,t.DEFAULT_TITLESIZE=512,t.SCENETYPE_WORLDMAP=1,t.SCENETYPE_COPYMAP=2,t.DATA_BLOCK=0,t.DATA_GROUND=1,t.DATA_MASK=2,t.DATA_SCENEDOOR=3,t.DATA_SCENEDOORENDPOnumber=4,t.DATA_JUMPPOINT=5,t.DATA_JUMPENDPOINT=6,t.DATA_FLYGROUND=7,t.DATA_AUTOJUMP=8,t.TYPE_EMPTY=0,t.TYPE_WATER=1,t.TYPE_FIRE=2,t.TYPE_WIND=3,t.TYPE_THUNDER=4,t.TYPE_MOUNTAIN=5,t.TYPE_TREE=6,t.TYPE_SNOW=7,t.TYPE_POISON=8,t.TYPE_SAND=9,t.TYPE_CURE=10,t}();__reflect(MyMapData.prototype,"MyMapData");var MyMapModule=function(){function t(){}return Object.defineProperty(t.prototype,"root",{get:function(){return this.m_root},enumerable:!0,configurable:!0}),Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(t){this.m_root=t,this.m_map||(this.m_map=new MyMapVo,this.m_root.addChild(this.m_map),SceneLayerModule.instance.init(this.m_map.sceneLayer,this.m_root),SceneEffectModule.instance.init(this.m_map.effectLayer))},t.prototype.addTouchMap=function(){this.m_mapTouchControl||(this.m_mapTouchControl=new MapTouchControl(this.m_root))},t.prototype.startTouchControl=function(t){this.m_mapTouchControl&&this.m_mapTouchControl.startTouchControl(t)},t.prototype.moveTouchControl=function(t){this.m_mapTouchControl&&this.m_mapTouchControl.moveTouchControl(t)},t.prototype.endTouchControl=function(){this.m_mapTouchControl&&this.m_mapTouchControl.endTouchControl()},t.prototype.showHideTouchControl=function(t){void 0===t&&(t=!0),this.m_mapTouchControl&&this.m_mapTouchControl.visible!=t&&(this.m_mapTouchControl.visible=t)},t.prototype.loadScene=function(){this.m_map&&this.m_map.setMap(SceneManager.instance.p_sceneId)},Object.defineProperty(t.prototype,"map",{get:function(){return this.m_map},enumerable:!0,configurable:!0}),t}();__reflect(MyMapModule.prototype,"MyMapModule");var MyMapTile=function(t){function e(){var e=t.call(this)||this;return e.m_onLoad=!1,e.m_onLoadOk=!1,e.m_groundUrl="null",e.touchEnabled=!1,e}return __extends(e,t),e.prototype.setData=function(t,e){this.m_onLoadOk=!1,this.m_mapData=t,this.m_idx=e},e.prototype.show=function(){this.x=Math.floor(this.m_idx%this.m_mapData.tileCol)*this.m_mapData.tileWidth,this.y=Math.floor(this.m_idx/this.m_mapData.tileCol)*this.m_mapData.tileHeight,1!=this.m_onLoad&&(this.m_onLoad=!0,1!=this.m_onLoadOk&&(this.m_groundUrl=TextureFrom.MAP+"resource/assets/scene/map/"+this.m_mapData.mapId+"/"+Math.floor(this.m_idx%this.m_mapData.tileCol)+"_"+Math.floor(this.m_idx/this.m_mapData.tileCol)+".jpg",TextureLoadManager.instance.requestLoadTextureMap(this.m_groundUrl,this,LoaderPriority.MAP,!1),this.addMiniMap()))},e.prototype.hide=function(){this.m_onLoad=!1,0==this.m_onLoadOk&&TextureLoadManager.instance.closeLoad(this.m_groundUrl,this),this.texture=null,this.m_onLoadOk=!1,this.removeFromParent()},e.prototype.removeFromParent=function(){null!=this.parent&&this.parent.removeChild(this)},e.prototype.onloadComplete=function(t){this.m_groundUrl==t&&(this.width=0/0,this.height=0/0,this.texture=TexturePool.instance.getTextureMap(t),TexturePool.instance.addTextureMapUse(this.texture,this),null!=this.texture&&(this.m_onLoadOk=!0))},e.prototype.addMiniMap=function(){1!=this.m_onLoadOk&&(this.texture=this.m_mapData.getMiniMapData(Math.floor(this.m_idx%this.m_mapData.tileCol),Math.floor(this.m_idx/this.m_mapData.tileCol)),this.width=this.texture.textureWidth/MyMapData.MINIMAP_SCALE,this.height=this.texture.textureHeight/MyMapData.MINIMAP_SCALE)},e.prototype.destory=function(){1==this.m_onLoadOk&&TextureLoadManager.instance.closeLoad(this.m_groundUrl,this),TexturePool.instance.removeTextureMapUse(this.texture,this),this.removeFromParent(),this.m_onLoad=!1,this.m_onLoadOk=!1,this.m_groundUrl="null"},e}(eui.Image);__reflect(MyMapTile.prototype,"MyMapTile");var MyMapVo=function(t){function e(){var e=t.call(this)||this;return e.m_onLoadMapData=!1,e.m_mapTilePool=[],e.m_mapTileList=[],e.m_lastMoveTime=0,e.m_mapTouchPoint=new egret.Point,e.m_mapFocusPoint=new egret.Point,e.m_tileViewRect=new egret.Rectangle,e.m_lastTileRect=new egret.Rectangle,e.p_mapViewRect=new egret.Rectangle(0,0,0,0),e.m_maptouchBeginPoint=new egret.Point,e.m_maptouchMovePoint=new egret.Point,e.actionidx=0,e.actionList=[AvatarConfig.ACTION_attack02,AvatarConfig.ACTION_jump01,AvatarConfig.ACTION_move,AvatarConfig.ACTION_stand],e.m_click_time=0,e.m_showToucBool=!1,e.m_updateSIFPoint=new egret.Point,e.m_tileLayer=new egret.DisplayObjectContainer,e.m_sceneLayer=new egret.DisplayObjectContainer,e.m_effectLayer=new egret.DisplayObjectContainer,e.m_effectLayer.name="m_effectLayer",e.addChild(e.m_tileLayer),e.addChild(e.m_sceneLayer),e.addChild(e.m_effectLayer),e.m_mapdata=new MyMapData,e.m_mapdata.mapDataCompleteFunc=e.onMapDataComplete,e.m_mapdata.callbackObj=e,e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,e.onMapTouchBegin,e),e.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onClickMap,e),Dispatch.register(StageManager.EVENT_STAGE_RESIZE,e.stageResize,e),e}return __extends(e,t),e.prototype.onMapTouchBegin=function(t){return this.m_maptouchBeginPoint.x=t.stageX,this.m_maptouchBeginPoint.y=t.stageY,1==PlayerManager.instance.p_mainPlayer.p_isDie||SceneModule.instance.isMissionScene&&MissionManager.instance.missionType==MissionTypeEnum.GUESS_BOSS?void 0:(this.m_pos||(this.m_pos=StaticDataJson.parseStrToList("map_touch_valid_pos")),this.m_maptouchBeginPoint.x<this.m_pos[0]&&this.m_maptouchBeginPoint.y>StageManager.instance.p_stageHeight-this.m_pos[1]&&(this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onMapTouchMove,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.onMapTouchEnd,this)),EnterFrameManager.getTimer-this.m_lastMoveTime>5e3?void(this.m_lastMoveTime=EnterFrameManager.getTimer):void this.startTouchMove(t.localX,t.localY))},e.prototype.onClickMap=function(t){FightUIModule.instance.showEffect(PublicCon.PATH_EFFECT_CLICK_STAGE,[t.localX,t.localY],SceneLayerModule.instance.liveThingsLayer),0==this.m_click_time?this.m_click_time=ServerTimeManager.instance.timerValue:ServerTimeManager.instance.timerValue-this.m_click_time<=500?(this.m_click_time=0,FightAutoAI.instance.p_isAutoFight&&(FightAutoAI.instance.stopAutoFight(),UIModule.instance.stopAuto(FightSkillManager.type_auto),PlayerManager.instance.p_mainPlayer&&PlayerManager.instance.p_mainPlayer.shiftToAction(AvatarConfig.ACTION_stand,4))):this.m_click_time=0},e.prototype.startTouchMove=function(t,e){MoveManager.instance.movePlayer(t,e),this.m_lastMoveTime=EnterFrameManager.getTimer},e.prototype.onMapTouchEnd=function(t){this.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onMapTouchMove,this),this.removeEventListener(egret.TouchEvent.TOUCH_END,this.onMapTouchEnd,this),MyMapModule.instance.endTouchControl(),this.m_showToucBool=!1},e.prototype.onMapTouchMove=function(t){return 1!=PlayerManager.instance.p_mainPlayer.p_isDie?(this.m_maptouchMovePoint.x=t.stageX,this.m_maptouchMovePoint.y=t.stageY,this.m_showToucBool?void MyMapModule.instance.moveTouchControl(this.m_maptouchMovePoint):void(egret.Point.distance(this.m_maptouchMovePoint,this.m_maptouchBeginPoint)<30||this.m_showToucBool||(this.m_showToucBool=!0,MyMapModule.instance.startTouchControl(this.m_maptouchBeginPoint)))):void 0},e.prototype.setMap=function(t){this.m_onLoadMapData=!0,this.m_mapdata.setSceneId(t)},e.prototype.onMapDataComplete=function(){this.m_onLoadMapData=!1,MoveManager.instance.resetMapdata(this.m_mapdata),SceneManager.instance.s_scene_load_scene_tos()},e.prototype.cleanMap=function(){this.m_tileViewRect=null,this.m_lastTileRect=null,this.m_tileViewRect=new egret.Rectangle,this.m_lastTileRect=new egret.Rectangle;for(var t in this.m_mapTileList){var e=this.m_mapTileList[t];e.destory(),this.m_mapTilePool.push(e)}this.m_mapTileList=[],SkillFactory.instance.destoryAllSkill(),SceneItemModule.instance.clearLivethings(),SceneEffectModule.instance.cleanMapEffect(),SceneEffectModule.instance.resetMapdata(this.m_mapdata),HitEffect.clearHitEffect(),TexturePool.instance.destoryTextureAll(!0)
},e.prototype.addMapTile=function(t,e){var i=t+e*this.m_mapdata.tileCol,s=this.m_mapTileList[i];s||(s=this.m_mapTilePool.length>0?this.m_mapTilePool.shift():new MyMapTile,s.setData(this.m_mapdata,i),this.m_mapTileList[i]=s),s.show(),this.m_tileLayer.addChild(s)},e.prototype.removeMapTile=function(t,e){var i=t+e*this.m_mapdata.tileCol,s=this.m_mapTileList[i];s&&(s.hide(),this.m_mapTileList[i]=null,delete this.m_mapTileList[i],this.m_mapTilePool.push(s))},e.prototype.stageResize=function(){this.upDateMapFocus(this.m_mapFocusPoint.x,this.m_mapFocusPoint.y)},e.prototype.upDateMapFocus=function(t,i){if(!this.m_onLoadMapData){this.m_mapFocusPoint.x=t,this.m_mapFocusPoint.y=i;var s=.5*StageManager.instance.p_stageWidth,n=.5*StageManager.instance.p_stageHeight,o=this.m_mapdata.mapWidth,a=this.m_mapdata.mapHeight;i-=42;var r=-(t-s),_=-(i-n);s>=t&&(r=0),n>=i&&(_=0),t>=o-s&&(r=-(o-2*s),r>0&&(r=0)),i>=a-n&&(_=-(a-2*n),_>0&&(_=0)),this.x=Math.floor(r),this.y=Math.floor(_),this.p_mapViewRect.x=Math.abs(r%StageManager.instance.p_stageWidth),this.p_mapViewRect.y=Math.abs(_%StageManager.instance.p_stageHeight),this.m_tileViewRect.x=Math.abs(Math.ceil(r/this.m_mapdata.tileWidth)),this.m_tileViewRect.y=Math.abs(Math.ceil(_/this.m_mapdata.tileHeight)),this.m_tileViewRect.width=Math.ceil((Math.abs(r%MyMapData.DEFAULT_TITLESIZE)+StageManager.instance.p_stageWidth)/this.m_mapdata.tileWidth)-1,this.m_tileViewRect.height=Math.ceil((Math.abs(_%MyMapData.DEFAULT_TITLESIZE)+StageManager.instance.p_stageHeight)/this.m_mapdata.tileHeight)-1,this.m_tileViewRect.width=this.m_tileViewRect.width+this.m_tileViewRect.x>this.m_mapdata.tileCol-1?this.m_mapdata.tileCol-1-this.m_tileViewRect.x:this.m_tileViewRect.width,this.m_tileViewRect.height=this.m_tileViewRect.height+this.m_tileViewRect.y>this.m_mapdata.tileRow-1?this.m_mapdata.tileRow-1-this.m_tileViewRect.y:this.m_tileViewRect.height,this.setTile();var h=!1;(0==r||0==_||r==-(o-2*s)||_==-(a-2*n))&&(h=!0),h||(this.m_updateSIFPoint.x=this.m_mapFocusPoint.x,this.m_updateSIFPoint.y=this.m_mapFocusPoint.y,Dispatch.dispatch(e.EVENT_UPDATE_MAP_FOCUS,this.m_updateSIFPoint))}},e.prototype.setTile=function(){if(!this.m_lastTileRect.equals(this.m_tileViewRect)){for(var t=this.m_lastTileRect.x<this.m_tileViewRect.x?this.m_lastTileRect.x:this.m_tileViewRect.x,e=this.m_lastTileRect.y<this.m_tileViewRect.y?this.m_lastTileRect.y:this.m_tileViewRect.y,i=this.m_lastTileRect.x+this.m_lastTileRect.width>this.m_tileViewRect.x+this.m_tileViewRect.width?this.m_lastTileRect.x+this.m_lastTileRect.width:this.m_tileViewRect.x+this.m_tileViewRect.width,s=this.m_lastTileRect.y+this.m_lastTileRect.height>this.m_tileViewRect.y+this.m_tileViewRect.height?this.m_lastTileRect.y+this.m_lastTileRect.height:this.m_tileViewRect.y+this.m_tileViewRect.height,n=[],o=[],a=t;i>=a;a++)for(var r=e;s>=r;r++)a<this.m_tileViewRect.x||a>this.m_tileViewRect.x+this.m_tileViewRect.width||r<this.m_tileViewRect.y||r>this.m_tileViewRect.y+this.m_tileViewRect.height?n.push(a,r):o.push(a,r);var _=0;for(_=0;_<n.length;_++)this.removeMapTile(n[_],n[++_]);for(_=0;_<o.length;_++)this.addMapTile(o[_],o[++_]);SceneEffectModule.instance.checkSceneEffect(this.m_tileViewRect),this.m_lastTileRect.x=this.m_tileViewRect.x,this.m_lastTileRect.y=this.m_tileViewRect.y,this.m_lastTileRect.width=this.m_tileViewRect.width,this.m_lastTileRect.height=this.m_tileViewRect.height}},Object.defineProperty(e.prototype,"viewRect",{get:function(){return this.m_tileViewRect},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mapdata",{get:function(){return this.m_mapdata},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sceneLayer",{get:function(){return this.m_sceneLayer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"effectLayer",{get:function(){return this.m_effectLayer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mapTouchPoint",{get:function(){return this.m_mapTouchPoint},enumerable:!0,configurable:!0}),e.EVENT_UPDATE_MAP_FOCUS="EVENT_UPDATE_MAP_FOCUS",e}(egret.DisplayObjectContainer);__reflect(MyMapVo.prototype,"MyMapVo");var MapItemGroup=function(t){function e(){var e=t.call(this)||this;return e.m_loadUrlDic={},e.m_loadUrlArr=[],e.m_loadLength=0,e.m_loadIndex=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"effectArr",{set:function(t){this.m_groupArr=t,this.m_loadUrlArr=[];for(var e=0;e<t.length;e++)this.m_csvData=SceneEffectJson.getData(t[e].effect_id),this.m_mapEffectUrl=TextureFrom.SCENEEFFECT+PublicCon.PATH_SCENE_EFFECT+this.m_csvData.folderPath+"/stand.png",-1==this.m_loadUrlArr.indexOf(this.m_mapEffectUrl)&&(this.m_loadUrlArr.push(this.m_mapEffectUrl),this.m_loadUrlDic[this.m_mapEffectUrl]=t[e].isScrollThing);this.m_loadLength=this.m_loadUrlArr.length;for(var i=0;i<this.m_loadUrlArr.length;i++)this.m_loadUrlDic[this.m_loadUrlArr[i]]?TextureLoadManager.instance.requestLoadTextureMap(this.m_loadUrlArr[i],this,LoaderPriority.MAPUNIT,!0):TextureLoadManager.instance.requestLoadTextureAtlas(this.m_loadUrlArr[i],this,LoaderPriority.MAPUNIT,!0)},enumerable:!0,configurable:!0}),e.prototype.onloadComplete=function(t){-1!=this.m_loadUrlArr.indexOf(t)&&(this.m_loadIndex++,this.checkProgress())},e.prototype.checkProgress=function(){if(this.m_loadIndex>=this.m_loadLength){for(var t,e,i=0;i<this.m_groupArr.length;i++)e=1==this.m_groupArr[i].layer?SceneEffectModule.instance.weatherEffectDic:SceneEffectModule.instance.sceneEffectDic,null==e[this.m_groupArr[i].only_id]&&(t=new MapItemMc,this.parent&&this.parent.addChildAt(t,this.parent.getChildIndex(this)),t.show(this.m_groupArr[i]),e[this.m_groupArr[i].only_id]=t);this.parent&&this.parent.removeChild(this)}},e.prototype.destory=function(){for(var t=0;t<this.m_loadUrlArr.length;t++)TextureLoadManager.instance.closeLoad(this.m_loadUrlArr[t],this)},e}(egret.Sprite);__reflect(MapItemGroup.prototype,"MapItemGroup",["ITextureLoadEvent"]);var MapItemMc=function(t){function e(){var e=t.call(this)||this;return e.easeModes=[{label:"Linear.easeNone",data:Linear.easeNone},{label:"Back.easeOut",data:Back.easeOut},{label:"Back.easeIn",data:Back.easeIn},{label:"Back.easeInOut",data:Back.easeInOut},{label:"Bounce.easeOut",data:Bounce.easeOut},{label:"Bounce.easeIn",data:Bounce.easeIn},{label:"Bounce.easeInOut",data:Bounce.easeInOut},{label:"Circ.easeOut",data:Circ.easeOut},{label:"Circ.easeIn",data:Circ.easeIn},{label:"Circ.easeInOut",data:Circ.easeInOut},{label:"Cubic.easeOut",data:Cubic.easeOut},{label:"Cubic.easeIn",data:Cubic.easeIn},{label:"Cubic.easeInOut",data:Cubic.easeInOut},{label:"Elastic.easeOut",data:Elastic.easeOut},{label:"Elastic.easeIn",data:Elastic.easeIn},{label:"Elastic.easeInOut",data:Elastic.easeInOut},{label:"Expo.easeOut",data:Expo.easeOut},{label:"Expo.easeIn",data:Expo.easeIn},{label:"Expo.easeInOut",data:Expo.easeInOut},{label:"Quad.easeOut",data:Quad.easeOut},{label:"Quad.easeIn",data:Quad.easeIn},{label:"Quad.easeInOut",data:Quad.easeInOut},{label:"Quart.easeOut",data:Quart.easeOut},{label:"Quart.easeIn",data:Quart.easeIn},{label:"Quart.easeInOut",data:Quart.easeInOut},{label:"Quint.easeOut",data:Quint.easeOut},{label:"Quint.easeIn",data:Quint.easeIn},{label:"Quint.easeInOut",data:Quint.easeInOut},{label:"Sine.easeOut",data:Sine.easeOut},{label:"Sine.easeIn",data:Sine.easeIn},{label:"Sine.easeInOut",data:Sine.easeInOut}],e.m_lastFocus=new egret.Point(0,0),Dispatch.register(MyMapVo.EVENT_UPDATE_MAP_FOCUS,e.onUpdateFocus,e),e}return __extends(e,t),e.prototype.onUpdateFocus=function(t){if(null!=this.m_display&&null!=this.m_effectVo&&this.m_effectVo.isScrollThing&&1==this.m_effectVo.layer){var e=0,i=0;return 0==this.m_lastFocus.x&&0==this.m_lastFocus.y?(this.m_lastFocus.x=t.x,void(this.m_lastFocus.y=t.y)):void((this.m_lastFocus.x!=t.x||this.m_lastFocus.y!=t.y)&&(e=this.m_lastFocus.x-t.x,i=this.m_lastFocus.y-t.y,this.m_display.offsetX+=e,this.m_display.offsetY+=i,this.m_lastFocus.x=t.x,this.m_lastFocus.y=t.y))}},e.prototype.update=function(){this.m_display instanceof SceneEffectItem&&(this.m_display.effectVo=this.m_effectVo,this.m_display.show()),this.tweenOnMove()},e.prototype.show=function(t){if(!this.m_display)if(this.m_effectVo=new SceneEffectVo,this.m_effectVo.setData(t),this.m_csvData=SceneEffectJson.getData(this.m_effectVo.effect_id),this.m_mapEffectUrl=TextureFrom.SCENEEFFECT+PublicCon.PATH_SCENE_EFFECT+this.m_csvData.folderPath+"/stand.png",this.m_effectVo.isScrollThing){if(null==TexturePool.instance.getTextureMap(this.m_mapEffectUrl))return;var e=TexturePool.instance.getTextureMap(this.m_mapEffectUrl);this.m_display=new ScrollImage(e,StageManager.instance.p_stageWidth,StageManager.instance.p_stageHeight),this.m_display.speedX=this.m_effectVo.xSpeed,this.m_display.speedY=this.m_effectVo.ySpeed,this.parent&&(this.parent.addChildAt(this.m_display,this.parent.getChildIndex(this)),this.parent.removeChild(this))}else this.m_display=new SceneEffectItem,this.m_display.effectVo=t,this.m_display.setSceneEffectId(this.m_effectVo.effect_id),this.parent&&(this.parent.addChildAt(this.m_display,this.parent.getChildIndex(this)),this.parent.removeChild(this))},e.prototype.tweenOnMove=function(){if(this.m_display){if(this.resetTweenMove(),0==this.m_effectVo.pointX&&0==this.m_effectVo.pointY)return;var t,e=Linear.easeNone;for(var i in this.easeModes)if(t=this.easeModes[i],t.label==this.m_effectVo.tweenEase){e=t.data;break}this.m_timeline||(this.m_timeline=new TimelineMax),this.m_timeline.repeat(this.m_effectVo.tweenNum>=999?-1:this.m_effectVo.tweenNum),this.m_timeline.repeatDelay(this.m_effectVo.tweenDelay),this.m_timeline.yoyo(1==this.m_effectVo.tweenType),this.m_timeline.delay(this.m_effectVo.delay),0!=this.m_effectVo.tweenIn&&0!=this.m_effectVo.tweenOut&&(this.m_display.alpha=this.m_effectVo.tweenReversed?this.m_effectVo.alpha:0),this.m_timeline.append(TweenLite.to(this.m_display,this.m_effectVo.tweenMove,{x:this.m_effectVo.pointX,y:this.m_effectVo.pointY,ease:e})),0!=this.m_effectVo.tweenIn&&this.m_timeline.append(TweenLite.to(this.m_display,this.m_effectVo.tweenIn,{alpha:this.m_effectVo.alpha,ease:Linear.easeNone}),this.m_effectVo.tweenReversed?-this.m_effectVo.tweenIn:-this.m_effectVo.tweenMove),0!=this.m_effectVo.tweenOut&&this.m_timeline.append(TweenLite.to(this.m_display,this.m_effectVo.tweenOut,{alpha:0,ease:Linear.easeNone}),this.m_effectVo.tweenReversed?-this.m_effectVo.tweenMove:-this.m_effectVo.tweenOut)}},e.prototype.tweenOnScale=function(){if(this.m_display){if(this.resetTweenScale(),0==this.m_effectVo.pointScaleX&&0==this.m_effectVo.pointScaleY)return;var t,e=Linear.easeNone;for(var i in this.easeModes)if(t.label==this.m_effectVo.tweenScaleEase){e=t.data;break}this.m_tweenOnScale||(this.m_tweenOnScale={},this.m_tweenOnScale.target=this.m_display),this.m_tweenOnScale.scaleX=100*this.m_effectVo.scaleX,this.m_tweenOnScale.scaleY=100*this.m_effectVo.scaleY,this.m_tweenOnScale.tweenScale=this.m_effectVo.tweenScale,this.m_scaleTween=TweenMax.to(this.m_tweenOnScale,this.m_tweenOnScale.tweenScale,{scaleX:this.m_effectVo.pointScaleX,scaleY:this.m_effectVo.pointScaleY,repeat:this.m_effectVo.tweenScaleNum>=999?-1:this.m_effectVo.tweenScaleNum,yoyo:1==this.m_effectVo.tweenScaleType,onUpdate:this.done,ease:e,delay:this.m_effectVo.delay})}},e.prototype.done=function(){this.m_tweenOnScale.target.scaleX=.01*this.m_tweenOnScale.scaleX,this.m_tweenOnScale.target.scaleY=.01*this.m_tweenOnScale.scaleY},e.prototype.resetTweenMove=function(){this.m_timeline&&(this.m_timeline.stop(),this.m_timeline.clear(),this.m_timeline=null),null!=this.m_display&&(this.m_display.alpha=this.m_effectVo.alpha,this.m_display.x=this.x,this.m_display.y=this.y)},e.prototype.resetTweenScale=function(){this.m_tweenOnScale&&TweenLite.killTweensOf(this.m_tweenOnScale),this.m_scaleTween=null,null!=this.m_display&&(this.m_display.scaleX=this.m_effectVo.scaleX,this.m_display.scaleY=this.m_effectVo.scaleY)},e.prototype.advanceTime=function(t){this.m_display instanceof ScrollImage&&(0!=this.m_effectVo.xSpeed&&(this.m_display.speedX+=this.m_effectVo.xSpeed),0!=this.m_effectVo.ySpeed&&(this.m_display.speedY+=this.m_effectVo.ySpeed)),0!=this.m_effectVo.rotationSpeed&&(this.m_display.rotation+=.01*this.m_effectVo.rotationSpeed)},Object.defineProperty(e.prototype,"image",{get:function(){return this.m_display},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"effectVo",{get:function(){return this.m_effectVo},set:function(t){this.m_effectVo=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentFrame",{set:function(t){null!=this.m_display},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this.$getX()},set:function(t){null!=this.m_display&&(this.m_display.x=Math.floor(t)),this.$setX(Math.floor(t))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.$getY()},set:function(t){null!=this.m_display&&(this.m_display.y=Math.floor(t)),this.$setY(Math.floor(t))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.m_display.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.m_display.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"display",{get:function(){return this.m_display},enumerable:!0,configurable:!0}),e.prototype.destory=function(){if(this.resetTweenMove(),this.resetTweenScale(),this.m_display){if(this.m_display instanceof SceneEffectItem)return this.m_display.destory(),void(this.m_display=null);this.m_display.removeFromParent(),this.m_display.destory(),this.m_display=null}this.m_effectVo=null},e}(egret.Sprite);__reflect(MapItemMc.prototype,"MapItemMc",["IAnimatable"]);var AttrSignJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},t.FileName="attr_sign",t}();__reflect(AttrSignJson.prototype,"AttrSignJson"),window.AttrSignJson=AttrSignJson;var SceneEffectConfig=function(){function t(){}return t.blendModeList=[{blendMode:"add"},{blendMode:"none"},{blendMode:"normal"},{blendMode:"auto"},{blendMode:"multiply"},{blendMode:"screen"},{blendMode:"erase"}],t.easeModes=[{label:"Linear.easeNone",data:Linear.easeNone},{label:"Back.easeOut",data:Back.easeOut},{label:"Back.easeIn",data:Back.easeIn},{label:"Back.easeInOut",data:Back.easeInOut},{label:"Bounce.easeOut",data:Bounce.easeOut},{label:"Bounce.easeIn",data:Bounce.easeIn},{label:"Bounce.easeInOut",data:Bounce.easeInOut},{label:"Circ.easeOut",data:Circ.easeOut},{label:"Circ.easeIn",data:Circ.easeIn},{label:"Circ.easeInOut",data:Circ.easeInOut},{label:"Cubic.easeOut",data:Cubic.easeOut},{label:"Cubic.easeIn",data:Cubic.easeIn},{label:"Cubic.easeInOut",data:Cubic.easeInOut},{label:"Elastic.easeOut",data:Elastic.easeOut},{label:"Elastic.easeIn",data:Elastic.easeIn},{label:"Elastic.easeInOut",data:Elastic.easeInOut},{label:"Expo.easeOut",data:Expo.easeOut},{label:"Expo.easeIn",data:Expo.easeIn},{label:"Expo.easeInOut",data:Expo.easeInOut},{label:"Quad.easeOut",data:Quad.easeOut},{label:"Quad.easeIn",data:Quad.easeIn},{label:"Quad.easeInOut",data:Quad.easeInOut},{label:"Quart.easeOut",data:Quart.easeOut},{label:"Quart.easeIn",data:Quart.easeIn},{label:"Quart.easeInOut",data:Quart.easeInOut},{label:"Quint.easeOut",data:Quint.easeOut},{label:"Quint.easeIn",data:Quint.easeIn},{label:"Quint.easeInOut",data:Quint.easeInOut},{label:"Sine.easeOut",data:Sine.easeOut},{label:"Sine.easeIn",data:Sine.easeIn},{label:"Sine.easeInOut",data:Sine.easeInOut}],t}();__reflect(SceneEffectConfig.prototype,"SceneEffectConfig");var SceneEffectItem=function(t){function e(){var e=t.call(this)||this;return e.m_isWeatherEffect=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"mHeight",{get:function(){return this.m_effectVo?this.m_effectVo.height:this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mWidth",{get:function(){return this.m_effectVo?this.m_effectVo.width:this.width},enumerable:!0,configurable:!0}),e.prototype.onloadComplete=function(e){t.prototype.onloadComplete.call(this,e),this.setEffectData()},e.prototype.setEffectData=function(){this.m_effectVo&&this.show(),this.m_effectVo&&1==this.m_effectVo.layer&&(this.m_isWeatherEffect=!0,0==this.m_effectVo.pointX&&0==this.m_effectVo.pointY&&Dispatch.register(CameraModule.EVENT_UPDATE_FOCUS,this.onMapFocusUpdate,this))},e.prototype.onMapFocusUpdate=function(){this.y=this.m_effectVo.y,this.x=this.m_effectVo.x},Object.defineProperty(e.prototype,"vo",{get:function(){return this.m_effectVo},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"effectVo",{set:function(t){this.m_effectVo||(this.m_effectVo=new SceneEffectVo,this.m_effectVo.setData(t))},enumerable:!0,configurable:!0}),e.prototype.show=function(){this.alpha=this.m_effectVo.alpha,this.blendMode=this.m_effectVo.blendMode,this.scaleX=this.m_effectVo.scaleX,this.scaleY=this.m_effectVo.scaleY,this.rotation=this.m_effectVo.rotation,this.mc.fps=0==this.m_effectVo.fps?12:this.m_effectVo.fps,this.onTweenMove(),this.onTweenScale(),this.parent},e.prototype.resetMove=function(t){void 0===t&&(t=0),this.resetTweenMove(),TweenLite.delayedCall(.001*t,this.onTweenMove.bind(this))},e.prototype.onTweenMove=function(){if(this.m_mc){if(this.resetTweenMove(),0==this.m_effectVo.pointX&&0==this.m_effectVo.pointY)return;this.m_mc.touchEnabled=!1;var t,e=Linear.easeNone;for(var i in SceneEffectConfig.easeModes)if(t=SceneEffectConfig.easeModes[i],t.label==this.m_effectVo.tweenEase){e=t.data;break}this.m_timeLine||(this.m_timeLine=new TimelineMax),this.m_timeLine.repeat(this.m_effectVo.tweenNum>=999?-1:this.m_effectVo.tweenNum),this.m_timeLine.repeatDelay(this.m_effectVo.tweenDelay),this.m_timeLine.yoyo(1==this.m_effectVo.tweenType),this.m_timeLine.delay(this.m_effectVo.delay),0!=this.m_effectVo.tweenIn&&0!=this.m_effectVo.tweenOut&&(this.alpha=this.m_effectVo.tweenReversed?this.m_effectVo.alpha:0),this.m_timeLine.append(TweenLite.to(this,this.m_effectVo.tweenMove,{x:this.m_effectVo.pointX,y:this.m_effectVo.pointY,ease:e})),0!=this.m_effectVo.tweenIn&&this.m_timeLine.append(TweenLite.to(this,this.m_effectVo.tweenIn,{alpha:this.m_effectVo.alpha,ease:Linear.easeNone}),this.m_effectVo.tweenReversed?-this.m_effectVo.tweenIn:-this.m_effectVo.tweenMove),0!=this.m_effectVo.tweenOut&&this.m_timeLine.append(TweenLite.to(this,this.m_effectVo.tweenOut,{alpha:0,ease:Linear.easeNone}),this.m_effectVo.tweenReversed?-this.m_effectVo.tweenMove:-this.m_effectVo.tweenOut)}},e.prototype.onTweenScale=function(){if(this.m_mc){if(this.resetTweenScale(),0==this.m_effectVo.pointScaleX&&0==this.m_effectVo.pointScaleY)return;var t,e=Linear.easeNone;for(var i in SceneEffectConfig.easeModes)if(t=SceneEffectConfig.easeModes[i],t.label==this.m_effectVo.tweenScaleEase){e=t.data;break}this.m_tweenOnScale||(this.m_tweenOnScale={},this.m_tweenOnScale.target=this),this.m_tweenOnScale.scaleX=100*this.m_effectVo.scaleX,this.m_tweenOnScale.scaleY=100*this.m_effectVo.scaleY,this.m_tweenOnScale.tweenScale=this.m_effectVo.tweenScale,this.m_scaleTween=TweenMax.to(this.m_tweenOnScale,this.m_tweenOnScale.tweenScale,{scaleX:this.m_effectVo.pointScaleX,scaleY:this.m_effectVo.pointScaleY,repeat:this.m_effectVo.tweenScaleNum>=999?-1:this.m_effectVo.tweenScaleNum,yoyo:1==this.m_effectVo.tweenScaleType,onUpdate:this.done.bind(this),ease:e,delay:this.m_effectVo.delay})}},e.prototype.done=function(){this.m_tweenOnScale.target.scaleX=.01*this.m_tweenOnScale.scaleX,this.m_tweenOnScale.target.scaleY=.01*this.m_tweenOnScale.scaleY},e.prototype.resetTweenMove=function(){this.m_timeLine&&(this.m_timeLine.stop(),this.m_timeLine.clear(),this.m_timeLine=null),null!=this.m_mc&&(TweenLite.killTweensOf(this.m_mc),this.alpha=this.m_effectVo.alpha,this.x=this.m_effectVo.x,this.y=this.m_effectVo.y)},e.prototype.resetTweenScale=function(){this.m_tweenOnScale&&TweenLite.killTweensOf(this.m_tweenOnScale),this.m_scaleTween=null,null!=this.m_mc&&(this.m_mc.scaleX=this.m_effectVo.scaleX,this.m_mc.scaleY=this.m_effectVo.scaleY)},e.prototype.hide=function(){this.resetTweenMove(),this.resetTweenScale()},e.prototype.destory=function(){Dispatch.remove(CameraModule.EVENT_UPDATE_FOCUS,this.onMapFocusUpdate,this),this.m_timeLine&&(this.m_timeLine.stop(),this.m_timeLine.clear(),this.m_timeLine=null),this.m_tweenOnScale&&TweenLite.killTweensOf(this.m_tweenOnScale),t.prototype.destory.call(this)},Object.defineProperty(e.prototype,"x",{get:function(){return this.$getX()},set:function(t){if(this.m_isWeatherEffect){var e=MyMapModule.instance.map.p_mapViewRect.x;t-=e,0>t&&(t+=StageManager.instance.p_stageWidth),t%=StageManager.instance.p_stageWidth}this.$setX(Math.floor(t))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.$getY()},set:function(t){if(this.m_isWeatherEffect){var e=MyMapModule.instance.map.p_mapViewRect.y;t-=e,0>t&&(t+=StageManager.instance.p_stageHeight),t%=StageManager.instance.p_stageHeight}this.$setY(Math.floor(t))},enumerable:!0,configurable:!0}),e}(SceneEffectBase);__reflect(SceneEffectItem.prototype,"SceneEffectItem");var SceneEffectModule=function(){function t(){this.m_sceneEffectDic={},this.m_weatherEffectDic={},this.m_mapItemGroupDic={},this.m_effectIndex=1,this.m_mapItemGroupIndex=0,this.m_tileViewRect=new egret.Rectangle,this.m_effectRect=new egret.Rectangle,this.m_index=0,this.m_checkNpcPoint=new egret.Point}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(t){this.m_downEffectLayer=t,this.m_liveEffectLayer=SceneLayerModule.instance.liveThingsLayer,this.m_upEffectLayer=SceneLayerModule.instance.upEffectLayer,this.m_weatherEffectLayer=SceneLayerModule.instance.weatherLayer,this.m_downEffectLayer.touchEnabled=!1,this.m_weatherEffectLayer.touchEnabled=!1,this.m_mapdata=MyMapModule.instance.map.mapdata,Dispatch.register(StageManager.EVENT_STAGE_RESIZE,this.stageResize,this)},t.prototype.checkSceneEffect=function(t){this.m_index++;this.m_tileViewRect.x=t.x*this.m_mapdata.tileWidth,this.m_tileViewRect.y=t.y*this.m_mapdata.tileHeight,this.m_tileViewRect.width=(t.width+1)*this.m_mapdata.tileWidth,this.m_tileViewRect.height=(t.height+1)*this.m_mapdata.tileHeight;var e;this.checkMapEffect(),this.checkNpc(),this.checkSceneDoor();for(var i=0;i<this.m_mapdata.mapEffectData.length;i++)if(e=this.m_mapdata.mapEffectData[i],e&&e.length>0)for(var s=0;s<e.length;s++)if(1!=e[s].layer&&(this.m_effectRect.x=e[s].x+(1-e[s].scaleX)*e[s].width,this.m_effectRect.y=e[s].y+(1-e[s].scaleY)*e[s].height,this.m_effectRect.width=e[s].width*e[s].scaleX,this.m_effectRect.height=e[s].height*e[s].scaleY,(this.m_effectRect.intersects(this.m_tileViewRect)||e[s].hasOwnProperty("isCheck")&&!e[s].isCheck)&&!this.m_sceneEffectDic[e[s].only_id])){this.creatEffectItemGroup(e);break}},t.prototype.checkMapEffect=function(t){if(void 0===t&&(t=!1),t){var e=MyMapModule.instance.map.viewRect;this.m_tileViewRect.x=e.x*this.m_mapdata.tileWidth,this.m_tileViewRect.y=e.y*this.m_mapdata.tileHeight,this.m_tileViewRect.width=(e.width+1)*this.m_mapdata.tileWidth,this.m_tileViewRect.height=(e.height+1)*this.m_mapdata.tileHeight}var i,s;for(var n in this.m_sceneEffectDic)if(this.m_sceneEffectDic[n]&&(this.m_sceneEffectDic[n]instanceof SceneEffectItem?i=this.m_sceneEffectDic[n]:this.m_sceneEffectDic[n]instanceof MapItemMc&&this.m_sceneEffectDic[n].display instanceof SceneEffectItem&&(i=this.m_sceneEffectDic[n].display)),i)if(s=i.hitRect,0==s.x&&0==s.y&&0==s.width&&0==s.height&&(s.x=i.x,s.y=i.y,s.width=1,s.height=1),s.intersects(this.m_tileViewRect)||i.vo&&!i.vo.isCheck){if(!i.isShow){if(i.isShow=!0,!i.mc)return;i.mc.play(),i.vo?this.getLayer(i.vo.layer).addChild(i):this.m_downEffectLayer.addChild(i)}}else if(i.isShow){if(!i.mc)return;i.isShow=!1,i.mc.stop(),i.removeFromParent()}},t.prototype.checkNpc=function(t){if(void 0===t&&(t=!1),t){var e=MyMapModule.instance.map.viewRect;this.m_tileViewRect.x=e.x*this.m_mapdata.tileWidth,this.m_tileViewRect.y=e.y*this.m_mapdata.tileHeight,this.m_tileViewRect.width=(e.width+1)*this.m_mapdata.tileWidth,this.m_tileViewRect.height=(e.height+1)*this.m_mapdata.tileHeight}this.m_npcDic=SceneItemModule.instance.npcDict;var i;for(var s in this.m_npcDic)if(i=this.m_npcDic[s],this.m_checkNpcPoint.x=i.x,this.m_checkNpcPoint.y=i.y,i.isShow){if(!this.m_tileViewRect.containsPoint(this.m_checkNpcPoint)){if(!i.mc)return;DisplayObjectUtils.removeFormParent(i),i.isShow=!1}}else this.m_tileViewRect.containsPoint(this.m_checkNpcPoint)&&(SceneLayerModule.instance.liveThingsLayer.addChild(i),i.isShow=!0)},t.prototype.checkSceneDoor=function(){},t.prototype.resetMapdata=function(t){this.m_mapdata=t,this.checkWeatherEffect(),this.checkNpc()},t.prototype.checkWeatherEffect=function(){if(GameManager.performanceRate!=PerformanceRateEnum.LOW)for(var t,e=0;e<this.m_mapdata.mapEffectData.length;e++)if(t=this.m_mapdata.mapEffectData[e],t&&t.length>0)for(var i=0;i<t.length;i++)if(1==t[i].layer){this.creatEffectItemGroup(t);break}},t.prototype.creatEffectItemGroup=function(t){var e=new MapItemGroup,i=t[0].layer;this.getLayer(i).addChild(e),e.effectArr=t,this.m_mapItemGroupDic[this.m_mapItemGroupIndex]=e,this.m_mapItemGroupIndex++},t.prototype.getLayer=function(t){var e;return e=1==t?this.m_weatherEffectLayer:2==t?this.m_liveEffectLayer:3==t?this.m_upEffectLayer:this.m_downEffectLayer},t.prototype.creatScrollEffect=function(t,e,i,s,n,o,a,r){void 0===e&&(e=0),void 0===i&&(i=0),void 0===s&&(s=0),void 0===n&&(n=0),void 0===o&&(o=1),void 0===a&&(a=1),void 0===r&&(r=null),this.m_effectIndex++;var _=new SceneEffectVo;_.only_id=this.m_effectIndex,_.effect_id=t,_.x=e,_.y=i,_.width=s,_.height=n,_.xSpeed=o,_.ySpeed=a,_.isScrollThing=!0;var h=[];h.push(_),this.creatEffectItemGroup(h)},t.prototype.creatEffectItem=function(t){this.m_effectIndex++;var e=new SceneEffectVo;e.only_id=this.m_effectIndex,e.effect_id=t;var i=[];i.push(e),this.creatEffectItemGroup(i)},t.prototype.creatSceneEffect=function(t,e,i,s){void 0===s&&(s=-1);var n=new SceneEffectItem;this.m_onlyId=Number(String(this.m_mapdata.sceneId)+String(1e3+this.m_effectIndex)),n.x=e,n.y=i,n.setSceneEffectId(t),n.isShow=!1,this.m_sceneEffectDic[this.m_onlyId]=n,this.m_downEffectLayer.addChild(n),this.m_effectIndex++},t.prototype.stageResize=function(){var t;for(var e in this.m_weatherEffectDic)t=this.m_weatherEffectDic[e],t.display instanceof ScrollImage&&t.display.resetData(StageManager.instance.p_stageWidth,StageManager.instance.p_stageHeight)},Object.defineProperty(t.prototype,"sceneEffectDic",{get:function(){return this.m_sceneEffectDic},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"weatherEffectDic",{get:function(){return this.m_weatherEffectDic},enumerable:!0,configurable:!0}),t.prototype.cleanMapEffect=function(){var t;for(var e in this.m_sceneEffectDic)t=this.m_sceneEffectDic[e],t.destory(),delete this.m_sceneEffectDic[e];for(var i in this.m_weatherEffectDic)t=this.m_weatherEffectDic[i],t.destory(),delete this.m_weatherEffectDic[i];for(var s in this.m_mapItemGroupDic)t=this.m_mapItemGroupDic[s],t.destory(),delete this.m_mapItemGroupDic[s]},Object.defineProperty(t.prototype,"weatherEffectLayer",{get:function(){return this.m_weatherEffectLayer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"upEffectLayer",{get:function(){return this.m_upEffectLayer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"liveEffectLayer",{get:function(){return this.m_liveEffectLayer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"downEffectLayer",{get:function(){return this.m_downEffectLayer},enumerable:!0,configurable:!0}),t}();__reflect(SceneEffectModule.prototype,"SceneEffectModule");var SceneEffectVo=function(){function t(){this.isCreat=!1,this.isCheck=!0,this.blendMode="auto",this.alpha=1,this.scaleX=1,this.scaleY=1,this.rotation=0,this.r=255,this.g=255,this.b=255,this.isScrollThing=!1,this.xSpeed=0,this.ySpeed=0,this.rotationSpeed=0,this.width=0,this.height=0,this.direct=-1,this.event_id=0,this.layer=0,this.part_id=0}return t.prototype.setData=function(t){this.clear();var e=this;for(var i in t)e.hasOwnProperty(i)&&(e[i]=t[i])},t.prototype.clear=function(){this.effect_id=0,this.only_id=0,this.teamIndex=0,this.isCreat=!1,this.name="",this.x=0,this.y=0,this.blendMode="",this.alpha=0,this.scaleX=0,this.scaleY=0,this.fps=0,this.rotation=0,this.r=0,this.g=0,this.b=0,this.isFade=!1,this.delay=0,this.tweenType=0,this.tweenNum=0,this.tweenDelay=0,this.tweenMove=0,this.tweenIn=0,this.tweenOut=0,this.pointX=0,this.pointY=0,this.tweenEase="",this.tweenScaleEase="",this.tweenReversed=!1,this.width=0,this.height=0,this.pointScaleX=0,this.pointScaleY=0,this.tweenScale=0,this.tweenScaleNum=0,this.tweenScaleType=0,this.isCheck=!1,this.event_id=0,this.layer=0,this.part_id=0},t}();__reflect(SceneEffectVo.prototype,"SceneEffectVo");var ShockManager=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.shockScreen=function(){StageManager.instance.scenelayer.x=0,StageManager.instance.scenelayer.y=0,this.shockHandler(StageManager.instance.scenelayer,20,20,20,100)},t.prototype.shockHandler=function(t,e,i,s,n){egret.Tween.removeTweens(t);for(var o=t.x,a=t.y,r=egret.Tween.get(t),_=n/s,h=0;s>h;h++){r.wait(_);var l=o+Math.floor(Math.random()*e*2)-e,c=a+Math.floor(Math.random()*i*2)-i;r.to({x:l,y:c},0)}r.wait(_).to({x:o,y:a},0)},t.prototype.shake=function(t){if(null==t)return null;var e=t.dis.y;null!=t.anchorOffsetX?t.dis.anchorOffsetX=t.anchorOffsetX:null!=t.anchorOffsetY?t.dis.anchorOffsetY=t.anchorOffsetY:(t.dis.anchorOffsetX=.5*t.dis.width,t.dis.anchorOffsetY=.5*t.dis.height);var i=egret.Tween.get(t.dis,{loop:t.bLoop}).wait(t.duration).to({y:e-20,scaleX:1.4,scaleY:1.1},50).wait(20).to({y:e-20,scaleX:1.2,scaleY:1.05},50).wait(20).to({y:e,scaleX:1,scaleY:1},50).wait(40).to({scaleX:.8,scaleY:.7},50).wait(20).to({scaleX:1,scaleY:1},50).wait(20).to({scaleX:.9,scaleY:.9},50).wait(20).to({scaleX:1,scaleY:1},50);return null!=t.callback&&i.call(t.callback,t.thisObj),i},t.prototype["float"]=function(t,e){void 0===e&&(e=!0);var i=egret.Tween.get(t,{loop:e}).to({y:-20},500).to({y:0},500);return i},t}();__reflect(ShockManager.prototype,"ShockManager");var ShockData=function(){function t(t,e,i,s){void 0===e&&(e=!0),this.bLoop=!0,this.duration=1e3,this.dis=t,this.bLoop=e,this.callback=i,this.thisObj=s}return t}();__reflect(ShockData.prototype,"ShockData");var SkillAssembly=function(){function t(t,e,i){this.m_fromSkillUnit=t,this.assemblyId=e,this.partId=i,this.templete=SkillAssemblyJson.jsonData,this.assemblyId>=0&&this.createSkillCell()}return t.prototype.createSkillCell=function(){if(null==this.templete[this.assemblyId])throw new Error("不存在 this.assemblyId："+this.assemblyId);this.m_skillCellList=new Array(this.templete[this.assemblyId].length);for(var t=0,e=0;e<this.m_skillCellList.length;e++){if(null==this.templete[this.assemblyId]||null==this.templete[this.assemblyId][e])throw new Error("技能 "+this.m_fromSkillUnit.skillId+" 不存在 this.assemblyId:"+this.assemblyId+" 或 idx:"+e+"配置");t=Number(this.m_fromSkillUnit.skillPlayer&&this.m_fromSkillUnit.skillPlayer instanceof AvatarPlayer&&this.templete[this.assemblyId][e].skillCellID.length>1?this.templete[this.assemblyId][e].skillCellID[this.m_fromSkillUnit.skillPlayer.playerData.sex]:this.templete[this.assemblyId][e].skillCellID[0]),this.m_skillCellList[e]=new SkillCell(this.m_fromSkillUnit,this,this.assemblyId,e,t)}},t.prototype.playAssembly=function(){if(this.assemblyId<0)return void this.m_fromSkillUnit.finishAssembly(this);this.m_finishNum=0;for(var t=0;t<this.m_skillCellList.length;t++)1==this.m_skillCellList[t].data.otherInVisible&&this.m_fromSkillUnit.skillPlayer instanceof AvatarOtherPlayer?this.m_skillCellList[t].onSkillFinish():this.m_skillCellList[t].playSkillCell()
},t.prototype.changeRound=function(){if(!(this.assemblyId<0))for(var t=0;t<this.m_skillCellList.length;t++)this.m_skillCellList[t].changeRound()},t.prototype.finishAll=function(){if(this.assemblyId<0)return void this.m_fromSkillUnit.finishAssembly(this);for(var t=0;t<this.m_skillCellList.length;t++)this.m_skillCellList[t].onSkillFinish()},t.prototype.finishCell=function(t){this.m_finishNum++,this.m_finishNum==this.m_skillCellList.length&&(this.m_fromSkillUnit.finishAssembly(this),null!=this.finishCallBack&&this.finishCallBack())},t.prototype.destory=function(){for(;this.m_skillCellList&&this.m_skillCellList.length>0;){var t=this.m_skillCellList[0];t.destory(),t=null,this.m_skillCellList&&this.m_skillCellList.splice(0,1)}this.m_fromSkillUnit=null,this.templete=null,this.m_skillCellList=null},t}();__reflect(SkillAssembly.prototype,"SkillAssembly");var SkillBase=function(){function t(e){this.m_direction=3,this.m_finishNum=0,this.startRound=0,this.skillFrom=SkillEnum.SKILL_FROM_NORMAL,t.pid++,this.skillResId=e,this.m_targetPoint=new egret.Point,this.m_skillUnitList=[]}return Object.defineProperty(t.prototype,"skillActiveSkillId",{get:function(){return this.m_activeSkillId},set:function(t){this.m_activeSkillId=t,this.m_csvActiveSkillUnit=ActiveSkillJson.getData(this.m_activeSkillId)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"skillResId",{get:function(){return this.m_skillResId},set:function(t){this.m_skillResId=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"skillPlayer",{get:function(){return this.m_skillPlayer},set:function(t){this.m_skillPlayer=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"skillTargetList",{get:function(){return this.m_skillTargetList},set:function(t){this.m_skillTargetList=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"round",{get:function(){return this.m_round},set:function(t){this.m_round=t},enumerable:!0,configurable:!0}),t.prototype.startAtkTo=function(t,e,i,s,n){this.skillPlayer=t,this.skillTargetList=e,this.round=1,this.m_finishNum=0,this.m_direction=n,null==s?0==this.skillTargetList.length?(this.m_settlementPoint.x=this.skillPlayer.x,this.m_settlementPoint.y=this.skillPlayer.y):(this.m_settlementPoint.x=this.skillTargetList[0].x,this.m_settlementPoint.y=this.skillTargetList[0].y):this.m_settlementPoint=s,0==this.m_skillUnitList.length&&(this.m_skillUnitList.push(new SkillUnit(this)),this.setSkillUnit(this.m_skillUnitList[this.m_skillUnitList.length-1])),this.skillTargetList.length>=1&&(this.m_targetPoint.x=this.skillTargetList[0].x,this.m_targetPoint.y=this.skillTargetList[0].y),0==this.m_skillUnitList.length&&(this.m_skillUnitList.push(new SkillUnit(this)),this.setSkillUnit(this.m_skillUnitList[this.m_skillUnitList.length-1])),this.m_skillUnitList[0].targetPoint=this.m_targetPoint,this.skillTargetList.length>=1&&(this.m_skillUnitList[0].target=this.skillTargetList[0])},t.prototype.setSkillUnit=function(t){t.skillPlayer=this.skillPlayer,t.skillPoint=this.m_settlementPoint,t.skillDirection=this.m_direction},t.prototype.onChangeTarget=function(t,e){this.m_targetPoint.x=t,this.m_targetPoint.y=e,this.m_skillUnitList[0].targetPoint=this.m_targetPoint},t.prototype.changeRound=function(t){this.round=t;for(var e=0;e<this.m_skillUnitList.length;e++)this.m_skillUnitList[e].changeRound(this.round)},t.prototype.pushHurtItem=function(t){null!=this.m_csvActiveSkillUnit&&(0==this.m_csvActiveSkillUnit.is_use_delay_time?this.m_skillUnitList[0].hitTarget(t):TweenLite.delayedCall(.001*Number(this.m_csvActiveSkillUnit.delay_time),this.m_skillUnitList[0].hitTarget.bind(this.m_skillUnitList[0]),[t]))},t.prototype.clearHurtList=function(){if(this.m_skillUnitList[0].hurtList)for(;this.m_skillUnitList[0].hurtList.length>0;)this.m_skillUnitList[0].hurtList.splice(0,1)},t.prototype.playSkill=function(){for(var t=0;t<this.m_skillUnitList.length;t++)this.m_skillUnitList[t].skillPlayer=this.skillPlayer,this.m_skillUnitList[t].skillPoint=this.m_settlementPoint,this.m_skillUnitList[t].skillDirection=this.m_direction,this.m_skillUnitList[t].play();this.startRunRound()},t.prototype.startRunRound=function(){for(var t=1;t<2*SkillJson.getData(this.m_skillResId).ForceStorageRound+20;t++)TweenLite.delayedCall(.5*t,this.changeRound.bind(this),[Number(t)])},t.prototype.stopRunRound=function(){TweenLite.killDelayedCallsTo(this.changeRound.bind(this))},t.prototype.finishSkill=function(){this.m_finishNum++,this.m_finishNum>=this.m_skillUnitList.length&&this.reset()},t.prototype.finishAll=function(){for(var t=0;t<this.m_skillUnitList.length;t++)this.m_skillUnitList[t].hitAllHp("finishAll"),this.m_skillUnitList[t].finishAll()},t.prototype.reset=function(){this.stopRunRound(),Skills.instance.removeSkill(this),this.m_skillPlayer=null,this.m_skillTargetList=null,SkillFactory.instance.recoverSkill(this)},t.prototype.destory=function(){this.m_csvActiveSkillUnit=null;for(var t=0;t<this.m_skillUnitList.length;t++)this.m_skillUnitList[t].destory();this.m_skillPlayer=null,this.m_skillTargetList=null,this.m_skillUnitList.length=0,Skills.instance.removeSkill(this)},t.pid=0,t}();__reflect(SkillBase.prototype,"SkillBase");var SkillCell=function(t){function e(e,i,s,n,o){var a=t.call(this)||this;return a.STEP_SHOW=0,a.STEP_PROCESS=1,a.STEP_DISAPPEAR=2,a.STEP_FINISH=3,a.m_frame=5,a.m_nextStep=-1,a.m_nowStep=-1,a.m_startTime=0,a.offsetX=0,a.offsetY=0,a.m_isPlayEndSett=!1,a.m_totalFrame=0,a.m_isFinished=!1,a.m_flyPoint=new egret.Point,a.m_showPoint=new egret.Point,a.m_playPoint=new egret.Point,a.m_fromSkillUnit=e,a.m_fromAssembly=i,a.m_data=new SkillCellBean(s,n,o),a.m_self=a,a.touchEnabled=!1,a.touchChildren=!1,a}return __extends(e,t),Object.defineProperty(e.prototype,"data",{get:function(){return this.m_data},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cellID",{get:function(){return this.m_data.cellID},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"assemblyIdxID",{get:function(){return this.m_data.skillAssemblyIndexID},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"assemblyID",{get:function(){return this.m_data.skillAssemblyID},enumerable:!0,configurable:!0}),e.prototype.initCellTexture=function(){var t=0;for(t=0;t<this.m_data.m_textureIdxLib.length;t++)this.m_data.m_textureIdxLib[t]&&TextureLoadManager.instance.requestLoadTextureAtlas(this.m_data.m_textureIdxLib[t],this.m_self,LoaderPriority.SKILL)},e.prototype.onloadComplete=function(t){var e=this.m_data.m_textureIdxLib.indexOf(t);this.m_nowStep==e&&(this.m_nextStep=this.m_nowStep,this.playNext())},e.prototype.playSkillCell=function(){this.initCellTexture(),this.m_nextStep=this.STEP_SHOW,this.m_data.startShowTime>0?this.m_data.playRound<=0&&DelayCallUtils.delayedCall(.001*this.m_data.startShowTime,this.startSkill,this):this.startSkill()},e.prototype.changeRound=function(){if(this.m_nextStep!=this.STEP_FINISH){var t=this.m_fromSkillUnit.round;t==this.m_data.playRound&&(this.m_nextStep=this.STEP_SHOW,this.m_data.playDelay>0?DelayCallUtils.delayedCall(.001*this.m_data.playDelay,this.startSkill,this):this.startSkill())}},e.prototype.startSkill=function(){DelayCallUtils.killDelayedCallsTo(this.startSkill,this),this.m_nextStep=this.STEP_SHOW,this.m_totalFrame=0,this.initSkillCell(),this.playNext()},e.prototype.playNext=function(t){switch(void 0===t&&(t=null),this.m_nowStep=this.m_nextStep,this.m_nowStep){case this.STEP_SHOW:this.m_nextStep=this.STEP_PROCESS,this.show();break;case this.STEP_PROCESS:this.m_nextStep=this.STEP_DISAPPEAR,this.process();break;case this.STEP_DISAPPEAR:this.m_nextStep=this.STEP_FINISH,this.disappear();break;case this.STEP_FINISH:this.m_nextStep=this.STEP_FINISH,this.finish();break;default:this.m_nextStep=this.STEP_FINISH,this.finish()}},e.prototype.initSkillCell=function(){if(this.m_fromSkillUnit){this.m_isFinished=!1,this.scaleY=1,this.m_curMC&&(this.m_curMC.x=this.m_curMC.y=0),this.leftOrRight=1,1==this.getPlayerDirection()||2==this.getPlayerDirection()||3==this.getPlayerDirection()?(this.leftOrRight=1,this.scaleX=1):5==this.getPlayerDirection()||6==this.getPlayerDirection()||7==this.getPlayerDirection()?(this.leftOrRight=-1,this.scaleX=-1):(0==this.getPlayerDirection()||4==this.getPlayerDirection())&&(1==this.getPlayerScaleX()?(this.leftOrRight=1,this.scaleX=1):(this.leftOrRight=-1,this.scaleX=-1)),0==this.m_data.directionType?(this.moveRotation=Math.PI/180*this.m_data.direction,1==this.getPlayerScaleX()):1==this.m_data.directionType?null!=this.m_fromSkillUnit.skillPlayer?this.moveRotation=(this.m_data.direction+180)/360*(2*Math.PI):this.moveRotation=this.m_data.direction/360*(2*Math.PI):2==this.m_data.directionType&&(this.moveRotation=Math.PI/180*this.m_data.direction),this.offsetX=this.m_data.settlementAndViewOffsetX,this.offsetY=this.m_data.settlementAndViewOffsetY;var t;t=this.m_data.directionPos?DirectionUtil.transformPointByDirection(this.getPlayerDirection(),new egret.Point(this.offsetX,this.offsetY)):new egret.Point(this.offsetX,this.offsetY),this.offsetX=t.x,this.offsetY=t.y,1==this.m_data.isFollow?this.m_self.rotation=DirectionUtil.changeRadianToAngle(this.moveRotation*this.m_self.scaleX):2==this.m_data.isFollow&&(this.scaleX=1),0==this.m_data.floor?(SceneLayerModule.instance.upEffectLayer.addChild(this.m_self),0==this.m_data.referToPosition?(this.m_self.x=this.offsetX*this.leftOrRight+this.getPlayerPosition().x,this.m_self.y=1*this.offsetY+this.getPlayerPosition().y-this.getPlayerPivotY(),this.m_self.y+=this.m_data.viewOffsetH):1==this.m_data.referToPosition?(this.m_self.x=this.offsetX*this.leftOrRight+this.m_fromSkillUnit.targetPoint.x,this.m_self.y=1*this.offsetY+this.m_fromSkillUnit.targetPoint.y-this.getPlayerPivotY(),this.m_self.y+=this.m_data.viewOffsetH):3==this.m_data.referToPosition&&(this.m_self.x=this.offsetX*this.leftOrRight+this.m_fromSkillUnit.skillPoint.x,this.m_self.y=1*this.offsetY+this.m_fromSkillUnit.skillPoint.y-this.getPlayerPivotY(),this.m_self.y+=this.m_data.viewOffsetH)):1==this.m_data.floor?(SceneLayerModule.instance.downEffectLayer.addChild(this.m_self),0==this.m_data.referToPosition?(this.m_self.x=this.offsetX*this.leftOrRight+this.getPlayerPosition().x,this.m_self.y=1*this.offsetY+this.getPlayerPosition().y-this.getPlayerPivotY(),this.m_self.y+=this.m_data.viewOffsetH):1==this.m_data.referToPosition?(this.m_self.x=this.offsetX*this.leftOrRight+this.m_fromSkillUnit.targetPoint.x,this.m_self.y=1*this.offsetY+this.m_fromSkillUnit.targetPoint.y-this.getPlayerPivotY(),this.m_self.y+=this.m_data.viewOffsetH):3==this.m_data.referToPosition&&(this.m_self.x=this.offsetX*this.leftOrRight+this.m_fromSkillUnit.skillPoint.x,this.m_self.y=1*this.offsetY+this.m_fromSkillUnit.skillPoint.y-this.getPlayerPivotY(),this.m_self.y+=this.m_data.viewOffsetH)):2==this.m_data.floor?(this.m_self.x=this.offsetX*this.leftOrRight+this.getPlayerPivotX(),this.m_self.y=1*this.offsetY,this.m_self.y+=this.m_data.viewOffsetH,0==this.m_data.referToPosition?this.m_fromSkillUnit.skillPlayer&&this.m_fromSkillUnit.skillPlayer.addChild(this.m_self):1==this.m_data.referToPosition?this.m_fromSkillUnit.target&&this.m_fromSkillUnit.target.addChild(this.m_self):3==this.m_data.referToPosition&&this.m_fromSkillUnit.skillPlayer&&this.m_fromSkillUnit.skillPlayer.addChild(this.m_self)):3==this.m_data.floor?(this.m_self.x=this.offsetX*this.leftOrRight+this.getPlayerPivotX(),this.m_self.y=1*this.offsetY,this.m_self.y+=this.m_data.viewOffsetH,0==this.m_data.referToPosition?this.m_fromSkillUnit.skillPlayer&&!this.m_fromSkillUnit.skillPlayer.isDestory&&this.m_fromSkillUnit.skillPlayer.addChildAt(this.m_self,this.m_fromSkillUnit.skillPlayer.getChildIndex(this.m_fromSkillUnit.skillPlayer.mc)):1==this.m_data.referToPosition?this.m_fromSkillUnit.target.addChildAt(this.m_self,0):3==this.m_data.referToPosition&&this.m_fromSkillUnit.skillPlayer&&!this.m_fromSkillUnit.skillPlayer.isDestory&&this.m_fromSkillUnit.skillPlayer.addChildAt(this.m_self,this.m_fromSkillUnit.skillPlayer.getChildIndex(this.m_fromSkillUnit.skillPlayer.mc))):4==this.m_data.floor?(SceneLayerModule.instance.liveThingsLayer.addChild(this.m_self),0==this.m_data.referToPosition?(this.m_self.x=this.offsetX*this.leftOrRight+this.getPlayerPosition().x,this.m_self.y=1*this.offsetY+this.getPlayerPosition().y-this.getPlayerPivotY(),this.m_self.y+=this.m_data.viewOffsetH):1==this.m_data.referToPosition?(this.m_self.x=this.offsetX*this.leftOrRight+this.m_fromSkillUnit.targetPoint.x,this.m_self.y=1*this.offsetY+this.m_fromSkillUnit.targetPoint.y,this.m_self.y+=this.m_data.viewOffsetH):3==this.m_data.referToPosition&&(this.m_self.x=this.offsetX*this.leftOrRight+this.m_fromSkillUnit.skillPoint.x,this.m_self.y=1*this.offsetY+this.m_fromSkillUnit.skillPoint.y-this.getPlayerPivotY(),this.m_self.y+=this.m_data.viewOffsetH)):5==this.m_data.floor?(this.m_fromSkillUnit.skillPlayer&&this.m_fromSkillUnit.skillPlayer instanceof AvatarMainPlayer&&SceneLayerModule.instance.downEffectLayer.addChild(this.m_self),this.m_self.x=PlayerManager.instance.p_mainPlayer.x,this.m_self.y=PlayerManager.instance.p_mainPlayer.y):6==this.m_data.floor?(this.m_fromSkillUnit.skillPlayer&&this.m_fromSkillUnit.skillPlayer instanceof AvatarMainPlayer&&SceneLayerModule.instance.upEffectLayer.addChild(this.m_self),this.m_self.x=PlayerManager.instance.p_mainPlayer.x,this.m_self.y=PlayerManager.instance.p_mainPlayer.y):7==this.m_data.floor&&(UIModule.instance.downUILayer3.addChild(this.m_self),this.m_self.x=.5*StageManager.instance.p_stageWidth,this.m_self.y=.5*StageManager.instance.p_stageHeight),this.m_self.alpha=1,this.m_data.shockType>0&&!(this.m_fromSkillUnit.skillPlayer instanceof AvatarOtherPlayer)&&CameraModule.instance.setCameraShake(this.m_data.shockType),this.startX=this.m_self.x,this.startY=this.m_self.y,this.m_data.flySpeed>0&&this.fly(),this.m_data.alphaStartShowTime>0&&(this.m_self.alpha=0,TweenLite.to(this.m_self,this.m_data.alphaStartShowTime/1e3,{alpha:1})),this.m_data.shadowDelay>=0&&(DelayCallUtils.killDelayedCallsTo(this.showShadow,this),DelayCallUtils.delayedCall(this.m_data.shadowDelay,this.showShadow,this))}},e.prototype.fly=function(){function t(){this.m_nextStep=this.STEP_DISAPPEAR,this.playNext()}var e;this.m_flyPoint.x=this.m_data.flySpeed*Math.cos(this.moveRotation),this.m_flyPoint.y=this.m_data.flySpeed*Math.sin(this.moveRotation),e=DirectionUtil.transformPointByDirection(this.getPlayerDirection(),this.m_flyPoint,null,!1),0==this.m_data.directionPos?(e.x=this.m_data.flySpeed*this.leftOrRight*Math.cos(this.moveRotation),e.y=this.m_data.flySpeed*Math.sin(this.moveRotation)):(e.x=e.x*this.leftOrRight,e.y=e.y),this.m_isPlayEndSett;var i=this.m_data.flyDistance/this.m_data.flySpeed;e.x=i*e.x,e.y=i*e.y,TweenLite.to(this.m_self,i*PublicCon.PATH_FPS_TIME_GAP,{x:this.m_self.x+e.x,y:this.m_self.y+e.y,ease:EaseFuncUtil.getEaseFunc(this.m_data.flyEase),onComplete:t.bind(this)})},e.prototype.show=function(){if(this.m_data.skillAssemblyUnit.PlayAction&&this.m_data.skillAssemblyUnit.PlayAction.length>=3&&this.m_fromSkillUnit.skillPlayer&&this.m_fromSkillUnit&&this.m_fromSkillUnit.skillPlayer&&!this.m_fromSkillUnit.skillPlayer.p_isDie&&(4==this.m_data.skillAssemblyUnit.PlayAction.length&&"lock"==this.m_data.skillAssemblyUnit.PlayAction[3]?(this.m_fromSkillUnit.skillPlayer.shiftToActionAndLoop(this.m_data.skillAssemblyUnit.PlayAction[0],Number(this.m_data.skillAssemblyUnit.PlayAction[1]),Number(this.m_data.skillAssemblyUnit.PlayAction[2])),this.m_fromSkillUnit.skillPlayer.lockAction=!0):(this.m_fromSkillUnit.skillPlayer.lockAction=!1,this.m_fromSkillUnit.skillPlayer.shiftToActionAndLoop(this.m_data.skillAssemblyUnit.PlayAction[0],Number(this.m_data.skillAssemblyUnit.PlayAction[1]),Number(this.m_data.skillAssemblyUnit.PlayAction[2])))),this.m_data.skillAssemblyUnit.PlayerMove&&3==this.m_data.skillAssemblyUnit.PlayerMove.length&&this.m_fromSkillUnit.skillPlayer&&this.m_fromSkillUnit.skillPlayer instanceof AvatarMainPlayer){var t,e=Number(this.m_data.skillAssemblyUnit.PlayerMove[2]),i=Number(this.m_data.skillAssemblyUnit.PlayerMove[1]),s=Number(this.m_data.skillAssemblyUnit.PlayerMove[0]);this.m_showPoint.x=s,this.m_showPoint.y=0,t=DirectionUtil.transformPointByDirection(this.getPlayerDirection(),this.m_showPoint,null,!1);var n=5!=this.getPlayerDirection()&&6!=this.getPlayerDirection()&&7!=this.getPlayerDirection()?1:-1;t.x=n*t.x+this.getPlayerPosition().x,t.y=t.y+this.getPlayerPosition().y;var o=MoveUtil.getMoveUnit();o.moveObj=this.m_fromSkillUnit.skillPlayer,o.haveJump=!1,o.targetX=t.x,o.targetY=t.y,o.speed=o.moveObj.moveSpeed;MoveManager.instance.moveUtil.calcPath(o);null!=o.path&&(t.x=o.path[o.path.length-2],t.y=o.path[o.path.length-1],MoveManager.instance.skillMove(this.m_fromSkillUnit.skillPlayer,t.x,t.y,e,this.m_fromSkillUnit.skillPlayer.curAction,i))}this.m_data.dark&&this.dark(),-1!=this.m_data.hidePlayer&&this.hidePlayer(),this.m_data.soundDelay>-1&&-1!=this.m_data.soundResource&&(0==this.m_data.soundDelay?this.playsound():DelayCallUtils.delayedCall(.001*this.m_data.soundDelay,this.playsound,this)),null!=this.m_data.m_textureIdxLib[0]?(this.changeSkillTextureByIdx(0),this.m_data.alphaStartShowTime>0?(this.m_self.alpha=0,TweenLite.to(this.m_self,this.m_data.alphaStartShowTime/1e3,{alpha:1,onComplete:this.playNext.bind(this)})):this.m_showMC.addEventListener(egret.Event.COMPLETE,this.playNext.bind(this),this),this.chickFrameHit()):this.playNext()},e.prototype.playsound=function(){},e.prototype.onSkillCellEnd=function(){this.m_nextStep=this.STEP_DISAPPEAR,this.playNext()},e.prototype.onSkillFinish=function(){this.m_nextStep=this.STEP_FINISH,this.playNext()},e.prototype.process=function(t){void 0===t&&(t=null),null!=this.m_data.m_textureIdxLib[1]?(this.m_data.playTimes>0?(this.changeSkillTextureByIdx(1,this.m_data.playTimes),this.playTransformList()||this.m_showMC.addEventListener(egret.Event.COMPLETE,this.playNext,this)):(this.changeSkillTextureByIdx(1),this.playTransformList()||(DelayCallUtils.killDelayedCallsTo(this.onSkillCellEnd,this),DelayCallUtils.delayedCall(.001*this.m_data.liveSpan,this.onSkillCellEnd,this))),this.chickFrameHit()):this.playNext()},e.prototype.playTransformList=function(){if(this.m_data.transformList.length<=0)return!1;TweenMax.killTweensOf(this.m_curMC);for(var t=0;t<this.m_data.transformList.length;t++){var e=this.m_data.transformList[t].clone();if(!(e.endTime<0))return TweenMax.killTweensOf(this.playNext.bind(this)),TweenMax.delayedCall(e.endTime,this.playNext.bind(this)),!0;if(e.directionPos&&(e.tweenData.hasOwnProperty("x")||e.tweenData.hasOwnProperty("y"))){var i,s=e.tweenData.hasOwnProperty("x")?e.tweenData.x:0,n=e.tweenData.hasOwnProperty("y")?-e.tweenData.y:0;this.m_playPoint.x=s,this.m_playPoint.y=n,i=DirectionUtil.transformPointByDirection(this.getPlayerDirection(),this.m_playPoint),e.controlMC?(e.tweenData.x=this.m_curMC.x+i.x,e.tweenData.y=this.m_curMC.y+i.y):(e.tweenData.x=this.x+this.scaleX*i.x,e.tweenData.y=this.y+i.y)}else e.tweenData.hasOwnProperty("x")&&(e.controlMC?e.tweenData.x=this.m_curMC.x+e.tweenData.x:e.tweenData.x=this.x+this.scaleX*e.tweenData.x),e.tweenData.hasOwnProperty("y")&&(e.controlMC?e.tweenData.y=this.m_curMC.y-e.tweenData.y:e.tweenData.y=this.y-e.tweenData.y);if(e.tweenData.hasOwnProperty("scaleX")&&(e.controlMC?e.tweenData.scaleX=this.m_curMC.scaleX*e.tweenData.scaleX:e.tweenData.scaleX=this.scaleX*e.tweenData.scaleX),e.tweenData.hasOwnProperty("scaleY")&&(e.controlMC?e.tweenData.scaleY=this.m_curMC.scaleY*e.tweenData.scaleY:e.tweenData.scaleY=this.scaleY*e.tweenData.scaleY),e.tweenData.hasOwnProperty("alpha")&&(e.controlMC?e.tweenData.alpha=this.m_curMC.alpha*e.tweenData.alpha:e.tweenData.alpha=e.tweenData.alpha),e.tweenData.hasOwnProperty("rotation")&&(e.directionRotation?e.controlMC?e.tweenData.rotation=this.m_curMC.rotation+Number(e.tweenData.rotation):e.tweenData.rotation=this.rotation+Number(e.tweenData.rotation):e.controlMC?e.tweenData.rotation=this.m_curMC.rotation+Number(e.tweenData.rotation):e.tweenData.rotation=this.rotation+Number(e.tweenData.rotation)),e.tweenData.hasOwnProperty("bezier"))for(var o=e.tweenData.bezier,a=0;a<o.length;a++)e.controlMC?(o[a].x=this.m_curMC.x+o[a].x,o[a].y=this.m_curMC.y-o[a].y):(o[a].x=this.x+Number(this.scaleX*o[a].x),o[a].y=this.y-Number(o[a].y));if(e.tweenData.hasOwnProperty("bezierThrough"))for(var r=e.tweenData.bezierThrough,_=0;_<r.length;_++)e.controlMC?(r[_].x=this.m_curMC.x+r[_].x,r[_].y=this.m_curMC.y-r[_].y):(r[_].x=this.x+Number(this.scaleX*r[_].x),r[_].y=this.y-Number(r[_].y));e.controlMC?TweenMax.to(this.m_curMC,e.time,e.tweenData):TweenMax.to(this,e.time,e.tweenData)}return!1},e.prototype.disappear=function(){this.m_fromAssembly&&(null!=this.m_data.m_textureIdxLib[2]?(this.changeSkillTextureByIdx(2),this.m_data.alphaDisappearTime>0?TweenLite.to(this.m_self,this.m_data.alphaDisappearTime/1e3,{alpha:0,onComplete:this.playNext.bind(this)}):this.m_showMC.addEventListener(egret.Event.COMPLETE,this.playNext.bind(this),this),this.chickFrameHit()):this.m_data.alphaDisappearTime>0?TweenLite.to(this.m_self,this.m_data.alphaDisappearTime/1e3,{alpha:0,onComplete:this.playNext.bind(this)}):this.playNext())},e.prototype.finish=function(t){void 0===t&&(t=null),this.m_isFinished||(this.m_isFinished=!0,DelayCallUtils.killDelayedCallsTo(this.startSkill,this),DelayCallUtils.killDelayedCallsTo(this.showShadow,this),this.m_nextStep=this.STEP_FINISH,this.m_data.dark&&this.endDark(),-1!=this.m_data.hidePlayer&&this.showPlayer(),null!=this.m_showMC&&(this.m_showMC.hasEventListener(egret.Event.COMPLETE)&&this.m_showMC.removeEventListener(egret.Event.COMPLETE,this.playNext,this),this.m_showMC.removieAllFrameScript(),this.m_showMC.stop()),this.removeFromParent(),this.m_self.removeFromParent(),this.m_self.removeEventListeners(),this.m_fromAssembly&&this.m_fromAssembly.finishCell(this.m_self),this.m_shadow&&(this.m_shadow.stop(),this.m_shadow=null),this.m_playerShadow&&(this.m_playerShadow.stop(),this.m_playerShadow=null))},e.prototype.callHitAll=function(){this.m_fromSkillUnit.hitAllHp(this.name)},e.prototype.destory=function(){this.finish(),this.removeFromParent(),this.m_self.removeFromParent(),this.m_self.removeEventListeners(),this.m_showMC&&(this.m_showMC.stop(),this.m_showMC.removeEventListeners(),this.m_showMC.removeFromParent()),this.m_showMC=null,this.m_fromSkillUnit=null,this.m_fromAssembly=null,this.m_data.destory(),this.m_shadow&&(this.m_shadow.stop(),this.m_shadow=null),this.m_playerShadow&&(this.m_playerShadow.stop(),this.m_playerShadow=null)},e.prototype.chickFrameHit=function(){},e.prototype.changeSkillTextureByIdx=function(t,e){void 0===e&&(e=-1),this.setMC(t,e)},e.prototype.setMC=function(t,e){if(void 0===e&&(e=-1),!(0>t)){this.m_showMC||(this.m_showMC=new MovieClip(this.getSkillMotion(t),this.m_data.m_skillLib[t]?this.m_data.m_skillLib[t].frames:this.m_frame,e),this.m_showMC.touchEnabled=!1,this.m_self.addChild(this.m_showMC)),this.m_showMC.removieAllFrameScript(),this.m_showMC.removeEventListener(egret.Event.COMPLETE,this.playNext,this);var i=this.m_data.m_skillLib[t];this.m_showMC.textures!=this.getSkillMotion(t)&&this.m_showMC.resetTextures(this.getSkillMotion(t),this.m_data.m_skillLib[t].frames,e),this.m_showMC.blendMode=i.blendMode,this.m_showMC.alpha=i.alpha,this.m_showMC.texture&&(this.m_showMC.anchorOffsetX=.5*this.m_showMC.texture.textureWidth+i.offsetX/i.scaleX,this.m_showMC.anchorOffsetY=.5*this.m_showMC.texture.textureHeight+i.offsetY/i.scaleY),this.m_showMC.scaleX=i.scaleX,this.m_showMC.scaleY=i.scaleY,this.m_showMC.rotation=DirectionUtil.changeRadianToAngle(i.rotation+(this.m_data.directionRotation?DirectionUtil.getRadianByDirection(this.getPlayerDirection()):0)),this.m_showMC.smoothing=!0,this.m_showMC.play(),this.m_curMC=this.m_showMC}},e.prototype.dark=function(){},e.prototype.endDark=function(){},e.prototype.hidePlayer=function(){if(this.m_fromSkillUnit.skillPlayer){var t=function(){this.m_fromSkillUnit&&this.m_fromSkillUnit.skillPlayer&&(this.m_fromSkillUnit.skillPlayer.alpha=this.m_data.hidePlayer)};TweenLite.to(this.m_fromSkillUnit.skillPlayer,.5,{alpha:this.m_data.hidePlayer}),DelayCallUtils.delayedCall(.5,t,this)}},e.prototype.showPlayer=function(){if(this.m_fromSkillUnit&&this.m_fromSkillUnit.skillPlayer){var t=function(){this.m_fromSkillUnit&&this.m_fromSkillUnit.skillPlayer&&(this.m_fromSkillUnit.skillPlayer.alpha=1)};TweenLite.to(this.m_fromSkillUnit.skillPlayer,.5,{alpha:1}),DelayCallUtils.delayedCall(.5,t,this)}},e.prototype.showShadow=function(){DelayCallUtils.killDelayedCallsTo(this.showShadow,this),this.m_data.shadowPlayer?!this.m_playerShadow&&this.m_fromSkillUnit.skillPlayer&&(this.m_playerShadow=new ImageShadowEffect,this.m_playerShadow.play(this.m_fromSkillUnit.skillPlayer,this.m_data.shadowFps,.7,this.m_data.shadowAlphaTime)):this.m_shadow||(this.m_shadow=new SkillCellShadow,this.m_shadow.play(this,this.m_data.shadowFps,.7,this.m_data.shadowAlphaTime))},e.prototype.getSkillMotion=function(t){var e=this.m_data.m_skillLib[t];return null==e.textures?TexturePool.instance.getTextureAtlas(PublicCon.PATH_REPLACE_URL):e.textures},e.prototype.getPlayerDirection=function(){return 3==this.m_data.referToPosition?this.m_fromSkillUnit.skillDirection:this.m_fromSkillUnit.skillPlayer?this.m_fromSkillUnit.skillPlayer.curDirection:this.m_fromSkillUnit.skillDirection},e.prototype.getPlayerPosition=function(){return 3==this.m_data.referToPosition?this.m_fromSkillUnit.skillPoint:this.m_fromSkillUnit.skillPlayer?this.m_fromSkillUnit.skillPlayer.getPos():this.m_fromSkillUnit.skillPoint},e.prototype.getPlayerPivotX=function(){return this.m_fromSkillUnit.skillPlayer?this.m_fromSkillUnit.skillPlayer.anchorOffsetX:0},e.prototype.getPlayerPivotY=function(){return this.m_fromSkillUnit.skillPlayer?this.m_fromSkillUnit.skillPlayer.anchorOffsetY:0},e.prototype.getPlayerScaleX=function(){return this.m_fromSkillUnit.skillPlayer&&this.m_fromSkillUnit.skillPlayer.mc?this.m_fromSkillUnit.skillPlayer.mc.scaleX:1},Object.defineProperty(e.prototype,"showMC",{get:function(){return this.m_showMC},enumerable:!0,configurable:!0}),e.prototype.removeFromParent=function(){this.parent&&this.parent.removeChild(this)},e.prototype.removeEventListeners=function(){},e}(egret.Sprite);__reflect(SkillCell.prototype,"SkillCell",["ITextureLoadEvent"]);var SkillCellShadow=function(){function t(){this.m_lastTime=0,this.m_nowImageVec=[]}return t.prototype.play=function(t,e,i,s){this.m_target=t,this.m_fps=e,this.m_alpha=i,this.m_alphaTime=s,this.m_gap=1e3/e,this.start()},t.prototype.start=function(){EnterFrameManager.instance.add(this,this.m_fps)},t.prototype.advanceTime=function(t){this.draw()},t.prototype.draw=function(){return this.m_target&&this.m_target.parent?this.m_target.showMC&&this.m_target.showMC.texture?void this.drawImg():void 0:void this.stop()},t.prototype.drawImg=function(){function t(t){var e=this.m_nowImageVec.indexOf(t);-1!=e&&this.m_nowImageVec.splice(e,1),ImagePools.recoverImage(t),t=null,0==this.m_nowImageVec.length&&this.stop()}var e=this.m_target.showMC,i=null;i=ImagePools.getImage(e.texture),i.alpha=e.alpha*this.m_alpha,i.anchorOffsetX=e.anchorOffsetX,i.anchorOffsetY=e.anchorOffsetY,i.scaleX=e.scaleX*this.m_target.scaleX,i.scaleY=e.scaleY,i.x=this.m_target.x+this.m_target.scaleX*e.x,i.y=this.m_target.y+e.y,i.blendMode=e.blendMode,i.rotation=e.rotation*this.m_target.scaleX+this.m_target.rotation*this.m_target.scaleX,this.m_target.parent.addChildAt(i,this.m_target.parent.getChildIndex(this.m_target)),this.m_nowImageVec.push(i),TweenLite.to(i,this.m_alphaTime,{alpha:0,ease:Cubic.easeIn,onComplete:t.bind(this),onCompleteParams:[i]})},t.prototype.stop=function(){EnterFrameManager.instance.remove(this,this.m_fps),this.destory()},t.prototype.destory=function(){for(var t in this.m_nowImageVec){var e=this.m_nowImageVec[t];TweenLite.killTweensOf(e),ImagePools.recoverImage(e)}this.m_nowImageVec.length=0},t}();__reflect(SkillCellShadow.prototype,"SkillCellShadow");var SkillEnum=function(){function t(){}return t.SKILL_COMMON=1,t.SKILL_BIANSHEN=2,t.SKILL_JUEXIN=3,t.SKILL_YAOLING=4,t.SKILL_MONSTER=5,t.SKILL_GOD_WEAPON=9,t.SKILL_FROM_NORMAL="NORMAL",t.SKILL_HEART=10,t.SKILL_FROM_PLAYER_MALE="PLAYER_MALE",t.SKILL_FROM_PLAYER_FEMALE="PLAYER_FEMALE",t}();__reflect(SkillEnum.prototype,"SkillEnum");var SkillFactory=function(){function t(){}return t.prototype.SkillFactory=function(){},Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){this.m_skillDict=[],this.m_skillIdList=[],this.m_onPlaySkillList=[]},t.prototype.getSkillById=function(t,e){var i=SkillEnum.SKILL_FROM_NORMAL;i=SkillEnum.SKILL_FROM_NORMAL;var s,n=this.m_skillDict[t+""+i];return n||(n=[],this.m_skillDict[t]=n),n&&0!=n.length?(s=n[0],n.splice(0,1)):(s=new SkillBase(t),s.skillFrom=i),this.m_onPlaySkillList.push(s),s},t.prototype.recoverSkill=function(t){var e=this.m_onPlaySkillList.indexOf(t);-1!=e&&this.m_onPlaySkillList.splice(e,1);var i=t.skillResId,s=this.m_skillDict[i+""+t.skillFrom];s||(s=[],this.m_skillDict[i+""+t.skillFrom]=s),s.push(t),-1==this.m_skillIdList.indexOf(i+""+t.skillFrom)&&this.m_skillIdList.push(i+""+t.skillFrom)},t.prototype.destoryAllSkill=function(){for(;0!=this.m_onPlaySkillList.length;)this.m_onPlaySkillList.shift().destory();for(var t=0;t<this.m_skillIdList.length;t++){var e=this.m_skillIdList[t],i=this.m_skillDict[e];if(i)for(;i.length>0;){var s=i[0];s.finishAll(),s.destory(),i.splice(0,1)}i=null,delete this.m_skillDict[e]}},t.prototype.getSkillUrlList=function(t){function e(){for(var e="ForceStorageId",s="ShootId",n="FlyId",o=3,a=[e,s,n],r=0;o>r;r++)if(SkillJson.getData(t)){var _=SkillJson.getData(t)[a[r]];_>=0&&i(_)}else FloatTipModule.instance.popTip("不存在技能ID为"+t+"的技能")}function i(e){if(!SkillAssemblyJson.getData(e))throw new Error("skillId:"+t+",assemblyId:"+e+"缺失，请检查SkillAssembly表");for(var i=SkillAssemblyJson.getData(e).length,n=0,o=0;i>o;o++)n=Number(SkillAssemblyJson.jsonData[e][o].skillCellID[1]),s(n)}function s(t){var e=["ShowResource","ProcessResource","DisappearResource"],i=SkillResourceJson.jsonData,s=SkillCellJson.jsonData[t];if(!s)return void FloatTipModule.instance.popTip("技能SkillCellID为"+t+"的SkillCell");for(var o=0;o<e.length;o++){var a=s[e[o]];a>-1&&n(i[a].Address)}}function n(t){-1==o.indexOf(t)&&o.push(t)}var o=[];if(0>t)return o;var a=SkillJson.jsonData[t].HitId;-1!=a&&SkillResourceJson.jsonData[a]&&n(SkillResourceJson.jsonData[a].Address);var r=SkillJson.jsonData[t].HitId;return r>=0&&i(r),e(),o},t}();__reflect(SkillFactory.prototype,"SkillFactory");var Skills=function(){function t(){this.m_skillDict=[]}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.playSkill=function(t,e,i,s,n,o,a){void 0===n&&(n=null),void 0===o&&(o=null),void 0===a&&(a=-1);for(var r=new Array,_=new Array,h=0;h<s.length;h++){var l;l=1==s[h].defender_type?SceneItemModule.instance.getPlayer(s[h].defender_id):SceneItemModule.instance.getMonster(s[h].defender_id),null!=l&&r.push(l)}var c=SkillFactory.instance.getSkillById(e,i);c.skillActiveSkillId=t,0==r.length&&null!=o&&r.push(o),null==n&&(n=0==r.length?i.getPos():r[0].getPos()),c.startAtkTo(i,r,_,n,a),c.onChangeTarget(n.x,n.y),c.playSkill();for(var m=0;m<s.length;m++)c.pushHurtItem(s[m])},t.prototype.playSkillAction=function(t,e,i,s,n,o){void 0===s&&(s=null),void 0===n&&(n=null),void 0===o&&(o=-1);for(var a=new Array,r=new Array,_=0;_<i.length;_++){var h;h=1==i[_].defender_type?SceneItemModule.instance.getPlayer(i[_].defender_id):SceneItemModule.instance.getMonster(i[_].defender_id),null!=h&&a.push(h)}var l=SkillFactory.instance.getSkillById(t,e);0==a.length&&null!=n&&a.push(n),null==s&&(s=0==a.length?e.getPos():a[0].getPos()),l.startAtkTo(e,a,r,s,o),l.onChangeTarget(s.x,s.y),l.playSkill()},t.prototype.removeSkill=function(t){},t.prototype.getSkill=function(t,e){return this.m_skillDict["_fighter"+t+"_skill"+e]},t.prototype.destory=function(t){var e;
for(var i in this.m_skillDict)if(-1!=i.indexOf("_fighter"+t+"_skill")&&(e=this.m_skillDict[i]))return e.finishAll(),e.destory(),e=null,delete this.m_skillDict[i],!0;return!1},t.prototype.playDrameSkill=function(t,e,i,s){void 0===i&&(i=null),void 0===s&&(s=null);var n=SkillFactory.instance.getSkillById(t,e),o=new Array;return null!=s&&o.push(s),n.startAtkTo(e,o,[],i,-1),null==s&&null!=i&&n.onChangeTarget(i.x,i.y),n.playSkill(),n},t}();__reflect(Skills.prototype,"Skills");var SkillUnit=function(){function t(e){void 0===e&&(e=null),this.SkillType=[t.ATYPE_FORCESTORAGE,t.ATYPE_SHOOT,t.ATYPE_FLY],this.SkillNum=3,this.SKILL_FINISH=3,this.skillDirection=3,this.m_hurtList=[],this.m_pid=0,t.pid++,this.m_pid=t.pid,this.m_fromSkill=e,this.m_fromSkill&&(this.skillPlayer=this.m_fromSkill.skillPlayer,this.skillId=this.m_fromSkill.skillResId,this.activeSkillId=this.m_fromSkill.skillActiveSkillId,this.createAssembly())}return Object.defineProperty(t.prototype,"hurtList",{get:function(){return this.m_hurtList},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"targetPoint",{get:function(){return null==this.m_targetPoint&&this.m_target&&(this.m_targetPoint=new egret.Point(this.m_target.x,this.m_target.y)),this.m_targetPoint},set:function(t){this.m_targetPoint=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"target",{get:function(){return this.m_target},set:function(t){this.m_target=t},enumerable:!0,configurable:!0}),t.prototype.createAssembly=function(){this.m_skillAssemblyList=new Array(this.SkillNum);for(var t=0,e=0;e<this.SkillNum;e++)t=SkillJson.getData(this.m_fromSkill.skillResId)[this.SkillType[e]],this.m_skillAssemblyList[e]=new SkillAssembly(this,t,e)},t.prototype.play=function(){this.skillPlayer&&-1==this.skillDirection?this.skillDirection=this.skillPlayer.curDirection:this.skillDirection=2,this.m_finishNum=0,this.playAssemblyByName(t.ATYPE_FORCESTORAGE),this.playAssemblyByName(t.ATYPE_SHOOT),this.playAssemblyByName(t.ATYPE_FLY)},t.prototype.changeRound=function(e){this.round=e,this.m_fromSkill&&(this.dispatchRoundByName(t.ATYPE_FORCESTORAGE),this.dispatchRoundByName(t.ATYPE_SHOOT),this.dispatchRoundByName(t.ATYPE_FLY))},t.prototype.dispatchRoundByName=function(t){var e=this.SkillType.indexOf(t);this.m_skillAssemblyList[e].changeRound()},t.prototype.playAssemblyByName=function(t){var e=this.SkillType.indexOf(t);this.m_skillAssemblyList[e].playAssembly()},t.prototype.finishAssembly=function(t){switch(void 0===t&&(t=null),this.m_finishNum++,this.m_finishNum){case this.SKILL_FINISH:this.m_fromSkill.finishSkill(),this.skillPlayer=null,this.m_target=null}},t.prototype.finishAll=function(){this.m_fromSkill&&(this.finishAssemblyByName(t.ATYPE_FORCESTORAGE),this.finishAssemblyByName(t.ATYPE_SHOOT),this.finishAssemblyByName(t.ATYPE_FLY))},t.prototype.finishAssemblyByName=function(t){var e=this.SkillType.indexOf(t);this.m_skillAssemblyList[e].finishAll()},t.prototype.skillHitTest=function(t){if(this.m_fromSkill)for(var e=0;e<this.hurtList.length;e++){var i;if(i=1==this.hurtList[e].defender_type?SceneItemModule.instance.getPlayer(this.hurtList[e].defender_id):SceneItemModule.instance.getMonster(this.hurtList[e].defender_id),null!=i){var s,n;null==i.mc?(s=50,n=100):(s=.5*i.mc.texture.textureWidth,n=i.mc.texture.textureHeight);var o=i.x-.5*s,a=i.y-n,r=s,_=n,h=new egret.Rectangle(o,a,r,_);t.intersects(h)&&this.hitTarget(this.hurtList[e])}}},t.prototype.hitTarget=function(t){if(!this.m_fromSkill)return void FightHurtModule.instance.execHurt(t,this.skillPlayer,this.activeSkillId);SkillJson.getData(this.skillId);FightHurtModule.instance.execHurt(t,this.skillPlayer,this.activeSkillId)},t.prototype.hitAllHp=function(t){if(this.m_fromSkill)for(;this.hurtList.length>0;)this.hitTarget(this.hurtList[0])},t.prototype.timeOutHit=function(){},t.prototype.destory=function(){if(this.m_target=null,this.skillPlayer=null,this.m_fromSkill){for(;this.m_skillAssemblyList.length>0;){var t=this.m_skillAssemblyList[0];t.destory(),t=null,this.m_skillAssemblyList.splice(0,1)}this.m_skillAssemblyList=null}},t.ATYPE_FORCESTORAGE="ForceStorageId",t.ATYPE_SHOOT="ShootId",t.ATYPE_FLY="FlyId",t.pid=0,t}();__reflect(SkillUnit.prototype,"SkillUnit");var SkillCellBean=function(){function t(e,i,s){if(this.flyEase="0",this.dark=!1,this.soundResource=-1,this.shadowDelay=-1,this.shadowFps=-1,this.shadowAlphaTime=-1,this.shadowPlayer=!1,this.transformList=[],this.hidePlayer=-1,this.otherInVisible=!1,this.m_textureIdxLib=[],this.m_skillLib=[],this.skillAssemblyUnitLib=SkillAssemblyJson.jsonData,this.myCsvSkillCellUnitList=SkillCellJson.jsonData,this.myCsvSkillResourceList=SkillResourceJson.jsonData,this.skillAssemblyID=e,this.skillAssemblyIndexID=i,this.cellID=s,this.myCsvSkillCellUnit=this.myCsvSkillCellUnitList[this.cellID],null==this.myCsvSkillCellUnit)throw new Error("不存在cellId:"+this.cellID);this.skillAssemblyUnit=this.skillAssemblyUnitLib[this.skillAssemblyID][this.skillAssemblyIndexID],this.otherInVisible=Boolean(this.myCsvSkillCellUnit.OtherInVisible),this.liveType=this.myCsvSkillCellUnit.LiveType,this.flySpeed=this.myCsvSkillCellUnit.FlySpeed/PublicCon.DEL_FPS,this.flyEase=this.myCsvSkillCellUnit.FlyEase,this.floor=this.myCsvSkillCellUnit.Floor,this.shockType=this.myCsvSkillCellUnit.ShockType,this.isFollow=this.myCsvSkillCellUnit.IsFollow,this.dark=this.myCsvSkillCellUnit.Dark,this.lightRange=this.myCsvSkillCellUnit.LightRange,this.soundResource=this.myCsvSkillCellUnit.SoundResource,-1!=this.myCsvSkillCellUnit.SoundResource,this.referToPosition=this.skillAssemblyUnit.ReferToPosition,this.settlementAndViewOffsetX=this.skillAssemblyUnit.SettlementAndViewOffsetX,this.settlementAndViewOffsetY=this.skillAssemblyUnit.SettlementAndViewOffsetY,this.viewOffsetH=this.skillAssemblyUnit.ViewOffsetH,this.directionPos=this.skillAssemblyUnit.DirectionPos,this.directionRotation=this.skillAssemblyUnit.DirectionRotation,this.directionType=this.skillAssemblyUnit.DirectionType,this.direction=this.skillAssemblyUnit.Direction,this.flyDistance=this.skillAssemblyUnit.FlyDistance,this.playTimes=this.skillAssemblyUnit.PlayTimes,this.startShowTime=this.skillAssemblyUnit.StartShowTime,this.liveSpan=this.skillAssemblyUnit.LiveSpan,this.settlement=this.skillAssemblyUnit.Settlement,this.alphaStartShowTime=this.skillAssemblyUnit.AlphaStartShowTime,this.alphaDisappearTime=this.skillAssemblyUnit.AlphaDisappearTime,this.soundDelay=this.skillAssemblyUnit.SoundDelay,this.shadowDelay=this.skillAssemblyUnit.shadowDelay,this.shadowFps=this.skillAssemblyUnit.shadowFps,this.shadowAlphaTime=this.skillAssemblyUnit.shadowAlphaTime,this.shadowPlayer=this.skillAssemblyUnit.shadowPlayer,this.hidePlayer=this.skillAssemblyUnit.HidePlayer,this.playerMove=this.skillAssemblyUnit.PlayerMove;var n=this.skillAssemblyUnit.Transform;if("-1"!=n)for(var o=n.split("|"),a=0;a<o.length;a++){for(var r=o[a].split("/"),_=new SkillTransformBean,h=0;h<r.length;h++){var l=r[h].split(":");if(l.length>=2)switch(l[0]){case"time":_.time=Number(l[1]);break;case"ease":_.tweenData[l[0]]=this.getEaseFunc(l[1]);break;case"bezier":for(var c=l[1].split(")"),m=[],p=0;p<c.length;p++){var u=c[p].split("*");m.push({x:Number(u[0]),y:Number(u[1])})}_.tweenData[l[0]]=m;break;case"bezierThrough":for(var d=l[1].split(")"),g=[],f=0;f<d.length;f++){var y=d[f].split("*");g.push({x:Number(y[0]),y:Number(y[1])})}_.tweenData[l[0]]=g;break;case"end":_.endTime=Number(l[1]);break;case"controlMC":_.controlMC=Boolean(Number(l[1]));break;case"directionPos":_.directionPos=Boolean(Number(l[1]));break;case"directionRotation":_.directionRotation=Boolean(Number(l[1]));break;case"rotation":_.tweenData[l[0]]=DirectionUtil.changeRadianToAngle(Number(l[1])/360*(2*Math.PI));break;default:_.tweenData[l[0]]=Number(l[1])}}this.transformList.push(_)}this.playRound=Math.floor(this.startShowTime/t.ROUNDTIME),this.playDelay=this.startShowTime-this.playRound*t.ROUNDTIME;for(var v=0;v<t.TEXTURE_NAME_LIB.length;v++){var M=this.myCsvSkillCellUnit[t.TEXTURE_NAME_LIB[v]];if(""!=M){var E=SkillResourceJson.getData(M);this.m_textureIdxLib[v]=TextureFrom.SKILL_UNDELATE+E.Address;var T=this.myCsvSkillCellUnitList[this.cellID][t.TEXTURE_NAME_LIB[v]];if(""!=T){var S=new SkillDataBean;S.texture=this.m_textureIdxLib[v],S.skillResourceId=T;var w=SkillResourceJson.getData(T);S.Address=w.Address,S.blendMode=w.BlendMode,S.alpha=w.Alpha,S.scaleX=w.ScaleX,S.scaleY=w.ScaleY,S.frames=w.Frames,S.offsetX=w.OffsetX,S.offsetY=w.OffsetY,S.rotation=w.Rotation,S.rgb=w.RGB,this.m_skillLib[v]=S}}else this.m_textureIdxLib[v]=null}}return t.prototype.getEaseFunc=function(t){var e;switch(t){case"Cubic.easeIn":e=Cubic.easeIn;break;case"Cubic.easeInOut":e=Cubic.easeInOut;break;case"Cubic.easeOut":e=Cubic.easeOut;break;case"Linear.easeNone":e=Linear.easeNone;break;case"Back.easeInOut":e=Back.easeInOut;break;case"Back.easeIn":e=Back.easeIn;break;case"Back.easeOut":e=Back.easeOut;break;default:e=Linear.easeNone}return e},t.prototype.destory=function(){for(this.skillAssemblyUnitLib=null,this.myCsvSkillCellUnitList=null,this.myCsvSkillResourceList=null,this.skillAssemblyUnit=null,this.myCsvSkillCellUnit=null;this.m_textureIdxLib.length>0;){var t=this.m_textureIdxLib[0];t=null,this.m_textureIdxLib.splice(0,1)}for(;this.m_skillLib.length>0;){var e=this.m_skillLib[0];null!=e&&e.destory(),e=null,this.m_skillLib.splice(0,1)}},t.TEXTURE_NAME_LIB=["ShowResource","ProcessResource","DisappearResource"],t.McMax=3,t.ROUNDTIME=500,t}();__reflect(SkillCellBean.prototype,"SkillCellBean");var SkillDataBean=function(){function t(){this.Address="",this.blendMode=""}return Object.defineProperty(t.prototype,"textures",{get:function(){if(-1==this.m_textures.indexOf(".png"))throw new Error("该文件不是png文件 :"+this.m_textures);return TexturePool.instance.getTextureAtlas(this.m_textures)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"texture",{set:function(t){this.m_textures=t},enumerable:!0,configurable:!0}),t.prototype.destory=function(){this.m_textures=null,this.Address=null,this.blendMode=null},t}();__reflect(SkillDataBean.prototype,"SkillDataBean");var SkillTransformBean=function(){function t(){this.time=0,this.tweenData={},this.endTime=-1,this.controlMC=!0,this.directionPos=!1,this.directionRotation=!1,this.tweenJsonCode=""}return t.prototype.clone=function(){var e=new t;return e.time=this.time,e.endTime=this.endTime,e.controlMC=this.controlMC,e.directionPos=this.directionPos,e.directionRotation=this.directionRotation,""==this.tweenJsonCode&&(this.tweenJsonCode=JSON.stringify(this.tweenData)),e.tweenData=JSON.parse(this.tweenJsonCode),null!=this.tweenData.ease&&(e.tweenData.ease=this.tweenData.ease),e},t}();__reflect(SkillTransformBean.prototype,"SkillTransformBean");var LightningEffect=function(){function t(t,e,i,s,n){void 0===s&&(s=null),void 0===n&&(n=301),this._lightningList=[],this._type=t,this._arrPoint=e,this._parentMc=s,this._backFunc=i,this._size=n,this.createLightning(this._size)}return t.prototype.createLightning=function(t){if(this._arrPoint.length>1){var e;1==this._type&&(e=new LightningItem3D(this._arrPoint.shift(),this._arrPoint[0],this.closeItem.bind(this),this.nextItem.bind(this),t)),this._lightningList.push(e)}},t.prototype.nextItem=function(t){this.createLightning(this._size)},t.prototype.closeItem=function(t){this._lightningList.splice(this._lightningList.indexOf(t)),t.dipsoe(),t=null,this._arrPoint.length<=1&&(this._lightningList=[],this._backFunc.apply(null,[this]))},t}();__reflect(LightningEffect.prototype,"LightningEffect");var LightningItem3D=function(){function t(t,e,i,s,n){this.m_size=1,this.m_start=t,this.m_end=e,this._removeBack=i,this._nextBack=s,this.m_size=n,this.m_start instanceof MagicWeapon&&EffectModule.instance.light(this.m_start,600),this.m_bodyPath=TextureFrom.SKILL+PublicCon.PATH_LIGHTNING+this.m_size+"/body.png",this.m_lightPath=TextureFrom.SKILL+PublicCon.PATH_LIGHTNING+this.m_size+"/line.png",TextureLoadManager.instance.requestLoadTextureAtlas(this.m_bodyPath,this,LoaderPriority.EFFECT),TextureLoadManager.instance.requestLoadTextureAtlas(this.m_lightPath,this,LoaderPriority.EFFECT)}return t.prototype.onloadComplete=function(t){if(!this.m_showMC&&this.m_lightPath==t){this.m_showMC=new MovieClip(TexturePool.instance.getTextureAtlas(t),12),this.m_showMC.addEventListener(egret.Event.COMPLETE,this.onPlayComplete,this),this.m_showMC.addFrameScript(1,this.onNext.bind(this)),this.m_showMC.addFrameScript(5,this.attack.bind(this)),this.m_showMC.anchorOffsetX=400,this.m_showMC.anchorOffsetY=290,this.m_showMC.blendMode=egret.BlendMode.ADD,this.m_showMC.smoothing=!0,SceneLayerModule.instance.upEffectLayer.addChild(this.m_showMC),this.m_showMC.play();var e,i,s,n;if(this.m_start instanceof MagicWeapon){var o=this.m_start.item.localToGlobal(0,0);o=SceneLayerModule.instance.liveThingsLayer.globalToLocal(o.x,o.y),e=o.x+0,i=o.y+50,n=0,s=0}else e=this.m_start.x,i=this.m_start.y,n=this.m_start.anchorOffsetX,s=this.m_start.anchorOffsetY;this.m_showMC.x=e,this.m_showMC.y=i-s-30;var a=this.m_end.x-e,r=this.m_end.y-this.m_end.anchorOffsetY-30-(i-s-30),_=Math.sqrt(a*a+r*r);this.m_showMC.scaleY=800*_/220/800;var h=(Math.atan2(r,a)-.5*Math.PI)/Math.PI*180;this.m_showMC.rotation=h,TweenLite.from(this.m_showMC,.2,{scaleY:0,onComplete:this.startEnterFrame.bind(this)})}this.m_attarkMc||t!=this.m_bodyPath||(this.m_attarkMc=new MovieClip(TexturePool.instance.getTextureAtlas(t),12),this.m_attarkMc.addEventListener(egret.Event.COMPLETE,this.onPlayCompleteAtt,this),this.m_attarkMc.anchorOffsetX=123,this.m_attarkMc.anchorOffsetY=123,this.m_attarkMc.blendMode=egret.BlendMode.ADD,this.m_attarkMc.smoothing=!0,SceneLayerModule.instance.upEffectLayer.addChild(this.m_attarkMc),this.m_attarkMc.stop(),this.m_attarkMc.visible=!1)},t.prototype.startEnterFrame=function(){EnterFrameManager.instance.addEnterFrame(this.initView,this)},t.prototype.initView=function(){var t,e,i,s;if(this.m_start instanceof MagicWeapon){var n=this.m_start.item.localToGlobal(0,0);n=SceneLayerModule.instance.liveThingsLayer.globalToLocal(n.x,n.y),t=n.x+0,e=n.y+50,s=0,i=0}else t=this.m_start.x,e=this.m_start.y,s=this.m_start.anchorOffsetX,i=this.m_start.anchorOffsetY;this.m_showMC.x=t,this.m_showMC.y=e-i-30;var o=this.m_end.x-t,a=this.m_end.y-this.m_end.anchorOffsetY-30-(e-i-30),r=Math.sqrt(o*o+a*a);this.m_showMC.scaleY=800*r/220/800;var _=(Math.atan2(a,o)-.5*Math.PI)/Math.PI*180;this.m_showMC.rotation=_,this.m_attarkMc&&(this.m_attarkMc.x=this.m_end.x,this.m_attarkMc.y=this.m_end.y-35-this.m_end.anchorOffsetY)},t.prototype.attack=function(){this.m_attarkMc&&(this.m_attarkMc.LoopNum=1,this.m_attarkMc.visible=!0,this.m_attarkMc.x=this.m_end.x,this.m_attarkMc.y=this.m_end.y-35-this.m_end.anchorOffsetY,this.m_attarkMc.play())},t.prototype.onNext=function(){this._nextBack.apply(null,[this])},t.prototype.onPlayCompleteAtt=function(t){this.m_attarkMc&&(SceneLayerModule.instance.upEffectLayer.removeChild(this.m_attarkMc),this.m_attarkMc.stop(),this.m_attarkMc.dispose(),this.m_attarkMc=null)},t.prototype.onPlayComplete=function(t){this.m_showMC.removeEventListener(egret.Event.COMPLETE,this.onPlayComplete,this),this.m_showMC.removieAllFrameScript(),EnterFrameManager.instance.removeEnterFrame(this.initView,this),this.m_showMC.stop(),TweenLite.to(this.m_showMC,.4,{alpha:0,onComplete:this.destory.bind(this)})},t.prototype.destory=function(){this._removeBack.apply(null,[this])},t.prototype.dipsoe=function(){EnterFrameManager.instance.removeEnterFrame(this.initView,this),this.onPlayCompleteAtt(null),SceneLayerModule.instance.upEffectLayer.removeChild(this.m_showMC),this.m_showMC.stop(),this.m_showMC.dispose(),this.m_showMC=null},t}();__reflect(LightningItem3D.prototype,"LightningItem3D",["ITextureLoadEvent"]);var EnterFrameFpsItem=function(){function t(t){this.m_objects=[],this.m_currentTime=0,this.m_fps=t,this.m_finalFrame=this.m_fps-1,this.m_defaultFrameDuration=1/this.m_fps,this.m_currentFrame=0,this.m_currentTime=0,this.m_totalTime=this.m_defaultFrameDuration*this.m_fps,this.m_durations=[],this.m_startTimes=[];for(var e=0;e<this.m_fps;++e)this.m_durations[e]=this.m_defaultFrameDuration,this.m_startTimes[e]=e*this.m_defaultFrameDuration}return t.prototype.advanceTime=function(t){this.m_currentFrame;if(this.m_currentTime==this.m_totalTime&&(this.m_currentTime=0,this.m_currentFrame=0),0!=t&&this.m_currentTime!=this.m_totalTime){this.m_currentTime+=t;for(var e=!1;this.m_currentTime+5e-4-(this.m_startTimes[this.m_currentFrame]+this.m_durations[this.m_currentFrame])>=0;){this.m_currentFrame==this.m_finalFrame?(this.m_currentTime-=this.m_totalTime,this.m_currentFrame=0):this.m_currentFrame++;var i,s=[];for(i=0;i<this.m_objects.length;i++)s[i]=this.m_objects[i];for(i=0;i<s.length;i++)s[i].advanceTime(t);e=!0}}},t.prototype.add=function(t){t&&-1==this.m_objects.indexOf(t)&&(this.m_objects[this.m_objects.length]=t)},t.prototype.remove=function(t){if(null!=t){var e=this.m_objects.indexOf(t);-1!=e&&this.m_objects.splice(e,1)}},t}();__reflect(EnterFrameFpsItem.prototype,"EnterFrameFpsItem",["IAnimatable"]);var EnterFrameManager=function(){function t(){this.m_enterFrameFpsDict=[]}return t.prototype.init=function(){egret.Ticker.getInstance().register(this.advanceTime,this)},Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.add=function(t,e){void 0===e&&(e=12),null==this.m_enterFrameFpsDict[e]&&(this.m_enterFrameFpsDict[e]=new EnterFrameFpsItem(e)),this.m_enterFrameFpsDict[e].add(t)},t.prototype.remove=function(t,e){void 0===e&&(e=12),null!=t&&null!=this.m_enterFrameFpsDict[e]&&this.m_enterFrameFpsDict[e].remove(t)},t.prototype.addEnterFrame=function(e,i){Dispatch.register(t.ENTER_FRAME,e,i)},t.prototype.removeEnterFrame=function(e,i){Dispatch.remove(t.ENTER_FRAME,e,i)},t.prototype.advanceTime=function(e){t.getTimer=egret.getTimer();var i=e/1e3;this.passedTime=i,this.passedTime>1&&(this.passedTime=1),this.passedTime<0&&(this.passedTime=1/egret.MainContext.instance.stage.frameRate);for(var s in this.m_enterFrameFpsDict)this.m_enterFrameFpsDict[s].advanceTime(this.passedTime);return Dispatch.dispatch(t.ENTER_FRAME,this.passedTime),!0},t.ENTER_FRAME="ENTER_FRAME",t.getTimer=0,t}();__reflect(EnterFrameManager.prototype,"EnterFrameManager");var MovieClip=function(t){function e(e,i,s){void 0===i&&(i=12),void 0===s&&(s=-1);var n=t.call(this)||this;return n.m_currentFrame=-1,n.finalFrame=0,n.m_loopNum=-1,n.m_fps=12,n.m_isPlay=!1,n.m_listeners={},n.m_fps=i,n.m_loopNum=s,n.textures=e,n.touchEnabled=!1,n}return __extends(e,t),e.prototype.initMC=function(){if(this.m_textures&&0!=this.m_textures.length){this.finalFrame=this.m_textures.length-1,this.removieAllFrameScript(),this.m_loop=!0,this.m_currentLoopNum=0,this.m_currentTime=0,this.currentFrame=0;var t=this.m_textures.length;this.m_defaultFrameDuration=1/this.m_fps,this.m_totalTime=this.m_defaultFrameDuration*t,this.m_durations=[],this.m_startTimes=[];for(var e=0;t>e;++e)this.m_durations[e]=this.m_defaultFrameDuration,this.m_startTimes[e]=e*this.m_defaultFrameDuration}},e.prototype.advanceTime=function(t){var e=this.m_currentFrame;if(this.m_loop&&this.m_currentTime==this.m_totalTime&&(this.m_currentTime=0,this.m_currentFrame=0),this.m_currentTime+=t,this.m_currentFrame>=this.finalFrame){if(this.m_currentLoopNum++,this.hasEventListener(egret.Event.COMPLETE)){var i=this.m_currentTime-this.m_totalTime;if(-1==this.m_loopNum)return this.m_currentTime=this.m_totalTime,void this.dispatchEventWith(egret.Event.COMPLETE);if(this.m_currentLoopNum>=this.m_loopNum)return this.dispatchEventWith(egret.Event.COMPLETE),this.m_currentTime=this.m_totalTime,this.m_currentLoopNum=0,void this.advanceTime(i)}this.m_loop?(this.m_currentTime-=this.m_totalTime,this.m_currentFrame=0):this.m_currentTime=this.m_totalTime}else this.m_currentFrame++,this.m_frameFuncDict&&null!=this.m_frameFuncDict[this.m_currentFrame]&&this.m_frameFuncDict[this.m_currentFrame]();this.m_currentFrame!=e&&null!=this.m_textures&&(this.texture=this.m_textures[this.m_currentFrame])},e.prototype.play=function(){EnterFrameManager.instance.add(this,this.m_fps),this.isPlay=!0},e.prototype.stop=function(){EnterFrameManager.instance.remove(this,this.m_fps),this.isPlay=!1},Object.defineProperty(e.prototype,"currentFrame",{get:function(){return this.m_currentFrame},set:function(t){if(0!=this.m_textures.length){this.m_currentFrame=t,this.texture=this.m_textures[this.m_currentFrame],this.m_currentTime=0;for(var e=0;t>e;++e)this.m_currentTime+=this.getFrameDuration(e)}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textures",{get:function(){return this.m_textures},set:function(t){this.removeTexturesUse(),null!=t&&(this.m_textures=t,this.addTexturesUse(),this.initMC())},enumerable:!0,configurable:!0}),e.prototype.removeTexturesUse=function(){if(null!=this.m_textures&&this.m_textures.length>0){var t=this.m_textures[0];if(t.fromAtlas){var e=t.fromAtlas;e.removeUse(this.hashCode)}}},e.prototype.addTexturesUse=function(){if(null!=this.m_textures&&this.m_textures.length>0){var t=this.m_textures[0];if(t.fromAtlas){var e=t.fromAtlas;e.addUse(this.hashCode)}}},e.prototype.resetTextures=function(t,e,i){void 0===e&&(e=12),void 0===i&&(i=-1),this.m_fps!=e&&(EnterFrameManager.instance.remove(this,this.m_fps),EnterFrameManager.instance.add(this,e)),this.m_fps=e,this.textures=t},Object.defineProperty(e.prototype,"fps",{get:function(){return this.m_fps},set:function(t){this.m_fps!=t&&(EnterFrameManager.instance.remove(this,this.m_fps),EnterFrameManager.instance.add(this,t)),this.m_fps=t;var e=1/t,i=e/this.m_defaultFrameDuration;this.m_currentTime*=i,this.m_defaultFrameDuration=e;for(var s=0;s<this.numFrames;++s)this.setFrameDuration(s,this.getFrameDuration(s)*i)},enumerable:!0,configurable:!0}),e.prototype.getFrameDuration=function(t){if(t>=this.numFrames&&(t=this.numFrames-1),0>t||t>=this.numFrames)throw new Error("Invalid frame id");return this.m_durations[t]},e.prototype.setFrameDuration=function(t,e){if(0>t||t>=this.numFrames)throw new Error("Invalid frame id");this.m_totalTime-=this.getFrameDuration(t),this.m_totalTime+=e,this.m_durations[t]=e,this.updateStartTimes()},e.prototype.updateStartTimes=function(){var t=this.numFrames;this.m_startTimes.length=0,this.m_startTimes[0]=0;for(var e=1;t>e;++e)this.m_startTimes[e]=this.m_startTimes[e-1]+this.m_durations[e-1]},e.prototype.removieAllFrameScript=function(){if(this.m_frameFuncDict)for(var t in this.m_frameFuncDict)this.m_frameFuncDict[t]=null,delete this.m_frameFuncDict[t]},e.prototype.addFrameScript=function(t,e){this.m_frameFuncDict||(this.m_frameFuncDict=[]),this.m_frameFuncDict[t]=e},e.prototype.removeFrameScript=function(t){this.m_frameFuncDict&&(this.m_frameFuncDict[t]=null,delete this.m_frameFuncDict[t])},e.prototype.copyMcFrameData=function(t){t.textures.length>this.m_currentFrame?t.currentFrame=this.m_currentFrame:t.currentFrame=t.textures.length-1,t.CurrentTime=this.CurrentTime},Object.defineProperty(e.prototype,"totalTime",{get:function(){return this.m_totalTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numFrames",{get:function(){return this.m_textures.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loop",{get:function(){return this.m_loop},set:function(t){this.m_loop=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"LoopNum",{get:function(){return this.m_loopNum},set:function(t){this.m_loopNum=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CurrentTime",{get:function(){return this.m_currentTime},set:function(t){this.m_currentTime=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TotalTime",{get:function(){return this.m_totalTime},set:function(t){this.m_totalTime=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DefaultFrameDuration",{get:function(){return this.m_defaultFrameDuration},set:function(t){this.m_defaultFrameDuration=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPlay",{get:function(){return this.m_isPlay},set:function(t){this.m_isPlay=t},enumerable:!0,configurable:!0}),e.prototype.removeFromParent=function(){null!=this.parent&&this.parent.removeChild(this)},e.prototype.addEventListener=function(t,e,i,s,n){this.$addListener(t,e,i,s,n);var o;return null!=this.m_listeners[t]?o=this.m_listeners[t]:(o=[],this.m_listeners[t]=o),o.push({type:t,listener:e,thisObject:i,useCapture:s,priority:n}),null},e.prototype.removeEventListeners=function(t){void 0===t&&(t="all");var e,i=0;if("all"!=t){if(e=this.m_listeners[t]){for(i=0;i<e.length;i++)this.removeEventListener(e[i].type,e[i].listener,e[i].thisObject,e[i].useCapture),e[i].type=null,e[i].listener=null,e[i].thisObject=null,e[i].useCapture=null,e[i].priority=null,e[i]=null;e.length=0,this.m_listeners[t]=null,delete this.m_listeners[t]}}else{var s=[];for(var n in this.m_listeners){for(e=this.m_listeners[n],i=0;i<e.length;i++)this.removeEventListener(e[i].type,e[i].listener,e[i].thisObject,e[i].useCapture),e[i].type=null,e[i].listener=null,e[i].thisObject=null,e[i].useCapture=null,e[i].priority=null,e[i]=null;e.length=0,this.m_listeners[n]=null,s.push(n)}for(i=0;i<s.length;i++)delete this.m_listeners[s[i]]}},e.prototype.dispose=function(){this.removeTexturesUse(),this.stop(),this.m_durations=null,this.m_startTimes=null,this.m_textures=null,this.removeEventListeners(),this.removieAllFrameScript(),this.removeFromParent(),this.m_frameFuncDict=null,this.texture=null},e}(egret.Bitmap);__reflect(MovieClip.prototype,"MovieClip",["IAnimatable"]);var Dispatch=function(){function t(){this.observers=[]}return t.getInstance=function(){return null==this.instance&&(this.instance=new t),this.instance},t.prototype.add=function(t,e,i,s){void 0===s&&(s=!1);var n=this.observers[t];if(null!=e&&s&&e.apply(i),null==n)n=[],this.observers[t]=n;else if(-1!=this.getCallIdx(n,e,i))return;n.push(new DispatchItemData(e,i))},t.prototype.getCallIdx=function(t,e,i){for(var s=0;s<t.length;s++)if(t[s].call==e&&t[s].thisObj==i)return s;return-1},t.prototype.remove=function(t,e,i){var s=this.observers[t];if(s){var n=this.getCallIdx(s,e,i);-1!=n&&(s[n].call=null,s[n].thisObj=null,s.splice(n,1)),s.length<=0&&(this.observers[t]=null,delete this.observers[t])}},t.prototype.execute=function(t,e){var i=this.observers[t];if(i){i=i.concat();for(var s=[],n=0;n<i.length;n++)s[n]=i[n];for(var o=0;o<s.length;o++){var a=s[o],r=a.call,_=a.thisObj;null!=r&&null!=_&&(URIManager.isdebug?0==e.length||1==e.length&&null==e[0]?r.apply(_,null):r.apply(_,e):0==e.length?r.apply(_,null):r.apply(_,e))}}},t.dispatch=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];this.getInstance().execute(t,e)},t.register=function(t,e,i,s){void 0===s&&(s=!1),this.getInstance().add(t,e,i,s)},t.remove=function(t,e,i){this.getInstance().remove(t,e,i)},t}();__reflect(Dispatch.prototype,"Dispatch");var DispatchItemData=function(){function t(t,e){this.call=t,this.thisObj=e}return t}();__reflect(DispatchItemData.prototype,"DispatchItemData");var GamePreLoadManager=function(t){function e(){var e=t.call(this)||this;return e.p_onPreloadCreate=!1,e.p_isLoadCreateOver=!1,e.p_onPreloadGame=!1,e.p_isLoadGameOver=!1,e.preLoadHasList=[],e.preLoadList=[],e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.m_instance||(this.m_instance=new e),this.m_instance},enumerable:!0,configurable:!0}),e.prototype.addPreloadLoginData=function(t){void 0===t&&(t=null)},e.prototype.preloadLogin=function(){LoadingUIModule.instance.show(this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onPreloadLoginComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.loadGroup("preloadLogin"),null!=window.hideLoadingDiv&&window.hideLoadingDiv()},e.prototype.onPreloadLoginComplete=function(){RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onPreloadLoginComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onPreloadLoginJsonComplete,this),RES.loadGroup("preloadInitJson")},e.prototype.onPreloadLoginJsonComplete=function(){RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onPreloadLoginJsonComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this);for(var t=RES.getGroupByName("preloadInitJson"),i=0;i<t.length;i++)JsonUtil.setJsonToClass(t[i]);RES.destroyRes("preloadInitJson"),LoadingUIModule.instance.hide(this),Dispatch.dispatch(e.EVENT_LOGIN_COMPLETE)},e.prototype.preloadCreate=function(t){return void 0===t&&(t=!0),this.p_isLoadCreateOver?void Dispatch.dispatch(e.EVENT_CREATE_COMPLETE):(t&&LoadingUIModule.instance.show(this),void(this.p_onPreloadCreate||(this.p_onPreloadCreate=!0,RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onPreloadCreateComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.loadGroup("preloadCreate"))))},e.prototype.onPreloadCreateComplete=function(){LoadingUIModule.instance.hide(this),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onPreloadCreateComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),this.p_isLoadCreateOver=!0,Dispatch.dispatch(e.EVENT_CREATE_COMPLETE),this.preloadGame(!1)},e.prototype.preloadGame=function(t){if(void 0===t&&(t=!0),this.p_isLoadGameOver)return void Dispatch.dispatch(e.EVENT_MAINGAME_COMPLETE);if(t&&LoadingUIModule.instance.show(this),1!=this.p_onPreloadGame){this.p_onPreloadGame=!0,RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onPreloadGameComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this);var i,s=[],n=RES.getGroupByName("preloadGame");for(i=0;i<n.length;i++)s.push(n[i].name);if(URIManager.isdebug)for(n=RES.getGroupByName("preloadJson"),i=0;i<n.length;i++)s.push(n[i].name);else s.splice(0,0,"gamedata_bin");TextureLoadManager.instance.requestLoadTextureAtlas(TextureFrom.SYSTEM+PublicCon.PATH_REPLACE_URL,this,LoaderPriority.SKILL),TextureLoadManager.instance.requestLoadTextureAtlas(TextureFrom.SYSTEM+PublicCon.PATH_EFFECT_CLICK_STAGE,this,LoaderPriority.SKILL),TextureLoadManager.instance.requestLoadTextureAtlas(TextureFrom.UI_EFFECT+"resource/assets/uiEffect/main/meiyuan",this,LoaderPriority.EFFECT),RES.createGroup("gamePreload",s),RES.loadGroup("gamePreload")}},e.prototype.onloadComplete=function(t){},e.prototype.onPreloadGameComplete=function(t){void 0===t&&(t=null),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onPreloadGameComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),LoadingUIModule.instance.hide(this),this.p_isLoadGameOver=!0,SceneMainModule.instance.setLoadUI(!0),Dispatch.dispatch(e.EVENT_MAINGAME_COMPLETE)},e.prototype.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load")},e.prototype.onResourceProgress=function(t){"gamePreload"==t.groupName&&LoadingUIModule.instance.setloadCount(t.itemsLoaded,t.itemsTotal)},e.EVENT_LOGIN_COMPLETE="EVENT_LOGIN_COMPLETE",e.EVENT_CREATE_COMPLETE="EVENT_CREATE_COMPLETE",e.EVENT_MAINGAME_COMPLETE="EVENT_MAINGAME_COMPLETE",e}(egret.HashObject);__reflect(GamePreLoadManager.prototype,"GamePreLoadManager",["ITextureLoadEvent"]);var SoundMoude=function(){function t(){this.m_soundId=0,this.m_volume=1,this.m_cachingList=[],this.m_currList=[],this.m_volumeEffect=1,this.m_isMute=!1,this.m_isMuteEffect=!1,this.m_typeLoading=0
}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){Dispatch.register(PlayerManager.EVENT_PLAYER_INIT,this.initData,this)},t.prototype.initData=function(){var t=PlayerManager.instance.getSetingMsg(GameSetConfig.k_sound_bj),e=PlayerManager.instance.getSetingMsg(GameSetConfig.k_sound_effect),i=parseFloat(PlayerManager.instance.getSetingMsg(GameSetConfig.k_sound_size)),s=parseFloat(PlayerManager.instance.getSetingMsg(GameSetConfig.k_sound_effect_size));i&&i>=0?this.setSoundVolume(i):this.setSoundVolume(1),s&&s>=0?this.setSoundEffectVolume(s):this.setSoundEffectVolume(1),this.getBtnState(t)||(this.isMute=!0),this.getBtnState(e)||(this.isMuteEffect=!0)},t.prototype.getBtnState=function(t){return t?"true"==t?!0:!1:!0},t.prototype.proLoadSound=function(){if(!this.m_isMute&&null!=SceneManager.instance.p_sceneJson){var t=SceneManager.instance.p_sceneJson.sound,e=SoundJson.getBgSoundPath(t);""!=e&&this.m_soundId!=t&&0==this.m_typeLoading&&(this.m_typeLoading=1,this.m_soundId=t,RES.getResByUrl(e,this.onLoadCompleteSound,this,RES.ResourceItem.TYPE_SOUND))}},t.prototype.onLoadCompleteSound=function(t,e){this.m_isMute||(this.m_soundData=t,3==this.m_typeLoading?this.m_channel?TweenLite.to(this.m_channel,.3,{volume:0,onComplete:this.playSoundSure.bind(this)}):this.playSoundSure():this.m_typeLoading=2)},t.prototype.playSound=function(){this.m_isMute||0!=this.m_typeLoading&&(2==this.m_typeLoading?this.m_channel?TweenLite.to(this.m_channel,.3,{volume:0,onComplete:this.playSoundSure.bind(this)}):this.playSoundSure():this.m_typeLoading=3)},t.prototype.playSoundSure=function(){this.m_sound=null,this.m_channel&&(TweenLite.killTweensOf(this.m_channel),this.m_channel.stop(),this.m_channel=null),this.m_sound=this.m_soundData,this.m_sound&&(this.m_sound.type=egret.Sound.MUSIC,this.m_channel=this.m_sound.play(),this.m_channel.volume=0,TweenLite.to(this.m_channel,.3,{volume:this.soundValueReal}),this.m_typeLoading=0)},Object.defineProperty(t.prototype,"isMute",{get:function(){return this.m_isMute},set:function(t){this.m_isMute=t,this.m_isMute?(this.m_channel&&(TweenLite.killTweensOf(this.m_channel),this.m_channel.stop(),this.m_channel=null),this.m_sound=null,this.m_soundId=0,this.m_typeLoading=0):(this.proLoadSound(),this.playSound())},enumerable:!0,configurable:!0}),t.prototype.setSoundVolume=function(t){this.m_volume=t,this.m_channel&&(this.m_channel.volume=this.soundValueReal)},Object.defineProperty(t.prototype,"soundValueReal",{get:function(){var t=SoundJson.getData(this.m_soundId);return t&&t.sound_value>0?Number(Number(this.m_volume*(t.sound_value/100)).toFixed(2)):this.m_volume},enumerable:!0,configurable:!0}),t.prototype.playSoundEffect=function(t,e){if(void 0===e&&(e=1),!this.m_isMuteEffect){var i=SoundJson.getEffectSoundPath(t);if(""!=i){var s;s=this.m_cachingList.length>0?this.m_cachingList.shift():new SoundVo(this.backSoundEffects.bind(this)),s.play(t,i,e,this.m_volumeEffect),this.m_currList.push(s)}}},t.prototype.backSoundEffects=function(t){var e=this.m_currList.indexOf(t);e>-1&&this.m_currList.splice(e,1),this.m_cachingList.push(t)},t.prototype.stopSoundEffectAll=function(){for(var t in this.m_currList)this.m_currList[t].stop(!1),this.m_cachingList.push(this.m_currList[t]);this.m_currList=[]},t.prototype.setSoundEffectVolume=function(t){this.m_volumeEffect=t;for(var e in this.m_currList)this.m_currList[e].setSoundEffectVolume(this.m_volumeEffect)},Object.defineProperty(t.prototype,"isMuteEffect",{get:function(){return this.m_isMuteEffect},set:function(t){this.m_isMuteEffect=t},enumerable:!0,configurable:!0}),t}();__reflect(SoundMoude.prototype,"SoundMoude");var SoundVo=function(){function t(t){this.m_loops=-1,this.m_volumeEffect=1,this.m_backFunc=t}return t.prototype.play=function(t,e,i,s){void 0===i&&(i=1),void 0===s&&(s=1),this.m_loops=i,this.m_soundId=t,this.m_volumeEffect=s,RES.getResByUrl(e,this.onLoadComplete,this,RES.ResourceItem.TYPE_SOUND)},t.prototype.onLoadComplete=function(t,e){-1!=this.m_loops&&(this.m_sound=t,this.m_sound.type=egret.Sound.EFFECT,this.m_channel=this.m_sound.play(0,this.m_loops),this.m_channel.volume=this.soundEffectValueReal,this.m_channel.addEventListener(egret.Event.SOUND_COMPLETE,this.stop,this))},t.prototype.stop=function(t){void 0===t&&(t=!0),this.m_loops=-1,t&&null!=this.m_backFunc&&this.m_backFunc.apply(this,[this]),this.m_channel&&(this.m_channel.removeEventListener(egret.Event.SOUND_COMPLETE,this.stop,this),this.m_channel.stop(),this.m_channel=null)},t.prototype.setSoundEffectVolume=function(t){this.m_volumeEffect=t,this.m_channel&&(this.m_channel.volume=this.soundEffectValueReal)},Object.defineProperty(t.prototype,"soundEffectValueReal",{get:function(){var t=SoundJson.getData(this.m_soundId);return t&&t.sound_value>0?Number(Number(this.m_volumeEffect*(t.sound_value/100)).toFixed(2)):this.m_volumeEffect},enumerable:!0,configurable:!0}),t}();__reflect(SoundVo.prototype,"SoundVo");var LoadConfig=function(){function t(){}return t.RESCONFIG_LOADER="RESCONFIG_LOADER",t.RES_LOADER="URL_LOADER",t.DB_LOADER="DB_LOADER",t.PARTICLE_LOADER="PARTICLE_LOADER",t.EXML_LOADER="EXML_LOADER",t.JSON_LOADER="JSON_LOADER",t.UN_LOADER="UN_LOADER",t.GRADS_SWF=3,t.GRADS_DISPLAY=2,t.GRADS_BYTE=1,t.GRADS_OHTER=0,t.PROGRESS_BYTE=0,t.PROGRESS_FILE=1,t}();__reflect(LoadConfig.prototype,"LoadConfig");var LoaderViewFactory=function(){function t(){}return t.getLoaderView=function(t){switch(t){case LoaderViewType.MAIN:return LoadingUIModule.instance;case LoaderViewType.MAP:break;case LoaderViewType.MODULE:break;case LoaderViewType.DRAMA:break;case LoaderViewType.VIDEO:break;case LoaderViewType.PVPFIGHT:}return null},t}();__reflect(LoaderViewFactory.prototype,"LoaderViewFactory");var LoaderViewType=function(){function t(){}return t.DRAMA="DRAMA",t.MODULE="MODULE",t.MAIN="MAIN",t.MAP="MAP",t.VIDEO="VIDEO",t.PVPFIGHT="PVPFIGHT",t}();__reflect(LoaderViewType.prototype,"LoaderViewType");var LoadController=function(){function t(){this.m_loadList=new Array,this.m_notify=!0,this.m_loaderInfo="",this.spro=0,this.epro=0,this.stime=0,this.etime=0,this.m_multiTaskLoader=new MultiTaskLoader}return t.prototype.load=function(t,e,i,s,n){void 0===i&&(i="NULL"),void 0===s&&(s=""),void 0===n&&(n=!0),this.m_iLoadEvent=t,this.m_loadList=e,this.m_loadViewType=i,this.m_notify=n,this.m_loaderInfo=s,this.m_loaderView=LoaderViewFactory.getLoaderView(this.m_loadViewType),this.setProgress(0),this.setLoadCount(1),this.onStart(),this.spro=0,i==LoaderViewType.MAIN&&(this.m_multiTaskLoader.progressType=LoadConfig.PROGRESS_FILE),this.m_multiTaskLoader.load(e,this,this.onComplete,this.setProgress,this.onStart,this.setLoadCount)},t.prototype.onStart=function(){this.m_loaderView&&(this.m_loaderView.setLoadInfoText(this.m_loaderInfo),this.m_loaderView.show(this))},t.prototype.setProgress=function(t){if(this.m_loaderView&&this.m_loaderView.setProgress(t),this.epro=Number(100*t),!(this.epro-this.spro<1)){this.spro=this.epro;for(var e="当前加载进度:",i=0;100*t>i;i++)e+="-";Trace.log("--",e,t),this.etime=egret.getTimer(),this.stime=this.etime}},t.prototype.setLoadCount=function(t){Trace.log("LoadCount",t,this.m_loadList.length),this.m_loaderView&&this.m_loaderView.setloadCount(t,this.m_loadList.length)},t.prototype.onComplete=function(){this.m_loaderView&&this.m_loaderView.hide(this),this.m_notify&&this.m_iLoadEvent.onComplete()},t.prototype.destory=function(){this.m_multiTaskLoader.destory(),this.m_loadList.length=0,this.m_iLoadEvent=null},t}();__reflect(LoadController.prototype,"LoadController");var LoaderPriority=function(){function t(){}return t.DRAMA_EFFECT=0,t.ROLEMOTION=1,t.EFFECT=2,t.SKILL=3,t.IMAGE=4,t.PREROLEMOTION=5,t.DRAMA_CSV=6,t.MAP=7,t.MAPUNIT=8,t.DRAGON=9,t.UIEFFECT=10,t.IDLELOAD=11,t}();__reflect(LoaderPriority.prototype,"LoaderPriority");var LoadItem=function(){function t(t,e,i){this.url="",this.loadType="",this.priority=10,this.url=t,this.loadType=e,this.priority=i}return t.TEXTUREMAP="TEXTUREMAP",t.TEXTUREATLAS="TEXTUREATLAS",t.DRAGON="DRAGON",t}();__reflect(LoadItem.prototype,"LoadItem");var LoadTaskFactory=function(){function t(){}return t.createSwfItem=function(t,e,i){void 0===e&&(e=null)},t.createResConfigItem=function(t,e,i){return void 0===e&&(e=null),new LoadTaskItem(t,LoadConfig.RESCONFIG_LOADER,RES.ResourceItem.TYPE_IMAGE,e,i)},t.createImageItem=function(t,e,i){return void 0===e&&(e=null),new LoadTaskItem(t,LoadConfig.RES_LOADER,RES.ResourceItem.TYPE_IMAGE,e,i)},t.createDBItem=function(t,e,i){return void 0===e&&(e=null),void 0===i&&(i=null),new LoadTaskItem(t,LoadConfig.DB_LOADER,RES.ResourceItem.TYPE_IMAGE,e,i)},t.createExmlItem=function(t,e,i){var s=e;return null==s&&(s=function(t,e){EXML.parse(t.toString())}),new LoadTaskItem(t,LoadConfig.EXML_LOADER,RES.ResourceItem.TYPE_TEXT,s,i)},t.creatConfigItem=function(t,e,i){var s=e;return null==s&&(s=function(e,i){JsonUtil.analyze(t,e)}),null!=t.jsonData&&t.jsonData.length>0?this.createUnLoadItem():new LoadTaskItem("resource/json/"+t.FileName+".json",LoadConfig.JSON_LOADER,RES.ResourceItem.TYPE_TEXT,s,i)},t.createJsonItem=function(t,e,i){return void 0===e&&(e=null),new LoadTaskItem(t,LoadConfig.JSON_LOADER,RES.ResourceItem.TYPE_JSON,e,i)},t.createUnLoadItem=function(t,e,i){return void 0===t&&(t=""),void 0===e&&(e=null),void 0===i&&(i=null),new LoadTaskItem(t+Math.random,LoadConfig.UN_LOADER,RES.ResourceItem.TYPE_IMAGE,e,i)},t}();__reflect(LoadTaskFactory.prototype,"LoadTaskFactory");var LoadTaskItem=function(){function t(t,e,i,s,n){this.url=t,this.loaderType=e,this.dataFormat=i,this.callBackFunction=s,this.callBackObject=n}return t.prototype.callBack=function(t){null!=this.callBackFunction&&this.callBackFunction.call(this.callBackObject,[t])},t}();__reflect(LoadTaskItem.prototype,"LoadTaskItem");var MultiTaskLoader=function(){function t(){this.m_completeLoadCount=0,this.m_errorDictDiction=new Object,this.progressType=LoadConfig.PROGRESS_BYTE}return t.prototype.load=function(t,e,i,s,n,o){this.reset(),this.m_LoadTaskList=t,this.m_loadController=e,this.m_onCompleteFunc=i,this.m_setProgressFunc=s,this.m_setLoadCount=o,this.m_onStartFunc=n,this.starLoading()},t.prototype.starLoading=function(){this.m_onStartFunc.call(this.m_loadController),this.m_taskDict=[];for(var t=0;t<this.m_LoadTaskList.length;t++){var e=this.m_LoadTaskList[t];this.m_taskDict[e.url]=e,this.loadTaskItem(e)}},t.prototype.loadTaskItem=function(t){switch(t.loaderType){case LoadConfig.RES_LOADER:RES.getResByUrl(t.url,this.onResComplete,this,t.dataFormat);break;case LoadConfig.DB_LOADER:Trace.log("loadTaskItem","DB_LOADER",t.url);break;case LoadConfig.PARTICLE_LOADER:break;case LoadConfig.EXML_LOADER:RES.getResByUrl(t.url,this.onResComplete,this,t.dataFormat);break;case LoadConfig.JSON_LOADER:RES.getResByUrl(t.url,this.onResComplete,this,RES.ResourceItem.TYPE_JSON);break;case LoadConfig.UN_LOADER:this.onResComplete(null,t.url);break;case LoadConfig.RESCONFIG_LOADER:RES.getResAsync(t.url,this.onResComplete,this);break;default:Trace.log("不存在加载类型",t.loaderType)}},Object.defineProperty(t.prototype,"loadTaskList",{get:function(){return this.m_LoadTaskList},enumerable:!0,configurable:!0}),t.prototype.onResComplete=function(t,e){this.onComplete(t,e)},t.prototype.onloadComplete=function(t){Trace.log("onloadComplete",t),this.onComplete(null,t)},t.prototype.onComplete=function(t,e){var i=this.m_taskDict[e].callBackFunction;null!=i&&i.call(this.m_taskDict[e].callBackObject,t,e),this.m_completeLoadCount++,this.m_setProgressFunc.call(this.m_loadController,[this.m_completeLoadCount/this.m_LoadTaskList.length]),this.m_setLoadCount.call(this.m_loadController,[this.m_completeLoadCount]),this.m_completeLoadCount>=this.m_LoadTaskList.length&&(this.m_setProgressFunc.call(this.m_loadController,[1]),this.m_setLoadCount.call(this.m_loadController,[this.m_completeLoadCount]),this.m_onCompleteFunc.call(this.m_loadController))},t.prototype.loadProgress=function(t){},t.prototype.ioError=function(t){},t.prototype.destory=function(){},t.prototype.reset=function(){this.m_LoadTaskList=null,this.m_taskDict=[],this.m_completeLoadCount=0,this.m_onCompleteFunc=null,this.m_setProgressFunc=null},t}();__reflect(MultiTaskLoader.prototype,"MultiTaskLoader");var TextureFrom=function(){function t(){}return t.SYSTEM="SYSTEM$",t.SKILL="SKILL$",t.BUFF="BUFF$",t.PET="PET$",t.MONSTER="MONSTER$",t.COLLECT="COLLECT$",t.CHARACTER="CHARACTER$",t.CHARACTER_WEAPON="CHARACTER_WEAPON$",t.MOUNT="MOUNT$",t.NPC="NPC$",t.MAP="MAP$",t.EFFECT="EFFECT$",t.MONSTER_EFFECT="MONSTER_EFFECT$",t.SCENEEFFECT="SCENEEFFECT$",t.UI_EFFECT="UI_EFFECT$",t.SKILL_UNDELATE="SKILL_UNDELATE$",t.checkList=[],t}();__reflect(TextureFrom.prototype,"TextureFrom");var TextureLoadManager=function(t){function e(){var i=t.call(this)||this;return i.m_waitloading=!0,i.m_loadedDict=new Object,i.m_loadDict=[],i.m_loaderDict=[],i.m_nowLoadList=[],i.m_waitLoadList=[],i.m_idleloadList=[],egret.Capabilities.runtimeType==egret.RuntimeType.WXGAME?(e.THREAD=5,e.LOAD_IDLE_THREAD=2):(e.THREAD=10,e.LOAD_IDLE_THREAD=2),i}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.m_instance||(this.m_instance=new e),this.m_instance},enumerable:!0,configurable:!0}),e.prototype.startLoadItem=function(t){var e=this.m_waitLoadList.indexOf(t);switch(-1!=e&&this.m_waitLoadList.splice(e,1),this.m_nowLoadList.push(t),this.m_loadedDict[t.url]=!0,t.loadType){case LoadItem.TEXTUREMAP:this.m_loaderDict[t.url]=new TextureLoaderMap(t.url);break;case LoadItem.TEXTUREATLAS:this.m_loaderDict[t.url]=new TextureLoaderAtlasItem(t.url);break;case LoadItem.DRAGON:this.m_loaderDict[t.url]=new TextureLoaderDragonItem(t.url);break;default:throw new Error("无加载类型  无法加载  TextureLoadManager:65")}},e.prototype.endLoadItem=function(t){for(var i=0;i<this.m_nowLoadList.length;i++)if(this.m_nowLoadList[i].url==t){var s=this.m_nowLoadList[i];this.m_nowLoadList.splice(i,1),s=null;break}this.m_nowLoadList.length<e.THREAD?(this.m_waitLoadList.length>0&&this.startLoadItem(this.m_waitLoadList[0]),this.m_nowLoadList.length<=e.LOAD_IDLE_THREAD&&(this.m_waitloading=!1,Dispatch.dispatch(e.EVENT_WAITLOADING_END),this.startIdleLoad())):(this.m_waitloading=!0,this.checkOnLoadedRes())},e.prototype.waitLoadItem=function(t){this.closeIdleLoad(t.url),this.m_waitLoadList.push(t),this.m_waitLoadList.sort(this.sortPriority),this.m_nowLoadList.length<e.THREAD?(this.m_waitLoadList.length>0&&this.startLoadItem(this.m_waitLoadList[0]),this.m_nowLoadList.length<=e.LOAD_IDLE_THREAD&&(this.m_waitloading=!1,Dispatch.dispatch(e.EVENT_WAITLOADING_END),this.startIdleLoad())):(this.m_waitloading=!0,this.checkOnLoadedRes())},e.prototype.checkOnLoadedRes=function(){for(var t=0;t<this.m_waitLoadList.length;t++)1==this.m_loadedDict[this.m_waitLoadList[t].url]&&(this.startLoadItem(this.m_waitLoadList[t]),t--)},e.prototype.closeLoad=function(t,e){if("null"!=t&&""!=t){var i=this.m_loadDict[t];if(i){var s=i.indexOf(e);-1!=s&&i.splice(s,1)}if(this.closeIdleLoad(t),!i||0==i.length){var n=this.m_loaderDict[t];n&&(n.destory(),n=null,delete this.m_loaderDict[t]);var o=this.getLoaderItem(t);if(o){var a=this.m_waitLoadList.indexOf(o);-1!=a&&this.m_waitLoadList.splice(a,1),a=this.m_nowLoadList.indexOf(o),-1!=a&&this.endLoadItem(o.url)}}}},e.prototype.getLoaderItem=function(t){for(var e=0;e<this.m_waitLoadList.length;e++)if(this.m_waitLoadList[e].url==t)return this.m_waitLoadList[e];for(var i=0;i<this.m_nowLoadList.length;i++)if(this.m_nowLoadList[i].url==t)return this.m_nowLoadList[i];return null},e.prototype.addIdleLoad=function(t){if(DelayCallUtils.killDelayedCallsTo(this.startIdleLoad,this),null!=this.m_loadDict[t.url]&&this.m_loadDict[t.url].length>0)return void this.startIdleLoadTime();for(var e=0;e<this.m_idleloadList.length;e++)if(this.m_idleloadList[e].url==t.url)return;this.m_idleloadList.push(t),this.m_idleloadList.sort(this.sortPriority),this.startIdleLoadTime()},e.prototype.startIdleLoadTime=function(){this.startIdleLoad()},e.prototype.startIdleLoad=function(){if(e.enableIdleLoad&&this.m_idleloadList.length>0&&this.m_nowLoadList.length<=e.LOAD_IDLE_THREAD){if(null==this.m_idleloadList[0].url)return this.m_idleloadList.shift(),void this.startIdleLoad();this.waitLoadItem(this.m_idleloadList.shift()),this.m_nowLoadList.length<=1&&this.startIdleLoad()}},e.prototype.closeIdleLoad=function(t){var e=this.m_loadDict[t];if(!e||0==e.length)for(var i=0;i<this.m_idleloadList.length;i++)this.m_idleloadList[i].url==t&&(this.m_idleloadList.splice(i,1),i--)},e.prototype.sortPriority=function(t,e){return t.priority-e.priority},e.prototype.onRequestLoad=function(t,e){var i=this.m_loadDict[t];return i&&-1!=i.indexOf(e)?!0:!1},e.prototype.requestLoadTextureMap=function(t,e,i,s){if(void 0===s&&(s=!1),"null"!=t){var n=t;TexturePool.instance.getTextureMap(n)?e&&e.onloadComplete(n):(s&&this.addIdleLoad(new LoadItem(n,LoadItem.TEXTUREMAP,i)),this.m_loadDict[n]?(-1==this.m_loadDict[n].indexOf(e)&&this.m_loadDict[n].push(e),this.getLoaderItem(n)||s||this.waitLoadItem(new LoadItem(n,LoadItem.TEXTUREMAP,i))):(this.m_loadDict[n]=[e],s||this.waitLoadItem(new LoadItem(n,LoadItem.TEXTUREMAP,i))))}},e.prototype.requestLoadTextureAtlas=function(t,e,i,s){if(void 0===s&&(s=!1),"null"!=t){var n=t;TexturePool.instance.getTextureAtlas(n)?e&&e.onloadComplete(n):(s&&this.addIdleLoad(new LoadItem(n,LoadItem.TEXTUREATLAS,i)),this.m_loadDict[n]?(-1==this.m_loadDict[n].indexOf(e)&&this.m_loadDict[n].push(e),this.getLoaderItem(n)||s||this.waitLoadItem(new LoadItem(n,LoadItem.TEXTUREATLAS,i))):(this.m_loadDict[n]=[e],s||this.waitLoadItem(new LoadItem(n,LoadItem.TEXTUREATLAS,i))))}},e.prototype.requestLoadDragon=function(t,e,i,s){if(void 0===s&&(s=!1),"null"!=t){var n=t;TexturePool.instance.getTextureDragon(n)?e&&e.onloadComplete(n):(s&&this.addIdleLoad(new LoadItem(n,LoadItem.DRAGON,i)),this.m_loadDict[n]?(-1==this.m_loadDict[n].indexOf(e)&&this.m_loadDict[n].push(e),this.getLoaderItem(n)||s||this.waitLoadItem(new LoadItem(n,LoadItem.DRAGON,i))):(this.m_loadDict[n]=[e],s||this.waitLoadItem(new LoadItem(n,LoadItem.DRAGON,i))))}},e.prototype.onLoadItemComplete=function(t){var e=t.key;if(this.m_loadDict[e]){for(var i=this.m_loadDict[e],s=0;s<i.length;s++)i[s]&&i[s].onloadComplete(e);i.length=0,i=null,this.m_loadDict[e]=null,delete this.m_loadDict[e],this.m_loaderDict[e]=null,delete this.m_loaderDict[e]}t.destory(),t=null,this.endLoadItem(e)},e.prototype.onLoadItemError=function(t){console.log("加载失败",t.key),this.endLoadItem(t.key),t.destory()},e.prototype.printLoadList=function(){console.log("当前正在加载的项");var t=0;for(t=0;t<this.m_nowLoadList.length;t++)console.log("idx",t,this.m_nowLoadList[t].url);for(console.log("\n\n\n\n\n\n当前等待加载的项"),t=0;t<this.m_waitLoadList.length;t++)console.log("idx",t,this.m_waitLoadList[t].url)},e.EVENT_WAITLOADING_END="EVENT_WAITLOADING_END",e.THREAD=2,e.LOAD_IDLE_THREAD=2,e.enableIdleLoad=!0,e}(egret.HashObject);__reflect(TextureLoadManager.prototype,"TextureLoadManager");var TexturePool=function(t){function e(){var i=t.call(this)||this;return i.m_texturePoolMap={},i.m_textureAtlasPool={},i.m_textureDragonPool={},i.disposeSize=130,i.disposeSizeDragon=200,i.m_removeCloseTime=0,e.showTextureUse&&(i.textureUseLabel=new egret.TextField,i.textureUseLabel.x=100,i.textureUseLabel.y=200,i.textureUseLabel.stroke=1,i.textureUseLabel.size=24,i.textureUseLabel.touchEnabled=!1,StageManager.instance.popUplayer.addChild(i.textureUseLabel)),i}return __extends(e,t),e.prototype.showTextureUse=function(){e.showTextureUse=!0,e.showTextureUse&&!this.textureUseLabel&&(this.textureUseLabel=new egret.TextField,this.textureUseLabel.x=100,this.textureUseLabel.y=200,this.textureUseLabel.stroke=1,this.textureUseLabel.size=24,this.textureUseLabel.touchEnabled=!0,StageManager.instance.popUplayer.addChild(this.textureUseLabel))},Object.defineProperty(e,"instance",{get:function(){return this.m_instance||(this.m_instance=new e),this.m_instance},enumerable:!0,configurable:!0}),e.prototype.addCommonUseTexture=function(t){if(null!=t&&t.length>0){var e=t[0];if(e.fromAtlas){var i=e.fromAtlas;i.addUse(this.hashCode)}}},e.prototype.getFileUrl=function(t){var e=t.split("$"),i=e.length>=2?e[e.length-1]:t;return i},e.prototype.pushTextureAtlas=function(t,e){var i=this.getTextAtlasKey(this.getFileUrl(t));this.m_textureAtlasPool[i]||(this.m_textureAtlasPool[i]={mc:e,key:t})},e.prototype.getTextureAtlas=function(t){var e=this.getTextAtlasKey(this.getFileUrl(t));return this.m_textureAtlasPool[e]?this.m_textureAtlasPool[e].mc.textures:null},e.prototype.destoryTextureAtlas=function(t){var e=this.getTextAtlasKey(this.getFileUrl(t));if(this.m_textureAtlasPool[e]){var i=this.m_textureAtlasPool[e].mc;i&&i.useNum<=0&&(delete this.m_textureAtlasPool[e],i.dispose(),i=null,RES.destroyRes(e+".png"),RES.destroyRes(e+".json"))}},e.prototype.getTextAtlasKey=function(t){var e=t;return Object(/^.+\.png$/).test(e)?e=e.replace(/\.png$/,""):Object(/^.+\.jpg$/).test(e)?e=e.replace(/\.jpg$/,""):Object(/^.+\.json$/).test(e)&&(e=e),e},e.prototype.pushTextureDragon=function(t,e){var i=this.getFileUrl(t);this.m_textureDragonPool[i]||(this.m_textureDragonPool[i]={mc:e,key:t})},e.prototype.getTextureDragon=function(t,e){void 0===e&&(e=0);var i=this.getFileUrl(t);if(this.m_textureDragonPool[i]){var s=this.m_textureDragonPool[i].mc;if(s)return s.addUse(e),s.dataInfo}return null},e.prototype.pushTextureMap=function(t,e){var i=this.getFileUrl(t);this.m_texturePoolMap[i]||(this.m_texturePoolMap[i]={mc:new TextureMap(e),key:t})},e.prototype.getTextureMap=function(t){var e=this.getFileUrl(t);return this.m_texturePoolMap[e]?this.m_texturePoolMap[e].mc.texture:null},e.prototype.addTextureMapUse=function(t,e){if(null!=t){var i=t;if(i.fromItem){var s=i.fromItem;s.addUse(e.hashCode)}}},e.prototype.removeTextureMapUse=function(t,e){if(null!=t){var i=t;if(i.fromItem){var s=i.fromItem;s.removeUse(e.hashCode)}}},e.prototype.destoryTextureDragon=function(t,e){void 0===e&&(e=0);var i=this.getFileUrl(t);if(this.m_textureDragonPool[i]){var s=this.m_textureDragonPool[i].mc;if(s&&s.removeUse(e),s&&s.useNum<=0){delete this.m_textureDragonPool[i],s.dispose(),s=null,RES.destroyRes(t);var n=t.split("/"),o=n[n.length-2]+"/"+n[n.length-1];dragonBones.EgretFactory.factory.getDragonBonesData(o)&&dragonBones.EgretFactory.factory.removeDragonBonesData(o),dragonBones.EgretFactory.factory.getTextureAtlasData(o)&&dragonBones.EgretFactory.factory.removeTextureAtlasData(o)}}},e.prototype.destoryTextureMap=function(t){var e=this.getFileUrl(t);if(this.m_texturePoolMap[e]){var i=this.m_texturePoolMap[e].mc;i&&i.useNum<=0&&(delete this.m_texturePoolMap[e],i.dispose(),i=null,RES.destroyRes(e))}},e.prototype.destoryAtlasFrom=function(t){var e=[];for(var i in this.m_textureAtlasPool){var s=this.m_textureAtlasPool[i].mc,n=this.m_textureAtlasPool[i].key;if(s&&s.useNum<=0){var o=n.split("$");o[1]+"$"==t&&e.push(i)}}for(var a=0;a<e.length;a++)this.destoryTextureAtlas(e[a])},e.prototype.destoryTextureAll=function(t){if(void 0===t&&(t=!1),!(ServerTimeManager.instance.timerValue<=this.m_removeCloseTime)||t){this.m_removeCloseTime=ServerTimeManager.instance.timerValue+300;var e=[];for(var i in this.m_textureAtlasPool){var s=this.m_textureAtlasPool[i].mc,n=this.m_textureAtlasPool[i].key;if(s&&s.useNum<=0){var o=n.split("$");o&&2==o.length&&(TextureFrom.checkList.indexOf(o[0]+"$")>-1||o[0]+"$"==TextureFrom.SKILL_UNDELATE)||e.push(i)}}for(var a=0;a<e.length;a++)this.destoryTextureAtlas(e[a]);e=[];for(var n in this.m_texturePoolMap){var r=this.m_texturePoolMap[n].mc;r&&r.useNum<=0&&e.push(n)}for(var a=0;a<e.length;a++)this.destoryTextureMap(e[a])}},e.prototype.destoryUselessDragon=function(){for(var t in this.m_textureDragonPool)if(this.m_textureDragonPool[t]){var e=this.m_textureDragonPool[t].mc;e&&e.useNum<=0&&this.destoryTextureDragon(t)}},e.getTextureSize=function(t,i){return t*i*4/e.MBSZIE},e.getTexturePower2Size=function(t,i){return t=e.getNextPowerOfTwo(t),i=e.getNextPowerOfTwo(i),t*i*4/e.MBSZIE},e.getNextPowerOfTwo=function(t){if(t>0&&0==(t&t-1))return t;var e=1;for(t-=1e-9;t>e;)e<<=1;return e},e.showTextureUse=!1,e.allTextureSize=0,e.allTexturePower2Size=0,e.MBSZIE=1048576,e}(egret.HashObject);__reflect(TexturePool.prototype,"TexturePool");var TextureAtlas=function(){function t(t,e){this.m_textureDataList=[],this.m_textrues=[],this.m_useLib=[],this.m_textureSize=0,this.m_texturePower2Size=0,this.m_texture=t,this.m_textureData=e,this.m_textureSheet=new egret.SpriteSheet(t);for(var i in this.m_textureData.frames){var s=this.m_textureData.frames[i];s.key=i,this.m_textureDataList.push(s);var n=this.m_textureSheet.createTexture(i,s.x,s.y,s.w,s.h,s.offX,s.offY,s.sourceW,s.sourceH),o=n;o.name=i,o.fromAtlas=this,this.m_textrues.push(n)}this.m_textrues.sort(this.sortTexturesByName),this.m_textureSize=TexturePool.getTextureSize(this.m_texture.textureWidth,this.m_texture.textureHeight),this.m_texturePower2Size=TexturePool.getTexturePower2Size(this.m_texture.textureWidth,this.m_texture.textureHeight),TexturePool.allTextureSize+=this.m_textureSize,TexturePool.allTexturePower2Size+=this.m_texturePower2Size,TexturePool.instance.textureUseLabel&&(TexturePool.instance.textureUseLabel.text="Size:"+TexturePool.allTextureSize+"\nPower2Size:"+TexturePool.allTexturePower2Size),TexturePool.allTextureSize>TexturePool.instance.disposeSize&&TexturePool.instance.destoryTextureAll()}return t.prototype.sortTexturesByName=function(t,e){var i=t.name,s=e.name;return s>i?-1:i>s?1:0},Object.defineProperty(t.prototype,"textures",{get:function(){return this.m_textrues.concat()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textureSize",{get:function(){return this.m_textureSize},enumerable:!0,configurable:!0}),t.prototype.addUse=function(t){var e=this.m_useLib.indexOf(t);-1==e&&this.m_useLib.push(t)},t.prototype.removeUse=function(t){var e=this.m_useLib.indexOf(t);-1!=e&&this.m_useLib.splice(e,1)},Object.defineProperty(t.prototype,"useNum",{get:function(){return this.m_useLib.length},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){for(this.m_textureData=null,this.m_textureDataList.length=0,this.m_textureDataList=null,this.m_textureSheet.dispose(),this.m_textureSheet=null,this.m_texture.disposeBitmapData=!0,this.m_texture.dispose(),this.m_texture=null;this.m_textrues.length;){var t=this.m_textrues.shift();t.dispose(),t.name=null,t.fromAtlas=null}this.m_textrues.length=0,this.m_textrues=null,this.m_useLib.length=0,this.m_useLib=null,TexturePool.allTextureSize-=this.m_textureSize,TexturePool.allTexturePower2Size-=this.m_texturePower2Size,this.m_textureSize=0,this.m_texturePower2Size=0,TexturePool.instance.textureUseLabel&&(TexturePool.instance.textureUseLabel.text="Size:"+TexturePool.allTextureSize+"\nPower2Size:"+TexturePool.allTexturePower2Size)},t}();__reflect(TextureAtlas.prototype,"TextureAtlas");var TextureDragon=function(){function t(e,i,s){this.m_useLib=[],this.m_dragonSize=0,this.m_dragonPower2Size=0,this.m_createTime=0,this.m_texture=e,this.m_ske=i,this.m_tex=s,this.m_dragonSize=TexturePool.getTextureSize(this.m_texture.textureWidth,this.m_texture.textureHeight),this.m_dragonPower2Size=TexturePool.getTexturePower2Size(this.m_texture.textureWidth,this.m_texture.textureHeight),t.allDragonSize+=this.m_dragonSize,t.allDragonPower2Size+=this.m_dragonPower2Size,this.m_createTime=EnterFrameManager.getTimer,TexturePool.instance.textureUseLabel&&(TexturePool.instance.textureUseLabel.text="Size:"+t.allDragonSize+"\nPower2Size:"+t.allDragonPower2Size),t.allDragonSize>TexturePool.instance.disposeSizeDragon}return Object.defineProperty(t.prototype,"dataInfo",{get:function(){return[this.m_ske,this.m_tex,this.m_texture]},enumerable:!0,configurable:!0}),t.prototype.addUse=function(t){if(t>0){var e=this.m_useLib.indexOf(t);-1==e&&this.m_useLib.push(t)}},t.prototype.removeUse=function(t){var e=this.m_useLib.indexOf(t);-1!=e&&this.m_useLib.splice(e,1)},Object.defineProperty(t.prototype,"useNum",{get:function(){return EnterFrameManager.getTimer-this.m_createTime<1e3?1:this.m_useLib.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textureSize",{get:function(){return this.m_dragonSize},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){this.m_ske=null,this.m_tex=null,this.m_useLib.length=0,this.m_useLib=null,t.allDragonSize-=this.m_dragonSize,t.allDragonPower2Size-=this.m_dragonPower2Size,this.m_dragonSize=0,this.m_dragonPower2Size=0,TexturePool.instance.textureUseLabel&&(TexturePool.instance.textureUseLabel.text="Size:"+t.allDragonSize+"\nPower2Size:"+t.allDragonPower2Size)},t.allDragonSize=0,t.allDragonPower2Size=0,t}();__reflect(TextureDragon.prototype,"TextureDragon");var TextureMap=function(){function t(t){this.m_useLib=[],this.m_textureSize=0,this.m_texturePower2Size=0,this.m_texture=t;var e=this.m_texture;e.fromItem=this,this.m_textureSize=TexturePool.getTextureSize(this.m_texture.textureWidth,this.m_texture.textureHeight),this.m_texturePower2Size=TexturePool.getTexturePower2Size(this.m_texture.textureWidth,this.m_texture.textureHeight),TexturePool.allTextureSize+=this.m_textureSize,TexturePool.allTexturePower2Size+=this.m_texturePower2Size,TexturePool.instance.textureUseLabel&&(TexturePool.instance.textureUseLabel.text="Size:"+TexturePool.allTextureSize+"\nPower2Size:"+TexturePool.allTexturePower2Size),TexturePool.allTextureSize>TexturePool.instance.disposeSize&&TexturePool.instance.destoryTextureAll()}return Object.defineProperty(t.prototype,"texture",{get:function(){return this.m_texture},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textureSize",{get:function(){return this.m_textureSize},enumerable:!0,configurable:!0}),t.prototype.addUse=function(t){var e=this.m_useLib.indexOf(t);-1==e&&this.m_useLib.push(t)},t.prototype.removeUse=function(t){if(null!=this.m_useLib){var e=this.m_useLib.indexOf(t);-1!=e&&this.m_useLib.splice(e,1)}},Object.defineProperty(t.prototype,"useNum",{get:function(){return this.m_useLib.length},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){this.m_texture.disposeBitmapData=!0,this.m_texture.dispose(),this.m_texture=null,this.m_useLib.length=0,this.m_useLib=null,TexturePool.allTextureSize-=this.m_textureSize,TexturePool.allTexturePower2Size-=this.m_texturePower2Size,this.m_textureSize=0,this.m_texturePower2Size=0,TexturePool.instance.textureUseLabel&&(TexturePool.instance.textureUseLabel.text="Size:"+TexturePool.allTextureSize+"\nPower2Size:"+TexturePool.allTexturePower2Size)},t}();__reflect(TextureMap.prototype,"TextureMap");var TextureLoaderAtlasItem=function(){function t(t){this.m_tFrom="",this.m_fileType=".png",this.m_url=t;var e="",i=this.m_url.split("$");i.length>=2&&(this.m_tFrom=i[0]+"$",e=i[1]),""==e&&(e=this.m_url);var s="",n="";Object(/^.+\.png$/).test(e)?(n=".png",s=e.replace(/\.png$/,"")):Object(/^.+\.jpg$/).test(e)?(n=".jpg",s=e.replace(/\.jpg$/,"")):(n=".png",s=e),this.m_imgurl=s+n,this.m_jsonurl=s+".json",RES.getResByUrl(this.m_imgurl,this.onLoadComplete,this,RES.ResourceItem.TYPE_IMAGE),RES.getResByUrl(this.m_jsonurl,this.onLoadComplete,this,RES.ResourceItem.TYPE_JSON)}return t.prototype.onLoadComplete=function(t,e){e==this.m_imgurl&&(this.m_texture=t),e==this.m_jsonurl&&(this.m_data=t),this.m_data&&this.m_texture&&(TexturePool.instance.pushTextureAtlas(this.m_url,new TextureAtlas(this.m_texture,this.m_data)),TextureLoadManager.instance.onLoadItemComplete(this))},t.prototype.onLoadError=function(){TextureLoadManager.instance.onLoadItemError(this)},Object.defineProperty(t.prototype,"key",{get:function(){return this.m_url},enumerable:!0,configurable:!0}),t.prototype.destory=function(){},t}();__reflect(TextureLoaderAtlasItem.prototype,"TextureLoaderAtlasItem",["ITextureLoad"]);var TextureLoaderDragonItem=function(){function t(t){this.m_tFrom="",this.m_loadCount=3,this.m_url=t;var e="",i=this.m_url.split("$");i.length>=2&&(this.m_tFrom=i[0]+"$",e=i[1]),""==e&&(e=this.m_url);var s="",n="";Object(/^.+\.png$/).test(e)?(n="_tex.png",s=e.replace(/\.png$/,"")):Object(/^.+\.jpg$/).test(e)?(n="_tex.jpg",s=e.replace(/\.jpg$/,"")):(n="_tex.png",s=e),this.m_imgUrl=s+n,this.m_skeUrl=s+"_ske.json",this.m_texUrl=s+"_tex.json";
var o=[];o.push(this.m_imgUrl),RES.$addResourceData({name:this.m_imgUrl,type:RES.ResourceItem.TYPE_IMAGE,url:this.m_imgUrl}),o.push(this.m_skeUrl),RES.$addResourceData({name:this.m_skeUrl,type:RES.ResourceItem.TYPE_JSON,url:this.m_skeUrl}),o.push(this.m_texUrl),RES.$addResourceData({name:this.m_texUrl,type:RES.ResourceItem.TYPE_JSON,url:this.m_texUrl}),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onLoadCompleteDragon,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onLoadErrorDragon,this),RES.createGroup(s,o),RES.loadGroup(s)}return t.prototype.onLoadCompleteDragon=function(t){void 0===t&&(t=null),this.m_texture=RES.getRes(this.m_imgUrl),this.m_ske=RES.getRes(this.m_skeUrl),this.m_tex=RES.getRes(this.m_texUrl),this.m_texture&&this.m_ske&&this.m_tex&&(TexturePool.instance.pushTextureDragon(this.m_url,new TextureDragon(this.m_texture,this.m_ske,this.m_tex)),TextureLoadManager.instance.onLoadItemComplete(this))},t.prototype.onLoadErrorDragon=function(t){TextureLoadManager.instance.onLoadItemError(this)},Object.defineProperty(t.prototype,"key",{get:function(){return this.m_url},enumerable:!0,configurable:!0}),t.prototype.destory=function(){},t}();__reflect(TextureLoaderDragonItem.prototype,"TextureLoaderDragonItem",["ITextureLoad"]);var TextureLoaderMap=function(){function t(t){this.m_tFrom="",this.m_fileType=".png",this.m_url=t;var e="",i=this.m_url.split("$");i.length>=2&&(this.m_tFrom=i[0]+"$",e=i[1]),""==e&&(e=this.m_url);var s="",n="";Object(/^.+\.png$/).test(e)?(n=".png",s=e.replace(/\.png$/,"")):Object(/^.+\.jpg$/).test(e)?(n=".jpg",s=e.replace(/\.jpg$/,"")):(n=".png",s=e),this.m_loaderUrl=s+n,RES.getResByUrl(this.m_loaderUrl,this.onLoadComplete,this,RES.ResourceItem.TYPE_IMAGE)}return t.prototype.onLoadComplete=function(t,e){TexturePool.instance.pushTextureMap(this.m_url,t),TextureLoadManager.instance.onLoadItemComplete(this)},t.prototype.onLoadError=function(){TextureLoadManager.instance.onLoadItemError(this)},Object.defineProperty(t.prototype,"key",{get:function(){return this.m_url},enumerable:!0,configurable:!0}),t.prototype.destory=function(){},t}();__reflect(TextureLoaderMap.prototype,"TextureLoaderMap",["ITextureLoad"]);var AchievementManager=function(){function t(){this.m_achive_data={},this.p_WithdrawalType=9999,this.achievementClick=!0}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){MessageManager.register(MessageType.m_achievement_get_info_toc,this.c_achievement_get_info,this),MessageManager.register(MessageType.m_achievement_get_award_toc,this.c_achievement_get_award,this),MessageManager.register(MessageType.m_achievement_notice_update_achievement_data_toc,this.c_achievement_notice_update_achievement_data,this)},t.prototype.initData=function(t){this.m_achive_data={};for(var e=0;e<t.length;e++)this.m_achive_data[t[e].type]=t[e];EntranceModule.instance.setEntranceVisible(ChargeManager.instance.isShowWithdrawal,FunctionEnum.WITHDRAWAL_SYS),this.setDrawRed(),this.setFuncRed()},t.prototype.s_achievement_get_info=function(){var t=MessageProtocol.getClass(MessageType.m_achievement_get_info_tos);MessageProtocol.sendMessage(MessageType.m_achievement_get_info_tos,t)},t.prototype.c_achievement_get_info=function(e){this.m_achive_data={};for(var i=0;i<e.achievement_data_list.length;i++)this.m_achive_data[e.achievement_data_list[i].type]=e.achievement_data_list[i];Dispatch.dispatch(t.EVENT_ACHIEVE_GET_INFO)},t.prototype.s_achievement_get_award=function(t){if(this.achievementClick){this.achievementClick=!1;var e=MessageProtocol.getClass(MessageType.m_achievement_get_award_tos);e.type=t,MessageProtocol.sendMessage(MessageType.m_achievement_get_award_tos,e)}},t.prototype.c_achievement_get_award=function(e){switch(this.achievementClick=!0,e.result){case proto.m_achievement_get_award_toc.ENUM.success:var i=this.m_achive_data[e.achievement_data.type];if(i){var s=AchievementJson.getData(e.achievement_data.type,i.id);s&&SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_4002)}if(this.m_achive_data[e.achievement_data.type]=e.achievement_data,Dispatch.dispatch(t.EVENT_ACHIEVE_DATA_UPDATE),Dispatch.dispatch(t.EVENT_ACHIEVE_DATA_UPDATE+e.achievement_data.type,!0),Dispatch.dispatch(DailyTaskManager.EVENT_SCENE_DAILY_TASK_CHANGE),this.setFuncRed(),e.achievement_data.type==this.p_WithdrawalType){var n=1;i&&(n=i.id),Dispatch.dispatch(t.EVENT_ACHIEVE_DATA_UPDATE+e.achievement_data.type+"_"+n),Dispatch.dispatch(t.EVENT_ACHIEVE_RESET_LIST),EntranceModule.instance.setEntranceVisible(ChargeManager.instance.isShowWithdrawal,FunctionEnum.WITHDRAWAL_SYS),this.setDrawRed()}break;case proto.m_achievement_get_award_toc.ENUM.fail:FloatTipModule.instance.popTipLanguage("l_game_tips_13");break;case proto.m_achievement_get_award_toc.ENUM.not_enough_grid:FloatTipModule.instance.popTipLanguage("l_game_tips_14");break;case proto.m_achievement_get_award_toc.ENUM.not_authority:FloatTipModule.instance.popTipLanguage("l_game_tips_7");break;case proto.m_achievement_get_award_toc.ENUM.already_have:FloatTipModule.instance.popTipLanguage("l_game_tips_5")}},t.prototype.c_achievement_notice_update_achievement_data=function(e){this.m_achive_data[e.achievement_data.type]=e.achievement_data,Dispatch.dispatch(t.EVENT_ACHIEVE_DATA_UPDATE+e.achievement_data.type,!1,e.achievement_data.id),2==DailyTaskManager.instance.p_daily_show.key&&DailyTaskManager.instance.p_daily_show.value==e.achievement_data.type&&Dispatch.dispatch(DailyTaskManager.EVENT_SCENE_DAILY_TASK_CHANGE),Dispatch.dispatch(t.EVENT_ACHIEVE_DATA_UPDATE),this.setDrawRed(),this.setFuncRed()},t.prototype.getAchieveDataByType=function(t){return this.m_achive_data[t]},t.prototype.getTaskList=function(t){var e,i=[],s=[],n=[];e=AchievementJson.getDataByClientsType(t);for(var o=0;o<e.length;o++){var a=e[o],r=this.m_achive_data[a];r?1==r.state?i.push(a):2==r.state?n.push(a):0==r.state&&s.push(a):s.push(a)}return i.concat(s.concat(n))},t.prototype.setRed=function(t){for(var e in this.m_achive_data){var i=this.m_achive_data[e],s=AchievementJson.getData(i.type,i.id);if(s.clients_type==t&&1==i.state)return!0}return!1},t.prototype.getWithdrawalList=function(){var t=AchievementJson.getListByType(this.p_WithdrawalType),e=this.m_achive_data[this.p_WithdrawalType],i=[],s=[],n=[];if(e){for(var o=0;o<t.length;o++)t[o]<e.id?i.push({taskId:t[o],state:2}):t[o]==e.id?n.push({taskId:t[o],state:e.state}):s.push({taskId:t[o],state:0});return ArrayUtils.setSortArr(i,["taskId"],[0]),ArrayUtils.setSortArr(s,["taskId"],[0]),n.concat(s.concat(i))}for(var o=0;o<t.length;o++)s.push({taskId:t[o],state:0});return s},t.prototype.setDrawRed=function(){var t=!1,e=this.m_achive_data[this.p_WithdrawalType];e&&1==e.state&&(t=!0),RedNoticeManager.instance.dispatchRed(RedNoticeConfig.RED_WITHDRAW,t)},t.prototype.setFuncRed=function(){var t=DailyTaskManager.instance.setDailyRed();if(!t)for(var e in this.m_achive_data){var i=this.m_achive_data[e];if(i&&i.type!=this.p_WithdrawalType&&1==i.state){t=!0;break}}RedNoticeManager.instance.dispatchRed(RedNoticeConfig.RED_ACHIEVEMENT,t)},t.EVENT_ACHIEVE_GET_INFO="EVENT_ACHIEVE_GET_INFO",t.EVENT_ACHIEVE_DATA_UPDATE="EVENT_ACHIEVE_DATA_UPDATE",t.EVENT_ACHIEVE_RESET_LIST="EVENT_ACHIEVE_RESET_LIST",t}();__reflect(AchievementManager.prototype,"AchievementManager");var ActivityManager=function(t){function e(){var e=t.call(this)||this;return e.m_activityStateList={},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.m_instance||(this.m_instance=new e),this.m_instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){MessageManager.register(MessageType.m_activity_restart_all_activity_toc,this.c_activity_restart_all_activity,this),MessageManager.register(MessageType.m_activity_update_activity_time_toc,this.c_activity_update_activity_time,this)},e.prototype.initData=function(t){this.m_activityStateList={};for(var e=0;e<t.length;e++)this.m_activityStateList[t[e].activity_id]=t[e]},e.prototype.initDatasss=function(t){var e=new proto.Activity_Data;e.activity_id=t,e.activity_state=2,e.start_time=ServerTimeManager.instance.timer,e.close_time=ServerTimeManager.instance.timer+1544442,this.m_activityStateList[e.activity_id]=e},e.prototype.initShowBubble=function(){for(var t in FunctionIconJson.jsonData){var e=FunctionIconJson.jsonData[t];e.bubble_red_enum&&""!=e.bubble_red_enum&&EntranceConfig.setBubbleRedEnum(e.function_id,e.bubble_red_enum.split("&"))}for(var t in this.m_activityStateList){var i=this.m_activityStateList[t];this.setActivityPaopaoTishi(i.activity_id,!1)}},e.prototype.setActivityPaopaoTishi=function(t,i){void 0===i&&(i=!0);var s=ActivityInfoJson.getData(t);if(s){var n=!1,o="";this.isReady(t)?(n=!0,o=s.name+"活动即将来开启，请准备"):this.isOpen(t)&&(n=!0,o=s.name+"活动已开启，请前往参与");var a,r=FunctionJson.getData(s.function_id);r&&r.enter_list&&r.enter_list[0]&&(a=Number(r.enter_list[0]));var _=EntranceConfig.getBubbleRedEnum(a);FunctionManager.instance.getOpenFuncId(s.function_id)&&_&&_.length>0&&RedNoticeManager.instance.dispatchRed(_[0],n,[o]),i&&(Dispatch.dispatch(e.ACTIVITY_UPDATE+t),Dispatch.dispatch(e.ACTIVITY_UPDATE,t))}},e.prototype.c_activity_restart_all_activity=function(t){this.m_activityStateList={};for(var i=0;i<t.activity_data.length;i++)this.m_activityStateList[t.activity_data[i].activity_id]=t.activity_data[i];Dispatch.dispatch(e.ACTIVITY_RESTART),this.initShowBubble(),EntranceModule.instance.refreshEntrance()},e.prototype.c_activity_update_activity_time=function(t){for(var e=0;e<t.activity_data.length;e++){var i=t.activity_data[e].activity_id;this.m_activityStateList[i]=t.activity_data[e],this.setActivityPaopaoTishi(i)}DelayCallUtils.killDelayedCallsTo(this.refrshsEntrance,this),DelayCallUtils.delayedCall(1,this.refrshsEntrance,this)},e.prototype.refrshsEntrance=function(){EntranceModule.instance.refreshEntrance()},e.prototype.closeActivity=function(t){for(var e=0;e<t.length;e++){var i=this.m_activityStateList[t[e]];i&&(i.activity_state=3,this.setActivityPaopaoTishi(t[e]))}EntranceModule.instance.refreshEntrance()},e.prototype.getInfoById=function(t){return this.m_activityStateList[t]},e.prototype.getActivityStartTime=function(t){var e=this.m_activityStateList[t];return e?e.start_time:-1},e.prototype.getActivityEndTime=function(t){var e=this.m_activityStateList[t];return e&&e.start_time>0?e.close_time:-1},e.prototype.getActivityRemainingTime=function(t){var e=this.getActivityEndTime(t)-ServerTimeManager.instance.timer;return 0>=e?0:e},e.prototype.isReady=function(t){if(this.m_activityStateList[t]){var e=this.m_activityStateList[t];if(1==e.activity_state)return!0}return!1},e.prototype.isOpen=function(t){if(this.m_activityStateList[t]){var e=this.m_activityStateList[t];if(2==e.activity_state)return!0}return!1},e.prototype.isClose=function(t){return this.isReady(t)||this.isOpen(t)?!1:!0},e.ACTIVITY_RESTART="ACTIVITY_RESTART",e.ACTIVITY_UPDATE="ACTIVITY_UPDATE",e}(egret.HashObject);__reflect(ActivityManager.prototype,"ActivityManager");var BagManager=function(){function t(){this.m_bagList={}}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){MessageManager.register(MessageType.m_prop_notice_update_prop_toc,this.s_prop_notice_update,this),MessageManager.register(MessageType.m_prop_use_item_toc,this.s_prop_use,this)},t.prototype.initData=function(t){this.m_bagList={};for(var e in t)this.m_bagList[t[e].prop_id]=t[e].num},t.prototype.s_prop_notice_update=function(e){var i=!1;for(var s in e.prop_list){var n=e.prop_list[s],o=this.getNum(n.prop_id);0==o&&n.num>0&&(i=!0),n.num<=0&&this.m_bagList[n.prop_id]?(i=!0,delete this.m_bagList[n.prop_id]):this.m_bagList[n.prop_id]=n.num,!i&&ItemJson.getData(n.prop_id)&&0==ItemJson.getData(n.prop_id).is_stacked&&(i=!0),Dispatch.dispatch(t.EVENT_BAG_UPGRADE+n.prop_id),Dispatch.dispatch(t.EVENT_BAG_UPGRADE,n.prop_id)}i&&Dispatch.dispatch(t.EVENT_BAG_ADDNEW)},t.prototype.c_prop_use=function(t,e){var i=MessageProtocol.getClass(MessageType.m_prop_use_item_tos);i.item_id=t,i.num=e,MessageProtocol.sendMessage(MessageType.m_prop_use_item_tos,i)},t.prototype.s_prop_use=function(e){switch(e.prop_list,e.result){case proto.m_prop_use_item_toc.ENUM.success:Dispatch.dispatch(t.EVENT_BAOXIANG_EFFECTS,e.prop_list);break;case proto.m_prop_use_item_toc.ENUM.fail:FloatTipModule.instance.popTipLanguage("l_bag_item_use_fail");break;case proto.m_prop_use_item_toc.ENUM.no_condition:FloatTipModule.instance.popTipLanguage("l_bag_item_use_No")}},Object.defineProperty(t.prototype,"gold",{get:function(){return this.getNum(ItemEnum.GOLD)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rmb",{get:function(){return this.getNum(ItemEnum.RMB)},enumerable:!0,configurable:!0}),t.prototype.getNum=function(t){return this.m_bagList[t]?this.m_bagList[t]:0},t.prototype.getBagList=function(){var t=[],e=1;for(var i in this.m_bagList){var s=ItemJson.getData(Number(i));if(s&&s.order>0)if(0==s.is_stacked)for(var n=this.getNum(s.id),o=0;n>o;o++)e+=1,t.push({c_id:s.id,c_sortIdx:s.order,c_rid:e});else e+=1,t.push({c_id:s.id,c_sortIdx:s.order,c_rid:e})}return ArrayUtils.setSortArr(t,["c_sortIdx"],[1]),t.length<40&&(t.length=40),t},t.prototype.isEnoughProp=function(t,e){void 0===e&&(e=!0);var i=Number(t[0]),s=Number(t[1]);return this.getNum(i)>=s?!0:(e&&PopupModule.instance.showAccess(i),!1)},t.prototype.noEnoughRmb=function(){if(GuideModule.instance.getIsGuiding())return void FloatTipModule.instance.popTipLanguage("l_game_tips_22");var t=LanguageJson.getText("l_btn_yes"),e=LanguageJson.getText("l_btn_no");PopupModule.instance.showTishiPrompt(PopupMsgEnum.RMB_NO_ENOUGH,this.sureRecharge.bind(this),null,null,t,e)},t.prototype.noEnoughGold=function(){if(GuideModule.instance.getIsGuiding())return void FloatTipModule.instance.popTipLanguage("l_game_tips_20");var t=LanguageJson.getText("l_btn_yes"),e=LanguageJson.getText("l_btn_no");PopupModule.instance.showTishiPrompt(PopupMsgEnum.GOLD_NO_ENOUGH,this.sureRecharge.bind(this),null,null,t,e)},t.prototype.sureRecharge=function(t){PopupModule.instance.hidePopAll(),1==t&&ChargeManager.instance.openCharge()},t.prototype.getIconPath=function(t){var e=ItemJson.getData(t);return e?PublicCon.PATH_ITEM_ICON+e.icon+".png":""},t.prototype.getQualityPath=function(t){var e=ItemJson.getData(t);return e?"commonsUI_item_bj_"+e.quality:""},t.prototype.getPointByItem=function(t,e){return void 0===e&&(e=!1),t==ItemEnum.GOLD?UIModule.instance.pointGold:UIModule.instance.getPointByFunctionId(FunctionEnum.BAG_SYS,e,t)},t.prototype.checkCondition=function(t,e){void 0===e&&(e=!1);var i="";if(t&&t.length>0){switch(t[0]){case"level":PlayerManager.instance.p_playerInfo.level<Number(t[1])&&(i=LanguageJson.getHtmlText("l_game_tips_24",[t[1]]));break;case"vip_level":PlayerManager.instance.p_playerInfo.vip_level<Number(t[1])&&(i=LanguageJson.getHtmlText("l_game_tips_23",[t[1]]))}e&&""!=i&&FloatTipModule.instance.popTip(i)}return i},t.EVENT_BAG_UPGRADE="EVENT_BAG_UPGRADE",t.EVENT_BAG_ADDNEW="EVENT_BAG_ADDNEW",t.EVENT_BAG_DETAIL="EvENT_BAG_DETAIL",t.EVENT_SYNTHETIC_SUCCESS="EVENT_SYNTHETIC_SUCCESS",t.EVENT_BAOXIANG_EFFECTS="EVENT_BAOXIANG_EFFECTS",t}();__reflect(BagManager.prototype,"BagManager");var BraveOneManager=function(){function t(){this.p_realId=0,this.p_missionId=0}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){MessageManager.register(MessageType.m_brave_one_get_info_list_toc,this.c_brave_one_get_info_list,this),MessageManager.register(MessageType.m_brave_one_create_toc,this.c_brave_one_create,this),MessageManager.register(MessageType.m_brave_one_enter_toc,this.c_brave_one_enter,this),MessageManager.register(MessageType.m_brave_one_clean_toc,this.c_brave_one_clean,this),MessageManager.register(MessageType.m_brave_one_notice_fight_scene_toc,this.c_brave_one_notice_fight_scene,this),MessageManager.register(MessageType.m_brave_one_wait_scene_toc,this.c_brave_one_wait_scene,this),MessageManager.register(MessageType.m_brave_one_ready_start_toc,this.c_brave_one_ready_start,this),MessageManager.register(MessageType.m_brave_one_fight_player_toc,this.c_brave_one_fight_player,this),MessageManager.register(MessageType.m_brave_one_win_player_toc,this.c_brave_one_win_player,this)},t.prototype.s_brave_one_get_info_list=function(t){var e=MessageProtocol.getClass(MessageType.m_brave_one_get_info_list_tos);e.page=t,MessageProtocol.sendMessage(MessageType.m_brave_one_get_info_list_tos,e)},t.prototype.c_brave_one_get_info_list=function(e){Dispatch.dispatch(t.EVENT_GET_BRAVE_INFO,e.braveOneDataList)},t.prototype.s_brave_one_create=function(t,e){var i=MessageProtocol.getClass(MessageType.m_brave_one_create_tos);i.id=t,i.pos_id=e,MessageProtocol.sendMessage(MessageType.m_brave_one_create_tos,i)},t.prototype.c_brave_one_create=function(e){switch(e.result){case proto.m_brave_one_create_toc.ENUM.success:this.m_braveData=e.braveOneData,this.p_realId=this.m_braveData.realId,Dispatch.dispatch(t.EVENT_CREATE_BRAVE_ROOM);break;case proto.m_brave_one_create_toc.ENUM.fail:FloatTipModule.instance.popTipLanguage("l_multi_popTip_2");break;case proto.m_brave_one_create_toc.ENUM.not_authority:FloatTipModule.instance.popTipLanguage("l_brave_tip_1");break;case proto.m_brave_one_create_toc.ENUM.already_have:FloatTipModule.instance.popTipLanguage("l_multi_popTip_3");break;case proto.m_brave_one_create_toc.ENUM.function_no_open:FloatTipModule.instance.popTipLanguage("l_game_tips_9");break;case proto.m_brave_one_create_toc.ENUM.not_enough_grid:FloatTipModule.instance.popTipLanguage("l_game_tips_10");break;case proto.m_brave_one_create_toc.ENUM.no_enough_prop:FloatTipModule.instance.popTipLanguage("l_game_tips_11")}},t.prototype.s_brave_one_enter=function(t){var e=MessageProtocol.getClass(MessageType.m_brave_one_enter_tos);e.realId=t,MessageProtocol.sendMessage(MessageType.m_brave_one_enter_tos,e)},t.prototype.c_brave_one_enter=function(e){switch(e.result){case proto.m_brave_one_enter_toc.ENUM.success:this.p_realId=e.realId,this.m_braveData=e.braveOneData,FloatTipModule.instance.popTipLanguage("l_multi_popTip_10"),Dispatch.dispatch(t.EVENT_ENTER_BRAVE_ROOM),PopupModule.instance.showPop(PopupConfig.ID_BRAVE_ONE_WAIT,{missionId:e.braveOneData.id},!1);break;case proto.m_brave_one_enter_toc.ENUM.fail:FloatTipModule.instance.popTipLanguage("l_multi_popTip_11");break;case proto.m_brave_one_enter_toc.ENUM.not_authority:FloatTipModule.instance.popTipLanguage("l_game_tips_15");break;case proto.m_brave_one_enter_toc.ENUM.none:FloatTipModule.instance.popTipLanguage("l_multi_popTip_14");break;case proto.m_brave_one_enter_toc.ENUM.already_have:FloatTipModule.instance.popTipLanguage("l_multi_popTip_3");break;case proto.m_brave_one_enter_toc.ENUM.function_no_open:FloatTipModule.instance.popTipLanguage("l_game_tips_9");break;case proto.m_brave_one_enter_toc.ENUM.not_enough_grid:FloatTipModule.instance.popTipLanguage("l_game_tips_10");break;case proto.m_brave_one_enter_toc.ENUM.no_enough_prop:FloatTipModule.instance.popTipLanguage("l_game_tips_11")}},t.prototype.s_brave_one_clean=function(){var t=MessageProtocol.getClass(MessageType.m_brave_one_clean_tos);MessageProtocol.sendMessage(MessageType.m_brave_one_clean_tos,t)},t.prototype.c_brave_one_clean=function(e){switch(e.result){case proto.m_brave_one_clean_toc.ENUM.success:this.p_realId=0,Dispatch.dispatch(t.EVENT_ENTER_BRAVE_ROOM);break;case proto.m_brave_one_clean_toc.ENUM.fail:FloatTipModule.instance.popTipLanguage("l_brave_tip_2");break;case proto.m_brave_one_clean_toc.ENUM.none:FloatTipModule.instance.popTipLanguage("l_multi_popTip_14");break;case proto.m_brave_one_clean_toc.ENUM.already_have:FloatTipModule.instance.popTipLanguage("l_brave_tip_3");break;case proto.m_brave_one_clean_toc.ENUM.function_no_open:FloatTipModule.instance.popTipLanguage("l_game_tips_9");break;case proto.m_brave_one_clean_toc.ENUM.not_enough_grid:FloatTipModule.instance.popTipLanguage("l_game_tips_10");break;case proto.m_brave_one_clean_toc.ENUM.no_enough_prop:FloatTipModule.instance.popTipLanguage("l_game_tips_11")}},t.prototype.c_brave_one_notice_fight_scene=function(e){e.braveOneData&&Dispatch.dispatch(t.EVENT_NOTICE_FIGHT_SCENE,e.braveOneData),this.p_realId>0&&PopupModule.instance.showPop(PopupConfig.ID_BRAVE_ONE_WAIT,{missionId:e.braveOneData.id},!1)},t.prototype.c_brave_one_wait_scene=function(t){t.wait_end_time&&t.wait_end_time>0&&MissionUIModule.instance.setWaitTime(t.wait_end_time)},t.prototype.c_brave_one_ready_start=function(t){t.start_time&&t.start_time>0&&MissionUIModule.instance.showStartTime(t.start_time)},t.prototype.c_brave_one_fight_player=function(t){PlayerManager.instance.playerId!=t.player_id},t.prototype.c_brave_one_win_player=function(t){this.p_realId=0},t.EVENT_GET_BRAVE_INFO="EVENT_GET_BRAVE_INFO",t.EVENT_CREATE_BRAVE_ROOM="EVENT_CREATE_BRAVE_ROOM",t.EVENT_ENTER_BRAVE_ROOM="EVENT_ENTER_BRAVE_ROOM",t.EVENT_CHOOSE_CAP_COST="EVENT_CHOOSE_CAP_COST",t.EVENT_NOTICE_FIGHT_SCENE="EVENT_NOTICE_FIGHT_SCENE",t.EVENT_READY_START="EVENT_READY_START",t}();__reflect(BraveOneManager.prototype,"BraveOneManager");var CardManager=function(){function t(){this.m_cardData={},this.m_titleData={},this.m_bookData={}}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){MessageManager.register(MessageType.m_card_get_award_toc,this.c_card_get_award,this),MessageManager.register(MessageType.m_card_notice_card_update_toc,this.c_card_notice_card_update,this)},t.prototype.initData=function(t){for(var e in t){var i=t[e];this.m_bookData[i.card_book_id]=i;for(var s in i.card_title_list){var n=i.card_title_list[s];this.m_titleData[n.card_title_id]=n;for(var o in n.card_list){var a=n.card_list[o];this.m_cardData[a.card_id]=a}}}this.setYaoZuRed(),this.setShenZuRed()},t.prototype.s_card_get_award=function(t,e){var i=MessageProtocol.getClass(MessageType.m_card_get_award_tos);i.type=t,i.id=e,MessageProtocol.sendMessage(MessageType.m_card_get_award_tos,i)},t.prototype.c_card_get_award=function(e){switch(e.result){case proto.m_card_get_award_toc.ENUM.success:RewardModule.instance.receiveByProp(e.prop_list),this.resetData(e.type,e.id),this.setYaoZuRed(),this.setShenZuRed(),Dispatch.dispatch(t.EVENT_CARD_REWARD_RECEIVED+e.type,e.id);break;case proto.m_card_get_award_toc.ENUM.fail:FloatTipModule.instance.popTipLanguage("l_game_tips_13");break;case proto.m_card_get_award_toc.ENUM.no_condition:FloatTipModule.instance.popTipLanguage("l_game_tips_15")}},t.prototype.resetData=function(t,e){if(1==t){var i=this.m_bookData[e];i?i.state=2:(i=new proto.CardBook,i.state=2,this.m_bookData[e]=i)}else if(2==t){var s=this.m_titleData[e];s?s.state=2:(s=new proto.CardTitle,s.state=2,this.m_titleData[e]=s)}else{var n=this.m_cardData[e];n?n.state=2:(n=new proto.Card,n.state=2,this.m_cardData[e]=n)}},t.prototype.c_card_notice_card_update=function(e){var i=this.m_cardData[e.card_id];i?i.num=e.num:(i=new proto.Card,i.num=e.num,this.m_cardData[e.card_id]=i),Dispatch.dispatch(t.EVENT_CARD_UPDATA,e.card_id),this.setYaoZuRed(),this.setShenZuRed()},t.prototype.getCardDataById=function(t){return this.m_cardData[t]},t.prototype.getTitleStateById=function(t){var e=this.m_titleData[t];if(e&&2==e.state)return 2;for(var i=CardTitleJson.getData(t),s=1,n=0;n<i.card_item_list.length;n++){var o=this.m_cardData[i.card_item_list[n]];if(!o||o&&2!=o.state){s=0;break}}return s},t.prototype.getBookStateById=function(t){var e=this.m_bookData[t];if(e&&2==e.state)return 2;var i=CardBookJson.getData(t);if(!i)return 0;for(var s=1,n=0;n<i.card_title_list.length;n++){var o=this.m_titleData[i.card_title_list[n]];if(!o||o&&2!=o.state){s=0;break}}return s},t.prototype.getRedByTitleId=function(t){var e=CardTitleJson.getData(t);for(var i in e.card_item_list){var s=this.m_cardData[e.card_item_list[i]];if(s&&2!=s.state){var n=CardJson.getData(s.card_id);if(s.num>=n.goal_count)return!0}}return!1},t.prototype.setYaoZuRed=function(){var t=!1,e=2,i=CardBookJson.getData(e);for(var s in i.card_title_list){var n=i.card_title_list[s];if(1==this.getTitleStateById(n)||this.getRedByTitleId(n)){t=!0;break}}RedNoticeManager.instance.dispatchRed(RedNoticeConfig.RED_CARD_YAOZU,t)},t.prototype.setShenZuRed=function(){var t=!1,e=1,i=CardBookJson.getData(e);for(var s in i.card_title_list){var n=i.card_title_list[s];if(1==this.getTitleStateById(n)||this.getRedByTitleId(n)){t=!0;break}}RedNoticeManager.instance.dispatchRed(RedNoticeConfig.RED_CARD_SHENZU,t)},t.EVENT_CARD_UPDATA="EVENT_CARD_UPDATA",t.EVENT_CARD_REWARD_RECEIVED="EVENT_CARD_REWARD_RECEIVED",t}();__reflect(CardManager.prototype,"CardManager");var ChargeManager=function(t){function e(){var e=t.call(this)||this;return e.p_isOpenPay=-1,e.m_lastTime=0,e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.m_instance||(this.m_instance=new e),this.m_instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){MessageManager.register(MessageType.m_charge_charge_toc,this.rechargeBack,this),MessageManager.register(MessageType.m_charge_notice_charge_data_toc,this.c_notice_charge_data,this),MessageManager.register(MessageType.m_charge_notice_is_open_charge_toc,this.c_charge_notice_is_open_charge,this)},e.prototype.initData=function(t,e){this.p_charge_list=t,this.m_first_charge_state=e,EntranceModule.instance.setEntranceVisible(this.isFirstOpenCharge,FunctionEnum.FIRST_RECHARGE)},e.prototype.requestRecharge=function(t,e){if(URIManager.p_isGuest)return void PopupModule.instance.showPop(PopupConfig.ID_ACCREDIT,null,!1);if(!(ServerTimeManager.instance.timer<this.m_lastTime)){this.m_lastTime=ServerTimeManager.instance.timer+2;var i=MessageProtocol.getClass(MessageType.m_charge_charge_tos);i.item_id=t,i.count=e,MessageProtocol.sendMessage(MessageType.m_charge_charge_tos,i)}},e.prototype.rechargeBack=function(t){switch(t.result){case proto.m_charge_charge_toc.ENUM.success:FloatTipModule.instance.popTipLanguage("l_vip_tips_1"),Dispatch.dispatch(e.EVENT_RECHARGE_SUCCESS,{item_id:t.item_id,count:t.count});break;case proto.m_charge_charge_toc.ENUM.fail:FloatTipModule.instance.popTipLanguage("l_vip_tips_2");break;case proto.m_charge_charge_toc.ENUM.already_have:FloatTipModule.instance.popTipLanguage("l_vip_tips_3");break;case proto.m_charge_charge_toc.ENUM.no_enough_prop:PlatformManager.instance.callPlatformPay(t.item_id,t.count,t.charge_value,t.charge_request_data);break;case proto.m_charge_charge_toc.ENUM.not_authority:FloatTipModule.instance.popTipLanguage("l_vip_tips_4");break;case proto.m_charge_charge_toc.ENUM.times_limit:FloatTipModule.instance.popTipLanguage("l_vip_tips_5")}},e.prototype.c_notice_charge_data=function(t){var i=RechargeJson.getData(t.item_id),s="0";switch(i&&(s=i.cash+""),t.result){case proto.m_charge_notice_charge_data_toc.ENUM.success:if(FloatTipModule.instance.popTipLanguage("l_vip_tips_1"),Dispatch.dispatch(e.EVENT_RECHARGE_SUCCESS,{item_id:t.item_id,count:t.count}),i&&i.recharge_type==ChargeGameEnum.FIRST_CHARGE){this.m_first_charge_state=1,EntranceModule.instance.setEntranceVisible(this.isFirstOpenCharge,FunctionEnum.FIRST_RECHARGE),PopupModule.instance.hidePop(PopupConfig.ID_FIRST_CHARGE);var n=RechargeJson.getData(t.item_id);if(n){var o=[[ItemEnum.GOLD,n.ingot]];o=o.concat(n.reward_item_list),RewardModule.instance.receiveByList(n.reward_item_list)}}break;case proto.m_charge_notice_charge_data_toc.ENUM.fail:FloatTipModule.instance.popTipLanguage("l_vip_tips_2");break;case proto.m_charge_notice_charge_data_toc.ENUM.refuse:FloatTipModule.instance.popTipLanguage("l_vip_tips_7")}GameManager.instance.callToNative("toAppChargeSuccess",t.result+"_"+s)},e.prototype.c_charge_notice_is_open_charge=function(t){this.p_isOpenPay=t.is_open,UIModule.instance.checkChargeDis(),Dispatch.dispatch(e.EVENT_RECHARGE_CHANGE),UIModule.instance.hideUI(UIConfig.ID_CHARGE),EntranceModule.instance.setEntranceVisible(this.isFirstOpenCharge,FunctionEnum.FIRST_RECHARGE),EntranceModule.instance.setEntranceVisible(this.isShowWithdrawal,FunctionEnum.WITHDRAWAL_SYS)},e.prototype.openCharge=function(){this.isOpenRecharge&&UIModule.instance.showUI(UIConfig.ID_CHARGE,{c_type:ShopHallEnum.TYPE_DIAMOND})},Object.defineProperty(e.prototype,"isOpenRecharge",{get:function(){return this.p_isOpenPay>-1?1==this.p_isOpenPay?!0:!1:1==URIManager.is_open_charg?!0:!1},enumerable:!0,configurable:!0}),e.prototype.openFirstCharge=function(){FunctionManager.instance.getOpenFuncId(FunctionEnum.FIRST_RECHARGE)&&this.isFirstOpenCharge&&PopupModule.instance.showPop(PopupConfig.ID_FIRST_CHARGE,null,!1)},Object.defineProperty(e.prototype,"isFirstOpenCharge",{get:function(){return 0==this.isOpenRecharge?!1:this.m_first_charge_state>0?!1:!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isShowWithdrawal",{get:function(){if(1==GameManager.instance.isShield)return!1;var t=AchievementManager.instance.getAchieveDataByType(AchievementManager.instance.p_WithdrawalType);return t&&2!=t.state?!0:!1},enumerable:!0,configurable:!0}),e.EVENT_RECHARGE_SUCCESS="EVENT_RECHARGE_SUCCESS",e.EVENT_RECHARGE_CHANGE="EVENT_RECHARGE_CHANGE",e}(egret.HashObject);__reflect(ChargeManager.prototype,"ChargeManager");var ChatManager=function(){function t(){this.m_msgList={},this.p_realList=[],this.p_fakeList=[],this.p_maxLen=100,this.p_scrollNum=3}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){MessageManager.register(MessageType.m_chat_channel_chat_toc,this.c_chat_channel_chat,this),MessageManager.register(MessageType.m_chat_broadcast_channel_msg_toc,this.c_chat_broadcast_channel_msg,this),MessageManager.register(MessageType.m_chat_broadcast_channel_msg_list_toc,this.c_chat_broadcast_channel_msg_list,this),Dispatch.register(PlayerManager.EVENT_PLAYER_INIT,this.initPlayerInfo,this)},t.prototype.initPlayerInfo=function(){this.m_msgList={}},t.prototype.s_chat_channel_chat=function(t,e,i,s){void 0===i&&(i=0),void 0===s&&(s="");var n=MessageProtocol.getClass(MessageType.m_chat_channel_chat_tos);n.channel=t,n.msg=e,MessageProtocol.sendMessage(MessageType.m_chat_channel_chat_tos,n)},t.prototype.c_chat_channel_chat=function(t){switch(t.fail_reason){case proto.m_chat_channel_chat_toc.ENUM.level_limit:FloatTipModule.instance.popTip("当前玩家等级不足，无法发送消息");break;case proto.m_chat_channel_chat_toc.ENUM.too_quick:FloatTipModule.instance.popTip("发送消息过快");break;case proto.m_chat_channel_chat_toc.ENUM.too_long:FloatTipModule.instance.popTip("发送消息过长");break;case proto.m_chat_channel_chat_toc.ENUM.fail:FloatTipModule.instance.popTip("发送失败")}},t.prototype.c_chat_broadcast_channel_msg=function(t){GameManager.instance.isShield||this.setMsg(t)},t.prototype.c_chat_broadcast_channel_msg_list=function(e){if(!GameManager.instance.isShield){this.p_fakeList=e.msg_data_list;for(var i=0;i<e.msg_data_list.length;i++)Dispatch.dispatch(t.EVENT_CHAT_FAKE_UPDATE,e)}},t.prototype.setMsg=function(e){var i=[];if(this.m_msgList[e.channel]?i=this.m_msgList[e.channel]:this.m_msgList[e.channel]=i,-1==i.indexOf(e)){i.push(e),i.length>ChatMoude.instance.p_msgLenght&&i.shift();var s=NoticeJson.getData(e.template_id);s&&1!=s.is_show&&(this.p_realList.length>=this.p_maxLen?(this.p_realList.splice(0,1),this.p_realList.push(e)):this.p_realList.push(e)),SceneModule.instance.isMainScene&&UIModule.instance.setPosition(),Dispatch.dispatch(t.EVENT_CHAT_UPDATE,e)}},t.prototype.getMainScrollData=function(){if(this.p_realList.length>=this.p_maxLen)return this.p_realList;for(var t=this.p_realList.concat(this.p_fakeList),e=[],i=0;i<this.p_maxLen&&t[i];i++)e.push(t[i]);return e},t.prototype.getMsgByChannelId=function(t){return this.m_msgList[t]?this.m_msgList[t]:[]
},t.prototype.getInitMsg=function(){return null},t.EVENT_CHAT_UPDATE="EVENT_CHAT_UPDATE",t.EVENT_CHAT_FAKE_UPDATE="EVENT_CHAT_FAKE_UPDATE",t}();__reflect(ChatManager.prototype,"ChatManager");var ChatMoude=function(){function t(){this.p_forbidData={},this.p_forbidLocalStorage="chat_pingbi",this.p_isTest=!1,this.p_channelId=1,this.p_isAutoRefresh=!0,this.p_msgLenght=1e3,this.p_isDebug=!1,this.m_nearMonsterPoint=new egret.Point}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){var e=egret.localStorage.getItem(t.instance.p_forbidLocalStorage);e=e?e:"{}",e&&(t.instance.p_forbidData=JSON.parse(e))},t.prototype.showChat=function(t){void 0===t&&(t=0)},t.prototype.hideChat=function(){},t.prototype.selectChannelId=function(e){e!=this.p_channelId&&(this.p_channelId=e,Dispatch.dispatch(t.EVENT_CHAT_SELECT_CHENNELID))},Object.defineProperty(t.prototype,"sendLimit",{get:function(){return ChatChannelJson.getData(this.p_channelId).send_limit},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sendCDTime",{get:function(){return ChatChannelJson.getData(this.p_channelId).send_cd_time},enumerable:!0,configurable:!0}),t.prototype.isSendMsgOk=function(e){if(-1!=e.indexOf("debug")){if(-1!=e.indexOf("cz")&&ChargeManager.instance.requestRecharge(99999,1),-1!=e.indexOf("config")&&FunctionManager.instance.executeFunction(Number(e.split(":")[1])),-1!=e.indexOf("funcid:")){var i=Number(e.split(":")[1]);PopupModule.instance.showTishiSingle("功能ID："+i+"————"+FunctionManager.instance.getOpenFuncId(i,!1))}if(-1!=e.indexOf("lang:")){var s=e.split(":")[1];PopupModule.instance.showTishiSingle(LanguageJson.getText(s))}return!1}if(!URIManager.is_platform&&-1!=e.indexOf("==")){for(var n=e.split("==")[1].split(","),o=Number(n[0]),a=[],r=1;r<n.length;r++)a.push(Number(n[r]));return DebugManager.instance.s_debug_debug(o,a),!1}if(!URIManager.is_platform&&-1!=e.indexOf("guide:")){var _=e.split(":")[1].split("_");return t.instance.p_moId=Number(_[1]),GuideModule.instance.startGuide(Number(_[0])),!1}if(!URIManager.is_platform&&-1!=e.indexOf("stageXY:"))return"1"==e.split(":")[1]?StageManager.instance.p_xy=!0:StageManager.instance.p_xy=!1,!1;if(!URIManager.is_platform&&-1!=e.indexOf("ui:")){var h=e.split(":")[1];if(Number(h)>0)UIModule.instance.showUI(Number(h));else{var l=ObjectUtils.getParsingObj(h);UIModule.instance.showUI(l.uiId,l)}return!1}if(!URIManager.is_platform&&-1!=e.indexOf("popup:")){var c=e.split(":")[1];if(Number(c)>0)PopupModule.instance.showPop(Number(c),null,!1);else{var m=ObjectUtils.getParsingObj(c);PopupModule.instance.showPop(m.configPopId,m,!0)}return!1}if(!URIManager.is_platform&&-1!=e.indexOf("mon:")){var p=e.split(":")[1].split("_"),u=SceneItemModule.instance.getMonster(Number(p[0]));if(u){var d=Number(p[1]);1==d?u.setShowEffect(p[2]?Boolean(Number(p[2])):!1):3==d?u.addBingDong():4==d?FightUIModule.instance.showMyMana(u,p[2]?Number(p[2]):111,p[3]?Number(p[3]):12,p[2]?Number(p[4]):-1):5==d?FightUIModule.instance.showGuangBo(PlayerManager.instance.p_mainPlayer,u,p[2]?Number(p[2]):-1):6==d?FightUIModule.instance.showZhaDan(u):7==d?(u.testPosition([Number(p[2]),Number(p[3])]),u.testCC([Number(p[4]),Number(p[5])]),u.testHot([Number(p[6]),Number(p[7])])):8==d?FightUIModule.instance.getPoolLottery(u,Number(p[2])):9==d&&FightUIModule.instance.showHuoQiu(PlayerManager.instance.p_mainPlayer,u)}return!1}if(!URIManager.is_platform&&-1!=e.indexOf("hot:")){GameManager.p_hotAlpha=Number(e.split(":")[1]);for(var s in GameManager.p_hotList)GameManager.p_hotList[s]&&(GameManager.p_hotList[s].alpha=GameManager.p_hotAlpha);return!1}if(!URIManager.is_platform&&-1!=e.indexOf("scene:")){var g=Number(e.split(":")[1]);return SceneJson.getData(g)&&SceneManager.instance.s_scene_enter_scene_tos(g),!1}if(!URIManager.is_platform&&-1!=e.indexOf("monsterSkill:")){var f=e.split(":")[1].split("_");return FightUIModule.instance.setStartSkill(PlayerManager.instance.playerId,Number(f[1]),ServerTimeManager.instance.timer+Number(f[0])),!1}if(!URIManager.is_platform&&-1!=e.indexOf("mission:")){var f=e.split(":")[1].split("_");return MissionManager.instance.s_mission_challenge_mission(Number(f[0]),Number(f[1])),!1}if(!URIManager.is_platform&&-1!=e.indexOf("rage:"))return FightSkillManager.p_rage_id=Number(e.split(":")[1]),FightUIModule.instance.showRageSkill(),!1;if(!URIManager.is_platform&&-1!=e.indexOf("3d:"))return this.setTest3D(),!1;if(!URIManager.is_platform&&-1!=e.indexOf("fight:")){var f=e.split(":")[1].split("_"),y=GuessFightPopup.p_monsterList[f[0]];return y.shiftToAction(f[1],Number(f[2])),!1}if(!URIManager.is_platform&&-1!=e.indexOf("xian:")){var v=e.split(":")[1].split("_"),u=SceneItemModule.instance.getMonster(Number(v[0]));if(u){var M=u.x+Number(v[1]),E=u.y+Number(v[2]);FightUIModule.instance.showShunyi(u,M,E)}return!1}if(!URIManager.is_platform&&-1!=e.indexOf("guideCheck:")){var T=e.split(":")[1].split("_");return T&&T.length>0?(this.m_hotImgTile||(this.m_hotImgTile=new eui.Image("commonUI_box_0"),this.m_hotImgTile.scale9Grid=new egret.Rectangle(1,1,3,3),this.m_hotImgTile.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.m_hotImgTile.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onSetAuto,this),this.m_hotImgTile.addEventListener(egret.TouchEvent.TOUCH_END,this.onSetAutoEnd,this)),StageManager.instance.rootDirec.addChild(this.m_hotImgTile),this.m_hotImgTile.width=Number(T[1]),this.m_hotImgTile.height=Number(T[2]),this.m_guideMon=Number(T[0])):StageManager.instance.rootDirec.addChild(this.m_hotImgTile),!1}return!0},t.prototype.onSetAuto=function(t){t.stopPropagation(),t.stopImmediatePropagation(),this.m_dragX=t.stageX-this.m_hotImgTile.x,this.m_dragY=t.stageY-this.m_hotImgTile.y,StageManager.instance.p_stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onSetAutoMove,this)},t.prototype.onSetAutoEnd=function(t){t.stopPropagation(),t.stopImmediatePropagation(),StageManager.instance.p_stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onSetAutoMove,this)},t.prototype.onSetAutoMove=function(t){t.stopPropagation(),t.stopImmediatePropagation();var e=t.stageX-this.m_dragX,i=t.stageY-this.m_dragY;this.m_hotImgTile.x=e,this.m_hotImgTile.y=i},t.prototype.onClick=function(t){var e=[];1==this.m_guideMon?(e[0]=Math.floor(this.m_hotImgTile.x),e[1]=Math.floor(StageManager.instance.p_stageHeight-this.m_hotImgTile.y)):2==this.m_guideMon?(e[0]=Math.floor(this.m_hotImgTile.x),e[1]=Math.floor(this.m_hotImgTile.y)):(e[0]=Math.floor(this.m_hotImgTile.x-.5*(StageManager.instance.p_stageWidth-StageManager.MIN_STAGE_WIDTH)),e[1]=Math.floor(this.m_hotImgTile.y-.5*(StageManager.instance.p_stageHeight-StageManager.MIN_STAGE_HEIGHT))),console.log(e[0],e[1],"__当前坐标")},t.prototype.setTest3D=function(){var t=PlayerManager.instance.p_mainPlayer.getPos(),e=[];for(var i in SceneItemModule.instance.monsterDict){var s=SceneItemModule.instance.monsterDict[i];this.m_nearMonsterPoint.x=s.x-t.x,this.m_nearMonsterPoint.y=s.y-t.y,e.push({mc:s,lg:this.m_nearMonsterPoint.length})}ArrayUtils.setSortArr(e,["lg"],[0]);for(var n=[],o=0;5>o;o++)n.push(e[o].mc)},t.EVENT_CHAT_SELECT_CHENNELID="EVENT_CHAT_SELECT_CHENNELID",t.EVENT_CHAT_BANNED_PLAYER="EVENT_CHAT_BANNED_PLAYER",t}();__reflect(ChatMoude.prototype,"ChatMoude");var ClientLogManager=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){},t.prototype.s_client_log_client_log=function(t){var e=MessageProtocol.getClass(MessageType.m_client_log_client_log_tos);e.id=t,MessageProtocol.sendMessage(MessageType.m_client_log_client_log_tos,e)},t}();__reflect(ClientLogManager.prototype,"ClientLogManager");var CreatRoleManager=function(){function t(){this.p_is_send_creat_role=!1}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){MessageManager.register(MessageType.m_login_create_role_toc,this.m_create_role_toc,this)},t.prototype.m_create_role_tos=function(t,e){var i=MessageProtocol.getClass(MessageType.m_login_create_role_tos);i.server_id=LoginManager.instance.p_server_id,i.nickname=t,i.sex=e,i.from=PlatformManager.instance.os,i.acc_id=LoginManager.instance.p_acc_id,i.extra=PlatformManager.instance.createRoleExtra(),MessageProtocol.sendMessage(MessageType.m_login_create_role_tos,i)},t.prototype.m_create_role_toc=function(t){switch(LoginManager.instance.p_player_id=t.player_id,t.result){case proto.m_login_create_role_toc.ENUM.success:PlatformManager.instance.reportCreateRole(),Dispatch.register(GamePreLoadManager.EVENT_MAINGAME_COMPLETE,this.gotoGameSure,this),GamePreLoadManager.instance.preloadGame(),PlayerManager.instance.sureADJustTo();break;case proto.m_login_create_role_toc.ENUM.used:FloatTipModule.instance.popTipLanguage("l_createRole_tips_1");break;case proto.m_login_create_role_toc.ENUM.invalid_string:FloatTipModule.instance.popTipLanguage("l_createRole_tips_2");break;case proto.m_login_create_role_toc.ENUM.too_long:FloatTipModule.instance.popTipLanguage("l_createRole_tips_3");break;case proto.m_login_create_role_toc.ENUM.unknow:FloatTipModule.instance.popTipLanguage("l_createRole_tips_4")}t.result!=proto.m_login_create_role_toc.ENUM.success&&(this.p_is_send_creat_role=!1)},t.prototype.gotoGameSure=function(){Dispatch.remove(GamePreLoadManager.EVENT_MAINGAME_COMPLETE,this.gotoGameSure,this),LoginManager.instance.loginComplete(),Dispatch.dispatch(t.EVENT_CREATE_ROLE_COM)},Object.defineProperty(t.prototype,"isShowFriendCode",{get:function(){var t=!1;return URIManager.platformId==PlatformEnum.LOCAL&&(t=!0),t},enumerable:!0,configurable:!0}),t.EVENT_CREATE_ROLE_COM="EVENT_CREATE_ROLE_COM",t}();__reflect(CreatRoleManager.prototype,"CreatRoleManager");var DailyTaskManager=function(){function t(){this.m_daily_data={},this.taskClick=!0}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){MessageManager.register(MessageType.m_daily_task_get_info_toc,this.c_daily_task_get_info,this),MessageManager.register(MessageType.m_daily_task_get_award_toc,this.c_daily_task_get_award,this),MessageManager.register(MessageType.m_daily_task_notice_update_daily_task_data_toc,this.c_daily_task_notice_update_daily_task_data,this),MessageManager.register(MessageType.m_daily_task_notice_update_task_show_toc,this.c_daily_task_notice_update_task_show,this)},t.prototype.initData=function(t,e){this.m_daily_data={},this.p_daily_show=e;for(var i=0;i<t.length;i++)this.m_daily_data[t[i].id]=t[i]},t.prototype.s_daily_task_get_info=function(){var t=MessageProtocol.getClass(MessageType.m_daily_task_get_info_tos);MessageProtocol.sendMessage(MessageType.m_daily_task_get_info_tos,t)},t.prototype.c_daily_task_get_info=function(e){for(var i=0;i<e.daily_task_data_list.length;i++)this.m_daily_data[e.daily_task_data_list[i].id]=e.daily_task_data_list[i];Dispatch.dispatch(t.EVENT_DAILY_TASK_GET_INFO)},t.prototype.s_daily_task_get_award=function(t){if(this.taskClick){this.taskClick=!1;var e=MessageProtocol.getClass(MessageType.m_daily_task_get_award_tos);e.id=t,MessageProtocol.sendMessage(MessageType.m_daily_task_get_award_tos,e)}},t.prototype.c_daily_task_get_award=function(e){switch(this.taskClick=!0,e.result){case proto.m_daily_task_get_award_toc.ENUM.success:var i=this.getDailyTaskById(e.id);i.state=2,Dispatch.dispatch(t.EVENT_DAILY_TASK_RECEIVE_SUCCESS+e.id),Dispatch.dispatch(t.EVENT_DAILY_TASK_UPDATE);var s=DailyTaskJson.getData(e.id);s&&s.award_list&&SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_4002),AchievementManager.instance.setFuncRed();break;case proto.m_daily_task_get_award_toc.ENUM.fail:FloatTipModule.instance.popTipLanguage("l_game_tips_13");break;case proto.m_daily_task_get_award_toc.ENUM.not_enough_grid:FloatTipModule.instance.popTipLanguage("l_game_tips_14");break;case proto.m_daily_task_get_award_toc.ENUM.not_authority:FloatTipModule.instance.popTipLanguage("l_game_tips_7");break;case proto.m_daily_task_get_award_toc.ENUM.already_have:FloatTipModule.instance.popTipLanguage("l_game_tips_5")}},t.prototype.c_daily_task_notice_update_daily_task_data=function(e){for(var i=!1,s=0;s<e.daily_task_data_list.length;s++)e.daily_task_data_list[s].id==t.instance.p_daily_show.value&&(i=!0),this.m_daily_data[e.daily_task_data_list[s].id]=e.daily_task_data_list[s];1==t.instance.p_daily_show.key&&i&&Dispatch.dispatch(t.EVENT_SCENE_DAILY_TASK_CHANGE),Dispatch.dispatch(t.EVENT_DAILY_TASK_UPDATE),AchievementManager.instance.setFuncRed()},t.prototype.c_daily_task_notice_update_task_show=function(e){this.p_daily_show=e.task_show,Dispatch.dispatch(t.EVENT_SCENE_DAILY_TASK_CHANGE)},t.prototype.getDailyTaskById=function(t){return this.m_daily_data[t]},t.prototype.getTaskList=function(){for(var t=DailyTaskJson.getDailyTaskIdList(),e=[],i=[],s=[],n=0;n<t.length;n++){var o=t[n],a=this.m_daily_data[o];a?1==a.state?e.push(o):2==a.state?s.push(o):0==a.state&&i.push(o):i.push(o)}return e.concat(i.concat(s))},t.prototype.setDailyRed=function(){for(var t in this.m_daily_data){var e=this.m_daily_data[t];if(1==e.state)return!0}return!1},t.EVENT_DAILY_TASK_GET_INFO="EVENT_DAILY_TASK_GET_INFO",t.EVENT_DAILY_TASK_UPDATE="EVENT_DAILY_TASK_UPDATE",t.EVENT_DAILY_TASK_RECEIVE_SUCCESS="EVENT_DAILY_TASK_RECEIVE_SUCCESS",t.EVENT_SCENE_DAILY_TASK_CHANGE="EVENT_SCENE_DAILY_TASK_CHANGE",t}();__reflect(DailyTaskManager.prototype,"DailyTaskManager");var DebugManager=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){MessageManager.register(MessageType.m_debug_debug_toc,this.m_debug_debug_toc,this)},t.prototype.m_debug_debug_toc=function(t){t.result==proto.m_debug_debug_toc.ENUM.success?FloatTipModule.instance.popTip("修改成功成功成功~"):t.result==proto.m_debug_debug_toc.ENUM.fail&&FloatTipModule.instance.popTip("修改失败......")},t.prototype.s_debug_debug=function(t,e){var i=MessageProtocol.getClass(MessageType.m_debug_debug_tos);i.type=t,i.param_list=e,MessageProtocol.sendMessage(MessageType.m_debug_debug_tos,i)},t}();__reflect(DebugManager.prototype,"DebugManager");var DrawCardManager=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){MessageManager.register(MessageType.m_card_summon_do_summon_toc,this.c_card_summon_do_summon,this),Dispatch.register(TimesManager.EVENT_TIEMS_UPDATE+TimesEnum.CARD_SUMMON_TIMES,this.setRedNotice,this),Dispatch.register(PlayerManager.EVENT_PLAYER_INIT,this.setRedNotice,this)},t.prototype.setRedNotice=function(){var t=TimesManager.instance.getTimesById(TimesEnum.CARD_SUMMON_TIMES)>0;RedNoticeManager.instance.dispatchRed(RedNoticeConfig.RED_CHOU_KA,t)},t.prototype.c_card_summon_do_summon=function(e){switch(e.result){case proto.m_card_summon_do_summon_toc.ENUM.success:this.p_prop=e.prop_list,Dispatch.dispatch(t.EVENT_CARD_SUMMON);break;case proto.m_card_summon_do_summon_toc.ENUM.not_authority:BagManager.instance.noEnoughRmb();break;default:FloatTipModule.instance.popTipLanguage("l_card_summon_result_tip1")}},t.prototype.s_card_summon_do_summon=function(t){var e=MessageProtocol.getClass(MessageType.m_card_summon_do_summon_tos);e.type=t,MessageProtocol.sendMessage(MessageType.m_card_summon_do_summon_tos,e)},t.EVENT_CARD_SUMMON="EVENT_CARD_SUMMON",t}();__reflect(DrawCardManager.prototype,"DrawCardManager");var EverydaySignManager=function(t){function e(){var e=t.call(this)||this;return e.today_list=[],e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.m_instance||(this.m_instance=new e),this.m_instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){MessageManager.register(MessageType.m_everyday_sign_everyday_sign_toc,this.c_everyday_sign_everyday_sign,this),MessageManager.register(MessageType.m_everyday_sign_notice_day_toc,this.c_sign_notice_day,this)},e.prototype.initData=function(t){this.day=t.day,this.today_list=t.today,this.round=t.round,this.setRedNotice()},e.prototype.s_everyday_sign_everyday_sign=function(t){var e=MessageProtocol.getClass(MessageType.m_everyday_sign_everyday_sign_tos);e.today=t,e.round=this.round,MessageProtocol.sendMessage(MessageType.m_everyday_sign_everyday_sign_tos,e)},e.prototype.c_everyday_sign_everyday_sign=function(t){switch(t.result){case proto.m_everyday_sign_everyday_sign_toc.ENUM.success:this.today_list.push(t.today),Dispatch.dispatch(e.EVERYDAY_SIGN_DAY,t.today),this.setRedNotice(),SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_4002);break;case proto.m_everyday_sign_everyday_sign_toc.ENUM.not_authority:FloatTipModule.instance.popTipLanguage("l_vip_tips_4");break;case proto.m_everyday_sign_everyday_sign_toc.ENUM.function_no_open:FloatTipModule.instance.popTipLanguage("l_game_tips_9");break;case proto.m_everyday_sign_everyday_sign_toc.ENUM.already_have:FloatTipModule.instance.popTipLanguage("l_game_tips_5");break;case proto.m_everyday_sign_everyday_sign_toc.ENUM.no_enough_prop:BagManager.instance.noEnoughGold();break;default:FloatTipModule.instance.popTipLanguage("l_signIn_popTips_1")}},e.prototype.c_sign_notice_day=function(t){this.day=t.day,this.round=t.round,1==this.day&&(this.today_list=[]),this.setRedNotice(),Dispatch.dispatch(e.EVERYDAY_SIGN_ALL),DelayCallUtils.delayedCall(10,this.setNoticeEvent,this)},e.prototype.setNoticeEvent=function(){DelayCallUtils.killDelayedCallsTo(this.setNoticeEvent,this),Dispatch.dispatch(ServerTimeManager.ZERO_POINT_EVENT)},Object.defineProperty(e.prototype,"isSignInDay",{get:function(){return-1==this.today_list.indexOf(this.day)?!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBuQian",{get:function(){for(var t=1;30>=t;t++)if(-1==this.today_list.indexOf(t)&&t<e.instance.day)return!0;return!1},enumerable:!0,configurable:!0}),e.prototype.setRedNotice=function(){RedNoticeManager.instance.dispatchRed(RedNoticeConfig.RED_SIGN_IN,this.isSignInDay)},e.EVERYDAY_SIGN_DAY="EVERYDAY_SIGN_DAY",e.EVERYDAY_SIGN_ALL="EVERYDAY_SIGN_ALL",e}(egret.HashObject);__reflect(EverydaySignManager.prototype,"EverydaySignManager");var FightManager=function(t){function e(){var e=t.call(this)||this;return e.p_attackTime=-1,e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.m_instance||(this.m_instance=new e),this.m_instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){MessageManager.register(MessageType.m_fight_notice_fight_fail_toc,this.c_fight_notice_fight_fail,this),MessageManager.register(MessageType.m_fight_notice_fight_result_toc,this.c_fight_notice_fight_result,this),MessageManager.register(MessageType.m_fight_notice_add_buff_toc,this.c_fight_notice_add_buff,this),MessageManager.register(MessageType.m_fight_notice_remove_buff_toc,this.c_m_fight_notice_remove_buff,this),MessageManager.register(MessageType.m_fight_notice_get_function_monster_award_toc,this.c_m_fight_notice_get_function_monster_award,this)},e.prototype.s_fight_fight=function(t,e,i,s,n){if(!(this.p_attackTime>0&&ServerTimeManager.instance.timerValue<this.p_attackTime+FightSkillManager.instance.p_attackSpeed)){this.p_attackTime=ServerTimeManager.instance.timerValue;var o=MessageProtocol.getClass(MessageType.m_fight_fight_tos);if(o.skill_id=t,o.target_id=e,o.attack_type=s,o.target_type=i,o.mano_value=n,0!=o.target_id&&o.target_type!=ObjTypeEnum.NONE){var a=FightModule.instance.getFighter(i,e);if(null==a)return;o.dir=AvatarConfig.getDirection(a.x-PlayerManager.instance.p_mainPlayer.x,a.y-PlayerManager.instance.p_mainPlayer.y)}else{MyMapModule.instance.map.mapTouchPoint;o.dir=PlayerManager.instance.p_mainPlayer.curDirection}MessageProtocol.sendMessage(MessageType.m_fight_fight_tos,o)}},e.prototype.c_fight_notice_fight_fail=function(t){t.reason},e.prototype.c_fight_notice_add_buff=function(t){},e.prototype.c_m_fight_notice_remove_buff=function(t){},e.prototype.c_fight_notice_fight_result=function(t){FightModule.instance.executeFightResult(t)},e.prototype.c_m_fight_notice_get_function_monster_award=function(t){switch(FightAutoAI.instance.p_isAutoFight&&(FightAutoAI.instance.stopAutoFight(),UIModule.instance.stopAuto(FightSkillManager.type_auto),PlayerManager.instance.p_mainPlayer&&PlayerManager.instance.p_mainPlayer.shiftToAction(AvatarConfig.ACTION_stand)),t.special_event){case 9:PopupModule.instance.showPop(PopupConfig.ID_CARD_POPUP,t,!1);break;case 10:PopupModule.instance.showPop(PopupConfig.ID_MONSTER_ROLL,t,!1);break;case 11:PopupModule.instance.showPop(PopupConfig.ID_ROTARY_TABLE,t,!1)}},e.prototype.showPopupAward=function(t,e){RewardModule.instance.receiveByProp(e,5,2,this.s_get_award.bind(this,t))},e.prototype.s_get_award=function(t){var e=MessageProtocol.getClass(MessageType.m_fight_give_function_monster_award_tos);e.special_event=t,MessageProtocol.sendMessage(MessageType.m_fight_give_function_monster_award_tos,e)},Object.defineProperty(e.prototype,"fightAttackList",{get:function(){return[901,902,903]},enumerable:!0,configurable:!0}),e}(egret.HashObject);__reflect(FightManager.prototype,"FightManager");var FightSkillManager=function(){function t(){this.p_manaValue=-1,this.p_manaList=[],this.p_typeScene=2,this.p_goldDelayTime=0,this.p_rmbDelayTime=0}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){MessageManager.register(MessageType.m_fight_use_item_toc,this.c_fight_use_item_toc,this),MessageManager.register(MessageType.m_fight_notice_bin_dong_skill_toc,this.c_notice_bin_dong_skill,this),MessageManager.register(MessageType.m_fight_notice_cancel_bin_dong_toc,this.c_notice_cancel_bin_dong,this),MessageManager.register(MessageType.m_skill_use_skill_toc,this.c_skill_use_skill,this),Dispatch.register(MissionManager.EVENT_ENTER_MISSION,this.setChangeMission,this),Dispatch.register(PlayerManager.EVENT_PLAYER_INIT,this.initPlayerInfo,this)},t.prototype.initPlayerInfo=function(){t.type_lightning=Number(StaticDataJson.getData("monster_effect5_skill_id").data),t.type_baoza=Number(StaticDataJson.getData("monster_function_zhadan_skill_id").data),t.type_huoqiu=Number(StaticDataJson.getData("monster_function_huoqiu_skill_id").data),t.type_dizhen=Number(StaticDataJson.getData("monster_function_dizhen_skill_id").data),t.type_shenlong=Number(StaticDataJson.getData("monster_function_shenlongzhufu_id").data)},t.prototype.useSkillFight=function(t){var e=MessageProtocol.getClass(MessageType.m_fight_use_item_tos);e.item_id=t,e.mano_value=this.p_manaValue,MessageProtocol.sendMessage(MessageType.m_fight_use_item_tos,e)},t.prototype.c_fight_use_item_toc=function(e){switch(e.reason){case proto.m_fight_use_item_toc.ENUM.success:t.type_rage==e.item_id&&(FightUIModule.instance.showRageSkill(),SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_2001)),Dispatch.dispatch(t.EVENT_FIGHT_SKILL_USE+e.item_id);break;case proto.m_fight_use_item_toc.ENUM.cd_time:FloatTipModule.instance.popTipLanguage("l_fight_skill_cd");break;case proto.m_fight_use_item_toc.ENUM.fail:FloatTipModule.instance.popTipLanguage("l_fight_skill_fail")}},t.prototype.c_notice_bin_dong_skill=function(t){var e;if(t.player_id==PlayerManager.instance.playerId)CameraModule.instance.setCameraShake(20,1800),e=[0,0];else{var i=SceneItemModule.instance.getPlayer(t.player_id);i&&i.parent&&(e=i.getPointStage())}e&&(FightUIModule.instance.showForzen(e),SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_2006));for(var s=0;s<t.list.length;s++){var n=SceneItemModule.instance.monsterDict[t.list[s].scene_monster_id];n&&n.addBingDong(t.list[s].destroy_time)}},t.prototype.c_notice_cancel_bin_dong=function(t){for(var e in SceneItemModule.instance.monsterDict){var i=SceneItemModule.instance.monsterDict[e];if(i.dataMonster&&i.dataMonster.scene_monster_id==t.scene_monster_id){i.removeBingDong();break}}},t.prototype.setChangeMission=function(){var t=MissionJson.getData(MissionManager.instance.missionType,MissionManager.instance.missionId);t&&t.mana_attack_list&&this.setChangeScene(t.mana_attack_list)},t.prototype.setChangeScene=function(e){this.p_typeScene=e[0],this.p_manaList=e[1],-1==this.p_manaList.indexOf(this.p_manaValue)?this.p_manaValue=this.p_manaList[0]:this.p_manaValue<this.p_manaList[0]||this.p_manaList.length<=1?this.p_manaValue=this.p_manaList[0]:this.p_manaValue>this.p_manaList[this.p_manaList.length-1]&&(this.p_manaValue=this.p_manaList[this.p_manaList.length-1]),Dispatch.dispatch(t.EVENT_FIGHT_SET_MANA)},t.prototype.setManaValue=function(e){if(void 0===e&&(e=1),!(1==e&&this.currIdx>=this.p_manaList.length-1||-1==e&&this.currIdx<=0)){var i=this.currIdx+e;this.p_manaValue=this.p_manaList[i],Dispatch.dispatch(t.EVENT_FIGHT_SET_MANA)}},t.prototype.setAttackSpeed=function(){var t;PlayerManager.instance.p_mainPlayer&&PlayerManager.instance.p_mainPlayer.playerData&&(t=PlayerManager.instance.p_mainPlayer.playerData.hero_arms_id);var e=HeroPartsJson.getData(t);e&&(this.p_attackSpeed=Number(e.attack_speed)),this.p_attackSpeed<=0&&(this.p_attackSpeed=150)},Object.defineProperty(t.prototype,"currIdx",{get:function(){return this.p_manaList.indexOf(this.p_manaValue)},enumerable:!0,configurable:!0}),t.prototype.getCdTime=function(t){return UIModule.instance.getCdTime(t)},Object.defineProperty(t.prototype,"isGoldScene",{get:function(){return this.p_typeScene==ItemEnum.GOLD?!0:!1},enumerable:!0,configurable:!0}),t.prototype.getIsAttackTimes=function(e){void 0===e&&(e=!1);var i;return i=2==t.instance.p_typeScene?BagManager.instance.gold:BagManager.instance.rmb,i>=this.attValueMana?!0:(e&&(2==t.instance.p_typeScene?FloatTipModule.instance.popTipLanguage("l_game_tips_2"):FloatTipModule.instance.popTipLanguage("l_game_tips_20")),!1)},Object.defineProperty(t.prototype,"attValueMana",{get:function(){var t=1;return SceneManager.instance.p_sceneJson.drop_per>1e4&&(t=SceneManager.instance.p_sceneJson.drop_per/1e4),this.p_manaValue*t},enumerable:!0,configurable:!0}),t.prototype.s_skill_use_skill_tos=function(t,e){var i=MessageProtocol.getClass(MessageType.m_skill_use_skill_tos);i.active_skill_id=t,null!=e&&(i.dir=e),MessageProtocol.sendMessage(MessageType.m_skill_use_skill_tos,i)},t.prototype.c_skill_use_skill=function(e){1==e.result&&Dispatch.dispatch(t.EVENT_ACTIVE_SKILL_USE+e.active_skill_id,e)},t.EVENT_FIGHT_SKILL_USE="EVENT_FIGHT_SKILL_USE",t.EVENT_FIGHT_SKILL_STOP="EVENT_FIGHT_SKILL_STOP",t.EVENT_FIGHT_SET_MANA="EVENT_FIGHT_SET_MANA",t.EVENT_SKILL_GOLD_ADD="EVENT_SKILL_GOLD_ADD",t.EVENT_ACTIVE_SKILL_USE="EVENT_ACTIVE_SKILL_USE",t.type_lightning=102,t.type_baoza=105,t.type_huoqiu=106,t.type_dizhen=107,t.type_shenlong=108,t.huoQiu_speed=200,t}();__reflect(FightSkillManager.prototype,"FightSkillManager");var FunctionConfigManager=function(t){function e(){var e=t.call(this)||this;return e.m_initList={},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.m_instance||(this.m_instance=new e),this.m_instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){Dispatch.register(PlayerManager.EVENT_PLAYER_INIT,this.playerInfo,this)},e.prototype.playerInfo=function(){Dispatch.remove(PlayerManager.EVENT_PLAYER_INIT,this.playerInfo,this),PlayerManager.instance.s_player_customer_url(),DelayCallUtils.delayedCall(.8,this.checkInitPopup,this)},e.prototype.checkInitPopup=function(){return!this.m_initList[1]&&PlayerManager.instance.changeCreateName?(this.m_initList[1]=1,void PopupModule.instance.showPop(PopupConfig.ID_CREATE_ROLE,{c_funcBack:this.checkInitPopup.bind(this)},!1)):!this.m_initList[2]&&SevenLoginManager.instance.isReceiveSure?(this.m_initList[2]=1,void UIModule.instance.showUI(UIConfig.ID_WELFARE,{c_pageKey:FunctionEnum.SEVEN_LOGIN_SYS,c_funcBack:this.checkInitPopup.bind(this)})):void 0},e.prototype.executeFunction=function(t,e){switch(void 0===e&&(e=null),t.functions_type){case 1:this.configShowUI(t,e);break;case 2:this.configShowPopup(t,e)}},e.prototype.configShowUI=function(t,e){UIModule.instance.showUI(e.c_uiId,e)},e.prototype.configShowPopup=function(t,e){e&&e.isCache?PopupModule.instance.showPop(e.c_popupId,e,!1):PopupModule.instance.showPop(e.c_popupId,e)},e}(egret.HashObject);__reflect(FunctionConfigManager.prototype,"FunctionConfigManager");var FunctionManager=function(){function t(){this.m_fun_id_list=[],this.m_back_func={},this.registerFunctionOpenDict=[],this.displayAndFuncIdRelation=[]}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.initData=function(e){this.updateData(e,!0),Dispatch.dispatch(t.FUNCTION_OPEN_INIT)},t.prototype.updateData=function(t,e){void 0===e&&(e=!1);for(var i=[],s=0;s<t.length;s++){-1==i.indexOf(Number(t[s]))&&i.push(Number(t[s]));var n=FunctionJson.getData(t[s]);if(n&&n.enter_list&&n.enter_list.length>0)for(var o=0;o<n.enter_list.length;o++)-1==i.indexOf(Number(n.enter_list[o]))&&i.push(Number(n.enter_list[o]))}this.disOpenBack(i,e)},t.prototype.disOpenBack=function(e,i){for(var s=!1,n=0;n<e.length;n++)if(-1==this.m_fun_id_list.indexOf(e[n])){if(this.enabledFunction(e[n]),this.m_fun_id_list.push(e[n]),this.m_back_func[e[n]]&&this.m_back_func[e[n]].backFuncList)for(var o=this.m_back_func[e[n]].backFuncList,a=0;a<o.length;a++)null!=o[a]&&o[a].apply(null);if(!i){Dispatch.dispatch(t.FUNCTION_OPEN_UPDATE+e[n]),Dispatch.dispatch(t.FUNCTION_OPEN_SELECT,e[n]);var r=FunctionIconJson.getDataByFuncIdAcId(e[n]);r&&r.length>0&&0==s&&(s=!0)}}s&&EntranceModule.instance.refreshEntrance()},t.prototype.registerOpenBack=function(t,e){if(this.m_back_func[t]){var i=this.m_back_func[t].backFuncList;i.push(e)}else this.m_back_func[t]={funcId:t,backFuncList:[e]};1==this.getOpenFuncId(t)&&e.apply("")},t.prototype.getOpenFuncId=function(t,e){if(void 0===e&&(e=!1),-1!=this.m_fun_id_list.indexOf(t))return!0;if(e){var i=FunctionJson.getData(t);i&&""!=i.condition_desc?FloatTipModule.instance.popTip(i.condition_desc):FloatTipModule.instance.popTipLanguage("l_game_tips_9")}return!1},t.prototype.executeFunction=function(t,e){void 0===e&&(e=null);var i=FunctionConfigJson.getData(t);if(i){if(0!=i.function_id&&!this.getOpenFuncId(i.function_id,!0))return;FunctionConfigManager.instance.executeFunction(i,this.setMergeObj(e,i.param_obj))}},t.prototype.setMergeObj=function(t,e){if(t&&e)for(var i in e)t[i]=e[i];else null==t&&e&&(t=e);return t},t.prototype.registerFunctionOpen=function(t,e,i){void 0===i&&(i=null),1!=this.getOpenFuncId(e)&&this.disabledFunction(t,e,i)},t.prototype.disabledFunction=function(t,e,i){var s=this.registerFunctionOpenDict[e];null==s&&(s=[],this.registerFunctionOpenDict[e]=s);for(var n=-1,o=0;o<s.length;o++)if(s[o].display==t){n=o;break}-1==n&&(this.displayAndFuncIdRelation[t.hashCode]=e,s.push({display:t,funcId:e,point:i})),this.setDisplayObjectLock(t,i)},t.prototype.setDisplayObjectLock=function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=""),ObjectUtils.setGrey(t),t.lockTipMsg=i;var s=t.lockImg;null==s&&(t.lockImg=new eui.Image("commonUI_lock_1"),s=t.lockImg),s.touchEnabled=!1,t.parent.addChild(s),s.x=t.x+(e?e.x:.5*t.width),s.y=t.y+(e?e.y:-10),t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onFunctionClick,this,!1,999)},t.prototype.closeDisplayObjectLock=function(t){t.filters=null,t.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onFunctionClick,this,!1);var e=t.lockImg;e&&(e.source=null,DisplayObjectUtils.removeFormParent(e))},t.prototype.enabledFunction=function(t){var e=this.registerFunctionOpenDict[t];if(null!=e){for(var i=0;i<e.length;i++)if(e[i].display){this.closeDisplayObjectLock(e[i].display),delete this.displayAndFuncIdRelation[e[i].display.hashCode];
break}this.registerFunctionOpenDict[t]=null,delete this.registerFunctionOpenDict[t]}},t.prototype.onFunctionClick=function(t){var e=t.currentTarget;if(e.lockTipMsg&&""!=e.lockTipMsg)FloatTipModule.instance.popTip(e.lockTipMsg);else{var i=this.displayAndFuncIdRelation[e.hashCode];FloatTipModule.instance.popTip(FunctionJson.getData(i).condition_desc)}t.stopPropagation(),t.stopImmediatePropagation()},t.FUNCTION_OPEN_INIT="FUNCTION_OPEN_INIT",t.FUNCTION_OPEN_UPDATE="FUNCTION_OPEN_UPDATE",t.FUNCTION_OPEN_SELECT="FUNCTION_OPEN_SELECT",t}();__reflect(FunctionManager.prototype,"FunctionManager");var GameManager=function(){function t(){this.p_version="7",this.p_version_v="11",this.p_cacheAsBitmap=!1,this.p_isTexture=!1,this.triggerGC=null,this.gcTime=0,this.gcGap=18e4}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.initGame=function(){EnterFrameManager.instance.init(),MoveManager.instance.init(),MissionManager.instance.init(),PlayerManager.instance.init(),BagManager.instance.init(),SceneManager.instance.init(),ServerTimeManager.instance.init(),FightManager.instance.init(),SkillFactory.instance.init(),FightModule.instance.init(),ChatManager.instance.init(),TimesManager.instance.init(),TimeManager.instance.init(),DebugManager.instance.init(),AchievementManager.instance.init(),RankManager.instance.init(),ChargeManager.instance.init(),OnlineAwardManager.instance.init(),SevenLoginManager.instance.init(),EverydaySignManager.instance.init(),VipManager.instance.init(),SysCommonManager.instance.init(),FightSkillManager.instance.init(),MailManager.instance.init(),DailyTaskManager.instance.init(),TaskManager.instance.init(),ManyPeopleBossManager.instance.init(),GuessBossManager.instance.init(),GuessManager.instance.init(),MissionShiShiManager.instance.init(),PromoteManager.instance.init(),ShopManager.instance.init(),ActivityManager.instance.init(),PlatformFunctionManager.instance.init(),FightAutoAI.instance.init(),TurnTableManager.instance.init(),ShiShiRoomManager.instance.init(),RedPacketManager.instance.init(),InvestManager.instance.init(),MissionEitherManager.instance.init(),BraveOneManager.instance.init(),WithdrawManager.instance.init(),HeroManager.instance.init(),CardManager.instance.init(),TaskManager.instance.init(),LuckyDrawManager.instance.init(),DrawCardManager.instance.init(),FunctionConfigManager.instance.init(),GodDragonManager.instance.init();var t=TexturePool.instance.getTextureAtlas(PublicCon.PATH_REPLACE_URL);TexturePool.instance.addCommonUseTexture(t),t=TexturePool.instance.getTextureAtlas(PublicCon.PATH_EFFECT_CLICK_STAGE),TexturePool.instance.addCommonUseTexture(t)},t.prototype.callToNative=function(t,e){void 0===e&&(e=""),URIManager.p_h5Game?H5Manager.instance.trackEvent(t,e):URIManager.is_platform&&egret.ExternalInterface.call(t,e)},t.prototype.setPerformanceRate=function(e){switch(t.performanceRate=e,t.performanceRate){case PerformanceRateEnum.LOW:TexturePool.instance.disposeSize=30;break;case PerformanceRateEnum.MEDIUM:TexturePool.instance.disposeSize=110;break;case PerformanceRateEnum.HEIGHT:TexturePool.instance.disposeSize=130}},t.prototype.GC=function(){var t=egret.getTimer();t-this.gcTime<this.gcGap||(this.gcTime=t,console.log("触发真实GC"),wx.triggerGC())},t.prototype.getResByUrl=function(t){this.m_backFunc=t;var e=window.platform_name;URIManager.p_h5Game&&(e=H5Manager.instance.getPlatformName()),e&&""!=e?this.checkRelease(e):RES.getResByUrl(URIManager.rootUrl+"/resource/setting.json?v="+Math.random(),this.m_backFunc,this,RES.ResourceItem.TYPE_JSON)},t.prototype.checkRelease=function(t){var e=new egret.HttpRequest;e.responseType=egret.HttpResponseType.TEXT;var i=this.getSettingUrl(t)+"&setting=1";console.log("version__ ",i),e.open(i,egret.HttpMethod.GET),e.send(),e.addEventListener(egret.Event.COMPLETE,this.onVersionGetComplete,this),e.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onAllGetIOError,this),e.addEventListener(egret.ProgressEvent.PROGRESS,this.onAllGetProgress,this)},t.prototype.onVersionGetComplete=function(t){var e=t.currentTarget;this.m_backFunc(JSON.parse(e.response),""),console.log("back setting",e.response)},t.prototype.getSettingUrl=function(t){var e=t.split("_");return e[1]&&"1"==e[1]?"http://version.bountymasters.com/version?platform_id="+e[0]+"&version="+this.p_version:"http://47.101.164.86:6666/version?platform_id="+e[0]+"&version="+this.p_version},t.prototype.onAllGetIOError=function(t){console.log("get error ================: "+t)},t.prototype.onAllGetProgress=function(t){console.log("get progress ===============: "+Math.floor(100*t.bytesLoaded/t.bytesTotal)+"%")},Object.defineProperty(t.prototype,"isIos",{get:function(){return"iOS"==PlatformManager.instance.os||"ios"==PlatformManager.instance.os?!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isShield",{get:function(){return ChargeManager.instance.isOpenRecharge&&1!=URIManager.is_reviewing?!1:!0},enumerable:!0,configurable:!0}),t.performanceRate=3,t.p_hotAlpha=0,t.p_hotList=[],t}();__reflect(GameManager.prototype,"GameManager");var PerformanceRateEnum=function(){function t(){}return t.LOW=1,t.MEDIUM=2,t.HEIGHT=3,t}();__reflect(PerformanceRateEnum.prototype,"PerformanceRateEnum");var GiftCodeManager=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){MessageManager.register(MessageType.m_gift_code_gift_code_toc,this.c_gift_code_gift_code,this)},t.prototype.s_gift_code_gift_code=function(t){var e=MessageProtocol.getClass(MessageType.m_gift_code_gift_code_tos);e.gift_code_id,MessageProtocol.sendMessage(MessageType.m_gift_code_gift_code_tos,e)},t.prototype.c_gift_code_gift_code=function(t){t.result,t.item_list},t}();__reflect(GiftCodeManager.prototype,"GiftCodeManager");var GodDragonManager=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){MessageManager.register(MessageType.m_shen_long_draw_tos,this.s_shen_long_draw,this),MessageManager.register(MessageType.m_shen_long_draw_toc,this.c_shen_long_draw,this),MessageManager.register(MessageType.m_shen_long_notice_scene_shen_long_state_toc,this.c_shen_long_notice_scene_shen_long_state,this)},t.prototype.s_shen_long_draw=function(){var t=MessageProtocol.getClass(MessageType.m_shen_long_draw_tos);MessageProtocol.sendMessage(MessageType.m_shen_long_draw_tos,t)},t.prototype.c_shen_long_draw=function(e){switch(e.result){case proto.m_shen_long_draw_toc.ENUM.success:this.m_pDrawData=e,Dispatch.dispatch(t.EVENT_GODDRAGON_AWARD);break;case proto.m_shen_long_draw_toc.ENUM.fail:FloatTipModule.instance.popTipLanguage("l_game_tips_18");break;case proto.m_shen_long_draw_toc.ENUM.not_authority:FloatTipModule.instance.popTipLanguage("l_game_tips_15");break;case proto.m_shen_long_draw_toc.ENUM.no_enough_prop:FloatTipModule.instance.popTipLanguage("l_game_tips_11")}},t.prototype.c_shen_long_notice_scene_shen_long_state=function(t){this.m_pStateMsg=t,t.player_id&&!PopupModule.instance.havPopupStage(PopupConfig.ID_GODDRAGON_LOTTERY)&&PopupModule.instance.showPop(PopupConfig.ID_GODDRAGON_LOTTERY),t.state>=1?UIModule.instance.setGodDragonBtn():UIModule.instance.setGodDragonBtn(!1)},t.prototype.isPopupTishi=function(){var t=PlayerManager.instance.getSetingMsg(GameSetConfig.k_guessKey);t||(PlayerManager.instance.setingMsg(GameSetConfig.k_guessKey,"1"),PopupModule.instance.showPop(PopupConfig.ID_LUCK_BOSS_FIRST_ENTER,null,!1))},t.EVENT_GODDRAGON_AWARD="EVENT_GODDRAGON_AWARD",t.EVENT_GODDRAGON_BLESS="EVENT_GODDRAGON_BLESS",t}();__reflect(GodDragonManager.prototype,"GodDragonManager");var GuessBossManager=function(){function t(){this.p_guessRecord=[],this.m_myCost={},this.m_bossList=[],this.m_timesData={},this.m_maxCost=0,this.p_winBoss=0,this.p_award_list=[],this.p_total_cost_value=0,this.p_posList=[],this.p_fightData=[]}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){MessageManager.register(MessageType.m_mission_guess_get_record_toc,this.c_mission_guess_get_record,this),MessageManager.register(MessageType.m_mission_notice_guess_boss_cost_my_mana_toc,this.c_mission_notice_guess_boss_cost_my_mana,this),MessageManager.register(MessageType.m_mission_notice_guess_boss_cost_total_mana_toc,this.c_mission_notice_guess_boss_cost_total_mana,this),MessageManager.register(MessageType.m_mission_notice_guess_boss_mission_result_toc,this.c_mission_notice_guess_boss_mission_result,this),MessageManager.register(MessageType.m_mission_notice_guess_boss_mission_time_toc,this.c_mission_notice_guess_boss_mission_time,this),this.m_maxCost=Number(StaticDataJson.getData("guess_max_limit").data)},t.prototype.s_mission_guess_get_record=function(){var t=MessageProtocol.getClass(MessageType.m_mission_guess_get_record_tos);MessageProtocol.sendMessage(MessageType.m_mission_guess_get_record_tos,t)},t.prototype.c_mission_guess_get_record=function(e){this.p_guessRecord=e.guess_boss_record_list,ArrayUtils.setSortArr(this.p_guessRecord,["id"],[1]),this.getTrendChat(),Dispatch.dispatch(t.EVENT_GUESS_BOSS_RECORD)},t.prototype.getTrendChat=function(){if(this.m_timesData={},MissionManager.instance.missionType==MissionTypeEnum.GUESS_BOSS){for(var t in this.p_guessRecord){var e=this.p_guessRecord[t].boss_id;this.m_timesData[e]?this.m_timesData[e]+=1:this.m_timesData[e]=1}PopupModule.instance.showPop(PopupConfig.ID_LUCK_BOSS_RECORD,null,!1)}},t.prototype.c_mission_notice_guess_boss_cost_my_mana=function(e){for(var i in e.guess_boss_cost){var s=SceneItemModule.instance.getMonster(e.guess_boss_cost[i].boss_id);if(s){var n=s.jsonMonster.id;this.m_myCost[n]=e.guess_boss_cost[i],Dispatch.dispatch(t.EVENT_GUESS_BOSS_MYCOST_CHANGE+n)}}},t.prototype.getMyCostByBossId=function(t){var e=this.m_myCost[t];return e?Number(e.num):0},t.prototype.c_mission_notice_guess_boss_cost_total_mana=function(t){for(var e in t.guess_boss_cost)var i=SceneItemModule.instance.getMonster(t.guess_boss_cost[e].boss_id)},t.prototype.c_mission_notice_guess_boss_mission_result=function(e){this.p_winBoss=e.boss_id,this.p_posList=e.boss_id_list,this.p_fightData=e.guess_boss_result_fight_list,ArrayUtils.setSortArr(this.p_fightData,["round_id"],[0]),PopupModule.instance.hidePopAll(),e.guess_boss_result_fight_list.length>0&&PopupModule.instance.showPop(PopupConfig.ID_GUESS_BOSS_FIGHT,this.m_myCost),PopupModule.instance.showPop(PopupConfig.ID_GUESS_BOSS_EFFECT,{bossId:e.boss_id}),PopupModule.instance.showPop(PopupConfig.ID_GUESS_BOSS_RESULT,{bossId:e.boss_id,prop:e.award_list,totalCost:e.total_cost_value}),this.m_myCost={},Dispatch.dispatch(t.EVENT_GUESS_BOSS_RESULT)},t.prototype.c_mission_notice_guess_boss_mission_time=function(e){1==e.state&&PopupModule.instance.havPopupStage(PopupConfig.ID_GUESS_BOSS_FIGHT)&&(PopupModule.instance.hidePopAll(),PopupModule.instance.hidePop(PopupConfig.ID_GUESS_BOSS_FIGHT),PopupModule.instance.showPop(PopupConfig.ID_GUESS_BOSS_EFFECT,{bossId:this.p_winBoss}),PopupModule.instance.showPop(PopupConfig.ID_GUESS_BOSS_RESULT,{bossId:this.p_winBoss,prop:this.p_award_list,totalCost:this.p_total_cost_value})),e.timestamp&&MissionManager.instance.missionTime!=e.timestamp&&(MissionManager.instance.missionTime=e.timestamp,Dispatch.dispatch(MissionManager.EVENT_TIME_MISSION,e.state)),1==e.state&&e.timestamp-ServerTimeManager.instance.timer<=20||t.instance.isPopupTishi()},Object.defineProperty(t.prototype,"guessBossList",{get:function(){return this.m_bossList.length<=0&&(this.m_bossList=StaticDataJson.parseStrToList("guess_mission_boss_list")),this.m_bossList},enumerable:!0,configurable:!0}),t.prototype.getselectNum=function(t){return this.m_timesData[t]?this.m_timesData[t]:0},t.prototype.getBossIdx=function(t){var e=this.guessBossList.indexOf(t);return e},t.prototype.isMaxCost=function(t){for(var e in SceneItemModule.instance.monsterDict){var i=SceneItemModule.instance.monsterDict[e];if(i.dataMonster.monster_id==t){var s=this.getMyCostByBossId(t);return s>=this.m_maxCost?(FloatTipModule.instance.popTipLanguage("l_guess_boss_maxCost"),!0):!1}}return!1},t.prototype.isPopupTishi=function(){var t=PlayerManager.instance.getSetingMsg(GameSetConfig.k_guessKey);t||(PlayerManager.instance.setingMsg(GameSetConfig.k_guessKey,"1"),PopupModule.instance.showPop(PopupConfig.ID_LUCK_BOSS_FIRST_ENTER,null,!1))},t.EVENT_GUESS_BOSS_RECORD="EVENT_GUESS_BOSS_RECORD",t.EVENT_GUESS_BOSS_MYCOST_CHANGE="EVENT_GUESS_BOSS_MYCOST_CHANGE",t.EVENT_GUESS_BOSS_TOTALCOST_CHANGE="EVENT_GUESS_BOSS_TOTALCOST_CHANGE",t.EVENT_GUESS_BOSS_RESULT="EVENT_GUESS_BOSS_RESULT",t}();__reflect(GuessBossManager.prototype,"GuessBossManager");var GuessManager=function(){function t(){this.p_luckBossEndTime=0,this.p_players=0,this.p_bossState=0,this.p_guessRecord=[],this.m_myCost={},this.m_totalCost={},this.m_bossList=[],this.m_timesData={},this.m_maxCost=0,this.p_uniqueSkillList=[],this.p_guessType=0,this.m_initPoint=new egret.Point,this.m_goPoint=new egret.Point}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){MessageManager.register(MessageType.m_mission_guess_get_record_toc,this.c_mission_luck_boss_get_record,this),MessageManager.register(MessageType.m_mission_lucky_boss_bet_toc,this.c_mission_lucky_boss_bet,this),MessageManager.register(MessageType.m_mission_lucky_boss_bet_reset_toc,this.c_mission_lucky_boss_bet_reset,this),MessageManager.register(MessageType.m_mission_lucky_boss_bet_info_toc,this.c_mission_lucky_boss_bet_info,this),MessageManager.register(MessageType.m_mission_lucky_boss_bet_modification_toc,this.c_mission_lucky_boss_bet_modification,this),MessageManager.register(MessageType.m_mission_lucky_boss_status_toc,this.c_mission_lucky_boss_status,this),MessageManager.register(MessageType.m_mission_notice_lucky_boss_result_toc,this.c_mission_notice_lucky_boss_result,this),MessageManager.register(MessageType.m_mission_notice_lucky_boss_fight_toc,this.c_mission_notice_lucky_boss_fight,this),MessageManager.register(MessageType.m_mission_notice_scene_boss_bet_toc,this.c_mission_notice_scene_boss_bet,this),MessageManager.register(MessageType.m_mission_notice_scene_boss_step_toc,this.c_mission_notice_scene_boss_step,this),MessageManager.register(MessageType.m_mission_notice_scene_boss_result_toc,this.c_mission_notice_scene_boss_result,this),MessageManager.register(MessageType.m_mission_notice_scene_boss_dao_num_change_toc,this.c_mission_notice_scene_boss_dao_num_change,this)},t.prototype.s_mission_luck_boss_get_record=function(){var t=MessageProtocol.getClass(MessageType.m_mission_guess_get_record_tos);MessageProtocol.sendMessage(MessageType.m_mission_guess_get_record_tos,t)},t.prototype.c_mission_luck_boss_get_record=function(t){this.p_guessRecord=t.guess_boss_record_list,ArrayUtils.setSortArr(this.p_guessRecord,["id"],[1]),this.getTrendChat()},t.prototype.getTrendChat=function(){this.m_timesData={};for(var t in this.p_guessRecord){var e=this.p_guessRecord[t].boss_id;this.m_timesData[e]?this.m_timesData[e]+=1:this.m_timesData[e]=1}PopupModule.instance.showPop(PopupConfig.ID_LUCK_BOSS_RECORD,null,!1)},t.prototype.s_mission_lucky_boss_bet=function(t,e){var i=MessageProtocol.getClass(MessageType.m_mission_lucky_boss_bet_tos);i.pos=t,i.bet=e,MessageProtocol.sendMessage(MessageType.m_mission_lucky_boss_bet_tos,i)},t.prototype.c_mission_lucky_boss_bet=function(t){switch(t.result){case proto.m_mission_lucky_boss_bet_toc.ENUM.success:break;case proto.m_mission_lucky_boss_bet_toc.ENUM.no_enough_prop:FloatTipModule.instance.popTipLanguage("l_game_tips_11");break;case proto.m_mission_lucky_boss_bet_toc.ENUM.already_start:FloatTipModule.instance.popTipLanguage("l_luck_boss_cant_done");break;case proto.m_mission_lucky_boss_bet_toc.ENUM.already_start:FloatTipModule.instance.popTipLanguage("l_luck_boss_max_tips");break;case proto.m_mission_lucky_boss_bet_toc.ENUM.already_start:FloatTipModule.instance.popTipLanguage("l_luck_boss_cant_done");break;case proto.m_mission_lucky_boss_bet_toc.ENUM.already_start:FloatTipModule.instance.popTipLanguage("l_luck_boss_bet_tips2")}},t.prototype.s_mission_lucky_boss_bet_reset=function(){if(!this.isLuckBetReset)return void FloatTipModule.instance.popTipLanguage("l_luck_boss_clear_tips3");var t=MessageProtocol.getClass(MessageType.m_mission_lucky_boss_bet_reset_tos);MessageProtocol.sendMessage(MessageType.m_mission_lucky_boss_bet_reset_tos,t)},t.prototype.c_mission_lucky_boss_bet_reset=function(t){switch(t.result){case proto.m_mission_lucky_boss_bet_reset_toc.ENUM.success:FloatTipModule.instance.popTipLanguage("l_luck_boss_clear_tips1");break;case proto.m_mission_lucky_boss_bet_reset_toc.ENUM.failure:FloatTipModule.instance.popTipLanguage("l_luck_boss_clear_tips2");break;case proto.m_mission_lucky_boss_bet_reset_toc.ENUM.unknown:FloatTipModule.instance.popTipLanguage("l_luck_boss_cant_done")}},Object.defineProperty(t.prototype,"isLuckBetReset",{get:function(){for(var t in this.m_myCost){this.m_myCost[t];if(this.m_myCost[t]>0)return!0}return!1},enumerable:!0,configurable:!0}),t.prototype.c_mission_lucky_boss_bet_info=function(e){for(var i in e.bet_modification){var s=e.bet_modification[i],n=this.m_myCost[s.pos];void 0!=n&&n<s.bet&&Dispatch.dispatch(t.EVENT_GUESS_BOSS_MYCOST_CHANGE,s.pos),(void 0==n||void 0!=n&&n!=s.bet)&&(this.m_myCost[s.pos]=s.bet,Dispatch.dispatch(t.EVENT_GUESS_BOSS_MYCOST_CHANGE+s.pos))}},t.prototype.getMyLuckBet=function(t){return this.m_myCost[t]?this.m_myCost[t]:0},t.prototype.c_mission_lucky_boss_bet_modification=function(e){for(var i in e.bet_modification){var s=e.bet_modification[i],n=this.m_totalCost[s.pos];void 0!=n&&n<s.bet&&Dispatch.dispatch(t.EVENT_GUESS_BOSS_TOTALCOST_CHANGE,s.pos),(void 0==n||void 0!=n&&n!=s.bet)&&(this.m_totalCost[s.pos]=s.bet,Dispatch.dispatch(t.EVENT_GUESS_BOSS_TOTALCOST_CHANGE+s.pos))}},t.prototype.getTotalLuckBet=function(t){return this.m_totalCost[t]?this.m_totalCost[t]:0},t.prototype.s_mission_lucky_boss_status=function(t){var e=MessageProtocol.getClass(MessageType.m_mission_lucky_boss_status_tos);e.operation=t,MessageProtocol.sendMessage(MessageType.m_mission_lucky_boss_status_tos,e)},t.prototype.c_mission_lucky_boss_status=function(e){this.p_bossState=e.state,1==e.state&&(this.m_myCost={},this.m_totalCost={}),e.timestamp!=this.p_luckBossEndTime&&(this.p_luckBossEndTime=e.timestamp,Dispatch.dispatch(t.EVENT_GUESS_BOSS_TIME_CHANGE)),e.players!=this.p_players&&(this.p_players=e.players,Dispatch.dispatch(t.EVENT_GUESS_BOSS_PEOPLE_CHANGE)),1!=e.operation||PopupModule.instance.havPopupStage(PopupConfig.ID_LUCK_BOSS)||PopupModule.instance.showPop(PopupConfig.ID_LUCK_BOSS,null,!1)},t.prototype.c_mission_notice_lucky_boss_result=function(t){PopupModule.instance.showPop(PopupConfig.ID_LUCK_BOSS_RESULT,{win_boss:t.boss_id,prop:t.award_list},!1)},t.prototype.c_mission_notice_lucky_boss_fight=function(e){var i=FightModule.instance.getFighter(e.attacker_type,e.attacker_id);if(i){var s=FightModule.instance.getFighter(e.target_type,e.target_id);if(s){var n=e.defender_result_list,o=MissionGuessBossSkillJson.getData(e.skill_id);if(o){var a=o.type;if(1==a){i.shiftToAction(AvatarConfig.ACTION_attack01,e.dir);for(var r=0;r<n.length;r++){var _=FightModule.instance.getFighter(n[r].defender_type,n[r].defender_id);if(_){_&&_ instanceof AvatarMonster&&n[r].hp<=0&&(_.p_isDie=!0,Dispatch.dispatch(t.EVENT_GUESS_BOSS_DIE+_.jsonMonster.id));var h=this.getPartId(e.skill_id);FightUIModule.instance.showGuangBo(i,_,h),this.m_initPoint.x=i.x,this.m_initPoint.y=i.y+i.jsonAvatar.name_off_list[1]/2,this.m_goPoint.x=_.x,this.m_goPoint.y=_.y+_.jsonAvatar.name_off_list[1]/2;var l=egret.Point.distance(this.m_goPoint,this.m_initPoint),c=FightUIModule.instance.getAttackTime(l);TweenLite.delayedCall(.001*c,this.setAttackPlayer.bind(this),[_]),this.execDefender(e.skill_id,i,n[r])}else console.log("受到普攻的怪物不存在")}}else{i.shiftToAction(AvatarConfig.ACTION_attack01,e.dir),FloatTipModule.instance.popTip("BOSS"+i.jsonMonster.id+"正在播放大招！！！");for(var r=0;r<n.length;r++){var _=FightModule.instance.getFighter(n[r].defender_type,n[r].defender_id);if(_){var m;m=this.p_uniqueSkillList.length>0?this.p_uniqueSkillList.shift():new LuckBossUniqueSkill,m.show(_),_&&_ instanceof AvatarMonster&&n[r].hp<=0&&(_.p_isDie=!0,Dispatch.dispatch(t.EVENT_GUESS_BOSS_DIE+_.jsonMonster.id)),TweenLite.delayedCall(.2,this.setAttackPlayer.bind(this),[_]),this.execDefender(e.skill_id,i,n[r])}else console.log("受到大招的怪物不存在")}}}}}},t.prototype.getPartId=function(t){var e=101;switch(t){case 10001:e=101;break;case 10002:e=102;break;case 10003:e=151;break;case 10004:e=152;break;case 10005:e=201;break;case 10006:e=202}return e},t.prototype.execDefender=function(t,e,i){this.m_initPoint.x=e.x,this.m_initPoint.y=e.y+e.jsonAvatar.name_off_list[1]/2;var s=300,n=FightModule.instance.getFighter(i.defender_type,i.defender_id);if(n){this.m_goPoint.x=n.x,this.m_goPoint.y=n.y+n.jsonAvatar.name_off_list[1]/2;var o=egret.Point.distance(this.m_goPoint,this.m_initPoint);s=FightUIModule.instance.getAttackTime(o)}TweenLite.delayedCall(.001*s,FightHurtModule.instance.execHurt,[i,e,t],FightHurtModule.instance)},t.prototype.setAttackPlayer=function(t,e){t?(t.shiftToAction(AvatarConfig.ACTION_injure,t.p_moveDriection),FightUIModule.instance.showShouJi(t,null),SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_2005)):console.log("受击目标不存在")},Object.defineProperty(t.prototype,"guessBossList",{get:function(){return this.m_bossList.length<=0&&(this.m_bossList=StaticDataJson.parseStrToList("guess_mission_boss_list")),this.m_bossList},enumerable:!0,configurable:!0}),t.prototype.getSelectNum=function(t){return this.m_timesData[t]?this.m_timesData[t]:0},t.prototype.getBossIdx=function(t){var e=this.guessBossList.indexOf(t);return e},t.prototype.getLuckMaxCost=function(){return 0==this.m_maxCost&&(this.m_maxCost=Number(StaticDataJson.getData("guess_max_limit").data)),this.m_maxCost},t.prototype.isFirstEnterTips=function(){var t=PlayerManager.instance.getSetingMsg(GameSetConfig.k_guessKey);t||(PlayerManager.instance.setingMsg(GameSetConfig.k_guessKey,"1"),PopupModule.instance.showPop(PopupConfig.ID_LUCK_BOSS_FIRST_ENTER,null,!1))},t.prototype.s_mission_scene_boss_bet=function(t,e,i){var s=MessageProtocol.getClass(MessageType.m_mission_scene_boss_bet_tos);s.type=t,s.id=e,s.num=i,MessageProtocol.sendMessage(MessageType.m_mission_scene_boss_bet_tos,s)},t.prototype.s_mission_scene_boss_bet_reset=function(t){var e=MessageProtocol.getClass(MessageType.m_mission_scene_boss_bet_reset_tos);e.type=t,MessageProtocol.sendMessage(MessageType.m_mission_scene_boss_bet_reset_tos,e)},t.prototype.c_mission_notice_scene_boss_bet=function(e){this.p_guessData=e,Dispatch.dispatch(t.EVENT_GUESS_BOSS_UPDATE)},t.prototype.c_mission_notice_scene_boss_step=function(e){this.p_guessStep=e,SceneModule.instance.p_bossInfo&&(SceneModule.instance.p_bossInfo.state=e.step,SceneModule.instance.p_bossInfo.time=e.time),MissionUIModule.instance.showGuessInfo(),Dispatch.dispatch(t.EVENT_GUESS_BOSS_STATE_CHANGE),Dispatch.dispatch(t.EVENT_GUESS_BOSS_BTN_CHANGE)},t.prototype.c_mission_notice_scene_boss_result=function(t){this.p_resultData=t,UIModule.instance.hideUI(UIConfig.ID_BOSS_GUESS),0==this.p_resultData.result?PopupModule.instance.showPop(PopupConfig.ID_GUESS_LOSER):PopupModule.instance.showPop(PopupConfig.ID_GUESS_WIN)},t.prototype.c_mission_notice_scene_boss_dao_num_change=function(e){this.p_guessDao=e,Dispatch.dispatch(t.EVENT_GUESS_BOSS_DAO_NUM)},t.prototype.getGuessStep=function(){return this.p_guessStep},t.EVENT_GUESS_BOSS_MYCOST_CHANGE="EVENT_GUESS_BOSS_MYCOST_CHANGE",t.EVENT_GUESS_BOSS_TOTALCOST_CHANGE="EVENT_GUESS_BOSS_TOTALCOST_CHANGE",t.EVENT_GUESS_BOSS_PEOPLE_CHANGE="EVENT_GUESS_BOSS_PEOPLE_CHANGE",t.EVENT_GUESS_BOSS_TIME_CHANGE="EVENT_GUESS_BOSS_TIME_CHANGE",t.EVENT_GUESS_BOSS_DIE="EVENT_GUESS_BOSS_DIE",t.EVENT_GUESS_BOSS_RESULT="EVENT_GUESS_BOSS_RESULT",t.EVENT_GUESS_BOSS_DAO_NUM="EVENT_GUESS_BOSS_DAO_NUM",t.EVENT_GUESS_BOSS_UPDATE="EVENT_GUESS_BOSS_UPDATE",t.EVENT_GUESS_BOSS_NUMBER="EVENT_GUESS_BOSS_NUMBER",t.EVENT_GUESS_BOSS_STATE_CHANGE="EVENT_GUESS_BOSS_STATE_CHANGE",t.EVENT_GUESS_BOSS_BTN_CHANGE="EVENT_GUESS_BOSS_BTN_CHANGE",t.EVENT_GUESS_BOSS_CHIP="EVENT_GUESS_BOSS_CHIP",t}();__reflect(GuessManager.prototype,"GuessManager");var H5Manager=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.initData=function(){URIManager.p_h5Game=!0,this.m_sdkData=window.XiaoAQi_NativeSDK,this.startDownLoad(GameManager.instance.p_version+"."+GameManager.instance.p_version_v),this.m_sdkData.toAppH5Login=this.appH5Login.bind(this)},t.prototype.appH5Login=function(t){LoginManager.instance.loginGameCallBack(t)},t.prototype.loginGame=function(t){return this.m_sdkData.GameLogin(t)},t.prototype.logoutGame=function(){this.m_sdkData.Logout()},t.prototype.startDownLoad=function(t){this.m_sdkData.StartDownLoad(t)},t.prototype.trackEvent=function(t,e){void 0===e&&(e=""),this.m_sdkData.trackEvent(t,e)},t.prototype.getPlatformName=function(){return this.m_sdkData.GetPlatformName()},t}();__reflect(H5Manager.prototype,"H5Manager");var HeroManager=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){MessageManager.register(MessageType.m_hero_charge_hero_parts_toc,this.c_hero_charge_hero_parts,this),MessageManager.register(MessageType.m_hero_notice_hero_unlock_parts_toc,this.c_hero_notice_hero_unlock_parts,this),MessageManager.register(MessageType.m_hero_notice_unlock_hero_toc,this.c_hero_notice_unlock_hero,this),MessageManager.register(MessageType.m_hero_unlock_hero_toc,this.c_hero_unlock_hero,this),MessageManager.register(MessageType.m_hero_hero_up_star_toc,this.c_hero_hero_up_star,this)},t.prototype.initData=function(t){this.m_heroInfo=t,this.setRageSkill(),this.initRedNotice()},t.prototype.s_hero_unlock_hero=function(t){var e=MessageProtocol.getClass(MessageType.m_hero_unlock_hero_tos);e.id=t,MessageProtocol.sendMessage(MessageType.m_hero_unlock_hero_tos,e)},t.prototype.c_hero_unlock_hero=function(t){switch(t.result){case proto.m_hero_unlock_hero_toc.ENUM.success:FloatTipModule.instance.popTipLanguage("l_newRole_unlock_tips1");break;case proto.m_hero_unlock_hero_toc.ENUM.fail:FloatTipModule.instance.popTipLanguage("l_newRole_unlock_tips2");break;case proto.m_hero_unlock_hero_toc.ENUM.no_enough_prop:FloatTipModule.instance.popTipLanguage("l_newRole_unlock_tips3");break;case proto.m_hero_unlock_hero_toc.ENUM.already_have:FloatTipModule.instance.popTipLanguage("l_newRole_unlock_tips4")}},t.prototype.s_hero_hero_up_star=function(t){var e=MessageProtocol.getClass(MessageType.m_hero_hero_up_star_tos);e.id=t,MessageProtocol.sendMessage(MessageType.m_hero_hero_up_star_tos,e)},t.prototype.c_hero_hero_up_star=function(e){switch(e.result){case proto.m_hero_hero_up_star_toc.ENUM.success:FloatTipModule.instance.popTipLanguage("l_newRole_upstart_tips1");for(var i in this.m_heroInfo.hero_list)if(this.m_heroInfo.hero_list[i].id==e.id){this.m_heroInfo.hero_list[i].star=e.star;break}Dispatch.dispatch(t.EVENT_HERO_UPSTAR,e.id);break;case proto.m_hero_hero_up_star_toc.ENUM.fail:FloatTipModule.instance.popTipLanguage("l_newRole_upstart_tips2");break;case proto.m_hero_hero_up_star_toc.ENUM.no_enough_prop:FloatTipModule.instance.popTipLanguage("l_newRole_upstart_tips3");break;case proto.m_hero_hero_up_star_toc.ENUM.not_authority:FloatTipModule.instance.popTipLanguage("l_newRole_upstart_tips4");break;case proto.m_hero_hero_up_star_toc.ENUM.none:FloatTipModule.instance.popTipLanguage("l_newRole_upstart_tips5")}},t.prototype.s_hero_charge_hero_parts=function(t,e,i){var s=MessageProtocol.getClass(MessageType.m_hero_charge_hero_parts_tos);s.id=t,s.arms=e,s.ornaments=i,MessageProtocol.sendMessage(MessageType.m_hero_charge_hero_parts_tos,s)},t.prototype.c_hero_charge_hero_parts=function(e){switch(e.result){case proto.m_hero_charge_hero_parts_toc.ENUM.success:FloatTipModule.instance.popTipLanguage("l_newRole_wear_tips1"),this.m_heroInfo.id=e.id,this.m_heroInfo.arms=e.arms,this.m_heroInfo.ornaments=e.ornaments,this.setRageSkill(),Dispatch.dispatch(t.EVENT_HERO_CHANGE);break;case proto.m_hero_charge_hero_parts_toc.ENUM.fail:FloatTipModule.instance.popTipLanguage("l_newRole_wear_tips2");break;case proto.m_hero_charge_hero_parts_toc.ENUM.no_condition:FloatTipModule.instance.popTipLanguage("l_newRole_wear_tips3")}},t.prototype.c_hero_notice_hero_unlock_parts=function(e){null==this.m_heroInfo.list&&(this.m_heroInfo.list=[]),-1==this.m_heroInfo.list.indexOf(e.parts_id)&&this.m_heroInfo.list.push(e.parts_id),Dispatch.dispatch(t.EVENT_HERO_ADD_PARTS,e.parts_id)},t.prototype.c_hero_notice_unlock_hero=function(e){null==this.m_heroInfo.list&&(this.m_heroInfo.list=[]);for(var i=0;i<e.parts_id.length;i++)this.m_heroInfo.list.push(e.parts_id[i]);null==this.m_heroInfo.hero_list&&(this.m_heroInfo.hero_list=[]);var s=new proto.Hero;s.id=e.id,s.star=e.star,this.m_heroInfo.hero_list.push(s),Dispatch.dispatch(t.EVENT_HERO_ADD,e.id)},t.prototype.setRageSkill=function(){var t=HeroJson.getData(this.m_heroInfo.id);FightSkillManager.type_rage=t.hero_skill_list[0],FightSkillManager.p_rage_id=t.hero_skill_list[1],FightSkillManager.p_rage_time=t.hero_skill_list[2]},t.prototype.getHeroInfo=function(t){if(this.m_heroInfo.hero_list)for(var e in this.m_heroInfo.hero_list)if(this.m_heroInfo.hero_list[e].id==t)return this.m_heroInfo.hero_list[e];return null},t.prototype.getHasParts=function(t){return this.m_heroInfo.list&&this.m_heroInfo.list.indexOf(t)>-1?!0:!1},Object.defineProperty(t.prototype,"heroData",{get:function(){return this.m_heroInfo},enumerable:!0,configurable:!0}),t.prototype.getHeroList=function(t,e){void 0===e&&(e=0);for(var i=0,s=0,n=0,o=[],a=HeroJson.getHeroIdList(),r=0;r<a.length;r++){var _=this.getHeroInfo(a[r].hero_id);if(i=BagManager.instance.getNum(a[r].unlock_item_list[0]),1==t){if(_){var h=HeroStarJson.getData(_.id,_.star);s=h.item_list[1],n=i>=s?1:0,o.push({heroId:a[r].hero_id,star:_.star,step:a[r].quality,order:a[r].order,isRed:n})}}else _||(s=a[r].unlock_item_list[1],n=i>=s?1:0,o.push({heroId:a[r].hero_id,star:0,step:a[r].quality,order:a[r].order,isRed:n}))}switch(e){case 0:1==t?ArrayUtils.setSortArr(o,["order"],[0]):ArrayUtils.setSortArr(o,["isRed","order"],[1,0]);break;case 1:ArrayUtils.setSortArr(o,["star","order"],[1,0]);break;case 2:ArrayUtils.setSortArr(o,["step","order"],[1,0])}return o},t.prototype.getWeapByHeaoId=function(t){var e=this.getHeroInfo(t),i=HeroJson.getData(t);if(e)for(var s=0;s<this.heroData.list.length;s++){var n=this.heroData.list[s];if(i.weapon_part_list.indexOf(n)>-1)return n}return 0},t.prototype.getHeroIndex=function(t,e){for(var i=0;i<t.length;i++)if(t[i].heroId==e)return i;return-1},t.prototype.initRedNotice=function(){var t=HeroJson.getHeroIdList();for(var e in t){var i=t[e];Dispatch.register(BagManager.EVENT_BAG_UPGRADE+i.unlock_item_list[0],this.setRedNotice,this)}this.setRedNotice()},t.prototype.unlockItemChange=function(t){},t.prototype.setRedNotice=function(){var t=!1,e=HeroJson.getHeroIdList();for(var i in e){var s=e[i],n=this.getHeroInfo(s.hero_id),o=0,a=BagManager.instance.getNum(s.unlock_item_list[0]);if(n){var r=HeroStarJson.getData(n.id,n.star);o=r.item_list[1]}else o=s.unlock_item_list[1];if(a>=o){t=!0;break}}RedNoticeManager.instance.dispatchRed(RedNoticeConfig.RED_HERO,t)},t.EVENT_HERO_CHANGE="EVENT_HERO_CHANGE",t.EVENT_HERO_ADD="EVENT_HERO_ADD",t.EVENT_HERO_ADD_PARTS="EVENT_HERO_ADD_PARTS",t.EVENT_HERO_UPSTAR="EVENT_HERO_UPSTART",t
}();__reflect(HeroManager.prototype,"HeroManager");var InvestManager=function(){function t(){this.p_invest={}}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){MessageManager.register(MessageType.m_invest_get_invest_award_toc,this.c_invest_get_invest_award,this),MessageManager.register(MessageType.m_invest_notice_invest_data_update_toc,this.m_invest_get_invest_award_toc,this)},t.prototype.initData=function(t){this.p_invest={};for(var e in t){var i=t[e].id;this.p_invest[i]=t[e]}this.p_invest_data=t,this.setFuncRed()},t.prototype.s_invest_get_invest_award=function(t){var e=MessageProtocol.getClass(MessageType.m_invest_get_invest_award_tos);e.id=t,MessageProtocol.sendMessage(MessageType.m_invest_get_invest_award_tos,e)},t.prototype.c_invest_get_invest_award=function(e){switch(e.result){case proto.m_invest_get_invest_award_toc.ENUM.success:var i=this.getInvestData(e.id),s=TouZiJiHuaJson.getData(e.id);i&&(i.state=2),s&&RewardModule.instance.receiveByList(s.reward_list),SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_4004),Dispatch.dispatch(t.INVEST_DATA_UPDATE+e.id),this.setFuncRed();break;case proto.m_invest_get_invest_award_toc.ENUM.fail:FloatTipModule.instance.popTipLanguage("l_invest_tip_1");break;case proto.m_invest_get_invest_award_toc.ENUM.node:FloatTipModule.instance.popTipLanguage("l_invest_tip_2");break;case proto.m_invest_get_invest_award_toc.ENUM.not_authority:FloatTipModule.instance.popTipLanguage("l_invest_tip_3");break;case proto.m_invest_get_invest_award_toc.ENUM.already_get:FloatTipModule.instance.popTipLanguage("l_invest_tip_4")}},t.prototype.m_invest_get_invest_award_toc=function(e){e.invest_data;var i=e.invest_data.id;this.p_invest[i]=e.invest_data,Dispatch.dispatch(t.INVEST_DATA_UPDATE+e.invest_data.id),this.setFuncRed()},t.prototype.getInvestData=function(t){return this.p_invest[t]},t.prototype.setFuncRed=function(){var t=!1;for(var e in this.p_invest){var i=this.p_invest[e];if(1==i.state){t=!0;break}}RedNoticeManager.instance.dispatchRed(RedNoticeConfig.RED_INVEST,t)},t.INVEST_DATA_UPDATE="INVEST_DATA_UPDATE",t}();__reflect(InvestManager.prototype,"InvestManager");var LoginManager=function(t){function e(){var e=t.call(this)||this;return e.p_isLogin=!1,e.m_eventList=[],e.p_serverListData=[],e.p_player_id=0,e.p_is_inner=0,e.p_friend_code="",e.p_is_gm=!1,e.p_gm_account="",e.p_isReconnect=!1,e.p_isEverEnterGame=!1,e.m_isShowConnectPanel=!1,e.p_is_connect_socket=!1,e.p_is_login_out=!1,e.p_random_man_name=["1","2"],e.p_random_women_name=["1","2"],e.p_isOverRenZhen=!1,e.m_initBool=!1,e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.m_instance||(this.m_instance=new e),this.m_instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){MessageManager.register(MessageType.m_login_login_toc,this.m_login_toc,this),MessageManager.register(MessageType.m_login_notice_logout_toc,this.m_notice_logout_toc,this),Dispatch.register(GameSocket.EVENT_ON_SOCKET_STATE_CHANGE,this.onSocketChange,this)},e.prototype.onSocketChange=function(t){switch(ShiShiRoomManager.instance.p_roomId=0,t){case GameSocket.STATE_OPEN:0==this.p_isLogin&&(this.p_isLogin=!0,this.m_login_tos());break;case GameSocket.STATE_RECONNECTION:this.p_isLogin=!1;break;case GameSocket.STATE_CLOSE:this.p_isLogin=!1,0==this.p_isEverEnterGame?FloatTipModule.instance.popTipLanguage("l_login_tips_1"):this.p_isReconnect&&0==this.m_isShowConnectPanel&&(this.m_isShowConnectPanel=!0,this.p_is_login_out||(GuideModule.instance.getIsGuiding()?PopupModule.instance.showTishiSingle(LanguageJson.getText("l_login_tips_8"),this.reconnectOK.bind(this),null,"YES",8):PopupModule.instance.showTishiSingle(LanguageJson.getText("l_login_tips_8"),this.reconnectOK.bind(this))))}t!=GameSocket.STATE_OPEN&&(this.p_is_connect_socket=!1)},e.prototype.reconnectOK=function(){0!=this.p_isLogin||1!=this.p_isEverEnterGame||this.p_is_login_out||(PopupModule.instance.hidePopAll(),this.p_isReconnect=!1,this.m_isShowConnectPanel=!1,GameSocket.instance.reconnection())},e.prototype.m_notice_logout_toc=function(t){switch(t.reason){case proto.m_login_notice_logout_toc.ENUM.login_in_other:var i=LanguageJson.getText("l_login_tips_2");this.p_is_login_out=!0,e.instance.p_isReconnect=!0,PopupModule.instance.showTishiSingle(i,this.loginOutPopup.bind(this));break;case proto.m_login_notice_logout_toc.ENUM.system_maintenance:FloatTipModule.instance.popTipLanguage("l_login_tips_3");break;case proto.m_login_notice_logout_toc.ENUM.cheat:FloatTipModule.instance.popTipLanguage("l_login_tips_4");break;case proto.m_login_notice_logout_toc.ENUM.gm_kill:FloatTipModule.instance.popTipLanguage("l_login_tips_5");break;case proto.m_login_notice_logout_toc.ENUM.disable_login:FloatTipModule.instance.popTipLanguage("l_login_tips_6");break;case proto.m_login_notice_logout_toc.ENUM.fatigue:FloatTipModule.instance.popTipLanguage("l_login_tips_7")}},e.prototype.loginOutPopup=function(){this.loginOutBack(!0)},e.prototype.loginOutBack=function(t){void 0===t&&(t=!1),t&&(ServerListManager.instance.p_recentServerLists=[],PlatformManager.instance.p_platformData=null),URIManager.p_h5Game?H5Manager.instance.logoutGame():GameManager.instance.callToNative("toExitOut"),window.location.reload(!0)},e.prototype.loginGameCallBack=function(t){PlatformManager.instance.p_platformData=JSON.parse(t),URIManager.p_imeiKey=PlatformManager.instance.p_platformData.imei?PlatformManager.instance.p_platformData.imei:"",PlatformManager.instance.p_platformData.channel==URIManager.p_youke&&(URIManager.p_isGuest=!0,PlatformManager.instance.p_platformData.acc_id=PlatformManager.instance.p_platformData.imei),PlatformManager.instance.p_platformData&&PlatformManager.instance.p_platformData.app_name&&(URIManager.p_packName=PlatformManager.instance.p_platformData.app_name),PlatformManager.instance.p_platformData.apps&&(PlatformManager.instance.p_platformData.facebook_apps_id=encodeURI(PlatformManager.instance.p_platformData.apps)),ServerListManager.instance.requestRecentListData()},e.prototype.m_heart_beat_tos=function(){var t=MessageProtocol.getClass(MessageType.m_login_heart_beat_tos);MessageProtocol.sendMessage(MessageType.m_login_heart_beat_tos,t),TweenLite.delayedCall(15,this.m_heart_beat_tos.bind(this)),TweenLite.killDelayedCallsTo(this.m_heart_beat_tos)},e.prototype.m_enter_game_tos=function(){var t=MessageProtocol.getClass(MessageType.m_login_enter_game_tos);MessageProtocol.sendMessage(MessageType.m_login_enter_game_tos,t)},e.prototype.setDefaultServerParams=function(){var t=[];ServerListManager.instance.p_recentServerLists&&(t=t.concat(ServerListManager.instance.p_recentServerLists)),t=t.concat(ServerListManager.instance.p_allServerList),this.getServerList(t)},e.prototype.getServerList=function(t){this.p_serverListData=t;var e=this.p_serverListData[0].ip,i=this.p_serverListData[0].port;this.p_server_id=this.p_serverListData[0].id,this.p_desc=this.p_serverListData[0].desc,this.p_state=this.p_serverListData[0].state,URIManager.analyze("NULL",{game_host:e,game_port:Number(i)})},e.prototype.m_login_tos=function(){egret.localStorage.setItem(e.cookie_acc_id,this.p_acc_id),egret.localStorage.setItem(e.cookie_server_id,""+this.p_server_id),egret.localStorage.setItem(e.cookie_ip,URIManager.game_host),egret.localStorage.setItem(e.cookie_port,String(URIManager.game_port));var t=MessageProtocol.getClass(MessageType.m_login_login_tos);t.server_id=e.instance.p_server_id,t.acc_id=e.instance.p_acc_id,t.ticket=e.instance.p_password,t.time=e.instance.p_time,t.gm_account=e.instance.p_gm_account,t.entry=0,t.platform_id=URIManager.platformId,t.is_gm_login=0,t.qua=URIManager.p_imeiKey,t.pf=URIManager.p_fb,t.via=PlatformManager.instance.os,PlatformManager.instance.p_platformData&&PlatformManager.instance.p_platformData.channel&&(t.pf=PlatformManager.instance.p_platformData.channel),MessageProtocol.sendMessage(MessageType.m_login_login_tos,t)},e.prototype.m_login_toc=function(t){switch(this.p_random_man_name=t.random_man_name,this.p_random_women_name=t.random_women_name,this.p_player_id=t.player_id,t.result){case proto.m_login_login_toc.ENUM.success:if(this.m_initBool)return this.m_heart_beat_tos(),void this.m_enter_game_tos();this.m_initBool=!0,Dispatch.register(GamePreLoadManager.EVENT_MAINGAME_COMPLETE,this.gotoGameSure,this),GamePreLoadManager.instance.preloadGame(),PlayerManager.instance.sureADJustTo(),this.m_heart_beat_tos();break;case proto.m_login_login_toc.ENUM.no_role:Dispatch.register(GamePreLoadManager.EVENT_CREATE_COMPLETE,this.createRoleOpen,this),GamePreLoadManager.instance.preloadCreate(),this.m_heart_beat_tos();break;case proto.m_login_login_toc.ENUM.disable_login:PopupModule.instance.showTishiSingle(LanguageJson.getText("l_login_mTips_1"));break;case proto.m_login_login_toc.ENUM.verify_fail:PopupModule.instance.showTishiSingle(LanguageJson.getText("l_login_mTips_2"));break;case proto.m_login_login_toc.ENUM.token_expire:PopupModule.instance.showTishiSingle(LanguageJson.getText("l_login_mTips_3"));break;case proto.m_login_login_toc.ENUM.acc_no_exists:PopupModule.instance.showTishiSingle(LanguageJson.getText("l_login_mTips_4"));break;case proto.m_login_login_toc.ENUM.unknow:PopupModule.instance.showTishiSingle(LanguageJson.getText("l_createRole_tips_4"))}t.result!=proto.m_login_login_toc.ENUM.success&&t.result!=proto.m_login_login_toc.ENUM.no_role&&(this.p_isLogin=!1)},e.prototype.createRoleOpen=function(){UIModule.instance.removeLoginUI(),UIModule.instance.createRoleUI()},e.prototype.gotoGameSure=function(){LoadingUIModule.instance.hide(this),Dispatch.remove(GamePreLoadManager.EVENT_MAINGAME_COMPLETE,this.gotoGameSure,this),this.loginComplete()},e.prototype.loginComplete=function(){this.m_initBool=!0,JsonUtil.startJson(),GameManager.instance.initGame(),PlatformManager.instance.reportLogin(),UIModule.instance.removeLoginUI(),UIModule.instance.initShow(),this.m_enter_game_tos(),this.p_isReconnect=!1,this.p_isEverEnterGame=!0,RES.destroyRes("index_res/index_loading_line_bg.png"),RES.destroyRes("index_res/index_loading_line.png")},e.login_para_key="login_para_key",e.cookie_acc_id="acc_id",e.cookie_server_id="server_id",e.cookie_ip="ip",e.cookie_port="port",e}(egret.HashObject);__reflect(LoginManager.prototype,"LoginManager");var ServerListManager=function(t){function e(){var e=t.call(this)||this;return e.p_recentServerLists=[],e.p_allServerList=[],e.p_server_list_url_recent="",e.p_server_list_url_all="",e.p_server_list_group_num=0,e.p_isOpenShare=!0,e.p_isWhitePlayer=!1,e.p_noticCacheType="CACHETYPE_NOTICE",e.p_needNotic=!1,e.p_is_has_role=!0,e.p_is_request=!1,e.p_is_show_invited=0,e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.m_instance||(this.m_instance=new e),this.m_instance},enumerable:!0,configurable:!0}),e.prototype.requestRecentListData=function(){if(this.p_recentServerLists&&this.p_recentServerLists.length>0)return void Dispatch.dispatch(e.EVENT_SERVER_LIST);var t=new egret.HttpRequest;t.responseType=egret.HttpResponseType.TEXT;var i={};i=URIManager.is_platform||URIManager.p_h5Game?PlatformManager.instance.p_platformData:{acc_id:LoginManager.instance.p_acc_id,password:LoginManager.instance.p_password},i.version=GameManager.instance.p_version+"."+GameManager.instance.p_version_v,i.app_id=URIManager.p_packName;var s=URIManager.getPlatformUrl(this.p_server_list_url_recent,i);t.open(s,egret.HttpMethod.GET),t.send(),t.addEventListener(egret.Event.COMPLETE,this.onRecentGetComplete,this),t.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onRecentGetIOError,this),t.addEventListener(egret.ProgressEvent.PROGRESS,this.onRecentGetProgress,this)},e.prototype.onRecentGetComplete=function(t){var i=t.currentTarget,s=JSON.parse(i.response);if(s.errcode){if(40163!=s.errcode){var n=LanguageJson.getText("l_serverList_tips_1");FloatTipModule.instance.popTip(n+s.errcode)}}else{if(this.p_recentServerLists=s.recent,s.acc_id&&(LoginManager.instance.p_acc_id=s.acc_id,PlatformManager.instance.p_platformData.acc_id=s.acc_id),null!=s.time&&(LoginManager.instance.p_time=s.time),s.hasOwnProperty("isWhitePlayer")&&(this.p_isWhitePlayer=Boolean(s.isWhitePlayer)),s.hasOwnProperty("isOpenShare")&&(this.p_isOpenShare=Boolean(s.isOpenShare)),s.hasOwnProperty("disposeSize")&&(TexturePool.instance.disposeSize=Number(s.disposeSize)),s.hasOwnProperty("login_ticket")&&(LoginManager.instance.p_password=s.login_ticket),2==s.acc_type&&(LoginManager.instance.p_is_gm=!0),s.notice&&0!=s.has_role){var o=s.notice,a=egret.localStorage.getItem(this.p_noticCacheType);""==o||null!=a&&a==o||(egret.localStorage.setItem(this.p_noticCacheType,o),this.p_needNotic=!0)}s.hasOwnProperty("is_show_invited")&&(this.p_is_show_invited=Number(s.is_show_invited)),s.hasOwnProperty("isNativePay")&&(URIManager.is_native_pay=Number(s.isNativePay)),s.hasOwnProperty("isChargeOpen")&&(URIManager.is_open_charg=Number(s.isChargeOpen)),s.hasOwnProperty("isReviewing")&&(URIManager.is_reviewing=Number(s.isReviewing)),s.hasOwnProperty("has_role")&&(this.p_is_has_role=Boolean(s.has_role)),LoginManager.instance.setDefaultServerParams(),Dispatch.dispatch(e.EVENT_SERVER_LIST)}},e.prototype.onRecentGetIOError=function(t){FloatTipModule.instance.popTipLanguage("l_serverList_tips_1")},e.prototype.onRecentGetProgress=function(t){},e.prototype.requestAllListData=function(){var t=new egret.HttpRequest;t.responseType=egret.HttpResponseType.TEXT;var e={};e=URIManager.is_platform||URIManager.p_h5Game?PlatformManager.instance.p_platformData:{acc_id:LoginManager.instance.p_acc_id};var i=URIManager.getPlatformUrl(this.p_server_list_url_all,e);t.open(i,egret.HttpMethod.GET),t.send(),t.addEventListener(egret.Event.COMPLETE,this.onAllGetComplete,this),t.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onAllGetIOError,this),t.addEventListener(egret.ProgressEvent.PROGRESS,this.onAllGetProgress,this)},e.prototype.onAllGetComplete=function(t){function i(t,e){var i=Number(t.id),s=Number(e.id);return i-s}var s=t.currentTarget;this.p_allServerList=JSON.parse(s.response),this.p_allServerList.sort(i),Dispatch.dispatch(e.EVENT_SERVER_LIST_ALL)},e.prototype.onAllGetIOError=function(t){},e.prototype.onAllGetProgress=function(t){},e.EVENT_SERVER_LIST_ALL="EVENT_SERVER_LIST_ALL",e.EVENT_SERVER_LIST="EVENT_SERVER_LIST",e.EVENT_SERVER_SELECT="EVENT_SERVER_SELECT",e.EVENT_LOGIN_KEFU="EVENT_LOGIN_KEFU",e.EVENT_LOGIN_SET_INFO="EVENT_LOGIN_SET_INFO",e}(egret.HashObject);__reflect(ServerListManager.prototype,"ServerListManager");var LuckyDrawManager=function(t){function e(){var e=t.call(this)||this;return e.p_statusArr=[],e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.m_instance||(this.m_instance=new e),this.m_instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){MessageManager.register(MessageType.m_seize_treasure_currency_seize_treasure_type_toc,this.c_seize_treasure_currency_seize_treasure_type,this),MessageManager.register(MessageType.m_seize_treasure_get_treasure_toc,this.c_seize_treasure_get_treasure,this),MessageManager.register(MessageType.m_seize_treasure_get_extra_award_toc,this.c_seize_treasure_get_extra_award,this),MessageManager.register(MessageType.m_seize_treasure_get_extra_award_status_toc,this.c_seize_treasure_get_extra_award_status,this)},e.prototype.initData=function(t,e,i){this.p_typeId=t,this.p_times=e,this.p_luckyValue=i,this.s_seize_treasure_get_extra_award_status()},e.prototype.s_seize_treasure_get_treasure=function(t){var e=MessageProtocol.getClass(MessageType.m_seize_treasure_get_treasure_tos);e.type=t,MessageProtocol.sendMessage(MessageType.m_seize_treasure_get_treasure_tos,e)},e.prototype.c_seize_treasure_get_treasure=function(t){switch(t.result){case proto.m_seize_treasure_get_treasure_toc.ENUM.success:Dispatch.dispatch(e.EVENT_TREASURE_SEIZE,t.prop_list,t.times,t.value),this.p_times=t.times,this.p_luckyValue=t.value;break;case proto.m_seize_treasure_get_treasure_toc.ENUM.no_enough_prop:FloatTipModule.instance.popTip(LanguageJson.getText("l_treasure_hunt_tip"));break;case proto.m_seize_treasure_get_treasure_toc.ENUM.invalid_platform:FloatTipModule.instance.popTip(LanguageJson.getText("l_treasure_hunt_tip1"));break;case proto.m_seize_treasure_get_treasure_toc.ENUM.invalid_seize_treasure_data:FloatTipModule.instance.popTip(LanguageJson.getText("l_treasure_hunt_tip2"));break;case proto.m_seize_treasure_get_treasure_toc.ENUM.unknown:FloatTipModule.instance.popTip(LanguageJson.getText("l_treasure_hunt_tip3"))}},e.prototype.c_seize_treasure_currency_seize_treasure_type=function(t){this.p_typeId=t.type_id,Dispatch.dispatch(e.EVENT_TREASURE_UPDATA)},e.prototype.s_seize_treasure_get_extra_award=function(t){var e=MessageProtocol.getClass(MessageType.m_seize_treasure_get_extra_award_tos);e.idx=t,MessageProtocol.sendMessage(MessageType.m_seize_treasure_get_extra_award_tos,e)},e.prototype.c_seize_treasure_get_extra_award=function(t){switch(t.result){case proto.m_seize_treasure_get_extra_award_toc.ENUM.success:var e=t.prop_list.reverse();RewardModule.instance.receiveByProp(e),this.s_seize_treasure_get_extra_award_status();break;case proto.m_seize_treasure_get_extra_award_toc.ENUM.no_enough_seize_times:FloatTipModule.instance.popTip(LanguageJson.getText("l_treasure_extra_tip"));break;case proto.m_seize_treasure_get_extra_award_toc.ENUM.no_achievement_list:FloatTipModule.instance.popTip(LanguageJson.getText("l_treasure_extra_tip1"));break;case proto.m_seize_treasure_get_extra_award_toc.ENUM.no_achievement_wait_4_get:FloatTipModule.instance.popTip(LanguageJson.getText("l_treasure_extra_tip2"));break;case proto.m_seize_treasure_get_extra_award_toc.ENUM.unknown:FloatTipModule.instance.popTip(LanguageJson.getText("l_treasure_extra_tip3"))}},e.prototype.s_seize_treasure_get_extra_award_status=function(){var t=MessageProtocol.getClass(MessageType.m_seize_treasure_get_extra_award_status_tos);MessageProtocol.sendMessage(MessageType.m_seize_treasure_get_extra_award_status_tos,t)},e.prototype.c_seize_treasure_get_extra_award_status=function(t){switch(t.result){case proto.m_seize_treasure_get_extra_award_status_toc.ENUM.success:var i=t.status.split(",");this.p_statusArr=i,this.setRedNotice(),Dispatch.dispatch(e.EVENT_EXTRA_AWARD_STATUS,i);break;case proto.m_seize_treasure_get_extra_award_status_toc.ENUM.failure:FloatTipModule.instance.popTip(LanguageJson.getText("l_treasure_extra_tip4"));break;case proto.m_seize_treasure_get_extra_award_status_toc.ENUM.unknown:FloatTipModule.instance.popTip(LanguageJson.getText("l_treasure_extra_tip3"))}},Object.defineProperty(e.prototype,"isExtraGet",{get:function(){return-1!=this.p_statusArr.indexOf("2")?!0:!1},enumerable:!0,configurable:!0}),e.prototype.setRedNotice=function(){RedNoticeManager.instance.dispatchRed(RedNoticeConfig.RED_LUCKY_DRAW,this.isExtraGet)},e.EVENT_TREASURE_UPDATA="EVENT_TREASURE_UPDATA",e.EVENT_TREASURE_SEIZE="EVENT_TREASURE_SEIZE",e.EVENT_EXTRA_AWARD_STATUS="EVENT_TREASURE_TIMES_SET",e.EVENT_SEIZING_STATUS="EVENT_SEIZING_STATUS",e}(egret.HashObject);__reflect(LuckyDrawManager.prototype,"LuckyDrawManager");var MailManager=function(){function t(){this.p_isInitMailSimple=!1,this.p_mailRead=!1,this.m_mailList={},this.m_mailInfoList={},this.m_mailInitOpen=[],this.p_selectID=0}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){MessageManager.register(MessageType.m_mail_get_mail_info_toc,this.setMailList,this),MessageManager.register(MessageType.m_mail_read_mail_toc,this.setReadMail,this),MessageManager.register(MessageType.m_mail_get_item_mail_toc,this.setItemMail,this),MessageManager.register(MessageType.m_mail_delete_mail_toc,this.setDeleteMail,this),MessageManager.register(MessageType.m_mail_add_mail_toc,this.setAddMail,this),MessageManager.register(MessageType.m_mail_remove_mail_toc,this.setRemoveMail,this)},t.prototype.initData=function(t){this.m_mailInitOpen=t,this.setRedMail()},t.prototype.requestMailList=function(){var t=MessageProtocol.getClass(MessageType.m_mail_get_mail_info_tos);MessageProtocol.sendMessage(MessageType.m_mail_get_mail_info_tos,t)},t.prototype.setMailList=function(e){this.p_isInitMailSimple=!0;for(var i=0;i<e.mail_simple_info.length;i++)this.m_mailList[e.mail_simple_info[i].mail_real_id]=e.mail_simple_info[i];this.setRedMail(),Dispatch.dispatch(t.MAIL_LIST_INIT)},t.prototype.setAddMail=function(e){for(var i=0;i<e.mail_simple_info.length;i++){var s=e.mail_simple_info[i].mail_real_id;this.m_mailList[s]=e.mail_simple_info[i],-1==this.m_mailInitOpen.indexOf(s)&&this.m_mailInitOpen.push(s)}this.setRedMail(),Dispatch.dispatch(t.MAIL_LIST_INIT)},t.prototype.setRemoveMail=function(e){for(var i=0;i<e.mail_real_id.length;i++){this.m_mailInfoList[e.mail_real_id[i]]&&delete this.m_mailInfoList[e.mail_real_id[i]],this.m_mailList[e.mail_real_id[i]]&&delete this.m_mailList[e.mail_real_id[i]];var s=this.m_mailInitOpen.indexOf(e.mail_real_id[i]);s>-1&&this.m_mailInitOpen.splice(s,1)}this.setRedMail(),Dispatch.dispatch(t.MAIL_LIST_INIT)},t.prototype.requestReadMail=function(e){if(this.m_mailInfoList[e])0==this.m_mailList[e].state&&(this.m_mailList[e].state=1),Dispatch.dispatch(t.MAIL_OPEN_DETAIL,this.m_mailInfoList[e]),this.p_selectID=e,Dispatch.dispatch(t.MAIL_SELECT_STATE),this.setRedMail();else{var i=MessageProtocol.getClass(MessageType.m_mail_read_mail_tos);i.mail_real_id=e,MessageProtocol.sendMessage(MessageType.m_mail_read_mail_tos,i)}},t.prototype.setReadMail=function(e){var i=!1;switch(e.result){case proto.m_mail_read_mail_toc.ENUM.success:this.m_mailInfoList[e.mail_info.mail_real_id]&&(this.m_mailInfoList[e.mail_info.mail_real_id]=e.mail_info),this.m_mailList[e.mail_info.mail_real_id]?(this.m_mailList[e.mail_info.mail_real_id].state=e.mail_info.state,this.setRedMail(),this.p_selectID=e.mail_info.mail_real_id,i=!0):this.p_selectID=0,Dispatch.dispatch(t.MAIL_LIST_INIT),Dispatch.dispatch(t.MAIL_OPEN_DETAIL,e.mail_info,i);break;case proto.m_mail_read_mail_toc.ENUM.fail:FloatTipModule.instance.popTipLanguage("l_mail_popTips_1")}},t.prototype.requestItemMail=function(t){if(void 0===t&&(t=0),0!=t&&this.m_mailInfoList[t]&&2==this.m_mailInfoList[t].state)return void FloatTipModule.instance.popTipLanguage("l_mail_popTips_2");var e=MessageProtocol.getClass(MessageType.m_mail_get_item_mail_tos);e.mail_real_id=t,MessageProtocol.sendMessage(MessageType.m_mail_get_item_mail_tos,e)},t.prototype.setItemMail=function(t){switch(t.result){case proto.m_mail_get_item_mail_toc.ENUM.success:break;case proto.m_mail_get_item_mail_toc.ENUM.none:PopupModule.instance.showTishi(LanguageJson.getText("l_game_tips_14"));break;case proto.m_mail_get_item_mail_toc.ENUM.fail:FloatTipModule.instance.popTipLanguage("l_mail_popTips_3");break;case proto.m_mail_get_item_mail_toc.ENUM.old_item_time:FloatTipModule.instance.popTipLanguage("l_mail_popTips_4");break;case proto.m_mail_get_item_mail_toc.ENUM.not_authority:FloatTipModule.instance.popTipLanguage("l_mail_popTips_5")}t.mail_real_id&&t.mail_real_id.length>0&&this.setItemMailSuccess(t.mail_real_id)},t.prototype.setItemMailSuccess=function(e){for(var i=0;i<e.length;i++)this.m_mailInfoList[e[i]]&&(this.m_mailInfoList[e[i]].state=2),this.m_mailList[e[i]]&&(this.m_mailList[e[i]].state=2);this.setRedMail(),Dispatch.dispatch(t.MAIL_ITEM_REVEICE,e),Dispatch.dispatch(t.MAIL_LIST_INIT)},t.prototype.requestDeleteMail=function(t){if(void 0===t&&(t=0),0==t||this.m_mailList[t]){var e=MessageProtocol.getClass(MessageType.m_mail_delete_mail_tos);e.mail_real_id=t,MessageProtocol.sendMessage(MessageType.m_mail_delete_mail_tos,e)}},t.prototype.setDeleteMail=function(t){switch(t.result){case proto.m_mail_delete_mail_toc.ENUM.success:this.setDeleteMailSuccess(t.mail_real_id);break;case proto.m_mail_delete_mail_toc.ENUM.fail:FloatTipModule.instance.popTipLanguage("l_mail_delete_tips_3");break;case proto.m_mail_delete_mail_toc.ENUM.none:FloatTipModule.instance.popTipLanguage("l_mail_delete_tips_4")}},t.prototype.setDeleteMailSuccess=function(e){for(var i=0;i<e.length;i++)this.m_mailInfoList[e[i]]&&delete this.m_mailInfoList[e[i]],this.m_mailList[e[i]]&&delete this.m_mailList[e[i]];this.setRedMail(),Dispatch.dispatch(t.MAIL_LIST_INIT,!0)},t.prototype.getMailSimple=function(t){return this.m_mailList[t]},t.prototype.getMailInfo=function(t){return this.m_mailInfoList[t]},t.prototype.getMailSimpleList=function(){var t=[];for(var e in this.m_mailList)t.push(this.m_mailList[e]);return t.length>1&&ArrayUtils.setSortArr(t,["state","is_attach","create_time"],[0,1,1]),t},t.prototype.setRedMail=function(){if(this.p_mailRead=!1,this.p_isInitMailSimple)for(var t in this.m_mailList){var e=this.m_mailList[t];if(0==e.state){this.p_mailRead=!0;break}if(1==e.state&&1==e.is_attach){this.p_mailRead=!0;break}}else this.m_mailInitOpen&&this.m_mailInitOpen.length>0&&(this.p_mailRead=!0);RedNoticeManager.instance.dispatchRed(RedNoticeConfig.RED_MAIL_INFO,this.p_mailRead)},t.MAIL_LIST_INIT="MAIL_LIST_INIT",t.MAIL_ITEM_REVEICE="MAIL_ITEM_REVEICE",t.MAIL_OPEN_DETAIL="MAIL_OPEN_DETAIL",t.MAIL_SELECT_STATE="MAIL_SELECT_STATE",t}();__reflect(MailManager.prototype,"MailManager");var ManyPeopleBossManager=function(){function t(){this.p_roomId=0,this.p_is_auto=1,this.p_owner_mana=-1,this.m_room_player_data={}}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){MessageManager.register(MessageType.m_many_people_boss_get_room_list_toc,this.c_many_people_boss_get_room_list,this),MessageManager.register(MessageType.m_many_people_boss_join_room_toc,this.c_many_people_boss_join_room,this),MessageManager.register(MessageType.m_many_people_boss_create_room_toc,this.c_many_people_boss_create_room,this),MessageManager.register(MessageType.m_many_people_boss_start_toc,this.c_many_people_boss_start,this),MessageManager.register(MessageType.m_many_people_boss_participate_in_toc,this.c_many_people_boss_participate_in,this),MessageManager.register(MessageType.m_many_people_boss_set_is_all_ready_start_toc,this.c_many_people_boss_set_is_all_ready_start,this),MessageManager.register(MessageType.m_many_people_boss_ready_toc,this.c_many_people_boss_ready,this),MessageManager.register(MessageType.m_many_people_boss_notice_leave_room_toc,this.c_many_people_boss_notice_leave_room,this),MessageManager.register(MessageType.m_many_people_boss_notice_player_join_toc,this.c_many_people_boss_notice_player_join,this),MessageManager.register(MessageType.m_many_people_boss_notice_player_leave_toc,this.c_many_people_boss_notice_player_leave,this),MessageManager.register(MessageType.m_many_people_boss_notice_player_ready_toc,this.c_many_people_boss_notice_player_ready,this),MessageManager.register(MessageType.m_many_people_boss_notice_player_fight_result_toc,this.c_many_people_boss_notice_player_fight_result,this),MessageManager.register(MessageType.m_many_people_boss_notice_player_fight_start_toc,this.c_many_people_boss_notice_player_fight_start,this),MessageManager.register(MessageType.m_many_people_boss_notice_owner_fight_result_toc,this.c_many_people_boss_notice_owner_fight_result,this)},t.prototype.s_many_people_boss_get_room_list=function(t){var e=MessageProtocol.getClass(MessageType.m_many_people_boss_get_room_list_tos);e.boss_id=t,MessageProtocol.sendMessage(MessageType.m_many_people_boss_get_room_list_tos,e)},t.prototype.c_many_people_boss_get_room_list=function(e){Dispatch.dispatch(t.EVENT_MULTI_GET_ROOM,e.boss_id,e.room_data_list)},t.prototype.s_many_people_boss_join_room=function(t,e,i){var s=MessageProtocol.getClass(MessageType.m_many_people_boss_join_room_tos);s.room_id=t,s.password=e,s.invitation_code=i,MessageProtocol.sendMessage(MessageType.m_many_people_boss_join_room_tos,s)},t.prototype.c_many_people_boss_join_room=function(e){switch(e.result){case proto.m_many_people_boss_join_room_toc.ENUM.success:FloatTipModule.instance.popTipLanguage("l_multi_popTip_10"),this.p_roomId=e.room_details_data.room_data.room_id,this.p_roomInfo=e.room_details_data,this.setRoomDetailInfo(),Dispatch.dispatch(t.EVENT_MULTI_JOIN_ROOM);break;case proto.m_many_people_boss_join_room_toc.ENUM.fail:FloatTipModule.instance.popTipLanguage("l_multi_popTip_11");break;case proto.m_many_people_boss_join_room_toc.ENUM.not_enough_mana:FloatTipModule.instance.popTipLanguage("l_game_tips_2");break;case proto.m_many_people_boss_join_room_toc.ENUM.not_authority:FloatTipModule.instance.popTipLanguage("l_multi_popTip_12");break;case proto.m_many_people_boss_join_room_toc.ENUM.no_condition:FloatTipModule.instance.popTipLanguage("l_game_tips_15");break;case proto.m_many_people_boss_join_room_toc.ENUM.already_join_room:FloatTipModule.instance.popTipLanguage("l_multi_popTip_3");break;case proto.m_many_people_boss_join_room_toc.ENUM.error_password:FloatTipModule.instance.popTipLanguage("l_multi_popTip_13");break;case proto.m_many_people_boss_join_room_toc.ENUM.none:FloatTipModule.instance.popTipLanguage("l_multi_popTip_14");break;case proto.m_many_people_boss_join_room_toc.ENUM.time_limit:FloatTipModule.instance.popTipLanguage("l_multi_popTip_15")}},t.prototype.setRoomDetailInfo=function(){this.m_room_player_data={};for(var t in this.p_roomInfo.room_player_data_list){var e=this.p_roomInfo.room_player_data_list[t].pos_id;this.m_room_player_data[e]=this.p_roomInfo.room_player_data_list[t]}},t.prototype.s_many_people_boss_create_room=function(t,e,i){var s=MessageProtocol.getClass(MessageType.m_many_people_boss_create_room_tos);s.boss_id=t,s.is_lock=e,s.password=i,MessageProtocol.sendMessage(MessageType.m_many_people_boss_create_room_tos,s)},t.prototype.c_many_people_boss_create_room=function(e){switch(e.result){case proto.m_many_people_boss_create_room_toc.ENUM.success:FloatTipModule.instance.popTipLanguage("l_multi_popTip_1"),this.p_roomId=e.room_details_data.room_data.room_id,this.p_roomInfo=e.room_details_data,this.p_is_auto=e.room_details_data.is_all_ready_auto_start,this.setRoomDetailInfo(),Dispatch.dispatch(t.EVENT_MULTI_CREATE_ROOM);break;case proto.m_many_people_boss_create_room_toc.ENUM.fail:FloatTipModule.instance.popTipLanguage("l_multi_popTip_2");break;case proto.m_many_people_boss_create_room_toc.ENUM.no_condition:FloatTipModule.instance.popTipLanguage("l_game_tips_15");break;case proto.m_many_people_boss_create_room_toc.ENUM.already_join_room:FloatTipModule.instance.popTipLanguage("l_multi_popTip_3");break;case proto.m_many_people_boss_create_room_toc.ENUM.none:FloatTipModule.instance.popTipLanguage("l_multi_popTip_4")}},t.prototype.s_many_people_boss_start=function(){var t=MessageProtocol.getClass(MessageType.m_many_people_boss_start_tos);MessageProtocol.sendMessage(MessageType.m_many_people_boss_start_tos,t)},t.prototype.c_many_people_boss_start=function(t){switch(t.result){case proto.m_many_people_boss_start_toc.ENUM.success:break;case proto.m_many_people_boss_start_toc.ENUM.fail:FloatTipModule.instance.popTipLanguage("l_multi_popTip_5");break;case proto.m_many_people_boss_start_toc.ENUM.not_authority:FloatTipModule.instance.popTipLanguage("l_multi_popTip_6");break;case proto.m_many_people_boss_start_toc.ENUM.not_enough_number:FloatTipModule.instance.popTipLanguage("l_multi_popTip_7");break;case proto.m_many_people_boss_start_toc.ENUM.already_start:FloatTipModule.instance.popTipLanguage("l_multi_popTip_8");break;case proto.m_many_people_boss_start_toc.ENUM.no_condition:FloatTipModule.instance.popTipLanguage("l_multi_popTip_9")}},t.prototype.s_many_people_boss_participate_in=function(t){var e=MessageProtocol.getClass(MessageType.m_many_people_boss_participate_in_tos);e.is_participate_in=t,MessageProtocol.sendMessage(MessageType.m_many_people_boss_participate_in_tos,e)},t.prototype.c_many_people_boss_participate_in=function(t){switch(t.result){case proto.m_many_people_boss_participate_in_toc.ENUM.success:0==t.is_participate_in?FloatTipModule.instance.popTipLanguage("l_multi_popTip_16"):FloatTipModule.instance.popTipLanguage("l_multi_popTip_10");
break;case proto.m_many_people_boss_participate_in_toc.ENUM.fail:0==t.is_participate_in?FloatTipModule.instance.popTipLanguage("l_multi_popTip_17"):FloatTipModule.instance.popTipLanguage("l_multi_popTip_11");break;case proto.m_many_people_boss_participate_in_toc.ENUM.not_enough_mana:FloatTipModule.instance.popTipLanguage("l_game_tips_2")}},t.prototype.s_many_people_boss_kick_out_player=function(t){var e=MessageProtocol.getClass(MessageType.m_many_people_boss_kick_out_player_tos);e.pos_id=t,MessageProtocol.sendMessage(MessageType.m_many_people_boss_kick_out_player_tos,e)},t.prototype.s_many_people_boss_set_is_all_ready_start=function(t){var e=MessageProtocol.getClass(MessageType.m_many_people_boss_set_is_all_ready_start_tos);e.is_all_ready_start=t,MessageProtocol.sendMessage(MessageType.m_many_people_boss_set_is_all_ready_start_tos,e)},t.prototype.c_many_people_boss_set_is_all_ready_start=function(e){this.p_is_auto=e.is_all_ready_start,Dispatch.dispatch(t.EVENT_MULTI_FIGHT_AOTU)},t.prototype.s_many_people_boss_ready=function(t){var e=MessageProtocol.getClass(MessageType.m_many_people_boss_ready_tos);e.is_ready=t,MessageProtocol.sendMessage(MessageType.m_many_people_boss_ready_tos,e)},t.prototype.c_many_people_boss_ready=function(e){switch(e.result){case proto.m_many_people_boss_ready_toc.ENUM.success:0==e.is_ready?FloatTipModule.instance.popTipLanguage("l_multi_popTip_18"):FloatTipModule.instance.popTipLanguage("l_multi_popTip_19"),Dispatch.dispatch(t.EVENT_MULTI_SELF_READY_ROOM,e.is_ready);break;case proto.m_many_people_boss_ready_toc.ENUM.fail:FloatTipModule.instance.popTipLanguage("l_multi_popTip_20");break;case proto.m_many_people_boss_ready_toc.ENUM.not_enough_mana:FloatTipModule.instance.popTipLanguage("l_game_tips_2")}},t.prototype.s_many_people_boss_leave_room=function(){var t=MessageProtocol.getClass(MessageType.m_many_people_boss_leave_room_tos);MessageProtocol.sendMessage(MessageType.m_many_people_boss_leave_room_tos,t)},t.prototype.c_many_people_boss_notice_leave_room=function(t){this.noticeLeave(t.type)},t.prototype.noticeLeave=function(e){this.p_roomId=0;var i="",s="";1==e?(i=LanguageJson.getText("l_multi_room_tips_4"),s=LanguageJson.getText("l_btn_ok"),PopupModule.instance.showTishiSingle(i,null,null,s)):2==e&&(i=LanguageJson.getText("l_multi_room_tips_5"),s=LanguageJson.getText("l_btn_ok"),PopupModule.instance.showTishiSingle(i,null,null,s)),Dispatch.dispatch(t.EVENT_MULTI_SELF_LEAVE_ROOM)},t.prototype.c_many_people_boss_notice_player_join=function(e){var i=e.room_player_data.pos_id;this.m_room_player_data[i]||(this.m_room_player_data[i]=e.room_player_data,Dispatch.dispatch(t.EVENT_MULTI_OTHER_JOIN_ROOM,i))},t.prototype.c_many_people_boss_notice_player_leave=function(e){this.m_room_player_data[e.pos_id]&&(delete this.m_room_player_data[e.pos_id],Dispatch.dispatch(t.EVENT_MULTI_LEAVE_ROOM,e.pos_id))},t.prototype.c_many_people_boss_notice_player_ready=function(e){var i=this.m_room_player_data[e.pos_id];i.is_ready=e.is_ready,Dispatch.dispatch(t.EVENT_MULTI_READY_ROOM,e.pos_id,e.is_ready)},t.prototype.c_many_people_boss_notice_player_fight_result=function(t){t.room_details_data&&(this.p_roomId=t.room_details_data.room_data.room_id,this.p_roomInfo=t.room_details_data,this.p_is_auto=t.room_details_data.is_all_ready_auto_start,this.setRoomDetailInfo()),1==t.result?1==t.is_first_prize?PopupModule.instance.showPop(PopupConfig.ID_MULTI_FIRST_PRIZE,{reward:t.prop_list,rank:t.rank}):PopupModule.instance.showPop(PopupConfig.ID_MULTI_OTHER_PRIZE,{reward:t.prop_list,rank:t.rank,nick:t.win_name}):PopupModule.instance.showPop(PopupConfig.ID_MISSION_FAIL,{msg:LanguageJson.getText("l_missiom_fail")})},t.prototype.c_many_people_boss_notice_player_fight_start=function(t){this.p_owner_mana=-1,PopupModule.instance.hidePopAll(),t.mission_time&&t.mission_time>0?PopupModule.instance.showPop(PopupConfig.ID_MULTI_WAIT_ROOM,t.mission_time,!1):(MissionManager.instance.missionType=MissionTypeEnum.MANY_PEOPLE_BOSS,MissionManager.instance.setCloseUIMission(),this.p_roomId=0,this.p_roomInfo=null,this.m_room_player_data={})},t.prototype.c_many_people_boss_notice_owner_fight_result=function(e){this.p_owner_mana=e.mana,e.room_details_data&&e.room_details_data.room_player_data_list&&(this.p_roomInfo=e.room_details_data,this.setRoomDetailInfo()),Dispatch.dispatch(t.EVENT_MULTI_FIGHT_COMPLETE)},t.prototype.getDataByPosId=function(t){return this.m_room_player_data[t]},t.prototype.getRoomPeople=function(){var t=0;for(var e in this.m_room_player_data)this.m_room_player_data[e]&&t++;return t},t.prototype.getOwnerPartInState=function(){var t=!1;for(var e in this.m_room_player_data){var i=this.m_room_player_data[e];if(i&&1==i.is_room_owner){t=!0;break}}return t},t.EVENT_MULTI_GET_ROOM="EVENT_MULTI_GET_ROOM",t.EVENT_MULTI_JOIN_ROOM="EVENT_MULTI_JOIN_ROOM",t.EVENT_MULTI_CREATE_ROOM="EVENT_MULTI_CREATE_ROOM",t.EVENT_MULTI_SELF_LEAVE_ROOM="EVENT_MULTI_SELF_LEAVE_ROOM",t.EVENT_MULTI_LEAVE_ROOM="EVENT_MULTI_LEAVE_ROOM",t.EVENT_MULTI_OTHER_JOIN_ROOM="EVENT_MULTI_OTHER_JOIN_ROOM",t.EVENT_MULTI_OWNER_JOIN_ROOM="EVENT_MULTI_OWNER_JOIN_ROOM",t.EVENT_MULTI_READY_ROOM="EVENT_MULTI_READY_ROOM",t.EVENT_MULTI_SELF_READY_ROOM="EVENT_MULTI_SELF_READY_ROOM",t.EVENT_MULTI_FIGHT_COMPLETE="EVENT_MULTI_FIGHT_COMPLETE",t.EVENT_MULTI_FIGHT_AOTU="EVENT_MULTI_FIGHT_AOTU",t}();__reflect(ManyPeopleBossManager.prototype,"ManyPeopleBossManager");var MD5Manager=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.m_instance||(this.m_instance=new e),this.m_instance},enumerable:!0,configurable:!0}),e.prototype.hashMd5=function(t){return this.m_md5||(this.m_md5=new md5),this.m_md5.hex_md5(t)},e}(egret.HashObject);__reflect(MD5Manager.prototype,"MD5Manager");var MessageManager=function(){function t(){}return t.register=function(t,e,i,s){void 0===s&&(s=!1),Dispatch.register("MSG"+t,e,i,s)},t.remove=function(t,e){Dispatch.remove("MSG"+t,e,this)},Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.dispatcherMessage=function(t,e){Dispatch.dispatch("MSG"+t,e)},t}();__reflect(MessageManager.prototype,"MessageManager");var MissionEitherManager=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){MessageManager.register(MessageType.m_mission_either_notice_state_toc,this.c_mission_either_notice_state,this),MessageManager.register(MessageType.m_mission_either_notice_result_toc,this.c_mission_either_notice_result,this)},t.prototype.c_mission_either_notice_state=function(t){this.p_round=t.round,this.p_type=t.type,this.p_award_value=t.award_value,this.p_end_time=t.end_time,this.sendTimeUpdata(),this.stopFight(),this.showChoose()},t.prototype.sendTimeUpdata=function(){this.p_end_time&&MissionManager.instance.missionTime!=this.p_end_time&&(MissionManager.instance.missionTime=this.p_end_time,Dispatch.dispatch(MissionManager.EVENT_TIME_MISSION))},t.prototype.stopFight=function(){1==this.p_type&&Dispatch.dispatch(FightSkillManager.EVENT_FIGHT_SKILL_STOP+FightSkillManager.type_auto)},t.prototype.showChoose=function(){if(1==this.p_type){var t="当前获得的金币 : "+this.p_award_value+"\n是否选择翻倍？",e=LanguageJson.getText("l_btn_yes"),i=LanguageJson.getText("l_btn_no");PopupModule.instance.showTishi(t,this.chooseHandle.bind(this),null,e,i)}},t.prototype.chooseHandle=function(t){1==t?this.s_brave_one_clean(1):this.s_brave_one_clean(0)},t.prototype.s_brave_one_clean=function(t){var e=MessageProtocol.getClass(MessageType.m_mission_either_either_tos);e.either_value=t,MessageProtocol.sendMessage(MessageType.m_mission_either_either_tos,e)},t.prototype.c_mission_either_notice_result=function(t){PopupModule.instance.hidePopAll(),UIModule.instance.hideAllUI(),0==t.result_state?FloatTipModule.instance.popTip("自己选择离开了"):1==t.result_state?FloatTipModule.instance.popTip("选择错了，游戏结束！"):2==t.result_state?FloatTipModule.instance.popTip("时间到了,即将退出副本！"):3==t.result_state&&FloatTipModule.instance.popTip("通关了,恭喜获得 "+t.award_value+" 金币")},t.EVENT_MISSION_EITHER_STATE="EVENT_MISSION_EITHER_STATE",t}();__reflect(MissionEitherManager.prototype,"MissionEitherManager");var MissionManager=function(t){function e(){var e=t.call(this)||this;return e.missionType=-1,e.missionId=-1,e.missionTime=0,e.missionTotalAalue=0,e.missionNowValue=0,e.pagodaMissionBool=!1,e.p_missionGotoCloseUIList=[],e.m_passed_mission_list={},e.m_hurt_ranking_list={},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.m_instance||(this.m_instance=new e),this.m_instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){MessageManager.register(MessageType.m_mission_challenge_mission_toc,this.c_mission_challenge_mission,this),MessageManager.register(MessageType.m_mission_notice_mission_result_toc,this.c_mission_notice_mission_result_toc,this),MessageManager.register(MessageType.m_mission_notice_passed_mission_toc,this.c_passed_mission,this),MessageManager.register(MessageType.m_mission_notice_mission_close_time_toc,this.setMissionTime,this),MessageManager.register(MessageType.m_mission_notice_total_award_toc,this.setMissionAward,this),MessageManager.register(MessageType.m_mission_notice_mission_schedule_toc,this.s_notice_mission_schedule,this),MessageManager.register(MessageType.m_mission_get_award_toc,this.c_get_award_toc,this),MessageManager.register(MessageType.m_mission_notice_mission_ranking_toc,this.setHurtRanking,this),Dispatch.register(SceneManager.EVENT_ENTER_SCENE,this.changeScene,this)},e.prototype.setRedMissionByPower=function(){DelayCallUtils.killDelayedCallsTo(this.setRedMission,this),DelayCallUtils.delayedCall(2,this.setRedMission,this)},e.prototype.cleanMissionData=function(){this.missionTime=0,this.missionTotalAalue=0,this.missionNowValue=0,this.missionAwardList=null},e.prototype.changeScene=function(){if(this.pagodaMissionBool=!1,-1!=this.missionType&&!SceneModule.instance.isMissionScene){if(Dispatch.dispatch(e.EVENT_EXIT_MISSION_BEFORE),this.missionType=-1,this.missionId=-1,this.cleanMissionData(),PopupModule.instance.hidePopAll(),Dispatch.dispatch(e.EVENT_EXIT_MISSION),this.p_missionGotoCloseUIList.length>0)for(var t=0;t<this.p_missionGotoCloseUIList.length;t++)UIConfig.p_uiDict[this.p_missionGotoCloseUIList[t]]&&UIModule.instance.showUI(this.p_missionGotoCloseUIList[t],UIConfig.p_uiDict[this.p_missionGotoCloseUIList[t]].outMissionAny);this.p_missionGotoCloseUIList=[]}},e.prototype.initPassMissionId=function(t){for(var i=0;i<t.length;i++)this.m_passed_mission_list[t[i].mission_type]=t[i].mission_id,Dispatch.dispatch(e.EVENT_GUANQIA_MISSION+t[i].mission_type);this.setRedMission()},e.prototype.s_mission_challenge_mission=function(t,e){var i=MissionJson.getData(t,e);if(""==BagManager.instance.checkCondition(i.enter_conditions_list,!0)){if(i.mana_enter_list&&BagManager.instance.gold<i.mana_enter_list[0])return void FloatTipModule.instance.popTipLanguage("l_game_tips_2");if(SceneModule.instance.isMissionScene&&t!=MissionTypeEnum.PAGODA)return void FloatTipModule.instance.popTipLanguage("l_missiom_tips_1");SceneManager.instance.p_sceneJson.mission_type==MissionTypeEnum.PAGODA&&(this.pagodaMissionBool=!0);var s=MessageProtocol.getClass(MessageType.m_mission_challenge_mission_tos);s.mission_type=Number(t),s.mission_id=Number(e),MessageProtocol.sendMessage(MessageType.m_mission_challenge_mission_tos,s)}},e.prototype.c_mission_challenge_mission=function(t){switch(t.result){case proto.m_mission_challenge_mission_toc.ENUM.success:this.missionType=t.mission_type,this.missionId=t.mission_id,this.setCloseUIMission(),Dispatch.dispatch(e.EVENT_ENTER_MISSION);break;case proto.m_mission_challenge_mission_toc.ENUM.function_no_open:FloatTipModule.instance.popTipLanguage("l_game_tips_9");break;case proto.m_mission_challenge_mission_toc.ENUM.fail:FloatTipModule.instance.popTipLanguage("l_missiom_tips_2");break;case proto.m_mission_challenge_mission_toc.ENUM.activity_no_open:t.mission_type==MissionTypeEnum.WORLD_BOSS&&FloatTipModule.instance.popTipLanguage("l_missiom_tips_3");break;case proto.m_mission_challenge_mission_toc.ENUM.not_online:t.mission_type==MissionTypeEnum.WORLD_BOSS&&FloatTipModule.instance.popTipLanguage("l_missiom_tips_4");break;case proto.m_mission_challenge_mission_toc.ENUM.times_limit:FloatTipModule.instance.popTipLanguage("l_missiom_tips_5");break;case proto.m_mission_challenge_mission_toc.ENUM.time_limit:FloatTipModule.instance.popTipLanguage("l_missiom_tips_6");break;case proto.m_mission_challenge_mission_toc.ENUM.not_authority:FloatTipModule.instance.popTipLanguage("l_missiom_tips_7")}},e.prototype.c_passed_mission=function(t){this.m_passed_mission_list[t.passed_mission.mission_type]=t.passed_mission.mission_id,Dispatch.dispatch(e.EVENT_GUANQIA_MISSION+t.passed_mission.mission_type),this.setRedMission()},e.prototype.setMissionTime=function(t){this.missionTime!=t.time&&(this.missionTime=t.time,Dispatch.dispatch(e.EVENT_TIME_MISSION))},e.prototype.s_notice_mission_schedule=function(t){this.missionTotalAalue=t.total_value,this.missionNowValue=t.now_value,Dispatch.dispatch(e.EVENT_ROUND_MISSION)},e.prototype.setMissionAward=function(t){this.missionAwardList=t.total_prop_list,Dispatch.dispatch(e.EVENT_AWARD_MISSION)},e.prototype.s_mission_exit_mission_tos=function(){DelayCallUtils.killDelayedCallsTo(this.s_mission_exit_mission_tos,this);var t=MessageProtocol.getClass(MessageType.m_mission_exit_mission_tos);MessageProtocol.sendMessage(MessageType.m_mission_exit_mission_tos,t)},e.prototype.c_mission_notice_mission_result_toc=function(t){MissionUIModule.instance.finishMission(t)},e.prototype.getPassIdByType=function(t){return this.m_passed_mission_list[t]?this.m_passed_mission_list[t]:0},e.prototype.setHurtRanking=function(t){this.m_hurt_ranking_list[t.mission_type]=t,Dispatch.dispatch(e.MISSION_HURE_RANKING)},e.prototype.getHurtRanking=function(t){return this.m_hurt_ranking_list[t]},e.prototype.s_mission_get_award_tos=function(t){},e.prototype.c_get_award_toc=function(t){switch(t.result){case proto.m_mission_get_award_toc.ENUM.success:this.setAwardToExitMission();break;case proto.m_mission_get_award_toc.ENUM.fail:FloatTipModule.instance.popTipLanguage("l_game_tips_13");break;case proto.m_mission_get_award_toc.ENUM.no_enough_prop:BagManager.instance.noEnoughGold()}},e.prototype.getViewListByType=function(t){var e=[];for(var i in MissionTypeJson.jsonData){var s=MissionTypeJson.jsonData[i];s&&s.tab_type==t&&1==s.is_client&&(FunctionManager.instance.getOpenFuncId(s.function_id)?s.is_open=1:s.is_open=0,e.push(s))}return ArrayUtils.setSortArr(e,["tab_sort","is_open"],[0,1]),e},e.prototype.setCloseUIMission=function(){if(!GuideModule.instance.getIsGuiding())for(var t in UIModule.instance.showUIList){var e=UIModule.instance.showUIList[t];UIConfig.p_uiDict[e]&&UIConfig.p_uiDict[e].outMissionAny&&-1==this.p_missionGotoCloseUIList.indexOf(e)&&this.p_missionGotoCloseUIList.push(e)}UIModule.instance.hideAllUI(),PopupModule.instance.hidePopAll()},e.prototype.setAwardToExitMission=function(){PopupModule.instance.hidePopAll(),DelayCallUtils.delayedCall(1.8,this.s_mission_exit_mission_tos.bind(this),this)},e.prototype.setRedMission=function(){this.m_itemJsonList||(this.m_itemJsonList=this.getJsonList(1)),this.m_resourceJsonList||(this.m_resourceJsonList=this.getJsonList(3))},e.prototype.getJsonList=function(t){var e=[];for(var i in MissionTypeJson.jsonData){var s=MissionTypeJson.jsonData[i];s.tab_type==t&&(s.times_id>0&&Dispatch.register(TimesManager.EVENT_TIEMS_UPDATE+s.times_id,this.setRedMission,this),Dispatch.register(FunctionManager.FUNCTION_OPEN_UPDATE+s.function_id,this.setRedMission,this),e.push(s))}return e},e.prototype.isRedMission=function(t,e){void 0===e&&(e=0);for(var i=0;i<t.length;i++)if(FunctionManager.instance.getOpenFuncId(t[i].function_id)){var s=this.getPassIdByType(t[i].id)+1;MissionJson.getData(t[i].id,s)}return!1},e.EVENT_ENTER_MISSION="EVENT_ENTER_MISSION",e.EVENT_EXIT_MISSION="EVENT_EXIT_MISSION",e.EVENT_EXIT_MISSION_BEFORE="EVENT_EXIT_MISSION_BEFORE",e.EVENT_GUANQIA_MISSION="EVENT_GUANQIA_MISSION",e.EVENT_TIME_MISSION="EVENT_TIME_MISSION",e.EVENT_ROUND_MISSION="EVENT_ROUND_MISSION",e.EVENT_AWARD_MISSION="EVENT_AWARD_MISSION",e.MISSION_HURE_RANKING="MISSION_HURE_RANKING",e}(egret.HashObject);__reflect(MissionManager.prototype,"MissionManager");var MissionShiShiManager=function(t){function e(){var e=t.call(this)||this;return e.p_total=0,e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.m_instance||(this.m_instance=new e),this.m_instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){MessageManager.register(MessageType.m_mission_notice_shi_shi_settle_toc,this.c_mission_notice_shi_shi_settle,this),MessageManager.register(MessageType.m_mission_notice_shi_shi_time_toc,this.c_mission_notice_shi_shi_time,this),MessageManager.register(MessageType.m_mission_notice_shi_shi_value_toc,this.c_mission_notice_shi_shi_value,this)},e.prototype.c_mission_notice_shi_shi_settle=function(t){if(t.type>0){var i=this.getAvatarMonster();1==t.type&&i&&(i.p_isDie=!0),FightUIModule.instance.getPoolLottery(i,t.type),t.value>0&&DelayCallUtils.delayedCall(1.3,this.showRewardPop.bind(this,[t]),this)}t.nextEndTime&&MissionManager.instance.missionTime!=t.nextEndTime&&(MissionManager.instance.missionTime=t.nextEndTime,Dispatch.dispatch(MissionManager.EVENT_TIME_MISSION,t.next_type)),Dispatch.dispatch(e.EVENT_SHISHI_RESULT)},e.prototype.showRewardPop=function(t){var e=t[0],i=[.5*StageManager.instance.p_stageWidth,.5*StageManager.instance.p_stageHeight],s=UIModule.instance.pointGold;if(1==e.type)PlayerManager.instance.playerId==e.winPlayerId&&FlyResModule.instance.playResEffect3(i,s,ItemEnum.GOLD,30),PopupModule.instance.showPop(PopupConfig.ID_SHISHI_BOSS_RESULT,{winName:e.winName,value:e.value,secondList:e.last_data_list,totalCost:e.total_cost_value},!1);else if(PlayerManager.instance.playerId==e.winPlayerId)FlyResModule.instance.playResEffect3(i,s,ItemEnum.GOLD,20),PopupModule.instance.showPop(PopupConfig.ID_SHISHI_BOSS_RESULT2,{winName:e.winName,value:e.value},!1);else{var n=FightModule.instance.getFighter(1,e.winPlayerId),o=this.getAvatarMonster();n&&o&&TweenLite.delayedCall(.2,FightUIModule.instance.showOtherMana.bind(FightUIModule.instance),[n,o,e.value])}},e.prototype.getAvatarMonster=function(){var t=MissionJson.getData(MissionTypeEnum.SHISHI_BOSS,1);if(t&&t.boss_id)for(var e in SceneItemModule.instance.monsterDict){var i=SceneItemModule.instance.monsterDict[e];return i}return null},e.prototype.c_mission_notice_shi_shi_time=function(t){this.p_total=Number(t.value),Dispatch.dispatch(e.EVENT_SHISHI_TOTAL),t.nextEndTime&&MissionManager.instance.missionTime!=t.nextEndTime&&(MissionManager.instance.missionTime=t.nextEndTime,Dispatch.dispatch(MissionManager.EVENT_TIME_MISSION,t.type))},e.prototype.c_mission_notice_shi_shi_value=function(t){this.p_total=Number(t.value),Dispatch.dispatch(e.EVENT_SHISHI_TOTAL)},e.EVENT_SHISHI_TOTAL="EVENT_SHISHI_TOTAL",e.EVENT_SHISHI_RESULT="EVENT_SHISHI_RESULT",e}(egret.HashObject);__reflect(MissionShiShiManager.prototype,"MissionShiShiManager");var MoveBean=function(){function t(){this.m_moveObj=null,this.callBack=null,this.speed=10,this.targetX=0,this.targetY=0,this.curp=null,this.speedX=0,this.speedY=0,this.path=null,this.bPause=!1}return Object.defineProperty(t.prototype,"moveObj",{get:function(){return this.m_moveObj},set:function(t){this.m_moveObj=t,this.curp=new egret.Point(t.x,t.y)},enumerable:!0,configurable:!0}),t}();__reflect(MoveBean.prototype,"MoveBean");var MoveManager=function(){function t(){this.lastStopMoveTime=0,this.m_lastCheckPos=new egret.Point(0,0),this.m_currentPos=new egret.Point(0,0),this.m_updatePoint=new egret.Point,this.requestGap=500,this.lastRequestTimePlayerMove=0,this.lastRequestTimePetMove=0,this.lastRequestTimePlayerMoveStep=0}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){this.m_moveDict=[],this.m_moveUtil=new MoveUtil},t.prototype.resetMapdata=function(t){this.m_moveUtil.resetMapdata(t)},t.prototype.isMoving=function(t){return null!=this.m_moveDict[t.hashCode]?!0:!1},t.prototype.startMove=function(t){this.m_moveDict[t.moveObj.hashCode]&&this.m_moveDict[t.moveObj.hashCode].stopMove(!1,!1),this.m_moveDict[t.moveObj.hashCode]=t},t.prototype.stopMove=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!0),this.m_moveDict[t.hashCode]&&(this.m_moveDict[t.hashCode].stopMove(e,i),this.deleteMove(this.m_moveDict[t.hashCode],e))},t.prototype.deleteMove=function(t,e){void 0===e&&(e=!1),t&&t.moveObj&&(t.moveObj instanceof AvatarMainPlayer&&!e&&this.s_scene_player_stop_move_tos(),this.m_moveDict[t.moveObj.hashCode]&&(this.m_moveDict[t.moveObj.hashCode]=null,delete this.m_moveDict[t.moveObj.hashCode],t.destory()))},t.prototype.s_scene_player_stop_move_tos=function(e){void 0===e&&(e=!1);var i=MessageProtocol.getClass(MessageType.m_scene_player_stop_move_tos);i.x=Math.floor(PlayerManager.instance.p_mainPlayer.x),i.y=Math.floor(PlayerManager.instance.p_mainPlayer.y),MessageProtocol.sendMessage(MessageType.m_scene_player_stop_move_tos,i),Dispatch.dispatch(t.EVENT_PLAYER_MOVE,PlayerManager.instance.p_mainPlayer.getPos()),this.lastStopMoveTime=egret.getTimer()},t.prototype.move=function(t,e,i,s,n,o,a,r,_){void 0===s&&(s=null),void 0===n&&(n=-1),void 0===o&&(o=0),void 0===a&&(a=MoveType.MOVE),void 0===r&&(r=null),void 0===_&&(_=!1);var h=new MoveHandle(t,e,i,s,n,o,a,r);h.isServerControl=_,t.doHandle(h)},t.prototype.movePlayer=function(e,i,s,n,o,a){function r(){Dispatch.dispatch(t.MOVE_OVER),null!=s&&s()}void 0===s&&(s=null),void 0===n&&(n=-1),void 0===o&&(o=0),void 0===a&&(a=MoveType.MOVE),PlayerManager.instance.p_mainPlayer.curState!=StateType.XUAN_YUN&&(PlayerManager.instance.p_mainPlayer.haveBuffEffectType(EffectTypeEnum.DIZZY)||this.move(PlayerManager.instance.p_mainPlayer,e,i,r,n,o,a))},t.prototype.moveCrossMapToSceneDoor=function(t,e,i,s,n,o){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=null),void 0===s&&(s=null),void 0===n&&(n=-1),void 0===o&&(o=!1)},t.prototype.moveCrossMapToNpc=function(t,e,i,s,n,o,a){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=null),void 0===s&&(s=null),void 0===n&&(n=-1),void 0===o&&(o=!0),void 0===a&&(a=!1)},t.prototype.moveCrossMapToMonster=function(t,e,i,s,n,o,a){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=null),void 0===s&&(s=null),void 0===n&&(n=-1),void 0===o&&(o=!0),void 0===a&&(a=!1)},t.prototype.moveCrossMapToPoint=function(t,e,i,s,n,o,a,r,_,h){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===s&&(s=null),void 0===n&&(n=null),void 0===o&&(o=-1),void 0===a&&(a=!0),void 0===r&&(r=!0),void 0===_&&(_=!1),void 0===h&&(h=0)},t.prototype.moveCrossMapToGather=function(t,e,i,s,n,o,a){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=null),void 0===s&&(s=null),void 0===n&&(n=-1),void 0===o&&(o=!0),void 0===a&&(a=!1)},t.prototype.quickMove=function(t,e,i,s,n,o){void 0===i&&(i=null),void 0===s&&(s=-1),void 0===n&&(n=0),void 0===o&&(o=MoveType.QUICK_MOVE),this.move(PlayerManager.instance.p_mainPlayer,t,e,i,s,n,o)},t.prototype.skillMove=function(t,e,i,s,n,o){var a=new MoveSkillUnit;if(a.playSkillMove(t,e,i,s,o),t instanceof AvatarMainPlayer){var r=MessageProtocol.getClass(MessageType.m_scene_player_move_tos);r.move_type=2,r.x=Math.floor(e),r.y=Math.floor(i),r.time=o,r.high=s,r.action_id=n,MessageProtocol.sendMessage(MessageType.m_scene_player_move_tos,r)}},t.prototype.execMove=function(t,e,i,s,n,o,a,r){void 0===s&&(s=-1),void 0===n&&(n=0),void 0===o&&(o=null),void 0===a&&(a=MoveType.MOVE),void 0===r&&(r=null),this.m_moveUtil.moveTarget(t,e,i,s,n,o,a,r)},t.prototype.moveMainPlayer=function(e,i,s,n,o,a,r){void 0===s&&(s=null),void 0===n&&(n=-1),void 0===o&&(o=0),void 0===a&&(a=MoveType.MOVE),void 0===r&&(r=!1);var _=this.m_moveUtil.moveTarget(PlayerManager.instance.p_mainPlayer,e,i,n,o,s,a);_&&(null==_.path||2==_.path.length&&_.moveObj.x==_.path[0]&&_.moveObj.y==_.path[1]||r||t.instance.s_scene_player_move_tos(_.targetX,_.targetY,null,a))},t.prototype.moveMainPet=function(t,e,i,s,n,o){void 0===i&&(i=null),void 0===s&&(s=-1),void 0===n&&(n=0),void 0===o&&(o=MoveType.MOVE)},t.prototype.onUpDateMapPos=function(e,i,s){void 0===s&&(s=!1),CameraModule.instance.updateFocus(e,i),this.m_currentPos.x=Math.floor(e/MyMapData.GRID_SIZE),this.m_currentPos.y=Math.floor(i/MyMapData.GRID_SIZE),(!this.m_currentPos.equals(this.m_lastCheckPos)&&!t.instance.isBlock(e,i)||s)&&(t.instance.s_scene_player_move_step_tos(e,i),this.m_lastCheckPos.x=this.m_currentPos.x,this.m_lastCheckPos.y=this.m_currentPos.y,this.m_updatePoint.x=(this.m_currentPos.x+.5)*MyMapData.GRID_SIZE,this.m_updatePoint.y=(this.m_currentPos.y+.5)*MyMapData.GRID_SIZE,Dispatch.dispatch(t.EVENT_PLAYER_MOVE,this.m_updatePoint))},Object.defineProperty(t.prototype,"isAutoFindPath",{get:function(){return this.m_autoFindPath},set:function(t){},enumerable:!0,configurable:!0}),t.prototype.stopAutoMove=function(){this.isAutoFindPath=!1,this.stopMove(PlayerManager.instance.p_mainPlayer)},Object.defineProperty(t.prototype,"mapTile",{get:function(){return this.m_moveUtil.mapTile},enumerable:!0,configurable:!0}),t.prototype.isBlock=function(t,e){return this.m_moveUtil.pathHelper.isBlock(t,e)},t.prototype.killDelayMove=function(){},t.prototype.s_scene_player_move_tos=function(t,e,i,s){void 0===s&&(s=MoveType.MOVE);var n=egret.getTimer()-this.lastRequestTimePlayerMove;if(n<this.requestGap)return TweenLite.killDelayedCallsTo(this.s_scene_player_move_tos),void TweenLite.delayedCall(.001*(this.requestGap-n+10),this.s_scene_player_move_tos,[t,e,i,s],this);var o=MessageProtocol.getClass(MessageType.m_scene_player_move_tos);o.x=Math.floor(t),o.y=Math.floor(e),o.high=0,o.time=0,o.action_id="move",o.move_type=s==MoveType.QUICK_MOVE?1:0,MessageProtocol.sendMessage(MessageType.m_scene_player_move_tos,o),this.lastRequestTimePlayerMove=egret.getTimer()},t.prototype.s_petMove=function(t,e,i){void 0===i&&(i=MoveType.MOVE)},t.prototype.s_monsterMove=function(t,e,i){},t.prototype.s_scene_player_move_step_tos=function(t,e){var i=egret.getTimer()-this.lastRequestTimePlayerMoveStep;if(i<this.requestGap)return TweenLite.killDelayedCallsTo(this.s_scene_player_move_step_tos),void TweenLite.delayedCall(.001*(this.requestGap-i+10),this.s_scene_player_move_step_tos,[t,e],this);var s=MessageProtocol.getClass(MessageType.m_scene_player_move_step_tos);s.x=Math.floor(t),s.y=Math.floor(e),MessageProtocol.sendMessage(MessageType.m_scene_player_move_step_tos,s),this.lastRequestTimePlayerMoveStep=egret.getTimer()},Object.defineProperty(t.prototype,"mainPlayerMovePath",{get:function(){return MoveUnit.mainPlayerMovePath},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"moveDict",{get:function(){return this.m_moveDict},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"moveUtil",{get:function(){return this.m_moveUtil},enumerable:!0,configurable:!0}),t.EVENT_MAIN_PLAYER_STOP_MOVE="EVENT_MAIN_PLAYER_STOP_MOVE",t.EVENT_MAIN_PLAYER_END_MOVE="EVENT_MAIN_PLAYER_END_MOVE",t.EVENT_NOTICE_PLAYER_MOVE="EVENT_NOTICE_PLAYER_MOVE",t.EVENT_PLAYER_MOVE="event_player_move",t.EVENT_PLAYER_MOVEPATH="event_player_movepath",t.EVENT_AUTO_FINDPATH="event_auto_findpath",t.MOVE_OVER="player_move_over",t}();__reflect(MoveManager.prototype,"MoveManager");var MoveSkillUnit=function(){function t(){}return t.prototype.playSkillMove=function(t,e,i,s,n){var o=n-Math.floor(n);n=.001*n,this.m_skillPlayer=t,this.m_jumpHeight>0&&(TweenMax.to(t,n*o,{jumpHeight:this.m_jumpHeight*(n>1?1:n),ease:Sine.easeOut}),TweenMax.to(t,n*(1-o),{delay:.3*n,ease:Sine.easeIn,jumpHeight:0})),TweenMax.to(t,n,{x:e,y:i,ease:Linear.easeNone,onUpdate:this.onMoveUpdate.bind(this),onComplete:this.onMoveComplete.bind(this)})},t.prototype.onMoveUpdate=function(){this.m_skillPlayer&&this.m_skillPlayer==PlayerManager.instance.p_mainPlayer&&(this.m_skillPlayer.setPos(this.m_skillPlayer.x,this.m_skillPlayer.y),MoveManager.instance.onUpDateMapPos(this.m_skillPlayer.x,this.m_skillPlayer.y))},t.prototype.onMoveComplete=function(){this.m_skillPlayer=null},t}();__reflect(MoveSkillUnit.prototype,"MoveSkillUnit");var MoveType=function(){function t(){}return t.MOVE="MOVE",t.CROSSMAP_MOVE="CROSSMAP_MOVE",t.QUICK_MOVE="QUICK_MOVE",t.QUICK_MOVE2="QUICK_MOVE2",t.DODGE_MOVE="DODGE_MOVE",t.SOUL_MOVE="SOUL_MOVE",t.CROSSMAP_TO_NPC="crossmap_to_npc",t.CROSSMAP_TO_MONSTER="crossmap_to_monster",t.CROSSMAP_TO_SCENEDOOR="crossmap_to_scenedoor",t.CROSSMAP_TO_POINT="crossmap_to_point",t.CROSSMAP_TO_GATHER="crossmap_to_gather",t}();__reflect(MoveType.prototype,"MoveType");var MoveUnit=function(){function t(){this.m_moveObj=null,this.m_moveDirection=0,this.callBack=null,this.speed=10,this.targetX=0,this.targetY=0,this.haveJump=!0,this.isMainPlayer=!1,this.isPlayer=!1,this.moveType=MoveType.MOVE,this.moveSceneId=-1,this.curp=null,this.speedX=0,this.speedY=0,this.path=null,this.bPause=!1,this.range=0,this.onJump=!1,this.onQuickMove=!1,this.jumpCount=-1,this.curMoveAction=AvatarConfig.ACTION_move,this.m_startMovePoint=new egret.Point,this.m_updateDisPoint=new egret.Point,this.m_speedPoint=new egret.Point,this.id=Math.random()}return Object.defineProperty(t.prototype,"moveObj",{get:function(){return this.m_moveObj},set:function(t){this.m_moveObj=t,this.isMainPlayer=this.m_moveObj==PlayerManager.instance.p_mainPlayer?!0:!1,this.m_moveObj instanceof AvatarPlayer&&(this.isPlayer=!0),this.curp=this.m_moveObj.getPos().clone(),this.jumpCount=Math.floor(4*Math.random())-1,this.isMainPlayer&&(this.moveSceneId=1101)},enumerable:!0,configurable:!0}),t.prototype.startMove=function(){Dispatch.register(AvatarLive.EVENT_MOVESPEED_CHANGE+this.moveObj.livePid,this.onMoveSpeedChange,this),this.isMainPlayer&&(t.mainPlayerMovePath=this.path),this.m_startMovePoint.x=this.targetX,this.m_startMovePoint.y=this.targetY;var e=egret.Point.distance(this.moveObj.getPos(),this.m_startMovePoint);this.moveType==MoveType.QUICK_MOVE&&!this.onQuickMove&&e<=t.chongciDistance?this.setQuickMove():this.moveType==MoveType.QUICK_MOVE2&&this.setQuickMove(),this.onQuickMove?(egret.getTimer()-t.quickMoveLastTime>t.quickMoveTimeGap&&(t.quickMoveAction+=1,t.quickMoveAction=t.quickMoveAction>t.quickMoveActionLib.length?1:t.quickMoveAction,t.quickMoveLastTime=egret.getTimer()),this.curMoveAction=t.quickMoveActionLib[t.quickMoveAction-1],this.isPlayer||(this.curMoveAction=AvatarConfig.ACTION_jump),null==this.quickMoveEffect&&(this.quickMoveEffect=new ImageShadowEffect,this.quickMoveEffect.play(this.moveObj,10,.7,.5)),this.moveObj.curState=StateType.FAST_MOVE):(this.curMoveAction=AvatarConfig.ACTION_move,this.moveObj.curState=StateType.MOVE),this.m_moveDirection=AvatarConfig.getDirection(this.path[0]-this.moveObj.x,this.path[1]-this.moveObj.y),this.moveObj.shiftToAction(this.curMoveAction,this.m_moveDirection),this.speedCount(this),MoveManager.instance.startMove(this),EnterFrameManager.instance.addEnterFrame(this.advanceTime,this)},t.prototype.stopMove=function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!1),null!=this.m_moveObj&&(this.callBack=null,this.endMove(!0,t,e),this.isMainPlayer&&Dispatch.dispatch(MoveManager.EVENT_MAIN_PLAYER_STOP_MOVE))},t.prototype.startJump=function(){this.isMainPlayer&&MoveManager.instance.onUpDateMapPos(this.curp.x,this.curp.y),this.jumpCount++,this.onJump=!0;var e=this.path[0],i=this.path[1];MoveManager.instance.mapTile.getdata(e/MyMapData.GRID_SIZE,i/MyMapData.GRID_SIZE);this.m_jumpitem=new JumpUnit,this.m_jumpitem.jump(this.moveObj,e,i,t.jumpActionList[Math.floor(this.jumpCount%4)],FuncCallBack.create(this.endJump,this)),this.curp.x=this.path[0],this.curp.y=this.path[1],EnterFrameManager.instance.removeEnterFrame(this.advanceTime,this)},t.prototype.endJump=function(){if(this.isMainPlayer&&this.curp&&MoveManager.instance.onUpDateMapPos(this.curp.x,this.curp.y),this.m_jumpitem=null,null!=this.path){var t=this.path[0],e=this.path[1],i=(MoveManager.instance.mapTile.getdata(t/MyMapData.GRID_SIZE,e/MyMapData.GRID_SIZE),this.setNextStep());
i&&(EnterFrameManager.instance.addEnterFrame(this.advanceTime,this),this.moveObj.curState=StateType.MOVE)}},t.prototype.endMove=function(e,i,s){void 0===e&&(e=!1),void 0===i&&(i=!1),void 0===s&&(s=!0),this.isMainPlayer&&(t.mainPlayerMovePath=[]),this.isMainPlayer&&0==i&&MoveManager.instance.onUpDateMapPos(this.curp.x,this.curp.y,!0),!this.isMainPlayer&&this.moveObj&&this.moveObj.curState==StateType.MOVE&&(this.moveObj.curState=StateType.STAND),this.moveObj&&s&&this.moveObj.shiftToAction(AvatarConfig.ACTION_stand),null!=this.callBack&&this.callBack(),this.isMainPlayer&&Dispatch.dispatch(MoveManager.EVENT_MAIN_PLAYER_END_MOVE),MoveManager.instance.deleteMove(this,i),this.destory()},t.prototype.destory=function(){null!=this.m_jumpitem&&(this.m_jumpitem.destory(),this.m_jumpitem=null),this.m_moveObj&&Dispatch.remove(AvatarLive.EVENT_MOVESPEED_CHANGE+this.m_moveObj.livePid,this.onMoveSpeedChange,this),EnterFrameManager.instance.removeEnterFrame(this.advanceTime,this),this.m_moveObj=null,this.callBack=null,this.quickMoveEffect&&(this.quickMoveEffect.stop(),this.quickMoveEffect=null),this.m_moveDirection=0,this.speed=10,this.targetX=0,this.targetY=0,this.haveJump=!0,this.isPlayer=!1,this.moveType=MoveType.MOVE,this.moveSceneId=-1,this.curp=null,this.speedX=0,this.speedY=0,this.path=null,this.bPause=!1,this.range=0,this.onJump=!1,this.onQuickMove=!1,this.jumpCount=-1,this.curMoveAction=AvatarConfig.ACTION_move,MoveUtil.pushMoveUnit(this)},t.prototype.advanceTime=function(t){var e=t/.016666;this.isMainPlayer?(e>2&&(e=2),this.upDate(e)):this.upDate(e)},t.prototype.upDate=function(e){if(void 0===e&&(e=1),null==this.moveObj)return void this.endMove();if(this.path.length>0){var i=this.path[0],s=this.path[1],n=this.chickIsEnd();if(n){this.moveObj.setPos(i,s),this.isMainPlayer&&(t.mainPlayerMovePath=this.path);var o=this.setNextStep();if(!o)return}else(this.moveObj.curAction!=this.curMoveAction||this.moveObj.p_moveDriection!=this.m_moveDirection)&&(this.m_moveDirection=AvatarConfig.getDirection(this.speedX,this.speedY),this.moveObj.shiftToAction(this.curMoveAction,this.m_moveDirection)),this.curp.x=this.curp.x+this.speedX*e,this.curp.y=this.curp.y+this.speedY*e,this.isMainPlayer&&MoveManager.instance.onUpDateMapPos(this.curp.x,this.curp.y);this.moveObj.setPos(this.curp.x,this.curp.y),this.moveObj&&(this.m_updateDisPoint.x=this.targetX),this.m_updateDisPoint.y=this.targetY;var a=egret.Point.distance(this.moveObj.getPos(),this.m_updateDisPoint);this.moveType==MoveType.QUICK_MOVE&&!this.onQuickMove&&a<=t.chongciDistance?this.setQuickMove():this.moveType!=MoveType.QUICK_MOVE2||this.onQuickMove||this.setQuickMove()}else this.endMove()},t.prototype.setQuickMove=function(){this.onQuickMove=!0,this.onQuickMove&&(egret.getTimer()-t.quickMoveLastTime>t.quickMoveTimeGap&&(t.quickMoveAction+=1,t.quickMoveAction=t.quickMoveAction>t.quickMoveActionLib.length?1:t.quickMoveAction,t.quickMoveLastTime=egret.getTimer()),this.curMoveAction=t.quickMoveActionLib[t.quickMoveAction-1],this.isPlayer||(this.curMoveAction=AvatarConfig.ACTION_jump),null==this.quickMoveEffect&&(this.quickMoveEffect=new ImageShadowEffect,this.quickMoveEffect.play(this.moveObj,10,.7,.5)),this.moveObj.curState=StateType.FAST_MOVE),this.speed=1e3/60,this.speedCount(this)},t.prototype.chickIsEnd=function(){var t=this.path[0],e=this.path[1],i=!1,s=!1;return 0!=this.speedX?this.speedX>0&&t-this.curp.x<=0?i=!0:this.speedX<0&&t-this.curp.x>=0&&(i=!0):i=!0,0!=this.speedY?this.speedY>0&&e-this.curp.y<=0?s=!0:this.speedY<0&&e-this.curp.y>=0&&(s=!0):s=!0,1==s&&1==i?!0:s!=i?(0==s&&0!=this.speedX&&this.speedCount(this),0==i&&0!=this.speedY&&this.speedCount(this),!1):!1},t.prototype.setNextStep=function(){if(null==this.moveObj)return this.stopMove(),!1;this.onJump=!1,this.curp.x=this.path[0],this.curp.y=this.path[1],this.path.splice(0,2);var e=MoveManager.instance.mapTile.getdata(this.curp.x/MyMapData.GRID_SIZE,this.curp.y/MyMapData.GRID_SIZE);switch(e){case MyMapData.DATA_SCENEDOOR:if(this.moveObj==PlayerManager.instance.p_mainPlayer)return!1;break;case MyMapData.DATA_JUMPPOINT:if(this.path.length>0)for(var i=MoveManager.instance.mapTile.getJumpEndPointList(this.curp.x/MyMapData.GRID_SIZE,this.curp.y/MyMapData.GRID_SIZE),s=0;s<i.length;s++)if(i[s]&&i[s][0]==Math.floor(this.path[0]/MyMapData.GRID_SIZE)&&i[s][1]==Math.floor(this.path[1]/MyMapData.GRID_SIZE))return this.startJump(),!1}return this.path.length>0?(this.speedCount(this),this.onQuickMove?egret.getTimer()-t.quickMoveLastTime>t.quickMoveTimeGap&&(t.quickMoveAction+=1,t.quickMoveAction=t.quickMoveAction>3?3:t.quickMoveAction,t.quickMoveLastTime=egret.getTimer()):this.curMoveAction=AvatarConfig.ACTION_move,this.m_moveDirection=AvatarConfig.getDirection(this.speedX,this.speedY),this.moveObj.shiftToAction(this.curMoveAction,this.m_moveDirection),!0):(this.endMove(),!1)},t.prototype.speedCount=function(t){this.m_speedPoint.x=t.path[0],this.m_speedPoint.y=t.path[1];var e=egret.Point.distance(this.m_speedPoint,t.curp),i=e/t.speed;0!=i?(t.speedX=(this.m_speedPoint.x-t.curp.x)/i,t.speedY=(this.m_speedPoint.y-t.curp.y)/i):(t.speedX=0,t.speedY=0)},t.prototype.onMoveSpeedChange=function(){this.speed=this.moveObj.moveSpeed,this.onQuickMove||this.speedCount(this)},t.jumpActionList=[JumpConfig.JUMP_2,JumpConfig.JUMP_1,JumpConfig.JUMP_4,JumpConfig.JUMP_3],t.mainPlayerMovePath=[],t.quickMoveAction=0,t.quickMoveActionLib=[AvatarConfig.ACTION_jump01,AvatarConfig.ACTION_jump03,AvatarConfig.ACTION_jump04],t.quickMoveLastTime=0,t.quickMoveTimeGap=1e3,t.isStarlingRender=!0,t.chongciDistance=500,t}();__reflect(MoveUnit.prototype,"MoveUnit",["IAnimatable"]);var MoveUtil=function(){function t(){this.autoJumpCount=0,this.m_cajPoint=new egret.Point,this.m_calcPoint=new egret.Point,this.m_nearBlockTargetPt=new egret.Point,this.m_nearBlockObjPt=new egret.Point,this.m_nearBlockEndPt=new egret.Point,this.m_rangePoint=new egret.Point,this.m_angleDisPoint=new egret.Point,this.m_mapTile=new MapTileModel,this.m_pathFinder=new AStar(this.m_mapTile),this.m_pathHelper=new PathOptimizeHelper(this.m_mapTile)}return t.prototype.resetMapdata=function(t){this.m_mapTile.mapdata=t},t.prototype.moveTarget=function(e,i,s,n,o,a,r,_){if(void 0===n&&(n=-1),void 0===o&&(o=0),void 0===a&&(a=null),void 0===r&&(r=MoveType.MOVE),void 0===_&&(_=null),null==MyMapModule.instance.map.mapdata.gridData||0==MyMapModule.instance.map.mapdata.gridData.length)return e.x=i,e.y=s,null;i=Number(i),s=Number(s);var h=t.getMoveUnit();h.moveObj=e,h.callBack=a,h.targetX=i,h.targetY=s,h.speed=-1==n?h.moveObj.moveSpeed:n,h.moveType=r,h.range=o;var l;return null==_?l=this.calcPath(h):(h.path=_,l=!0),l?(this.autoJumpCount=0,this.checkAutoJump(h),h.startMove()):(h.moveObj.curAction!=AvatarConfig.ACTION_stand&&h.moveObj.shiftToAction(AvatarConfig.ACTION_stand),h.endMove(!0,!0,!0)),h},t.prototype.checkAutoJump=function(t){if(t.isMainPlayer&&!(this.autoJumpCount>10)){this.autoJumpCount++,this.m_cajPoint.x=t.path[t.path.length-2],this.m_cajPoint.y=t.path[t.path.length-1];var e=this.mapTile.getAutoJumpPoint(this.m_cajPoint.x,this.m_cajPoint.y);null!=e&&(t.path.push(e[0]*MyMapData.GRID_SIZE+.5*MyMapData.GRID_SIZE),t.path.push(e[1]*MyMapData.GRID_SIZE+.5*MyMapData.GRID_SIZE),t.targetX=e[0]*MyMapData.GRID_SIZE+.5*MyMapData.GRID_SIZE,t.targetY=e[1]*MyMapData.GRID_SIZE+.5*MyMapData.GRID_SIZE,this.checkAutoJump(t))}},t.prototype.calcPath=function(t){Math.floor(t.curp.x/MyMapData.GRID_SIZE),Math.floor(t.curp.y/MyMapData.GRID_SIZE),Math.floor(t.targetX/MyMapData.GRID_SIZE),Math.floor(t.targetY/MyMapData.GRID_SIZE);if(t.moveType==MoveType.SOUL_MOVE)t.path=[],t.path.push(t.targetX,t.targetY);else if(this.m_pathHelper.isBlock(t.targetX,t.targetY)){if(!this.getNearBlock(t))return!1}else if(this.m_pathHelper.isOpenPath(t.curp.x,t.curp.y,t.targetX,t.targetY))if(t.path=[],0==t.range)t.path.push(t.targetX,t.targetY);else{this.m_calcPoint.x=t.targetX,this.m_calcPoint.y=t.targetY;var e=this.getAngleDistance(t.curp,this.m_calcPoint,t.range);t.path.push(e.x,e.y)}else if(this.m_pathHelper.isBlock(t.curp.x,t.curp.y)&&!this.m_pathHelper.isBlock(t.targetX,t.targetY),t.path=this.aStarFindPath(t.curp.x,t.curp.y,t.targetX,t.targetY,t.range,t.haveJump),null==t.path){var i=this.m_pathHelper.getFirstBlockPoint(t.curp.x,t.curp.y,t.targetX,t.targetY);if(Math.floor(i.x)==t.curp.x&&Math.floor(i.y)==t.curp.y)return!1;t.path=[],t.path.push(i.x,i.y)}return!0},t.prototype.getNearBlock=function(t,e,i){void 0===e&&(e=5),void 0===i&&(i=!0);var s=Math.floor((i?t.targetX:t.curp.x)/MyMapData.GRID_SIZE),n=Math.floor((i?t.targetY:t.curp.y)/MyMapData.GRID_SIZE);if(!this.m_pathHelper.isBlockByGrid(s,n))return!0;this.m_nearBlockTargetPt.x=t.targetX,this.m_nearBlockTargetPt.y=t.targetY,this.m_nearBlockObjPt.x=t.curp.x,this.m_nearBlockObjPt.y=t.curp.y;for(var o=[],a=MyMapModule.instance.map.mapdata.gridCol,r=MyMapModule.instance.map.mapdata.gridRow,_=0>s-e?0:s-e,h=s+e>a-1?a-1:s+e,l=0>n-e?0:n-e,c=n+e>r-1?r-1:n+e,m=_;h>=m;++m)for(var p=l;c>=p;++p)this.m_pathHelper.isBlockByGrid(m,p)||(this.m_nearBlockEndPt.x=(m+.5)*MyMapData.GRID_SIZE,this.m_nearBlockEndPt.y=(p+.5)*MyMapData.GRID_SIZE,o.push({endPt:this.m_nearBlockEndPt,nearWeight:Math.abs(egret.Point.distance(this.m_nearBlockTargetPt,this.m_nearBlockEndPt)),distanceWeight:Math.abs(egret.Point.distance(this.m_nearBlockEndPt,this.m_nearBlockObjPt))}));o.sort(this.compare);var u=o.shift();if(null==u)return!1;if(!i)return t.moveObj.x=u.endPt.x,t.moveObj.y=u.endPt.y,t.curp.x=u.endPt.x,t.curp.y=u.endPt.y,!1;if(t.targetX=u.endPt.x,t.targetY=u.endPt.y,this.m_pathHelper.isOpenPath(t.curp.x,t.curp.y,t.targetX,t.targetY)){if(t.path=[],0==t.range)t.path.push(t.targetX,t.targetY);else{this.m_rangePoint.x=t.targetX,this.m_rangePoint.y=t.targetY;var d=this.getAngleDistance(t.curp,this.m_rangePoint,t.range);t.path.push(d.x,d.y)}return!0}return t.path=this.aStarFindPath(t.curp.x,t.curp.y,t.targetX,t.targetY,t.range,t.haveJump,500),null==t.path?!1:!0},t.prototype.compare=function(t,e){return t.nearWeight==e.nearWeight?t.distanceWeight-e.distanceWeight:t.nearWeight-e.nearWeight},t.prototype.aStarFindPath=function(t,e,i,s,n,o,a){void 0===a&&(a=1e5),this.m_pathFinder.maxTry=a;var r=Math.floor(t/MyMapData.GRID_SIZE),_=Math.floor(e/MyMapData.GRID_SIZE),h=Math.floor(i/MyMapData.GRID_SIZE),l=Math.floor(s/MyMapData.GRID_SIZE),c=this.m_pathFinder.find(r,_,h,l,n,o);if(null==c)return null;var m=[],p=c.length-1;m.push(t,e);for(var u=0;p>u;u++)m.push((c[u][0]+.5)*MyMapData.GRID_SIZE),m.push((c[u][1]+.5)*MyMapData.GRID_SIZE);return 0==n&&m.push(i,s),this.m_pathHelper.pathOptimize(m),m},t.prototype.getAngleDistance=function(t,e,i){void 0===i&&(i=100);var s=e.x-t.x,n=e.y-t.y,o=i/egret.Point.distance(t,e);return 0==egret.Point.distance(t,e)?e:(s=o*s,n=o*n,this.m_angleDisPoint.x=e.x-s,this.m_angleDisPoint.y=e.y-n,this.m_angleDisPoint)},Object.defineProperty(t.prototype,"mapTile",{get:function(){return this.m_mapTile},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pathHelper",{get:function(){return this.m_pathHelper},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pathFinder",{get:function(){return this.m_pathFinder},enumerable:!0,configurable:!0}),t.getMoveUnit=function(){var t;return t=this.moveUnitPool.length>0?this.moveUnitPool.shift():new MoveUnit},t.pushMoveUnit=function(t){-1==this.moveUnitPool.indexOf(t)&&this.moveUnitPool.push(t)},t.moveUnitPool=[],t}();__reflect(MoveUtil.prototype,"MoveUtil");var AStar=function(){function t(t,e){void 0===e&&(e=1e5),this.BLOCK=0,this.COST_STRAIGHT=10,this.COST_DIAGONAL=14,this.NOTE_ID=0,this.NOTE_OPEN=1,this.NOTE_CLOSED=2,this.m_curPoint=new egret.Point,this.m_endPoint=new egret.Point,this.m_mapTileModel=t,this.m_maxTry=e}return Object.defineProperty(t.prototype,"maxTry",{get:function(){return this.m_maxTry},set:function(t){this.m_maxTry=t},enumerable:!0,configurable:!0}),t.prototype.find=function(t,e,i,s,n,o){void 0===n&&(n=0),void 0===o&&(o=!0),n=Math.floor(n/MyMapData.GRID_SIZE),this.initLists(),this.m_openCount=0,this.m_openId=-1,this.openNote(t,e,0,0,0);var a,r,_,h,l=0;this.m_endPoint.x=i,this.m_endPoint.y=s;for(var c,m,p;this.m_openCount>0;){if(++l>this.m_maxTry)return this.destroyLists(),null;if(a=this.m_openList[0],this.closeNote(a),r=this.m_xList[a],_=this.m_yList[a],this.m_curPoint.x=r,this.m_curPoint.y=_,0==n){if(r==i&&_==s)return this.getPath(t,e,a)}else if(n>=egret.Point.distance(this.m_curPoint,this.m_endPoint))return this.getPath(t,e,a);h=this.getArounds(r,_,o);for(var u in h){var d=h[u];m=this.m_movementCostList[a]+(d[0]==r||d[1]==_?this.COST_STRAIGHT:this.COST_DIAGONAL),p=m+(Math.abs(i-d[0])+Math.abs(s-d[1]))*this.COST_STRAIGHT,this.isOpen(d[0],d[1])?(c=this.m_noteMap[d[1]][d[0]][this.NOTE_ID],m<this.m_movementCostList[c]&&(this.m_movementCostList[c]=m,this.m_pathScoreList[c]=p,this.m_fatherList[c]=a,this.aheadNote(this.getIndex(c)))):this.openNote(d[0],d[1],p,m,a)}}return this.destroyLists(),null},t.prototype.openNote=function(t,e,i,s,n){this.m_openCount++,this.m_openId++,null==this.m_noteMap[e]&&(this.m_noteMap[e]=[]),this.m_noteMap[e][t]=[],this.m_noteMap[e][t][this.NOTE_OPEN]=!0,this.m_noteMap[e][t][this.NOTE_ID]=this.m_openId,this.m_xList.push(t),this.m_yList.push(e),this.m_pathScoreList.push(i),this.m_movementCostList.push(s),this.m_fatherList.push(n),this.m_openList.push(this.m_openId),this.aheadNote(this.m_openCount)},t.prototype.closeNote=function(t){this.m_openCount--;var e=this.m_xList[t],i=this.m_yList[t];return this.m_noteMap[i][e][this.NOTE_OPEN]=!1,this.m_noteMap[i][e][this.NOTE_CLOSED]=!0,this.m_openCount<=0?(this.m_openCount=0,void(this.m_openList=[])):(this.m_openList[0]=this.m_openList.pop(),void this.backNote())},t.prototype.aheadNote=function(t){for(var e,i;t>1&&(e=Math.floor(.5*t),this.getScore(t)<this.getScore(e));)i=this.m_openList[t-1],this.m_openList[t-1]=this.m_openList[e-1],this.m_openList[e-1]=i,t=e},t.prototype.backNote=function(){for(var t,e,i=1;;){if(t=i,2*t<=this.m_openCount&&(this.getScore(i)>this.getScore(2*t)&&(i=2*t),2*t+1<=this.m_openCount&&this.getScore(i)>this.getScore(2*t+1)&&(i=2*t+1)),t==i)break;e=this.m_openList[t-1],this.m_openList[t-1]=this.m_openList[i-1],this.m_openList[i-1]=e}},t.prototype.isOpen=function(t,e){return null==this.m_noteMap[e]?!1:null==this.m_noteMap[e][t]?!1:this.m_noteMap[e][t][this.NOTE_OPEN]},t.prototype.isClosed=function(t,e){return null==this.m_noteMap[e]?!1:null==this.m_noteMap[e][t]?!1:this.m_noteMap[e][t][this.NOTE_CLOSED]},t.prototype.getArounds=function(t,e,i){var s,n,o=[],a=t,r=e,_=this.m_mapTileModel.getdata(a,r);switch(_){case MyMapData.DATA_SCENEDOOR:n=this.m_mapTileModel.getSceneDoorPoint(a,r),n&&(t=n.x,e=n.y);break;case MyMapData.DATA_JUMPPOINT:if(i)for(var h=this.m_mapTileModel.getJumpEndPointList(a,r),l=0;l<h.length;l++)h[l]&&o.push(h[l])}a=t+1,r=e;var c=this.m_mapTileModel.getdata(a,r)!=this.BLOCK;c&&!this.isClosed(a,r)&&o.push([a,r]),a=t,r=e+1;var m=this.m_mapTileModel.getdata(a,r)!=this.BLOCK;m&&!this.isClosed(a,r)&&o.push([a,r]),a=t-1,r=e;var p=this.m_mapTileModel.getdata(a,r)!=this.BLOCK;p&&!this.isClosed(a,r)&&o.push([a,r]),a=t,r=e-1;var u=this.m_mapTileModel.getdata(a,r)!=this.BLOCK;return u&&!this.isClosed(a,r)&&o.push([a,r]),a=t+1,r=e+1,s=this.m_mapTileModel.getdata(a,r)!=this.BLOCK,s&&c&&m&&!this.isClosed(a,r)&&o.push([a,r]),a=t-1,r=e+1,s=this.m_mapTileModel.getdata(a,r)!=this.BLOCK,s&&p&&m&&!this.isClosed(a,r)&&o.push([a,r]),a=t-1,r=e-1,s=this.m_mapTileModel.getdata(a,r)!=this.BLOCK,s&&p&&u&&!this.isClosed(a,r)&&o.push([a,r]),a=t+1,r=e-1,s=this.m_mapTileModel.getdata(a,r)!=this.BLOCK,s&&c&&u&&!this.isClosed(a,r)&&o.push([a,r]),o},t.prototype.getPath=function(t,e,i){for(var s=[],n=this.m_xList[i],o=this.m_yList[i];n!=t||o!=e;)s.unshift([n,o]),i=this.m_fatherList[i],n=this.m_xList[i],o=this.m_yList[i];return s.unshift([t,e]),this.destroyLists(),s},t.prototype.getIndex=function(t){var e=1;for(var i in this.m_openList){if(this.m_openList[i]==t)return e;e++}return-1},t.prototype.getScore=function(t){return this.m_pathScoreList[this.m_openList[t-1]]},t.prototype.initLists=function(){this.m_openList=[],this.m_xList=[],this.m_yList=[],this.m_pathScoreList=[],this.m_movementCostList=[],this.m_fatherList=[],this.m_noteMap=[]},t.prototype.destroyLists=function(){this.m_openList=null,this.m_xList=null,this.m_yList=null,this.m_pathScoreList=null,this.m_movementCostList=null,this.m_fatherList=null,this.m_noteMap=null},t}();__reflect(AStar.prototype,"AStar");var MapTileModel=function(){function t(){}return Object.defineProperty(t.prototype,"mapdata",{get:function(){return this.m_mapdata},set:function(t){this.m_mapdata=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numCols",{get:function(){return this.m_mapdata.gridCol},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numRows",{get:function(){return this.m_mapdata.gridRow},enumerable:!0,configurable:!0}),t.prototype.getdata=function(t,e){if(t=Math.floor(t),e=Math.floor(e),null==this.m_mapdata||!this.m_mapdata.gridData)return 0;if(0>t||t>=this.m_mapdata.gridCol||0>e||e>=this.m_mapdata.gridRow)return 0;var i=t+e*this.m_mapdata.gridCol;return this.m_mapdata.gridData[i]},t.prototype.getMaskData=function(t,e){if(t=Math.floor(t),e=Math.floor(e),!this.m_mapdata||!this.m_mapdata.maskData)return 0;if(0>t||t>=this.m_mapdata.gridCol||0>e||e>=this.m_mapdata.gridRow)return 0;var i=t+e*this.m_mapdata.gridCol;return this.m_mapdata.maskData[Math.floor(i)]},t.prototype.getSceneDoorPoint=function(t,e){t=Math.floor(t),e=Math.floor(e);var i=this.m_mapdata.sceneDoorData[t+"_"+e];return null==i?null:i.point},t.prototype.getJumpEndPointList=function(t,e){t=Math.floor(t),e=Math.floor(e);var i=this.m_mapdata.sceneJumpData[t+"_"+e];return null==i?[]:i},t.prototype.getSceneDoorId=function(t,e){t=Math.floor(t),e=Math.floor(e);var i=this.m_mapdata.sceneDoorData[t+"_"+e];return null==i?-1:i.sceneDoorId},t.prototype.getAutoJumpPoint=function(t,e){var i=Math.floor(t/40),s=Math.floor(e/40);return this.m_mapdata.sceneAutoJumpData[i+"_"+s]},t}();__reflect(MapTileModel.prototype,"MapTileModel",["IMapTileModel"]);var MoveHandle=function(){function t(t,e,i,s,n,o,a,r){void 0===s&&(s=null),void 0===n&&(n=-1),void 0===o&&(o=0),void 0===a&&(a=MoveType.MOVE),void 0===r&&(r=null),this.m_range=0,this.isServerControl=!1,this.m_lastRequestJumptoMountTime=0,this.m_target=t,this.m_x=e,this.m_y=i,this.m_range=o,this.m_moveCallBack=s,this.m_speed=n,this.m_moveType=a,this.m_movePath=r,this.m_life=this}return t.prototype.execHandle=function(){null!=this.m_target&&(this.m_target instanceof AvatarMainPlayer?MoveManager.instance.moveMainPlayer(this.m_x,this.m_y,this.onMoveComplete.bind(this),this.m_speed,this.m_range,this.m_moveType,this.isServerControl):MoveManager.instance.execMove(this.m_target,this.m_x,this.m_y,this.m_speed,this.m_range,null,this.m_moveType,this.m_movePath))},t.prototype.endHandle=function(e){void 0===e&&(e=null),null!=this.m_target&&(e instanceof t?MoveManager.instance.stopMove(this.m_target,!0,!1):MoveManager.instance.stopMove(this.m_target,!1,!1),this.dispose())},t.prototype.cancelHandle=function(){},t.prototype.onMoveComplete=function(){null!=this.m_moveCallBack&&this.m_moveCallBack(),this.m_target&&(this.m_target.curState=StateType.STAND),this.dispose()},t.prototype.dispose=function(){this.m_target=null,this.m_moveCallBack=null,this.m_life=null},Object.defineProperty(t.prototype,"handleId",{get:function(){return-1},enumerable:!0,configurable:!0}),t}();__reflect(MoveHandle.prototype,"MoveHandle",["IHandle"]);var AvatarJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||egret.log(this.FileName+" :不存在["+t+"]项！"),i},t.getActionUrlDict=function(e,i){var s=t.getData(e),n={},o=!1;null==s.fpsDict&&(s.fpsDict={},o=!0);for(var a=s.action.split("|"),r=s.fps.split("|"),_=0;_<a.length;_++){var h=void 0,l=[];if(-1==a[_].indexOf("#"))h=a[_],l=[-1,-1,-1,-1,-1];else{var c=a[_].split("#");h=c.shift(),l=this.setDirectionArr(c)}for(var m=0;m<PublicCon.DIRECTION_MAX;m++)if(n[h+"_"+m]=i+PublicCon.PATH_AVATAR+s.folder_path+h+(-1==l[m]?"":"_"+l[m])+".png",1==o){var p=r.length-1>=_?_:r.length-1;s.fpsDict[h+"_"+m]=Number(r[p])}}return n},t.getWeaponActionUrlDict=function(e,i,s){var n=t.getData(e),o=!1;null==n.fpsDict&&(n.fpsDict=[],o=!0);for(var a=n.action.split("|"),r=n.fps.split("|"),_=FightUIModule.instance.geAvatarPartsUrl(s,1,i),h={},l=0;l<a.length;l++){var c=void 0,m=[];if(-1==a[l].indexOf("#"))c=a[l],m=[-1,-1,-1,-1,-1];else{var p=a[l].split("#");c=p.shift(),m=this.setDirectionArr(p)}for(var u=0;u<PublicCon.DIRECTION_MAX;u++)if(h[c+"_"+u]=_+c+(-1==m[u]?"":"_"+m[u])+".png",1==o){var d=r.length-1>=l?l:r.length-1;n.fpsDict[c+"_"+u]=Number(r[d])}}return h},t.setDirectionArr=function(t){function e(t,e){return t-e}var i=[null,null,null,null,null];t.sort(e),-1!=t.indexOf("*")&&(t=[1,2,3,4,5]);var s;for(s=0;s<t.length;s++)i[Number(t[s])-1]=t[s];var n=0;for(s=0;s<i.length;s++)null==i[s]?i[s]=t[n]:n=t.indexOf(i[s]);return i},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="avatar",t}();__reflect(AvatarJson.prototype,"AvatarJson"),window.AvatarJson=AvatarJson;var JumpHandle=function(){function t(t,e,i){this.m_x=e,this.m_y=i,this.m_jumpTarget=t}return t.prototype.cancelHandle=function(){this.m_jumpTarget=null},t.prototype.endHandle=function(t){void 0===t&&(t=null),this.m_jumpTarget=null},t.prototype.execHandle=function(){this.m_jumpTarget.curState=StateType.JUMP,(new JumpUnit).jump(this.m_jumpTarget,this.m_x,this.m_y,1,null,500)},Object.defineProperty(t.prototype,"handleId",{get:function(){return 0},enumerable:!0,configurable:!0}),t}();__reflect(JumpHandle.prototype,"JumpHandle",["IHandle"]);var JumpModule=function(){function t(){}return t.prototype.JumpModule=function(){if(t.m_instance)throw new Error("JumpModule 是一个单例！")},Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){},t.prototype.setAutoJumpPoint=function(){},t.prototype.openDodgeJump=function(t){},t}();__reflect(JumpModule.prototype,"JumpModule");var JumpUnit=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.jump=function(t,i,s,n,o,a){void 0===n&&(n=JumpConfig.JUMP_1),void 0===o&&(o=null),void 0===a&&(a=-1),this.m_targetX=i,this.m_targetY=s;var r="";this.m_jumpTarget=t,this.m_jumpType=n,this.m_completeCallBack=o,t.curState=StateType.JUMP,-1==a?(a=this.getLength(t.x,t.y,i,s)/JumpConfig.JUMPSPEED,a<e.jump_min_time&&(a=e.jump_min_time)):a=.001*a;var _=i-t.x,h=s-t.y;if(a<e.jump_min_time&&(n=2),a>1.5)if(Math.abs(h)>Math.abs(_)&&h>0)n=JumpConfig.JUMP_1;else{var l=[JumpConfig.JUMP_1,JumpConfig.JUMP_2,JumpConfig.JUMP_3,JumpConfig.JUMP_4];n=l[Math.floor(Math.random()*l.length)]}a>e.jump_max_time&&(a=e.jump_max_time),TweenMax.killTweensOf(t),this.m_quickMoveEffect=new ImageShadowEffect,1==t.canJump?(r=t instanceof AvatarPlayer?AvatarConfig.ACTION_jump+"0"+n:AvatarConfig.ACTION_jump,t.shiftToAction(r,AvatarConfig.getDirection(i-this.m_jumpTarget.x,s-this.m_jumpTarget.y)),TweenMax.to(t,.3*a,{jumpHeight:JumpConfig.JUMPHEIGHT*(a>1?1:a),ease:Sine.easeOut}),TweenMax.to(t,.7*a,{delay:.3*a,ease:Sine.easeIn,jumpHeight:0}),this.m_quickMoveEffect.play(t,e.jump_shadow_setting[0],e.jump_shadow_setting[1],e.jump_shadow_setting[2]),TweenMax.to(t,a,{x:i,y:s,ease:Linear.easeNone,onUpdate:this.onJumpUpdate.bind(this)})):0==t.canJump||(a=.35,t.shiftToAction(r,AvatarConfig.getDirection(this.m_jumpTarget.x-i,this.m_jumpTarget.y-s)),this.m_quickMoveEffect.play(t,e.jump_shadow_setting[0],e.jump_shadow_setting[1],e.jump_shadow_setting[2],!1,!0),TweenMax.to(t,a,{x:i,y:s,onUpdate:this.onJumpUpdate.bind(this)})),DelayCallUtils.delayedCall(a,this.onJumpComplete,this)},e.prototype.onJumpUpdate=function(){this.m_jumpTarget&&this.m_jumpTarget==PlayerManager.instance.p_mainPlayer&&(CameraModule.instance.updateFocus(this.m_jumpTarget.x,this.m_jumpTarget.y),this.m_jumpTarget.setPos(this.m_jumpTarget.x,this.m_jumpTarget.y))},e.prototype.onJumpComplete=function(){this.m_jumpTarget&&(this.m_jumpTarget.shiftToAction(AvatarConfig.ACTION_stand),this.m_jumpTarget.setPos(this.m_targetX,this.m_targetY),this.m_jumpTarget.curState=StateType.JUMP_END),this.m_quickMoveEffect&&(this.m_quickMoveEffect.stop(),this.m_quickMoveEffect=null),null!=this.m_completeCallBack&&this.m_completeCallBack.call(),this.m_completeCallBack=null,this.m_jumpTarget=null},e.prototype.getLength=function(t,e,i,s){return new egret.Point(i-t,s-e).length},e.prototype.destory=function(){this.m_jumpTarget&&(TweenMax.killTweensOf(this.m_jumpTarget),this.m_jumpTarget.shiftToAction(AvatarConfig.ACTION_stand),this.m_jumpTarget.curState=StateType.JUMP_END,this.m_jumpTarget.jumpHeight=0,this.m_jumpTarget=null),this.m_quickMoveEffect&&(this.m_quickMoveEffect.stop(),this.m_quickMoveEffect=null),null!=this.m_completeCallBack&&this.m_completeCallBack.call(),DelayCallUtils.killDelayedCallsTo(this.onJumpComplete,this)},e.jump_shadow_setting=[10,.7,.5],e.jump_min_time=.7,e.jump_max_time=5,e}(egret.HashObject);__reflect(JumpUnit.prototype,"JumpUnit");var PathOptimizeHelper=function(){function t(t){this.m_mapTile=null,this.m_startPoint=new egret.Point,this.m_endPoint=new egret.Point,this.m_mapTile=t}return t.prototype.pathOptimize=function(t){for(var e=(t.length>>1)-1,i=0;1e4>i&&!(2>e-i);i++){for(var s=e;s-i>1;s--){var n=i<<1,o=s<<1;if(this.isOpenPath(t[n],t[n+1],t[o],t[o+1])){t.splice(n+2,s-i-1<<1);break}}e=(t.length>>1)-1}t.length>2&&t.splice(0,2)},t.prototype.isOpenPath=function(t,e,i,s){var n=this.getFirstBlockPoint(t,e,i,s);return n.x==i&&n.y==s},t.prototype.getFirstBlockPoint=function(e,i,s,n,o,a){void 0===o&&(o=0),void 0===a&&(a=null),this.m_startPoint.x=e,this.m_startPoint.y=i,this.m_endPoint.x=s,this.m_endPoint.y=n;var r=egret.Point.distance(this.m_startPoint,this.m_endPoint),_=(s-e)/r,h=(n-i)/r,l=_*t.STEP_LEN,c=h*t.STEP_LEN,m=Math.floor(r/t.STEP_LEN)+1;0!=o&&(m=o/t.STEP_LEN),this.m_endPoint.x=-1;for(var p=0;m>p;p++){0==o&&m-1==p?(this.m_startPoint.x=s,this.m_startPoint.y=n):(this.m_startPoint.x=this.m_startPoint.x+l,this.m_startPoint.y=this.m_startPoint.y+c);var u=a?!a.containsPoint(this.m_startPoint):!1;if(this.isBlock(this.m_startPoint.x,this.m_startPoint.y)||u){if(l>>=1,c>>=1,this.m_startPoint.x=this.m_startPoint.x-l,this.m_startPoint.y=this.m_startPoint.y-c,u=a?!a.containsPoint(this.m_startPoint):!1,!this.isBlock(this.m_startPoint.x,this.m_startPoint.y)&&!u){this.m_endPoint.x=this.m_startPoint.x,this.m_endPoint.y=this.m_startPoint.y;break}break}this.m_endPoint.x=this.m_startPoint.x,this.m_endPoint.y=this.m_startPoint.y}return-1==this.m_endPoint.x?new egret.Point(e,i):this.m_endPoint},t.prototype.isBlock=function(t,e){var i=Math.floor(t/MyMapData.GRID_SIZE),s=Math.floor(e/MyMapData.GRID_SIZE);return 0==this.m_mapTile.getdata(i,s)},t.prototype.isBlockByGrid=function(t,e){return 0==this.m_mapTile.getdata(t,e)},t.STEP_LEN=40,t}();__reflect(PathOptimizeHelper.prototype,"PathOptimizeHelper");var OnlineAwardManager=function(t){function e(){var e=t.call(this)||this;return e.online_time=0,e.id_list=[],e.m_timeList=[],e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.m_instance||(this.m_instance=new e),this.m_instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){MessageManager.register(MessageType.m_activity_give_online_award_toc,this.c_give_online_award,this),MessageManager.register(MessageType.m_player_notice_server_time_toc,this.c_notice_server_time,this)},e.prototype.initData=function(t){this.online_time=t.time,this.id_list=t.id,this.m_timeList=[];for(var e=ServerTimeManager.instance.onlineTime,i=OnlineAwardJson.getDataList(),s=0;s<i.length;s++)e>=i[s].time&&-1==this.m_timeList.indexOf(s)&&this.m_timeList.push(s);this.m_timeList.length<i.length,this.setRedNotice()},e.prototype.c_notice_server_time=function(t){ServerTimeManager.instance.initDate(t.server_time),this.online_time=0,this.id_list=[],this.m_timeList=[],Dispatch.dispatch(e.ONLINE_AWARD_UPDATE_ALL)},e.prototype.setOnlineTime=function(){var t=ServerTimeManager.instance.onlineTime,e=OnlineAwardJson.getDataList();if(!(this.m_timeList.length>=e.length))for(var i=0;i<e.length;i++)if(t>=e[i].time&&-1==this.m_timeList.indexOf(i)){this.m_timeList.push(i),this.setRedNotice();break}},e.prototype.s_give_online_award=function(t){var e=MessageProtocol.getClass(MessageType.m_activity_give_online_award_tos);e.id=t,MessageProtocol.sendMessage(MessageType.m_activity_give_online_award_tos,e)},e.prototype.c_give_online_award=function(t){switch(t.result){case proto.m_activity_give_online_award_toc.ENUM.success:this.id_list.push(t.id),Dispatch.dispatch(e.ONLINE_AWARD_UPDATE+t.id),this.setRedNotice();break;case proto.m_activity_give_online_award_toc.ENUM.activity_no_open:FloatTipModule.instance.popTip("活动未开启");break;case proto.m_activity_give_online_award_toc.ENUM.already_have:FloatTipModule.instance.popTip("已领取过该奖励");break;default:FloatTipModule.instance.popTip("领取失败")}},e.prototype.setRedNotice=function(){},e.ONLINE_AWARD_UPDATE="ONLINE_AWARD_UPDATE",e.ONLINE_AWARD_UPDATE_ALL="ONLINE_AWARD_UPDATE_ALL",e}(egret.HashObject);__reflect(OnlineAwardManager.prototype,"OnlineAwardManager");var PassTicketManager=function(){function t(){this.p_txz_id=1,this.p_day=5,this.p_endTime=ServerTimeManager.instance.timer+2592e3,this.p_lv=5,this.p_exp=200,this.p_is_buy=!1,this.p_box_num=0,this.p_silver_rewards=[],this.p_diamond_rewards=[],this.m_dailyTask={},this.m_monthTask={}}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){MessageManager.register(MessageType.m_tongxingzheng_task_info_notice_toc,this.c_tongxingzheng_task_info_notice,this),MessageManager.register(MessageType.m_tongxingzheng_task_daily_update_notice_toc,this.c_tongxingzheng_task_daily_update_notice,this),MessageManager.register(MessageType.m_tongxingzheng_task_month_update_notice_toc,this.c_tongxingzheng_task_month_update_notice,this),MessageManager.register(MessageType.m_tongxingzheng_task_daily_reward_collect_toc,this.c_tongxingzheng_task_daily_reward_collect,this),MessageManager.register(MessageType.m_tongxingzheng_collect_task_month_reward_toc,this.c_tongxingzheng_collect_task_month_reward,this),MessageManager.register(MessageType.m_tongxingzheng_reward_info_notice_toc,this.c_tongxingzheng_reward_info_notice,this),MessageManager.register(MessageType.m_tongxingzheng_purchase_level_toc,this.c_tongxingzheng_purchase_level,this),MessageManager.register(MessageType.m_tongxingzheng_collect_level_reward_toc,this.c_tongxingzheng_collect_level_reward,this),MessageManager.register(MessageType.m_tongxingzheng_purchase_unlock_toc,this.c_tongxingzheng_purchase_unlock,this)},t.prototype.c_tongxingzheng_task_info_notice=function(t){this.m_dailyTask={},this.m_monthTask={},this.p_day=t.day,this.p_endTime=t.time;for(var e in t.daily_tasks)this.m_dailyTask[t.daily_tasks[e].task_id]=t.daily_tasks[e];for(var e in t.month_tasks)this.m_monthTask[t.month_tasks[e].task_id]=t.month_tasks[e]},t.prototype.c_tongxingzheng_task_daily_update_notice=function(t){for(var e in t.tasks)this.m_dailyTask[t.tasks[e].task_id]=t.tasks[e]},t.prototype.c_tongxingzheng_task_month_update_notice=function(t){for(var e in t.tasks)this.m_monthTask[t.tasks[e].task_id]=t.tasks[e]},t.prototype.s_tongxingzheng_task_daily_reward_collect=function(t){var e=MessageProtocol.getClass(MessageType.m_tongxingzheng_task_daily_reward_collect_tos);e.id=t,MessageProtocol.sendMessage(MessageType.m_tongxingzheng_task_daily_reward_collect_tos,e)},t.prototype.c_tongxingzheng_task_daily_reward_collect=function(t){switch(t.result){case proto.m_tongxingzheng_task_daily_reward_collect_toc.ENUM.success:RewardModule.instance.receiveByProp(t.prop_list);break;case proto.m_tongxingzheng_task_daily_reward_collect_toc.ENUM.not_authority:FloatTipModule.instance.popTipLanguage("l_pass_ticket_task_tips1");
break;case proto.m_tongxingzheng_task_daily_reward_collect_toc.ENUM.already_get:FloatTipModule.instance.popTipLanguage("l_pass_ticket_task_tips3");break;case proto.m_tongxingzheng_task_daily_reward_collect_toc.ENUM.unknown:FloatTipModule.instance.popTipLanguage("l_pass_ticket_task_tips2")}},t.prototype.s_tongxingzheng_collect_task_month_reward=function(t){var e=MessageProtocol.getClass(MessageType.m_tongxingzheng_task_daily_reward_collect_tos);e.id=t,MessageProtocol.sendMessage(MessageType.m_tongxingzheng_task_daily_reward_collect_tos,e)},t.prototype.c_tongxingzheng_collect_task_month_reward=function(t){switch(t.result){case proto.m_tongxingzheng_collect_task_month_reward_toc.ENUM.success:RewardModule.instance.receiveByProp(t.prop_list);break;case proto.m_tongxingzheng_collect_task_month_reward_toc.ENUM.not_authority:FloatTipModule.instance.popTipLanguage("l_pass_ticket_task_tips1");break;case proto.m_tongxingzheng_collect_task_month_reward_toc.ENUM.already_get:FloatTipModule.instance.popTipLanguage("l_pass_ticket_task_tips3");break;case proto.m_tongxingzheng_collect_task_month_reward_toc.ENUM.unknown:FloatTipModule.instance.popTipLanguage("l_pass_ticket_task_tips2")}},t.prototype.s_tongxingzheng_purchase_unlock=function(t){var e=MessageProtocol.getClass(MessageType.m_tongxingzheng_purchase_unlock_tos);e.type=t,MessageProtocol.sendMessage(MessageType.m_tongxingzheng_purchase_unlock_tos,e)},t.prototype.c_tongxingzheng_purchase_unlock=function(e){switch(e.result){case proto.m_tongxingzheng_purchase_unlock_toc.ENUM.success:this.p_is_buy=!0,PopupModule.instance.hidePop(PopupConfig.ID_PASS_TICKET_BUY),Dispatch.dispatch(t.EVENT_PURCHASE_UNLOCK);break;case proto.m_tongxingzheng_purchase_unlock_toc.ENUM.no_enough_prop:FloatTipModule.instance.popTipLanguage("l_game_tips_11");break;case proto.m_tongxingzheng_purchase_unlock_toc.ENUM.unknown:FloatTipModule.instance.popTipLanguage("l_pass_ticket_unlock_tips1")}},t.prototype.c_tongxingzheng_reward_info_notice=function(e){this.p_is_buy=e.is_buy,this.p_txz_id=e.txz_id,this.p_silver_rewards=e.silver_rewards,this.p_diamond_rewards=e.diamond_rewards,this.p_lv!=Number(e.lv)&&(this.p_lv=Number(e.lv),Dispatch.dispatch(t.EVENT_PSAA_TICKET_LEVEL_UPDATA,Number(e.lv))),this.p_exp!=Number(e.exp)&&(this.p_exp=Number(e.exp),Dispatch.dispatch(t.EVENT_PSAA_TICKET_EXP_UPDATA,Number(e.exp))),this.p_box_num!=e.box_num&&(this.p_box_num=e.box_num,Dispatch.dispatch(t.EVENT_PSAA_TICKET_BIG_BOX))},t.prototype.s_tongxingzheng_purchase_level=function(){var t=MessageProtocol.getClass(MessageType.m_tongxingzheng_purchase_level_tos);MessageProtocol.sendMessage(MessageType.m_tongxingzheng_purchase_level_tos,t)},t.prototype.c_tongxingzheng_purchase_level=function(t){switch(t.result){case proto.m_tongxingzheng_purchase_level_toc.ENUM.success:PopupModule.instance.hidePop(PopupConfig.ID_PASS_TICKET_LEVEL);break;case proto.m_tongxingzheng_purchase_level_toc.ENUM.no_enough_prop:FloatTipModule.instance.popTipLanguage("l_game_tips_11");break;case proto.m_tongxingzheng_purchase_level_toc.ENUM.unknown:FloatTipModule.instance.popTipLanguage("l_pass_ticket_level_buy_tips1")}},t.prototype.s_tongxingzheng_collect_level_reward=function(t,e){var i=MessageProtocol.getClass(MessageType.m_tongxingzheng_collect_level_reward_tos);i.type=t,i.lv=e,MessageProtocol.sendMessage(MessageType.m_tongxingzheng_collect_level_reward_tos,i)},t.prototype.c_tongxingzheng_collect_level_reward=function(e){switch(e.result){case proto.m_tongxingzheng_collect_level_reward_toc.ENUM.success:1==e.type?-1==this.p_silver_rewards.indexOf(e.lv)&&this.p_silver_rewards.push(e.lv):2==e.type?-1==this.p_diamond_rewards.indexOf(e.lv)&&this.p_diamond_rewards.push(e.lv):this.p_box_num-=1,RewardModule.instance.receiveByProp(e.prop_list),Dispatch.dispatch(t.EVENT_PSAA_TICKET_LEVEL_RECEIVE+e.type,e.lv);break;case proto.m_tongxingzheng_collect_level_reward_toc.ENUM.not_authority:FloatTipModule.instance.popTipLanguage("l_pass_ticket_level_tips1");break;case proto.m_tongxingzheng_collect_level_reward_toc.ENUM.already_get:FloatTipModule.instance.popTipLanguage("l_pass_ticket_level_tips2");case proto.m_tongxingzheng_collect_level_reward_toc.ENUM.unknown:FloatTipModule.instance.popTipLanguage("l_pass_ticket_level_tips3")}},t.EVENT_PURCHASE_UNLOCK="EVENT_PURCHASE_UNLOCK",t.EVENT_PSAA_TICKET_EXP_UPDATA="EVENT_PSAA_TICKET_EXP_UPDATA",t.EVENT_PSAA_TICKET_LEVEL_UPDATA="EVENT_PSAA_TICKET_LEVEL_UPDATA",t.EVENT_PSAA_TICKET_BIG_BOX="EVENT_PSAA_TICKET_BIG_BOX",t.EVENT_PSAA_TICKET_LEVEL_RECEIVE="EVENT_PSAA_TICKET_LEVEL_RECEIVE",t}();__reflect(PassTicketManager.prototype,"PassTicketManager");var PlatformFunctionManager=function(){function t(){this.p_shareCode="",this.m_shareData={}}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){MessageManager.register(MessageType.m_platform_function_share_toc,this.c_platform_function_share,this),MessageManager.register(MessageType.m_platform_function_get_share_friend_give_toc,this.c_platform_function_get_share_friend_give,this),MessageManager.register(MessageType.m_platform_function_notice_share_friend_toc,this.c_platform_function_notice_share_friend,this),MessageManager.register(MessageType.m_platform_function_notice_share_count_toc,this.c_platform_function_notice_share_count,this),MessageManager.register(MessageType.m_platform_function_notice_platform_vip_level_toc,this.c_platform_function_notice_platform_vip_level,this),MessageManager.register(MessageType.m_platform_function_get_platform_award_info_toc,this.c_platform_function_get_platform_award_info,this),MessageManager.register(MessageType.m_platform_function_get_share_task_info_toc,this.c_platform_function_get_share_task_info,this),MessageManager.register(MessageType.m_platform_function_get_share_task_award_toc,this.c_platform_function_get_share_task_award,this),MessageManager.register(MessageType.m_platform_function_notice_share_task_toc,this.c_platform_function_notice_share_task,this),MessageManager.register(MessageType.m_platform_function_refresh_open_key_toc,this.c_platform_function_refresh_open_key,this)},t.prototype.initData=function(t){this.m_shareData={};for(var e in t){var i=t[e].task_id;this.m_shareData[i]=t[e]}this.setFuncRed()},t.prototype.setFuncRed=function(){var t=!1;for(var e in this.m_shareData){var i=this.m_shareData[e];if(1==i.state){t=!0;break}}RedNoticeManager.instance.dispatchRed(RedNoticeConfig.RED_SHARE,t)},t.prototype.s_platform_function_share=function(){var t=MessageProtocol.getClass(MessageType.m_platform_function_share_tos);MessageProtocol.sendMessage(MessageType.m_platform_function_share_tos,t)},t.prototype.c_platform_function_share=function(t){},t.prototype.s_platform_function_get_share_friend_give=function(t){var e=MessageProtocol.getClass(MessageType.m_platform_function_get_share_friend_give_tos);e.id,MessageProtocol.sendMessage(MessageType.m_platform_function_get_share_friend_give_tos,e)},t.prototype.c_platform_function_get_share_friend_give=function(t){t.result,t.id},t.prototype.c_platform_function_notice_share_friend=function(t){t.share_friend_data},t.prototype.c_platform_function_notice_share_count=function(e){Dispatch.dispatch(t.EVENT_SHARE_TIMRS_RESET)},t.prototype.c_platform_function_notice_platform_vip_level=function(t){t.p_vip_level,t.p_vip_award_state},t.prototype.s_platform_function_get_platform_award_info=function(t){var e=MessageProtocol.getClass(MessageType.m_platform_function_get_platform_award_info_tos);e.id,MessageProtocol.sendMessage(MessageType.m_platform_function_get_platform_award_info_tos,e)},t.prototype.c_platform_function_get_platform_award_info=function(t){t.inof_data},t.prototype.s_platform_function_get_share_task_info=function(t){var e=MessageProtocol.getClass(MessageType.m_platform_function_get_share_task_info_tos);e.show_type=t,MessageProtocol.sendMessage(MessageType.m_platform_function_get_share_task_info_tos,e)},t.prototype.c_platform_function_get_share_task_info=function(e){this.m_shareData={};for(var i in e.share_task_award_data){var s=e.share_task_award_data[i].task_id;this.m_shareData[s]=e.share_task_award_data[i]}Dispatch.dispatch(t.EVENT_SHARE_TASK_INFO),this.setFuncRed()},t.prototype.getShareTaskData=function(t){return this.m_shareData[t]},t.prototype.s_platform_function_get_share_task_award=function(t,e){var i=MessageProtocol.getClass(MessageType.m_platform_function_get_share_task_award_tos);i.task_type=t,i.task_id=e,MessageProtocol.sendMessage(MessageType.m_platform_function_get_share_task_award_tos,i)},t.prototype.c_platform_function_get_share_task_award=function(e){switch(e.share_task_award_data,e.result){case proto.m_platform_function_get_share_task_award_toc.ENUM.success:var i=this.getShareTaskData(e.share_task_award_data.task_id),s=ShareTaskJson.getData(e.share_task_award_data.task_type,e.share_task_award_data.task_id);i.state=2,RewardModule.instance.receiveByList(s.item_list),SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_4004),this.setFuncRed(),Dispatch.dispatch(t.EVENT_SHARE_TASK_UPDATA+e.share_task_award_data.task_id);break;case proto.m_platform_function_get_share_task_award_toc.ENUM.fail:FloatTipModule.instance.popTipLanguage("l_game_tips_13");break;case proto.m_platform_function_get_share_task_award_toc.ENUM.not_enough_grid:FloatTipModule.instance.popTipLanguage("l_game_tips_14");break;case proto.m_platform_function_get_share_task_award_toc.ENUM.not_authority:FloatTipModule.instance.popTipLanguage("l_game_tips_7");break;case proto.m_platform_function_get_share_task_award_toc.ENUM.already_have:FloatTipModule.instance.popTipLanguage("l_game_tips_5")}},t.prototype.c_platform_function_notice_share_task=function(e){e.share_task_award_data;for(var i in e.share_task_award_data){var s=e.share_task_award_data[i].task_id;this.m_shareData[s]=e.share_task_award_data[i],Dispatch.dispatch(t.EVENT_SHARE_TASK_UPDATA+e.share_task_award_data[i].task_id)}this.setFuncRed()},t.prototype.s_platform_function_refresh_open_key=function(t){var e=MessageProtocol.getClass(MessageType.m_platform_function_refresh_open_key_tos);e.open_key,MessageProtocol.sendMessage(MessageType.m_platform_function_refresh_open_key_tos,e)},t.prototype.c_platform_function_refresh_open_key=function(t){},t.EVENT_SHARE_TIMRS_RESET="EVENT_SHARE_TIMRS_RESET",t.EVENT_SHARE_TASK_INFO="EVENT_SHARE_TASK_INFO",t.EVENT_SHARE_TASK_UPDATA="EVENT_SHARE_TASK_UPDATA",t}();__reflect(PlatformFunctionManager.prototype,"PlatformFunctionManager");var DefaultPlatformManager=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.m_instance||(this.m_instance=new e),this.m_instance},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"os",{get:function(){return egret.Capabilities.os},enumerable:!0,configurable:!0}),e.prototype.initPlatform=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return this.p_platformData={},[2]})})},e.prototype.pay=function(t,e){console.log("DefaultPlatform pay")},e.prototype.callPlatformPay=function(t,e,i,s){console.log("DefaultPlatform callPlatformPay")},e.prototype.reportRegister=function(){console.log("DefaultPlatform reportRegister")},e.prototype.reportLogin=function(){console.log("DefaultPlatform reportLogin")},e.prototype.reportCreateRole=function(){console.log("DefaultPlatform reportCreateRole")},e.prototype.share=function(){},e.prototype.addShortCut=function(){console.log("DefaultPlatform addShortCut")},e.prototype.createRoleExtra=function(){return"nil"},e}(egret.HashObject);__reflect(DefaultPlatformManager.prototype,"DefaultPlatformManager",["IPlatformManager"]);var PlatformManager=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){if(!this.m_instance)switch(URIManager.platformId){case PlatformEnum.LOCAL:this.m_instance=DefaultPlatformManager.instance;break;case PlatformEnum.TEST:this.m_instance=TestManager.instance;break;default:this.m_instance=SEAAPPManager.instance}return this.m_instance},enumerable:!0,configurable:!0}),e}(egret.HashObject);__reflect(PlatformManager.prototype,"PlatformManager");var SEAAPPManager=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.m_instance||(this.m_instance=new e),this.m_instance},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"os",{get:function(){return egret.Capabilities.os},enumerable:!0,configurable:!0}),e.prototype.initPlatform=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return egret.ExternalInterface.addCallback("appLogin",function(t){LoginManager.instance.loginGameCallBack(t)}),egret.ExternalInterface.addCallback("appLoginKefuShow",function(t){Dispatch.dispatch(ServerListManager.EVENT_LOGIN_KEFU)}),egret.ExternalInterface.addCallback("appRecharge",function(t){}),egret.ExternalInterface.addCallback("appAdjustBack",function(t){PlayerManager.instance.registerADJust(t)}),egret.ExternalInterface.addCallback("appVerResource",function(t){URIManager.p_assestList=JSON.parse(t)}),egret.ExternalInterface.addCallback("appPageName",function(t){URIManager.p_packName=t}),egret.ExternalInterface.addCallback("appAccredit",function(t){var e=JSON.parse(t);PlayerManager.instance.s_visitor_binding(e.acc_id,e.channel)}),[2]})})},e.prototype.pay=function(t,e){console.log("DefaultPlatform pay")},e.prototype.callPlatformPay=function(t,e,i,s){var n="";if(1==URIManager.is_native_pay)for(var o=s,a=0;a<o.length;a++)n+=o[a].value;else for(var o=s,a=0;a<o.length;a++){n=o[a].value;break}GameManager.instance.callToNative("toAppRecharge",n),console.log("唤起平台充值 "+JSON.stringify(s),n)},e.prototype.reportRegister=function(){console.log("DefaultPlatform reportRegister")},e.prototype.reportLogin=function(){GameManager.instance.callToNative("toAppReportLogin")},e.prototype.reportCreateRole=function(){GameManager.instance.callToNative("toAppReportCreateRole")},e.prototype.share=function(){},e.prototype.addShortCut=function(){console.log("DefaultPlatform addShortCut")},e.prototype.createRoleExtra=function(){return"nil"},e}(egret.HashObject);__reflect(SEAAPPManager.prototype,"SEAAPPManager",["IPlatformManager"]);var TestManager=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"os",{get:function(){return egret.Capabilities.os},enumerable:!0,configurable:!0}),t.prototype.initPlatform=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return this.p_platformData={},console.log("DefaultPlatform initPlatform frendCode >= "+LoginManager.instance.p_friend_code),[2]})})},t.prototype.pay=function(t,e){console.log("DefaultPlatform pay")},t.prototype.callPlatformPay=function(t,e,i,s){console.log("DefaultPlatform callPlatformPay")},t.prototype.reportRegister=function(){console.log("DefaultPlatform reportRegister")},t.prototype.reportLogin=function(){console.log("DefaultPlatform reportLogin")},t.prototype.reportCreateRole=function(){console.log("DefaultPlatform reportCreateRole")},t.prototype.share=function(){},t.prototype.addShortCut=function(){console.log("DefaultPlatform addShortCut")},t.prototype.createRoleExtra=function(){return"nil"},t}();__reflect(TestManager.prototype,"TestManager",["IPlatformManager"]);var PlayerManager=function(t){function e(){var e=t.call(this)||this;return e.p_anger=0,e.m_setingList={},e.p_kefuUrl="",e.p_playerEffectIsShow=!0,e.p_playerIsShow=!0,e.m_adjustMsg="",e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.m_instance||(this.m_instance=new e),this.m_instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){MessageManager.register(MessageType.m_player_init_player_data_toc,this.m_init_player_data_toc,this),MessageManager.register(MessageType.m_player_notice_player_attr_change_toc,this.m_notice_player_attr_change_toc,this),MessageManager.register(MessageType.m_player_notice_player_string_attr_change_toc,this.m_notice_player_string_attr_change_toc,this),MessageManager.register(MessageType.m_player_notice_fun_active_toc,this.m_notice_fun_active_toc,this),MessageManager.register(MessageType.m_player_get_player_attr_toc,this.c_player_get_player_attr_toc,this),MessageManager.register(MessageType.m_player_change_name_toc,this.c_change_name,this),MessageManager.register(MessageType.m_player_set_player_data_toc,this.c_set_player_data,this),MessageManager.register(MessageType.m_scene_notice_anger_change_toc,this.c_set_anger,this),MessageManager.register(MessageType.m_player_customer_url_toc,this.c_player_customer_url,this),MessageManager.register(MessageType.m_player_adjust_toc,this.c_adjust_ok,this),MessageManager.register(MessageType.m_player_visitor_binding_toc,this.c_visitor_binding,this),MessageManager.register(MessageType.m_player_notice_player_adjust_value_toc,this.c_notice_player_adjust_value,this),MessageManager.register(MessageType.m_player_modify_nickname_gender_toc,this.c_modify_nickname_gender,this)},e.prototype.m_init_player_data_toc=function(t){this.p_playerInfo=t.role_data,ServerTimeManager.instance.initOpenServer(t.open_server_time),ServerTimeManager.instance.initDate(t.server_time),ActivityManager.instance.initData(t.activity_data),EntranceModule.instance.initData(),BagManager.instance.initData(t.prop_list),TimesManager.instance.initTimes(t.times_list),VipManager.instance.initData(t.vip_data),DailyTaskManager.instance.initData(t.daily_task_data_list,t.task_show),AchievementManager.instance.initData(t.achievement_data_list),TaskManager.instance.initData(t.task_info),FunctionManager.instance.initData(t.fun_id_list),SevenLoginManager.instance.initData(t.seven_login_data),EverydaySignManager.instance.initData(t.everyday_sign_data),MissionManager.instance.initPassMissionId(t.passed_mission_list),OnlineAwardManager.instance.initData(t.online_award_data),ChargeManager.instance.initData(t.charge_shop_data,t.first_charge_state),SysCommonManager.instance.initData(t.sysCommonDataList),MailManager.instance.initData(t.mail_real_id),PromoteManager.instance.initData(t.player_promote_data),PlatformFunctionManager.instance.p_shareCode=t.invitation_code,PlatformFunctionManager.instance.initData(t.share_task_award_data_list),this.p_anger=t.anger,HeroManager.instance.initData(t.player_hero),CardManager.instance.initData(t.card_book_list),LuckyDrawManager.instance.initData(t.seize_treasure_type_id,t.seize_times,t.seize_lucky_value),this.initSeting(t.client_data_list),Dispatch.dispatch(e.EVENT_PLAYER_INIT)},e.prototype.m_notice_player_string_attr_change_toc=function(t){for(var i,s=SceneItemModule.instance.getPlayer(t.player_id),n=0;n<t.list.length;n++){switch(i=t.list[n].value,t.list[n].attr){case proto.Attr.name:s.playerData.nickname=i,s.liveName=i,s instanceof AvatarMainPlayer&&(this.p_playerInfo.nickname=i)}s==this.p_mainPlayer&&Dispatch.dispatch(e.EVENT_PLAYER_INFO+t.list[n].attr)}},e.prototype.m_notice_player_attr_change_toc=function(t){var i=SceneItemModule.instance.getPlayer(t.player_id);if(null!=i)for(var s,n=0;n<t.list.length;n++){switch(s=t.list[n].value,t.list[n].attr){case proto.Attr.exp:i instanceof AvatarMainPlayer&&(this.p_playerInfo.exp=s);break;case proto.Attr.level:i.playerData.level=s,i instanceof AvatarMainPlayer&&(this.p_playerInfo.level=s,this.p_mainPlayer.upgradeLevel(),SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_1002),this.changeCreateName&&PopupModule.instance.showPop(PopupConfig.ID_CREATE_ROLE,null,!1));break;case proto.Attr.max_hp:i.playerData.max_hp=s;break;case proto.Attr.hp:i.playerData.hp=s,i.refreshHP(s);break;case proto.Attr.magic_weapon_id:i.playerData.magic_weapon_id=s,i.setMagicWeapon();break;case proto.Attr.hero_id:i.playerData.hero_id=s,i.setAvatarId(HeroJson.getData(s).avatar_id);break;case proto.Attr.hero_arms_id:i.playerData.hero_arms_id=s,i.setWeapon(),i instanceof AvatarMainPlayer&&FightSkillManager.instance.setAttackSpeed();break;case proto.Attr.hero_ornaments_id:i.playerData.hero_ornaments_id=s;break;case proto.Attr.move_speed:i.playerData.move_speed=s,i.moveSpeed=s/100*5/10*MyMapData.GRID_SIZE/PublicCon.DEL_FPS;break;case proto.Attr.title_id:i.playerData.title_id=s,i.setHead();break;case proto.Attr.vip_level:i.playerData.vip_level=s,i.setHead(),i instanceof AvatarMainPlayer&&(this.p_playerInfo.vip_level=s);break;case proto.Attr.sex:i.playerData.sex=s,i instanceof AvatarMainPlayer&&(this.p_playerInfo.sex=s);break;case proto.Attr.head_id:i.playerData.player_other_data.head_id=s,i instanceof AvatarMainPlayer&&(this.p_playerInfo.player_other_data.head_id=s);break;case proto.Attr.head_frame_id:i.playerData.player_other_data.head_frame_id=s,i instanceof AvatarMainPlayer&&(this.p_playerInfo.player_other_data.head_frame_id=s);break;case proto.Attr.chat_qi_pao_id:i.playerData.player_other_data.chat_qi_pao_id=s,i instanceof AvatarMainPlayer&&(this.p_playerInfo.player_other_data.chat_qi_pao_id=s),i.setChatBubble()}i==this.p_mainPlayer&&Dispatch.dispatch(e.EVENT_PLAYER_INFO+t.list[n].attr)}},e.prototype.m_notice_fun_active_toc=function(t){FunctionManager.instance.updateData(t.fun_id_list)},e.prototype.s_player_get_player_attr=function(t){var e=MessageProtocol.getClass(MessageType.m_player_get_player_attr_tos);e.player_id=t,MessageProtocol.sendMessage(MessageType.m_player_get_player_attr_tos,e)},e.prototype.c_player_get_player_attr_toc=function(t){Dispatch.dispatch(e.EVENT_PROPERTY+t.player_id,t.attr_data)},e.prototype.isPlayerNovice=function(t){void 0===t&&(t=0);var e=Number(StaticDataJson.getData("player_novice_condition").data),i=0;if(0==t)i=this.p_playerInfo.level;else{var s=SceneItemModule.instance.getPlayer(t);s&&s.playerData&&s.playerData.level&&(i=s.playerData.level)}return e>i?!0:!1},e.prototype.s_change_name=function(t){var e=MessageProtocol.getClass(MessageType.m_player_change_name_tos);e.name=t,MessageProtocol.sendMessage(MessageType.m_player_change_name_tos,e)},e.prototype.c_change_name=function(t){var e=proto.m_player_change_name_toc.ENUM;switch(t.result){case e.success:FloatTipModule.instance.popTip("成功改名");break;case e.used:FloatTipModule.instance.popTip("该名字已被使用");break;case e.invalid_string:FloatTipModule.instance.popTip("该名字含有敏感字");break;case e.too_long:FloatTipModule.instance.popTip("名字太长");break;case e.fail:FloatTipModule.instance.popTip("改名失败")}},e.prototype.s_set_player_data=function(t,e){var i=MessageProtocol.getClass(MessageType.m_player_set_player_data_tos);i.type=t,i.id=e,MessageProtocol.sendMessage(MessageType.m_player_set_player_data_tos,i)},e.prototype.c_set_player_data=function(t){var e=proto.m_player_set_player_data_toc.ENUM;switch(t.result){case e.success:break;case e.fail:FloatTipModule.instance.popTip("设置失败");break;case e.no_enough_prop:FloatTipModule.instance.popTip("未拥有该道具");break;case e.not_authority:FloatTipModule.instance.popTip(LanguageJson.getText("l_setting_not_authority"))}},e.prototype.c_set_anger=function(t){this.p_anger=t.anger,Dispatch.dispatch(e.EVENT_ANGER_SET)},e.prototype.s_player_customer_url=function(){var t=MessageProtocol.getClass(MessageType.m_player_customer_url_tos);MessageProtocol.sendMessage(MessageType.m_player_customer_url_tos,t)},e.prototype.c_player_customer_url=function(t){switch(t.result){case proto.m_player_customer_url_toc.ENUM.success:t.customer_url&&t.customer_url[0]&&(this.p_kefuUrl=t.customer_url[0].url)}},e.prototype.c_notice_player_adjust_value=function(t){Dispatch.dispatch(e.EVENT_TEST_MSG)},e.prototype.s_modify_nickname_gender=function(t,e){var i=MessageProtocol.getClass(MessageType.m_player_modify_nickname_gender_tos);i.gender=t,i.nickname=e,MessageProtocol.sendMessage(MessageType.m_player_modify_nickname_gender_tos,i)},e.prototype.c_modify_nickname_gender=function(t){switch(t.result){case proto.m_player_modify_nickname_gender_toc.ENUM.success:FloatTipModule.instance.popTipLanguage("l_createRole_tips_6"),e.instance.p_playerInfo.type=0,Dispatch.dispatch(e.EVENT_CREATE_ROLE_COM);break;case proto.m_player_modify_nickname_gender_toc.ENUM.used:FloatTipModule.instance.popTipLanguage("l_createRole_tips_1");break;case proto.m_player_modify_nickname_gender_toc.ENUM.invalid_string:FloatTipModule.instance.popTipLanguage("l_createRole_tips_2");break;case proto.m_player_modify_nickname_gender_toc.ENUM.too_long:FloatTipModule.instance.popTipLanguage("l_createRole_tips_3");break;case proto.m_player_modify_nickname_gender_toc.ENUM.fail:FloatTipModule.instance.popTipLanguage("l_createRole_tips_7");break;case proto.m_player_modify_nickname_gender_toc.ENUM.not_authority:FloatTipModule.instance.popTipLanguage("l_createRole_tips_8");break;case proto.m_player_modify_nickname_gender_toc.ENUM.unknown:FloatTipModule.instance.popTipLanguage("l_createRole_tips_4")}},e.prototype.s_visitor_binding=function(t,e){var i=MessageProtocol.getClass(MessageType.m_player_visitor_binding_tos);i.acc_id=t,i.channel=e,MessageProtocol.sendMessage(MessageType.m_player_visitor_binding_tos,i)},e.prototype.c_visitor_binding=function(t){var e="Google";switch(t.channel==URIManager.p_fb&&(e="Facebook"),t.result){case proto.m_player_visitor_binding_toc.ENUM.success:URIManager.p_isGuest=!1,PopupModule.instance.hidePop(PopupConfig.ID_ACCREDIT);var i=HtmlUtil.setText(LanguageJson.getText("l_accredit_success"),[e,e]);PopupModule.instance.showTishiSingle(i);break;case proto.m_player_visitor_binding_toc.ENUM.binding_same_acc_id:FloatTipModule.instance.popTipLanguage("l_accredit_use",[e]);break;default:FloatTipModule.instance.popTipLanguage("l_accredit_fail")}},e.prototype.registerADJust=function(t){this.m_adjustMsg=t,LoginManager.instance.p_isLogin&&this.s_player_adjust(this.m_adjustMsg)},e.prototype.sureADJustTo=function(){URIManager.is_platform&&""!=this.m_adjustMsg&&this.s_player_adjust(this.m_adjustMsg)},e.prototype.s_player_adjust=function(t){if(void 0===t&&(t=""),null!=t){var e=JSON.parse(t);if(null!=e){var i=[];for(var s in e){var n=new proto.m_player_adjust_tos.attr_change;n.attr=s,n.value=e[s],i.push(n)}this.m_adjustMsg="";var o=MessageProtocol.getClass(MessageType.m_player_adjust_tos);o.list=i,MessageProtocol.sendMessage(MessageType.m_player_adjust_tos,o)}}},e.prototype.c_adjust_ok=function(t){t.result==proto.m_player_adjust_toc.ENUM.success&&GameManager.instance.callToNative("toAppADJustOk","")},e.prototype.initSeting=function(t){this.m_setingList={};for(var e in t)this.m_setingList[t[e].id]=t[e].value},e.prototype.setingMsg=function(t,e){if(this.getSetingMsg(t)!=e){this.m_setingList[t]=e;var i=new proto.ClientData;i.id=t,i.value=e;var s=MessageProtocol.getClass(MessageType.m_player_update_client_data_tos);s.client_data_list=[i],MessageProtocol.sendMessage(MessageType.m_player_update_client_data_tos,s)}},e.prototype.deleteSetingMsg=function(t){this.m_setingList[t]&&delete this.m_setingList[t];var e=MessageProtocol.getClass(MessageType.m_player_delete_client_data_tos);e.id_list=[t],MessageProtocol.sendMessage(MessageType.m_player_delete_client_data_tos,e)},e.prototype.getSetingMsg=function(t){return this.m_setingList[t]},e.prototype.getEgretItem=function(t){return this.p_playerInfo?egret.localStorage.getItem(t+this.playerId):t},Object.defineProperty(e.prototype,"playerId",{get:function(){return this.p_playerInfo.player_id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"changeCreateName",{get:function(){return this.p_playerInfo.level>=2&&4==this.p_playerInfo.type},enumerable:!0,configurable:!0}),e.prototype.gotoKefu=function(){URIManager.p_isGuest?PopupModule.instance.showPop(PopupConfig.ID_ACCREDIT,null,!1):URIManager.is_platform||URIManager.p_h5Game?GameManager.instance.callToNative("toAppOpenKefu",e.instance.p_kefuUrl):window.open(e.instance.p_kefuUrl,"_blank")},e.EVENT_PLAYER_INIT="EVENT_PLAYER_INIT",e.EVENT_PLAYER_INFO="EVENT_PLAYER_INFO",e.EVENT_PROPERTY="EVENT_PROPERTY",e.EVENT_TOTAL_PROPERTY="EVENT_TOTAL_PROPERTY",e.EVENT_PLAYER_MODEL="EVENT_PLAYER_MODEL",e.EVENT_OTHERPLAYER_INFO="EVENT_OTHERPLAYER_INFO",e.EVENT_TEST_MSG="EVENT_TEST_MSG",e.EVENT_ANGER_SET="EVENT_ANGER_SET",e.EVENT_SHENLONG_DRAW="EVENT_SHENLONG_DRAW",e.EVENT_CREATE_ROLE_COM="EVENT_CREATE_ROLE_COM",e}(egret.HashObject);__reflect(PlayerManager.prototype,"PlayerManager");var PromoteManager=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){MessageManager.register(MessageType.m_promote_get_promote_record_toc,this.c_promote_get_promote_record,this),MessageManager.register(MessageType.m_promote_get_award_toc,this.c_promote_get_award,this),MessageManager.register(MessageType.m_promote_notice_player_promote_data_toc,this.c_promote_get_promote_info,this),MessageManager.register(MessageType.m_promote_notice_promote_times_toc,this.c_promote_notice_promote_record,this),MessageManager.register(MessageType.m_promote_invitation_code_toc,this.c_promote_invitation_code,this)},t.prototype.initData=function(t){this.p_player_promote=t,this.setFuncRed()},t.prototype.s_promote_get_promote_record=function(){var t=MessageProtocol.getClass(MessageType.m_promote_get_promote_record_tos);MessageProtocol.sendMessage(MessageType.m_promote_get_promote_record_tos,t)},t.prototype.c_promote_get_promote_record=function(e){this.p_player_promote.record_red=0,Dispatch.dispatch(t.EVENT_PROMOTE_INFO,e.promote_record_list),this.setFuncRed()},t.prototype.s_promote_get_award=function(){var t=MessageProtocol.getClass(MessageType.m_promote_get_award_tos);MessageProtocol.sendMessage(MessageType.m_promote_get_award_tos,t)},t.prototype.c_promote_get_award=function(t){switch(t.result){case proto.m_promote_get_award_toc.ENUM.success:this.showReward(t.mana,t.vip_exp);break;case proto.m_promote_get_award_toc.ENUM.fail:FloatTipModule.instance.popTipLanguage("l_promote_share_commission_2");break;case proto.m_promote_get_award_toc.ENUM.times_limit:FloatTipModule.instance.popTipLanguage("l_promote_share_commission_1");break;case proto.m_promote_get_award_toc.ENUM.none:FloatTipModule.instance.popTipLanguage("l_promote_share_commission")}},t.prototype.showReward=function(t,e){var i=[];0!=t&&i.push([ItemEnum.GOLD,t]),0!=e&&i.push([ItemEnum.RMB,e]),RewardModule.instance.receiveByList(i),SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_4004)},t.prototype.c_promote_get_promote_info=function(e){this.p_player_promote=e.player_promote_info_data,Dispatch.dispatch(t.EVENT_GET_PROMOTE_DATA),this.setFuncRed()},t.prototype.c_promote_notice_promote_record=function(e){var i=Number(StaticDataJson.getData("promote_award_today_times_limit").data);this.p_player_promote.times=i,Dispatch.dispatch(t.EVENT_TIMES_REFRESH),this.setFuncRed()},t.prototype.s_promote_invitation_code=function(t){var e=MessageProtocol.getClass(MessageType.m_promote_invitation_code_tos);e.invitation_code=t,MessageProtocol.sendMessage(MessageType.m_promote_invitation_code_tos,e)},t.prototype.c_promote_invitation_code=function(e){switch(e.result){case proto.m_promote_invitation_code_toc.ENUM.success:ServerListManager.instance.p_is_show_invited=0,FloatTipModule.instance.popTipLanguage("l_game_tips_8"),Dispatch.dispatch(t.EVENT_PROMOTE_CODE_UPDATA);break;case proto.m_promote_invitation_code_toc.ENUM.not_authority:FloatTipModule.instance.popTipLanguage("l_promote_invit_tips_3");break;default:FloatTipModule.instance.popTipLanguage("l_promote_invit_tips_2")}},t.prototype.isReward=function(){for(var t=this.p_player_promote.promote_info_list,e=0;e<t.length;e++)if(t[e].mana>0||t[e].vip_exp>0)return!0;return!1},t.prototype.setFuncRed=function(){var t=this.isReward(),e=this.p_player_promote.times>0,i=this.p_player_promote.record_red>0;RedNoticeManager.instance.dispatchRed(RedNoticeConfig.RED_PROMOTE,t&&e||i)},t.EVENT_GET_PROMOTE_DATA="EVENT_GET_PROMOTE_DATA",t.EVENT_TIMES_REFRESH="EVENT_TIMES_REFRESH",t.EVENT_PROMOTE_INFO="EVENT_PROMOTE_INFO",t.EVENT_PROMOTE_CODE_UPDATA="EVENT_PROMOTE_CODE_UPDATA",t
}();__reflect(PromoteManager.prototype,"PromoteManager");var PropManager=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){MessageManager.register(MessageType.m_prop_notice_update_prop_toc,this.c_prop_notice_update_prop,this)},t.prototype.c_prop_notice_update_prop=function(t){t.prop_list},t}();__reflect(PropManager.prototype,"PropManager");var RankManager=function(){function t(){this.selectFunId=0}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){MessageManager.register(MessageType.m_rank_get_rank_info_toc,this.c_rank_get_rank_info,this),MessageManager.register(MessageType.m_scene_get_gold_ranking_toc,this.c_scene_get_gold_ranking_toc,this),MessageManager.register(MessageType.m_scene_notice_first_gold_ranking_toc,this.c_scene_notice_first_gold_ranking_toc,this)},t.prototype.s_rank_get_rank_info=function(t,e){var i=MessageProtocol.getClass(MessageType.m_rank_get_rank_info_tos);i.fun_id=t,i.page_num=e,MessageProtocol.sendMessage(MessageType.m_rank_get_rank_info_tos,i)},t.prototype.c_rank_get_rank_info=function(e){this.rankInfo=e,Dispatch.dispatch(t.EVENT_RANK_INFO_UPDATE),e.fun_id,e.page_num,e.first_show_value,e.model_figure,e.my_rank,e.rank_info,e.total_num},t.prototype.s_scene_get_gold_ranking_tos=function(){var t=MessageProtocol.getClass(MessageType.m_scene_get_gold_ranking_tos);MessageProtocol.sendMessage(MessageType.m_scene_get_gold_ranking_tos,t)},t.prototype.c_scene_get_gold_ranking_toc=function(e){this.p_goldRankInfo=e,Dispatch.dispatch(t.EVENT_RANK_GOLD_INFO_UPDATE)},t.prototype.c_scene_notice_first_gold_ranking_toc=function(e){Dispatch.dispatch(t.EVENT_RANK_ONE_INFO,e)},t.EVENT_RANK_INFO_UPDATE="EVENT_RANK_INFO_UPDATE",t.EVENT_RANK_SELECT_UPDATE="EVENT_RANK_SELECT_UPDATE",t.EVENT_RANK_GOLD_INFO_UPDATE="EVENT_RANK_GOLD_INFO_UPDATE",t.EVENT_RANK_ONE_INFO="EVENT_RANK_ONE_INFO",t}();__reflect(RankManager.prototype,"RankManager");var RedNoticeBubble=function(){function t(){}return t.prototype.show=function(t,e,i,s){1==i?this.setRedPoint(t,e):2==i&&e.c_dataObj&&(1==e.c_dataObj.c_bubbleType?this.setBubbleTipMsg(t,e,s):2==e.c_dataObj.c_bubbleType?this.setBubbleTipImage(t,e,s):this.setBubbleTipOther(t,e,s))},t.prototype.setRedPoint=function(t,e){var i=e.c_mc,s=e.c_point;t?(this.m_redimg||(this.m_redimg=new eui.Image,this.m_redimg.source="commonUI_red",this.m_redimg.touchEnabled=!1),i.addChild(this.m_redimg),s?(this.m_redimg.x=s[0],this.m_redimg.y=s[1]):(this.m_redimg.right=10,this.m_redimg.top=5)):this.m_redimg&&this.m_redimg.parent&&this.m_redimg.parent.removeChild(this.m_redimg)},t.prototype.setBubbleTipMsg=function(t,e,i){var s=e.c_mc,n=e.c_point;t?(this.m_bubbleTip||(this.m_bubbleTip=new BubbleTip(n,s.width,s.height)),this.m_bubbleTip.showMsg(s,e.c_dataObj,1,i)):this.m_bubbleTip&&(this.m_bubbleTip.hide(),this.m_bubbleTip=null)},t.prototype.setBubbleTipImage=function(t,e,i){var s=e.c_mc,n=e.c_point;t?(this.m_bubbleImg||(this.m_bubbleImg=new BubbleTip(n,s.width,s.height)),this.m_bubbleImg.showMsg(s,e.c_dataObj,2,i)):this.m_bubbleImg&&(this.m_bubbleImg.hide(),this.m_bubbleImg=null)},t.prototype.setBubbleTipOther=function(t,e,i){},t}();__reflect(RedNoticeBubble.prototype,"RedNoticeBubble");var RedNoticeConfig=function(){function t(){}return t.RED_GAME_INIT="RED_GAME_INIT",t.RED_MAIL_INFO="RED_MAIL_INFO",t.RED_SEVEN_LOGIN="RED_SEVEN_LOGIN",t.RED_SIGN_IN="RED_SIGN_IN",t.RED_LUCKY_DRAW="RED_LUCKY_DRAW",t.RED_CHOU_KA="RED_CHOU_KA",t.RED_VIP_GET_AWARD="RED_VIP_GET_AWARD",t.RED_PROMOTE="RED_PROMOTE",t.RED_SHARE="RED_SHARE",t.RED_DRAGON="RED_DRAGON",t.RED_TURNTABLE_REWARD="RED_TURNTABLE_REWARD",t.RED_INVEST="RED_INVEST",t.RED_WITHDRAW="RED_WITHDRAW",t.RED_ACHIEVEMENT="RED_ACHIEVEMENT",t.RED_CARD_ZHUXIAN="RED_CARD_ZHUXIAN",t.RED_CARD_YAOZU="RED_CARD_YAOZU",t.RED_CARD_SHENZU="RED_CARD_SHENZU",t.RED_HERO="RED_HERO",t.RED_GOLD_TISHI="RED_GOLD_TISHI",t.RED_WITHDRAW_TISHI="RED_WITHDRAW_TISHI",t.RED_BOSS_SHOW_TIPS="RED_BOSS_SHOW_TIPS",t}();__reflect(RedNoticeConfig.prototype,"RedNoticeConfig");var RedNoticeManager=function(){function t(){this.m_registerList={},this.m_redEnumList={}}return t.prototype.initData=function(){this.dispatchRed(RedNoticeConfig.RED_GAME_INIT)},Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.registerRedBubbleTipMsg=function(t,e,i,s,n,o){void 0===i&&(i=1),void 0===s&&(s=!1),void 0===n&&(n=null),void 0===o&&(o=null),this.registerRed(t,o,n,{c_bubbleType:1,c_tipMsg:e,c_direction:i,c_isFloat:s},2)},t.prototype.registerRedBubbleTipImage=function(t,e,i,s,n,o){void 0===i&&(i=1),void 0===s&&(s=!0),void 0===n&&(n=null),void 0===o&&(o=null),this.registerRed(t,o,n,{c_bubbleType:2,c_iconName:e,c_direction:i,c_isFloat:s},2)},t.prototype.registerRedOpenUI=function(t,e,i,s){void 0===i&&(i=null),void 0===s&&(s=0),this.registerRed(t,e,i,s),t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onFunctionClick,this,!1,998)},t.prototype.onFunctionClick=function(t){var e=this.m_registerList[t.currentTarget.hashCode+"_1"];if(e.c_dataObj&&this.isShowRed(e.c_redNiticeList)){var i=e.c_dataObj;UIModule.instance.showUI(i,{isRedOpen:1}),t.stopPropagation(),t.stopImmediatePropagation()}},t.prototype.destroyRed=function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=1);var s=[],n=t.hashCode;if(e&&e.length>0&&this.m_registerList[n+"_"+i]&&this.m_registerList[n+"_"+i].c_redNiticeList)for(var o=this.m_registerList[n+"_"+i].c_redNiticeList,a=0;a<o.length;a++)-1==e.indexOf(o[a])&&s.push(o[a]);this.registerRed(t,s,null,null,i)},t.prototype.debugLogRed=function(){for(var t in this.m_registerList)if(this.m_registerList[t])for(var e=this.m_registerList[t].c_redNiticeList,i=0;i<e.length;i++)console.log("======================="+e[i],"========"+this.m_redEnumList[e[i]].c_isRed)},t.prototype.registerRed=function(t,e,i,s,n){if(void 0===i&&(i=null),void 0===s&&(s=null),void 0===n&&(n=1),null!=e){var o=t.hashCode;this.m_registerList[o+"_"+n]?(this.m_registerList[o+"_"+n].c_mc=t,this.m_registerList[o+"_"+n].c_redNiticeList=e,this.m_registerList[o+"_"+n].c_point=i,this.m_registerList[o+"_"+n].c_dataObj=s):this.m_registerList[o+"_"+n]={c_mc:t,c_redNiticeList:e,c_point:i,c_dataObj:s};for(var a=0;a<e.length;a++)if(this.m_redEnumList[e[a]]){var r=this.m_redEnumList[e[a]];r.c_mcKeyCode?-1==r.c_mcKeyCode.indexOf(o)&&r.c_mcKeyCode.push(o):r.c_mcKeyCode=[o],r.c_redType?-1==r.c_redType.indexOf(n)&&r.c_redType.push(n):r.c_redType=[n]}else this.m_redEnumList[e[a]]={c_mcKeyCode:[o],c_redType:[n]};this.showRedPoint(o,n)}},t.prototype.showRedPoint=function(t,e){if(this.m_registerList[t+"_"+e]){var i,s=!1,n=this.m_registerList[t+"_"+e].c_redNiticeList;if(n&&n.length>0)for(var o=0;o<n.length;o++)if(1==this.m_redEnumList[n[o]].c_isRed){s=!0,i=this.m_redEnumList[n[o]].c_dataObj;break}this.setRedPoint(s,this.m_registerList[t+"_"+e],e,i)}},t.prototype.dispatchRed=function(t,e,i){if(void 0===e&&(e=!0),void 0===i&&(i=null),this.m_redEnumList[t]?(this.m_redEnumList[t].c_isRed=e,this.m_redEnumList[t].c_dataObj=i):this.m_redEnumList[t]={c_isRed:e,c_dataObj:i},this.m_redEnumList[t].c_mcKeyCode)for(var s=this.m_redEnumList[t].c_mcKeyCode,n=0;n<s.length;n++)this.checkRed(s[n],this.m_redEnumList[t].c_redType,t);Dispatch.dispatch(t,e)},t.prototype.checkRed=function(t,e,i){for(var s=this.m_redEnumList[i].c_dataObj,n=this.m_redEnumList[i].c_isRed,o=0;o<e.length;o++)2==e[o]?this.m_registerList[t+"_"+e[o]]&&this.setRedPoint(n,this.m_registerList[t+"_"+e[o]],e[o],s):this.showRedPoint(t,1)},t.prototype.setRedPoint=function(t,e,i,s){void 0===s&&(s=null);var n;e.c_redBubbleTip?n=e.c_redBubbleTip:(n=new RedNoticeBubble,e.c_redBubbleTip=n),n.show(t,e,i,s)},t.prototype.isShowRed=function(t){if(t&&t.length>0)for(var e=0;e<t.length;e++)if(this.m_redEnumList[t[e]]&&1==this.m_redEnumList[t[e]].c_isRed)return!0;return!1},t}();__reflect(RedNoticeManager.prototype,"RedNoticeManager");var RedPacketManager=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){MessageManager.register(MessageType.m_red_packet_notice_player_red_packet_toc,this.c_red_packet_notice_player_red_packet,this),MessageManager.register(MessageType.m_red_packet_get_red_packet_toc,this.c_red_packet_get_red_packet,this),MessageManager.register(MessageType.m_red_packet_notice_player_red_packet_clear_toc,this.c_red_packet_notice_player_red_packet_clear,this)},t.prototype.c_red_packet_notice_player_red_packet=function(t){RedPacketModule.instance.createRedPack(t.red_packet)},t.prototype.s_red_packet_get_red_packet=function(t){var e=MessageProtocol.getClass(MessageType.m_red_packet_get_red_packet_tos);e.r_id=t,MessageProtocol.sendMessage(MessageType.m_red_packet_get_red_packet_tos,e)},t.prototype.c_red_packet_get_red_packet=function(t){t.result==proto.m_red_packet_get_red_packet_toc.ENUM.success?RedPacketModule.instance.receiveRedPack(t):RedPacketModule.instance.receiveRedPackFail(Number(t.r_id))},t.prototype.c_red_packet_notice_player_red_packet_clear=function(t){for(var e=0;e<t.r_id_list.length;e++)RedPacketModule.instance.recycleRedPack(Number(t.r_id_list[e]))},t}();__reflect(RedPacketManager.prototype,"RedPacketManager");var SceneManager=function(){function t(){this.p_sceneId=0,this.p_onPreLoadScene=!1,this.m_nearAvaPoint=new egret.Point}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){MessageManager.register(MessageType.m_scene_notice_prepare_scene_toc,this.c_scene_notice_prepare_scene_toc,this),MessageManager.register(MessageType.m_scene_enter_scene_toc,this.c_scene_enter_scene_toc,this),MessageManager.register(MessageType.m_scene_load_scene_toc,this.c_scene_load_scene_toc,this),MessageManager.register(MessageType.m_scene_sync_scene_toc,this.c_scene_sync_scene_toc,this),MessageManager.register(MessageType.m_scene_notice_scene_player_enter_toc,this.c_scene_notice_scene_player_enter_toc,this),MessageManager.register(MessageType.m_scene_notice_scene_player_leave_toc,this.c_scene_notice_scene_player_leave_toc,this),MessageManager.register(MessageType.m_scene_notice_player_move_toc,this.c_scene_notice_player_move_toc,this),MessageManager.register(MessageType.m_scene_notice_player_stop_move_toc,this.c_scene_notice_player_stop_move_toc,this),MessageManager.register(MessageType.m_scene_notice_obj_hp_change_toc,this.c_scene_notice_obj_hp_change_toc,this),MessageManager.register(MessageType.m_scene_notice_correct_player_pos_toc,this.c_scene_notice_correct_player_pos_toc,this),MessageManager.register(MessageType.m_scene_notice_player_teleport_toc,this.c_scene_notice_player_teleport_toc,this),MessageManager.register(MessageType.m_scene_notice_monster_enter_toc,this.c_scene_notice_monster_enter_toc,this),MessageManager.register(MessageType.m_scene_notice_monster_leave_toc,this.c_scene_notice_monster_leave_toc,this),MessageManager.register(MessageType.m_scene_notice_monster_move_toc,this.c_scene_notice_monster_move_toc,this),MessageManager.register(MessageType.m_scene_notice_monster_stop_move_toc,this.c_scene_notice_monster_stop_move_toc,this),MessageManager.register(MessageType.m_scene_notice_item_enter_toc,this.c_scene_notice_item_enter_toc,this),MessageManager.register(MessageType.m_scene_notice_item_leave_toc,this.c_scene_notice_item_leave_toc,this),MessageManager.register(MessageType.m_scene_player_rebirth_toc,this.c_scene_player_rebirth_toc,this),MessageManager.register(MessageType.m_scene_notice_player_death_toc,this.c_scene_notice_player_death_toc,this),MessageManager.register(MessageType.m_scene_query_player_pos_toc,this.c_scene_query_player_pos_toc,this),MessageManager.register(MessageType.m_scene_notice_scene_item_owner_change_toc,this.c_scene_notice_scene_item_owner_change_toc,this),MessageManager.register(MessageType.m_scene_notice_prepare_transmit_toc,this.c_scene_notice_prepare_transmit_toc,this),MessageManager.register(MessageType.m_scene_notice_start_yuchao_toc,this.c_scene_notice_start_yuchao,this),MessageManager.register(MessageType.m_scene_notice_stop_yuchao_toc,this.c_scene_notice_stop_yuchao,this),MessageManager.register(MessageType.m_scene_notice_monster_attr_change_toc,this.c_notice_monster_attr_change_toc,this),MessageManager.register(MessageType.m_scene_update_npc_date_toc,this.c_scene_update_npc_date_toc,this),MessageManager.register(MessageType.m_scene_notice_monster_list_toc,this.c_notice_monster_list,this),MessageManager.register(MessageType.m_scene_notice_special_skill_change_toc,this.c_special_skill_change,this),MessageManager.register(MessageType.m_scene_notice_yu_chao_start_time_toc,this.c_scene_notice_yu_chao_start_time,this),MessageManager.register(MessageType.m_scene_notice_send_msg_toc,this.c_scene_notice_send_msg_toc,this),MessageManager.register(MessageType.m_scene_notice_boss_state_toc,this.c_scene_notice_boss_state_toc,this),MessageManager.register(MessageType.m_scene_notice_monster_teleport_toc,this.c_notice_monster_teleport,this),MessageManager.register(MessageType.m_scene_player_collect_tos,this.s_scene_player_collect_tos,this)},t.prototype.c_scene_challenge_boss_tos=function(){var t=MessageProtocol.getClass(MessageType.m_scene_challenge_boss_tos);MessageProtocol.sendMessage(MessageType.m_scene_challenge_boss_tos,t)},t.prototype.s_scene_send_msg_tos=function(t,e){var i=MessageProtocol.getClass(MessageType.m_scene_send_msg_tos);i.id=e,i.type=t,MessageProtocol.sendMessage(MessageType.m_scene_send_msg_tos,i)},t.prototype.c_scene_notice_send_msg_toc=function(t){SceneModule.instance.noticePlayerBubbleLine(t)},t.prototype.s_scene_enter_scene_tos=function(t){if(1!=this.p_onPreLoadScene){var e=MessageProtocol.getClass(MessageType.m_scene_enter_scene_tos);e.scene_id=t,MessageProtocol.sendMessage(MessageType.m_scene_enter_scene_tos,e)}},t.prototype.c_scene_enter_scene_toc=function(t){t.result==proto.m_scene_enter_scene_toc.ENUM.fail?FloatTipModule.instance.popTipLanguage("l_scene_select_tips_4"):t.result==proto.m_scene_enter_scene_toc.ENUM.no_enough_prop?FloatTipModule.instance.popTipLanguage("l_game_tips_2"):t.result==proto.m_scene_enter_scene_toc.ENUM.not_authority&&FloatTipModule.instance.popTipLanguage("l_game_tips_3")},t.prototype.s_scene_load_scene_tos=function(){PlayerManager.instance.p_mainPlayer&&MoveManager.instance.stopMove(PlayerManager.instance.p_mainPlayer);var t=MessageProtocol.getClass(MessageType.m_scene_load_scene_tos);t.screen_width=StageManager.instance.p_stageWidth,t.screen_high=StageManager.instance.p_stageHeight,MessageProtocol.sendMessage(MessageType.m_scene_load_scene_tos,t)},t.prototype.s_scene_player_move_tos=function(t,e){var i=MessageProtocol.getClass(MessageType.m_scene_player_move_tos);i.x=t,i.y=e,MessageProtocol.sendMessage(MessageType.m_scene_player_move_tos,i)},t.prototype.s_scene_player_move_step_tos=function(t,e){var i=MessageProtocol.getClass(MessageType.m_scene_player_move_step_tos);i.x=t,i.y=e,MessageProtocol.sendMessage(MessageType.m_scene_player_move_step_tos,i)},t.prototype.s_scene_player_stop_move_tos=function(t,e){var i=MessageProtocol.getClass(MessageType.m_scene_player_stop_move_tos);i.x=t,i.y=e,MessageProtocol.sendMessage(MessageType.m_scene_player_stop_move_tos,i)},t.prototype.s_scene_player_collect_tos=function(t){if(0!=t.length){var e=MessageProtocol.getClass(MessageType.m_scene_player_collect_tos);e.scene_item_id=t,MessageProtocol.sendMessage(MessageType.m_scene_player_collect_tos,e)}},t.prototype.c_scene_notice_scene_item_owner_change_toc=function(t){SceneModule.instance.noticeSceneItemOwnerChange(t)},t.prototype.c_scene_notice_prepare_scene_toc=function(e){if(this.p_onPreLoadScene=!0,this.p_sceneId=e.scene_id,this.p_sceneJson=SceneJson.getData(this.p_sceneId),DelayCallUtils.killDelayedCallsTo(FightUIModule.instance.setStartSkill,FightUIModule.instance),Dispatch.dispatch(t.EVENT_INIT_SCENE),UIModule.instance.hideUI(UIConfig.ID_SCENE_SELECT),this.c_scene_notice_stop_yuchao(null),this.p_lastSceneType=this.p_sceneType,this.p_sceneType=this.p_sceneJson.type,SceneModule.instance.preloadScene(e),this.p_sceneId!=SceneModule.instance.mainSceneId&&this.p_sceneType!=SceneTypeEnum.MISSION){var i=Number(PlayerManager.instance.getSetingMsg(GameSetConfig.k_last_scene));this.p_sceneId!=i&&PlayerManager.instance.setingMsg(GameSetConfig.k_last_scene,this.p_sceneId.toString())}SoundMoude.instance.proLoadSound()},t.prototype.c_scene_load_scene_toc=function(t){SceneModule.instance.loadScene(t),this.p_onPreLoadScene=!1,SoundMoude.instance.playSound()},t.prototype.c_scene_sync_scene_toc=function(e){SceneModule.instance.syncScene(e),Dispatch.dispatch(t.EVENT_SYNC_SCENE)},t.prototype.c_scene_notice_scene_player_enter_toc=function(t){SceneModule.instance.playerEnterScene(t)},t.prototype.c_scene_notice_scene_player_leave_toc=function(t){SceneModule.instance.playerLeaveScene(t)},t.prototype.c_scene_notice_player_move_toc=function(t){SceneModule.instance.noticePlayerMove(t)},t.prototype.c_scene_notice_player_stop_move_toc=function(t){SceneModule.instance.noticePlayerStopMove(t)},t.prototype.c_scene_notice_obj_hp_change_toc=function(t){FightModule.instance.noticeObjHpChange(t)},t.prototype.c_scene_notice_correct_player_pos_toc=function(t){SceneModule.instance.correctPlayerPos(t)},t.prototype.c_scene_notice_player_teleport_toc=function(t){SceneModule.instance.doPlyerTeleport(t)},t.prototype.c_scene_notice_monster_enter_toc=function(t){SceneModule.instance.monsterEnterScene(t)},t.prototype.c_scene_notice_monster_leave_toc=function(t){SceneModule.instance.monsterLeaveScene(t)},t.prototype.c_scene_notice_monster_move_toc=function(t){SceneModule.instance.noticeMonsterMove(t)},t.prototype.c_scene_notice_start_yuchao=function(t){SceneModule.instance.p_ycContinueTime=t.continue_time,SceneModule.instance.p_ycStopTime=Number(t.stop_time),FightUIModule.instance.hideMonsterPreCome(),FightUIModule.instance.showMonsterComing(),FightUIModule.instance.showCountDown(3,Number(t.stop_time),1e3*t.continue_time)},t.prototype.c_scene_notice_stop_yuchao=function(t){SceneModule.instance.p_ycContinueTime=0,SceneModule.instance.p_ycStopTime=0,FightUIModule.instance.hideCountDown(),FightUIModule.instance.hideMonsterPreCome()},t.prototype.c_notice_monster_attr_change_toc=function(e){var i=SceneItemModule.instance.getMonster(e.scene_monster_id);if(i){for(var s in e.list)e.list[s].monsterattr==proto.Attr.belong_player_id&&(i.dataMonster.belong_player_id=e.list[s].value);Dispatch.dispatch(t.EVENT_MONSTER_ATTR_CHANGE+e.scene_monster_id)}},t.prototype.c_scene_notice_monster_stop_move_toc=function(t){SceneModule.instance.noticeMonsterStopMove(t)},t.prototype.c_scene_notice_prepare_transmit_toc=function(t){PlayerManager.instance.p_mainPlayer.setChuangSong()},t.prototype.s_notice_monster_list=function(){var t=MessageProtocol.getClass(MessageType.m_scene_get_monster_list_tos);MessageProtocol.sendMessage(MessageType.m_scene_get_monster_list_tos,t)},t.prototype.c_notice_monster_list=function(t){var e=t.monster_list;if(e&&PlayerManager.instance.p_mainPlayer){var i=PlayerManager.instance.p_mainPlayer.getPos(),s=void 0;for(var n in e){var o=e[n];this.m_nearAvaPoint.x=o.x-i.x,this.m_nearAvaPoint.y=o.y-i.y,s?this.m_nearAvaPoint.length<s.lg&&(s={mc:o,lg:this.m_nearAvaPoint.length}):s={mc:o,lg:this.m_nearAvaPoint.length}}if(s&&s.mc){var a=s.mc;MoveManager.instance.quickMove(a.x,a.y)}}},t.prototype.c_special_skill_change=function(t){FightUIModule.instance.setStartSkill(t.player_id,t.special_skill_id,t.special_skill_expire_time)},t.prototype.c_scene_notice_yu_chao_start_time=function(t){FightUIModule.instance.showMonsterPreCome(t.time)},t.prototype.c_scene_notice_boss_state_toc=function(e){return SceneModule.instance.isMissionScene?void(SceneModule.instance.p_bossInfo=e):(e.mission_id<=0&&e.state<=0&&(UIModule.instance.setEventBubble(!1),PopupModule.instance.hidePop(PopupConfig.ID_BOSS_EVENT)),void(SceneModule.instance.p_bossInfo&&SceneModule.instance.p_bossInfo.mission_id==e.mission_id&&SceneModule.instance.p_bossInfo.mission_type==e.mission_type?(SceneModule.instance.p_bossInfo=e,Dispatch.dispatch(t.EVENT_BOSS_EVENT)):(SceneModule.instance.p_bossInfo=e,e.mission_id>0&&FightUIModule.instance.showBossEvent())))},t.prototype.c_notice_monster_teleport=function(t){SceneModule.instance.noticeMonsterTeleport(t)},t.prototype.c_scene_notice_item_enter_toc=function(t){SceneModule.instance.noticItemEnterScene(t)},t.prototype.c_scene_notice_item_leave_toc=function(t){SceneModule.instance.noticItemLeaveScene(t)},t.prototype.s_scene_player_rebirth_tos=function(){var t=MessageProtocol.getClass(MessageType.m_scene_player_rebirth_tos);MessageProtocol.sendMessage(MessageType.m_scene_player_rebirth_tos,t)},t.prototype.c_scene_player_rebirth_toc=function(e){e.result==proto.m_scene_player_rebirth_toc.ENUM.success?(PlayerManager.instance.p_mainPlayer.shiftToAction(AvatarConfig.ACTION_stand),Dispatch.dispatch(t.EVENT_MAINPLAYER_REBIRTH)):FloatTipModule.instance.popTip("原地复活失败")},t.prototype.c_scene_notice_player_death_toc=function(e){Dispatch.dispatch(t.EVENT_MAINPLAYER_DIE)},t.prototype.s_scene_query_player_pos_tos=function(t,e){var i=MessageProtocol.getClass(MessageType.m_scene_query_player_pos_tos);i.player_id=t,i.type=e,MessageProtocol.sendMessage(MessageType.m_scene_query_player_pos_tos,i)},t.prototype.c_scene_query_player_pos_toc=function(e){Dispatch.dispatch(t.EVENT_PLAYER_POINT,e)},t.prototype.c_scene_update_npc_date_toc=function(t){for(var e=0;e<t.npc_data.length;e++)this.updateNpcData(t.npc_data[e])},t.prototype.updateNpcData=function(t){var e=SceneItemModule.instance.getNpc(t.npc_id);null==e?SceneItemModule.instance.createNpc(t.npc_id,t.x,t.y):(e.npcId=t.npc_id,e.setPos(t.x,t.y),e.setAvatarId(e.jsonNpc.avatar_id)),e=SceneItemModule.instance.getNpc(t.npc_id),0==e.isShow&&(e.isShow=!0),e.liveName=(""==t.npc_name?e.jsonNpc.name:t.npc_name)+(URIManager.isdebug?" npcid:"+e.jsonNpc.id:"")},t.prototype.isCourseGuide=function(){var t=PlayerManager.instance.getSetingMsg(GameSetConfig.k_course_guide);t&&"1"==t||(PlayerManager.instance.setingMsg(GameSetConfig.k_course_guide,"1"),PopupModule.instance.showPop(PopupConfig.ID_COURSE,null,!1))},t.EVENT_INIT_SCENE="EVENT_INIT_SCENE",t.EVENT_ENTER_SCENE="EVENT_ENTER_SCENE",t.EVENT_SYNC_SCENE="EVENT_SYNC_SCENE",t.EVENT_MAINPLAYER_REBIRTH="EVENT_MAINPLAYER_REBIRTH",t.EVENT_MAINPLAYER_DIE="EVENT_MAINPLAYER_DIE",t.EVENT_PLAYER_POINT="EVENT_PLAYER_POINT",t.EVENT_MONSTER_ATTR_CHANGE="EVENT_MONSTER_ATTR_CHANGE",t.EVENT_PLAYER_SKILL="EVENT_PLAYER_SKILL",t.EVENT_GOLD_RANK="EVENT_GOLD_RANK",t.EVENT_BOSS_EVENT="EVENT_BOSS_EVENT",t.EVENT_GOD_DRAGON_EFFECT="EVENT_GOD_DRAGON_EFFECT",t}();__reflect(SceneManager.prototype,"SceneManager");var ServerTimeManager=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){MessageManager.register(MessageType.m_player_get_server_time_toc,this.c_set_server_time,this)},t.prototype.initOpenServer=function(t){this.m_open_server_time=t},t.prototype.initDate=function(t){this.m_serverTime=Number(t),this.m_serverTimeRecTime=egret.getTimer()},t.prototype.s_get_server_time=function(){var t=MessageProtocol.getClass(MessageType.m_player_get_server_time_tos);MessageProtocol.sendMessage(MessageType.m_player_get_server_time_tos,t)},t.prototype.c_set_server_time=function(t){this.m_serverTime=Number(t.server_time),this.m_serverTimeRecTime=egret.getTimer()},t.prototype.getServerDate=function(){return new Date(this.timerValue)},Object.defineProperty(t.prototype,"timer",{get:function(){return Math.floor((this.m_serverTime+(egret.getTimer()-this.m_serverTimeRecTime))/1e3)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"timerValue",{get:function(){return this.m_serverTime+egret.getTimer()-this.m_serverTimeRecTime},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"timeOpenServer",{get:function(){return this.m_open_server_time},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"openServerTime",{get:function(){var t=new Date(1e3*this.timeOpenServer),e=String(t.getFullYear())+TimeUtil.formatZero(t.getMonth()+1)+TimeUtil.formatZero(t.getDate())+"000001",i=this.getServerTimeByNumStr(e);return i/1e3},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dayOpenServer",{get:function(){var t=new Date(1e3*this.timeOpenServer),e=String(t.getFullYear())+TimeUtil.formatZero(t.getMonth()+1)+TimeUtil.formatZero(t.getDate())+"235959",i=this.getServerTimeByNumStr(e);if(this.timerValue<=i)return 1;var s=(this.timerValue-i)/1e3;return Math.ceil(s/86400)+1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dayOpenServerRemanent",{get:function(){var t=new Date(1e3*this.timeOpenServer),e=String(t.getFullYear())+TimeUtil.formatZero(t.getMonth()+1)+TimeUtil.formatZero(t.getDate())+"235959",i=this.getServerTimeByNumStr(e);return i-this.m_open_server_time},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onlineTime",{get:function(){return OnlineAwardManager.instance.online_time+Math.floor((egret.getTimer()-this.m_serverTimeRecTime)/1e3)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"weekDay",{get:function(){var t=this.getServerDate().getDay();return 0==t?7:t},enumerable:!0,configurable:!0}),t.prototype.givenDayWeek=function(t){var e=new Date(1e3*t),i=e.getDay();return 0==i?7:i},t.prototype.isInTimeStrAll=function(t){var e=t.split("_"),i=this.getServerTimeByNumStr(String(e[0])),s=this.getServerTimeByNumStr(String(e[1]));return i<=1e3*this.timer&&s>=1e3*this.timer?!0:!1},t.prototype.getServerTimeByNumStr=function(t){return this.getDateByNumStr(t).valueOf()},t.prototype.getDateByNumStr=function(t){var e=Number(t.substr(0,4)),i=Number(t.substr(4,2))-1,s=Number(t.substr(6,2)),n=Number(t.substr(8,2)),o=Number(t.substr(10,2)),a=Number(t.substr(12,2));return new Date(e,i,s,n,o,a)},t.prototype.isToday=function(t){var e,i=this.getServerDate(),s=new Date(1e3*t);return e=i.getFullYear()==s.getFullYear()&&i.getMonth()==s.getMonth()&&i.getDate()==s.getDate()?!0:!1},t.prototype.yearMonth=function(){var t=this.getServerDate();return t.getMonth()+1<10?String(t.getFullYear())+"0"+String(t.getMonth()+1):String(t.getFullYear())+String(t.getMonth()+1)},t.prototype.getToday=function(){var t=this.getServerDate();return t.getDate()<10?"0"+t.getDate():String(t.getDate())},t.prototype.getTodayTimes=function(t){return this.getServerTimeByNumStr(this.yearMonth()+this.getToday()+t)/1e3},t.prototype.getTodayData=function(){var t=this.getServerDate();return t.getFullYear()+""+t.getMonth()+t.getDate()},t.ZERO_POINT_EVENT="ZERO_POINT_EVENT",t}();__reflect(ServerTimeManager.prototype,"ServerTimeManager");var SevenLoginManager=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){MessageManager.register(MessageType.m_seven_login_give_award_toc,this.c_seven_login_give_award,this),MessageManager.register(MessageType.m_seven_login_update_cumulative_day_toc,this.c_seven_login_update_cumulative_day,this),Dispatch.register(FunctionManager.FUNCTION_OPEN_UPDATE+FunctionEnum.SEVEN_LOGIN_SYS,this.initOpen,this)},t.prototype.initOpen=function(){RedNoticeManager.instance.dispatchRed(RedNoticeConfig.RED_SEVEN_LOGIN,this.isReceiveSure)},t.prototype.initData=function(t){this.m_already_give_list=t.already_give_list,this.m_cumulative_day=t.cumulative_day,this.isReceiveFinish&&EntranceModule.instance.setEntranceVisible(!1,FunctionEnum.SEVEN_LOGIN_SYS),this.setRedNotice()},t.prototype.s_seven_login_give_award=function(t){var e=MessageProtocol.getClass(MessageType.m_seven_login_give_award_tos);e.today=t,MessageProtocol.sendMessage(MessageType.m_seven_login_give_award_tos,e)},t.prototype.c_seven_login_give_award=function(e){switch(e.result){case proto.m_seven_login_give_award_toc.ENUM.success:this.m_already_give_list.push(e.today),ArrayUtils.setSortNum(this.m_already_give_list,0),Dispatch.dispatch(t.SEVENTLOGIN_SUCCESS,e.today,e.dice_id,e.dice_list),this.isReceiveFinish&&EntranceModule.instance.setEntranceVisible(!1,FunctionEnum.SEVEN_LOGIN_SYS),this.setRedNotice();break;case proto.m_seven_login_give_award_toc.ENUM.not_authority:FloatTipModule.instance.popTipLanguage("l_vip_tips_4");break;case proto.m_seven_login_give_award_toc.ENUM.function_no_open:FloatTipModule.instance.popTipLanguage("l_game_tips_9");break;case proto.m_seven_login_give_award_toc.ENUM.already_have:FloatTipModule.instance.popTipLanguage("l_game_tips_5");break;default:FloatTipModule.instance.popTipLanguage("l_game_tips_13")}},t.prototype.c_seven_login_update_cumulative_day=function(e){this.m_cumulative_day=e.cumulative_day,Dispatch.dispatch(t.SEVENTLOGIN_UPDATE),this.setRedNotice()},t.prototype.getStateByDay=function(t){return t>this.m_cumulative_day?0:-1!=this.m_already_give_list.indexOf(t)?2:1},Object.defineProperty(t.prototype,"isReceiveFinish",{get:function(){return 7==this.m_already_give_list.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isReceiveSure",{get:function(){return FunctionManager.instance.getOpenFuncId(FunctionEnum.SEVEN_LOGIN_SYS)?this.m_already_give_list.length<this.m_cumulative_day:!1},enumerable:!0,configurable:!0}),t.prototype.setRedNotice=function(){RedNoticeManager.instance.dispatchRed(RedNoticeConfig.RED_SEVEN_LOGIN,this.isReceiveSure)},t.SEVENTLOGIN_UPDATE="SEVENTLOGIN_UPDATE",t.SEVENTLOGIN_SUCCESS="SEVENTLOGIN_SUCCESS",t}();__reflect(SevenLoginManager.prototype,"SevenLoginManager");var ShiShiRoomManager=function(){function t(){this.p_roomId=0,this.p_totalValue=0,this.p_roomMaxPeople=0,this.m_room_player_data={}}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){MessageManager.register(MessageType.m_shi_shi_room_get_room_list_toc,this.c_shi_shi_room_get_room_list,this),MessageManager.register(MessageType.m_shi_shi_room_create_room_toc,this.c_shi_shi_room_create_room,this),MessageManager.register(MessageType.m_shi_shi_room_join_room_toc,this.c_shi_shi_room_join_room,this),MessageManager.register(MessageType.m_shi_shi_room_start_toc,this.c_shi_shi_room_start,this),MessageManager.register(MessageType.m_shi_shi_room_ready_toc,this.c_shi_shi_room_ready,this),MessageManager.register(MessageType.m_shi_shi_room_notice_leave_room_toc,this.c_shi_shi_room_notice_leave_room,this),MessageManager.register(MessageType.m_shi_shi_room_notice_player_join_toc,this.c_shi_shi_room_notice_player_join,this),MessageManager.register(MessageType.m_shi_shi_room_notice_player_leave_toc,this.c_shi_shi_room_notice_player_leave,this),MessageManager.register(MessageType.m_shi_shi_room_notice_player_ready_toc,this.c_shi_shi_room_notice_player_ready,this),MessageManager.register(MessageType.m_shi_shi_room_notice_player_fight_start_toc,this.c_shi_shi_room_notice_player_fight_start,this),MessageManager.register(MessageType.m_shi_shi_room_notice_room_owner_change_toc,this.c_shi_shi_room_notice_room_owner_change,this),MessageManager.register(MessageType.m_shi_shi_room_notice_player_fight_result_toc,this.c_shi_shi_room_notice_player_fight_result,this),MessageManager.register(MessageType.m_shi_shi_room_notice_shi_shi_value_toc,this.c_shi_shi_room_notice_shi_shi_value,this)},t.prototype.s_shi_shi_room_get_room_list=function(t){var e=MessageProtocol.getClass(MessageType.m_shi_shi_room_get_room_list_tos);e.mission_id=t,MessageProtocol.sendMessage(MessageType.m_shi_shi_room_get_room_list_tos,e)
},t.prototype.c_shi_shi_room_get_room_list=function(e){Dispatch.dispatch(t.EVENT_SHISHIROOM_GET_ROOMLIST,e.mission_id,e.room_data_list)},t.prototype.s_shi_shi_room_create_room=function(t,e,i){var s=MessageProtocol.getClass(MessageType.m_shi_shi_room_create_room_tos);s.mission_id=t,s.is_lock=e,s.password=i,MessageProtocol.sendMessage(MessageType.m_shi_shi_room_create_room_tos,s)},t.prototype.c_shi_shi_room_create_room=function(e){switch(e.result){case proto.m_shi_shi_room_create_room_toc.ENUM.success:FloatTipModule.instance.popTipLanguage("l_multi_popTip_1"),this.p_roomId=e.room_details_data.room_data.room_id,this.p_roomInfo=e.room_details_data,this.setRoomDetailInfo(),Dispatch.dispatch(t.EVENT_SHISHIROOM_CREATE_ROOM);break;case proto.m_shi_shi_room_create_room_toc.ENUM.fail:FloatTipModule.instance.popTipLanguage("l_multi_popTip_2");break;case proto.m_shi_shi_room_create_room_toc.ENUM.no_condition:FloatTipModule.instance.popTipLanguage("l_game_tips_15");break;case proto.m_shi_shi_room_create_room_toc.ENUM.already_join_room:FloatTipModule.instance.popTipLanguage("l_multi_popTip_3");break;case proto.m_shi_shi_room_create_room_toc.ENUM.none:FloatTipModule.instance.popTipLanguage("l_multi_popTip_4")}},t.prototype.setRoomDetailInfo=function(){this.m_room_player_data={};for(var t in this.p_roomInfo.room_player_data_list){var e=this.p_roomInfo.room_player_data_list[t].pos_id;this.m_room_player_data[e]=this.p_roomInfo.room_player_data_list[t]}},t.prototype.s_shi_shi_room_join_room=function(t,e,i){var s=MessageProtocol.getClass(MessageType.m_shi_shi_room_join_room_tos);s.room_id=t,s.password=e,s.invitation_code=i,MessageProtocol.sendMessage(MessageType.m_shi_shi_room_join_room_tos,s)},t.prototype.c_shi_shi_room_join_room=function(e){switch(e.result){case proto.m_shi_shi_room_join_room_toc.ENUM.success:FloatTipModule.instance.popTipLanguage("l_multi_popTip_10"),this.p_roomId=e.room_details_data.room_data.room_id,this.p_roomInfo=e.room_details_data,this.setRoomDetailInfo(),Dispatch.dispatch(t.EVENT_SHISHIROOM_JOIN_ROOM);break;case proto.m_shi_shi_room_join_room_toc.ENUM.fail:FloatTipModule.instance.popTipLanguage("l_multi_popTip_11");break;case proto.m_shi_shi_room_join_room_toc.ENUM.not_enough_mana:FloatTipModule.instance.popTipLanguage("l_game_tips_2");break;case proto.m_shi_shi_room_join_room_toc.ENUM.not_authority:FloatTipModule.instance.popTipLanguage("l_multi_popTip_12");break;case proto.m_shi_shi_room_join_room_toc.ENUM.no_condition:FloatTipModule.instance.popTipLanguage("l_game_tips_15");break;case proto.m_shi_shi_room_join_room_toc.ENUM.already_join_room:FloatTipModule.instance.popTipLanguage("l_multi_popTip_3");break;case proto.m_shi_shi_room_join_room_toc.ENUM.error_password:FloatTipModule.instance.popTipLanguage("l_multi_popTip_13");break;case proto.m_shi_shi_room_join_room_toc.ENUM.none:FloatTipModule.instance.popTipLanguage("l_multi_popTip_14");break;case proto.m_shi_shi_room_join_room_toc.ENUM.time_limit:FloatTipModule.instance.popTipLanguage("l_multi_popTip_15")}},t.prototype.s_shi_shi_room_start=function(){var t=MessageProtocol.getClass(MessageType.m_shi_shi_room_start_tos);MessageProtocol.sendMessage(MessageType.m_shi_shi_room_start_tos,t)},t.prototype.c_shi_shi_room_start=function(t){switch(t.result){case proto.m_many_people_boss_start_toc.ENUM.success:SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_1001);break;case proto.m_many_people_boss_start_toc.ENUM.fail:FloatTipModule.instance.popTipLanguage("l_multi_popTip_5");break;case proto.m_many_people_boss_start_toc.ENUM.not_authority:FloatTipModule.instance.popTipLanguage("l_multi_popTip_6");break;case proto.m_many_people_boss_start_toc.ENUM.not_enough_number:FloatTipModule.instance.popTipLanguage("l_multi_popTip_7");break;case proto.m_many_people_boss_start_toc.ENUM.already_start:FloatTipModule.instance.popTipLanguage("l_multi_popTip_8");break;case proto.m_many_people_boss_start_toc.ENUM.no_condition:FloatTipModule.instance.popTipLanguage("l_multi_popTip_9")}},t.prototype.s_shi_shi_room_kick_out_player=function(t){var e=MessageProtocol.getClass(MessageType.m_shi_shi_room_kick_out_player_tos);e.pos_id=t,MessageProtocol.sendMessage(MessageType.m_shi_shi_room_kick_out_player_tos,e)},t.prototype.s_shi_shi_room_ready=function(t){var e=MessageProtocol.getClass(MessageType.m_shi_shi_room_ready_tos);e.is_ready=t,MessageProtocol.sendMessage(MessageType.m_shi_shi_room_ready_tos,e)},t.prototype.c_shi_shi_room_ready=function(e){switch(e.result){case proto.m_many_people_boss_ready_toc.ENUM.success:0==e.is_ready?FloatTipModule.instance.popTipLanguage("l_multi_popTip_18"):FloatTipModule.instance.popTipLanguage("l_multi_popTip_19"),Dispatch.dispatch(t.EVENT_SHISHIROOM_MY_READY,e.is_ready);break;case proto.m_many_people_boss_ready_toc.ENUM.fail:FloatTipModule.instance.popTipLanguage("l_multi_popTip_20");break;case proto.m_many_people_boss_ready_toc.ENUM.not_enough_mana:FloatTipModule.instance.popTipLanguage("l_game_tips_2")}},t.prototype.s_shi_shi_room_leave_room=function(){var t=MessageProtocol.getClass(MessageType.m_shi_shi_room_leave_room_tos);MessageProtocol.sendMessage(MessageType.m_shi_shi_room_leave_room_tos,t)},t.prototype.c_shi_shi_room_notice_leave_room=function(t){this.noticeLeave(t.type)},t.prototype.noticeLeave=function(e){this.p_roomId=0;var i="",s="";1==e?(i=LanguageJson.getText("l_multi_room_tips_4"),s=LanguageJson.getText("l_btn_ok"),PopupModule.instance.showTishiSingle(i,null,null,s)):2==e&&(i=LanguageJson.getText("l_multi_room_tips_5"),s=LanguageJson.getText("l_btn_ok"),PopupModule.instance.showTishiSingle(i,null,null,s)),Dispatch.dispatch(t.EVENT_SHISHIROOM_SELF_LEAVE_ROOM)},t.prototype.c_shi_shi_room_notice_player_join=function(e){var i=e.room_player_data.pos_id;this.m_room_player_data[i]||(this.m_room_player_data[i]=e.room_player_data,Dispatch.dispatch(t.EVENT_SHISHIROOM_OTHER_JOIN_ROOM,i))},t.prototype.c_shi_shi_room_notice_player_leave=function(e){this.m_room_player_data[e.pos_id]&&(delete this.m_room_player_data[e.pos_id],Dispatch.dispatch(t.EVENT_SHISHIROOM_LEAVE_ROOM,e.pos_id))},t.prototype.c_shi_shi_room_notice_player_ready=function(e){var i=this.m_room_player_data[e.pos_id];i.is_ready=e.is_ready,Dispatch.dispatch(t.EVENT_SHISHIROOM_READY+e.pos_id,e.is_ready)},t.prototype.c_shi_shi_room_notice_player_fight_start=function(t){PopupModule.instance.hidePopAll(),MissionManager.instance.missionType=MissionTypeEnum.MANY_PEOPLE_SHISHI,MissionManager.instance.setCloseUIMission(),this.p_roomId=0,this.p_roomInfo=null,this.m_room_player_data={}},t.prototype.c_shi_shi_room_notice_room_owner_change=function(e){var i=this.m_room_player_data[e.pos_id];i&&(i.is_room_owner=1,this.p_roomInfo.is_room_owner=i.model_head_figure.player_id==PlayerManager.instance.playerId?1:0,this.p_roomInfo.owner_name=i.model_head_figure.nickname,this.p_roomInfo.owner_level=i.model_head_figure.level,Dispatch.dispatch(t.EVENT_SHISHIROOM_OWNER_UPDATA))},t.prototype.c_shi_shi_room_notice_player_fight_result=function(t){if(t.room_details_data&&(this.p_roomId=t.room_details_data.room_data.room_id,this.p_roomInfo=t.room_details_data,this.setRoomDetailInfo()),PopupModule.instance.hidePopAll(),t.win_player_id>0){if(PlayerManager.instance.playerId==t.win_player_id){var e=[.5*StageManager.instance.p_stageWidth,.5*StageManager.instance.p_stageHeight],i=UIModule.instance.pointGold;FlyResModule.instance.playResEffect3(e,i,ItemEnum.GOLD,30)}PopupModule.instance.showPop(PopupConfig.ID_MISSION_MULTI_VICTORY,{winName:t.win_name,prop:t.prop_list,totalCost:t.total_cost_value})}else PopupModule.instance.showPop(PopupConfig.ID_MISSION_FAIL,{msg:LanguageJson.getText("l_missiom_fail")})},t.prototype.c_shi_shi_room_notice_shi_shi_value=function(e){this.p_totalValue=Number(e.value),Dispatch.dispatch(t.EVENT_SHISHIROOM_VALUE_UPDATA)},t.prototype.getDataByPosId=function(t){return this.m_room_player_data[t]},t.prototype.getMissionMultiIdList=function(){for(var t=MissionJson.getListByType(MissionTypeEnum.MANY_PEOPLE_SHISHI),e=[],i=0;i<t.length;i++)t[i].id&&e.push(t[i].id);return e},t.prototype.getRoomMaxPeople=function(){return 0==this.p_roomMaxPeople&&(this.p_roomMaxPeople=Number(StaticDataJson.getData("many_people_shishi_number_max").data)),this.p_roomMaxPeople},t.prototype.getRoomPeople=function(){var t=0;for(var e in this.m_room_player_data)this.m_room_player_data[e]&&t++;return t},t.EVENT_SHISHIROOM_GET_ROOMLIST="EVENT_SHISHIROOM_GET_ROOMLIST",t.EVENT_SHISHIROOM_CREATE_ROOM="EVENT_SHISHIROOM_CREATE_ROOM",t.EVENT_SHISHIROOM_JOIN_ROOM="EVENT_SHISHIROOM_JOIN_ROOM",t.EVENT_SHISHIROOM_SELF_LEAVE_ROOM="EVENT_SHISHIROOM_SELF_LEAVE_ROOM",t.EVENT_SHISHIROOM_OTHER_JOIN_ROOM="EVENT_SHISHIROOM_OTHER_JOIN_ROOM",t.EVENT_SHISHIROOM_LEAVE_ROOM="EVENT_SHISHIROOM_LEAVE_ROOM",t.EVENT_SHISHIROOM_READY="EVENT_SHISHIROOM_READY",t.EVENT_SHISHIROOM_MY_READY="EVENT_SHISHIROOM_MY_READY",t.EVENT_SHISHIROOM_VALUE_UPDATA="EVENT_SHISHIROOM_VALUE_UPDATA",t.EVENT_SHISHIROOM_OWNER_UPDATA="EVENT_SHISHIROOM_OWNER_UPDATA",t}();__reflect(ShiShiRoomManager.prototype,"ShiShiRoomManager");var ShopManager=function(t){function e(){var e=t.call(this)||this;return e.m_shopData={},e.m_shopList={},e.m_shopMysteryList={},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.m_instance||(this.m_instance=new e),this.m_instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){MessageManager.register(MessageType.m_shop_get_shop_info_toc,this.c_shop_get_shop_info,this),MessageManager.register(MessageType.m_shop_shop_item_toc,this.c_shop_shop_item,this),MessageManager.register(MessageType.m_shop_notice_shop_state_toc,this.c_notice_shop_state,this)},e.prototype.c_notice_shop_state=function(t){this.m_shopData[t.id]&&(this.m_shopData[t.id].state=t.state),Dispatch.dispatch(e.SHOP_DATA_STATE_UPDATE+t.id),this.updateShopRed()},e.prototype.updateShopRed=function(){},e.prototype.s_shop_get_shop_info=function(t){var e=MessageProtocol.getClass(MessageType.m_shop_get_shop_info_tos);e.shop_type=t,MessageProtocol.sendMessage(MessageType.m_shop_get_shop_info_tos,e)},e.prototype.c_shop_get_shop_info=function(t){for(var i=0;i<t.shop_data.length;i++)this.m_shopList[t.shop_data[i].id]=t.shop_data[i].buy_count,this.m_shopData[t.shop_data[i].id]=t.shop_data[i];this.updateShopRed(),Dispatch.dispatch(e.SHOP_DATA_UPDATE),Dispatch.dispatch(e.SHOP_DATA_GET_INFO+t.shop_type,t.shop_data)},e.prototype.s_shop_shop_item=function(t,e){var i=ShopJson.getData(t);if(i&&BagManager.instance.isEnoughProp([i.buy_item_list[0][0],Number(i.buy_item_list[0][1])*e])){var s=MessageProtocol.getClass(MessageType.m_shop_shop_item_tos);s.id=t,s.buy_count=e,MessageProtocol.sendMessage(MessageType.m_shop_shop_item_tos,s)}},e.prototype.c_shop_shop_item=function(t){switch(t.result){case proto.m_shop_shop_item_toc.ENUM.success:this.m_shopList[t.id]?this.m_shopList[t.id]+=t.buy_count:this.m_shopList[t.id]=t.buy_count,this.m_shopData[t.id]&&(this.m_shopData[t.id].state=2),this.updateShopRed(),Dispatch.dispatch(e.SHOP_DATA_UPDATE),Dispatch.dispatch(e.SHOP_BUY_SUCCESS,t.id,t.buy_count);break;case proto.m_shop_shop_item_toc.ENUM.times_limit:FloatTipModule.instance.popTipLanguage("l_shop_vip_tips_2");break;case proto.m_shop_shop_item_toc.ENUM.function_no_open:FloatTipModule.instance.popTipLanguage("l_game_tips_9");break;case proto.m_shop_shop_item_toc.ENUM.no_enough_prop:FloatTipModule.instance.popTipLanguage("l_game_tips_11");break;case proto.m_shop_shop_item_toc.ENUM.fail:FloatTipModule.instance.popTipLanguage("l_vip_tips_8")}},e.prototype.getShopLimit=function(t){return this.m_shopList[t]?this.m_shopList[t]:0},e.prototype.getShopData=function(t){var e;return this.m_shopData[t]&&(e=this.m_shopData[t]),e},e.prototype.getShopMysteryList=function(){var t=[];for(var e in this.m_shopMysteryList){var i=ShopMysteryJson.getData(Number(e));t.push(i)}return ArrayUtils.setSortArr(t,["order_id"],[0]),t},e.prototype.isMysterySoldout=function(t){return this.m_shopMysteryList[t]&&2==this.m_shopMysteryList[t]?!0:!1},e.prototype.isLimitSoldout=function(t){var e=ShopJson.getData(t);return null==e?!0:0==e.limit_type||0!=e.limit_type&&this.getShopLimit(e.id)<e.limit?!1:!0},e.prototype.getShopList=function(t){var i=[];for(var s in ShopJson.jsonData){var n=ShopJson.jsonData[s];n.type==t&&(i.push(n),e.instance.isLimitSoldout(n.id)?n.is_sold_out=1:n.is_sold_out=0)}return ArrayUtils.setSortArr(i,["is_sold_out","order_id"],[0,0]),i},e.SHOP_DATA_UPDATE="SHOP_DATA_UPDATE",e.SHOP_DATA_GET_INFO="SHOP_DATA_GET_INFO",e.SHOP_DATA_STATE_UPDATE="SHOP_DATA_STATE_UPDATE",e.SHOP_BUY_SUCCESS="SHOP_BUY_SUCCESS",e.SHOP_MYSTERY_DATA_UPDATE="SHOP_MYSTERY_DATA_UPDATE",e.SHOP_MYSTERY_BUY_SUCCESS="SHOP_MYSTERY_BUY_SUCCESS",e.EVENT_SHOP_DETAIL="EVENT_SHOP_DETAIL",e}(egret.HashObject);__reflect(ShopManager.prototype,"ShopManager");var StageManager=function(){function t(){this.p_stageWidth=1136,this.p_stageHeight=640,this.p_stageX=0,this.p_stageY=0,this.p_xy=!1,this.p_liuHeight=0,this.m_isSound=!1,this.p_stage=egret.MainContext.instance.stage,this.p_stage.addEventListener(egret.Event.ACTIVATE,this.activateHandler,this),this.p_stage.addEventListener(egret.Event.DEACTIVATE,this.deactivateHandler,this),this.p_stage.addEventListener(egret.Event.RESIZE,this.stageResize,this)}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(t){this.m_root=new egret.DisplayObjectContainer,this.m_root.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onCheckPoint,this),this.m_root.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchRoot,this),this.stageResize(),t.addChild(this.m_root),this.m_scenelayer=new egret.DisplayObjectContainer,this.m_scenelayer.name="m_scenelayer",this.m_sceneUILayer=new egret.DisplayObjectContainer,this.m_sceneUILayer.touchEnabled=!1,this.m_sceneUILayer.name="m_sceneUILayer",this.m_uilayer=new egret.DisplayObjectContainer,this.m_uilayer.touchEnabled=!1,this.m_tiplayer=new egret.DisplayObjectContainer,this.m_tiplayer.touchEnabled=!1,this.m_popUplayer=new egret.DisplayObjectContainer,this.m_popUplayer.touchEnabled=!1,this.m_popToplayer=new egret.DisplayObjectContainer,this.m_popToplayer.touchEnabled=!1,this.m_guidelayer=new egret.DisplayObjectContainer,this.m_guidelayer.touchEnabled=!1,this.m_guidelayer.name="guideLayer",this.m_loadinglayer=new egret.DisplayObjectContainer,this.m_loadinglayer.touchEnabled=!1,this.m_root.addChild(this.m_scenelayer),this.m_root.addChild(this.m_sceneUILayer),this.m_root.addChild(this.m_uilayer),this.m_root.addChild(this.m_tiplayer),this.m_root.addChild(this.m_popUplayer),this.m_root.addChild(this.m_popToplayer),this.m_root.addChild(this.m_guidelayer),this.m_root.addChild(this.m_loadinglayer),LoadingUIModule.instance.init(this.m_loadinglayer)},t.prototype.stageResize=function(e){void 0===e&&(e=null);var i=this.p_stage.stageWidth,s=this.p_stage.stageHeight;this.m_root&&(this.p_stageWidth=i<t.MAX_STAGE_WIDTH?i:t.MAX_STAGE_WIDTH,this.p_stageHeight=s<t.MAX_STAGE_HEIGHT?s:t.MAX_STAGE_HEIGHT,this.m_root.x=Math.floor(.5*(i-this.p_stageWidth)),this.m_root.y=Math.floor(.5*(s-this.p_stageHeight)),null==this.m_root.scrollRect?this.m_root.scrollRect=new egret.Rectangle(0,0,this.p_stageWidth,this.p_stageHeight):(this.m_root.scrollRect.width=this.p_stageWidth,this.m_root.scrollRect.height=this.p_stageHeight),Dispatch.dispatch(t.EVENT_STAGE_RESIZE))},t.prototype.onCheckPoint=function(t){this.p_xy&&URIManager.isdebug&&console.log("XY______",t.stageX,t.stageY)},t.prototype.touchRoot=function(e){Dispatch.dispatch(t.EVENT_STAGE_CLICK,e)},t.prototype.activateHandler=function(){this.m_isSound||(SoundMoude.instance.isMute=!1),LoginManager.instance.reconnectOK()},t.prototype.deactivateHandler=function(){this.m_isSound=SoundMoude.instance.isMute,SoundMoude.instance.isMute=!0},t.prototype.initUIStage=function(){PopupModule.instance.init(this.m_popUplayer),UIModule.instance.init(this.m_uilayer),SceneModule.instance.init(this.m_scenelayer)},Object.defineProperty(t.prototype,"rootDirec",{get:function(){return this.m_root},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scenelayer",{get:function(){return this.m_scenelayer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sceneUILayer",{get:function(){return this.m_sceneUILayer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"uilayer",{get:function(){return this.m_uilayer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"popUplayer",{get:function(){return this.m_popUplayer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"popToplayer",{get:function(){return this.m_popToplayer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"guidelayer",{get:function(){return this.m_guidelayer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tiplayer",{get:function(){return this.m_tiplayer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"loadinglayer",{get:function(){return this.m_loadinglayer},enumerable:!0,configurable:!0}),t.EVENT_STAGE_RESIZE="EVENT_STAGE_RESIZE",t.EVENT_STAGE_CLICK="EVENT_STAGE_CLICK",t.MAX_STAGE_WIDTH=2560,t.MAX_STAGE_HEIGHT=1386,t.MIN_STAGE_WIDTH=1136,t.MIN_STAGE_HEIGHT=640,t}();__reflect(StageManager.prototype,"StageManager");var StepByStepSyManager=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){MessageManager.register(MessageType.m_step_by_step_sy_enter_toc,this.c_step_by_step_sy_enter,this),MessageManager.register(MessageType.m_step_by_step_sy_fight_toc,this.c_step_by_step_sy_fight,this),MessageManager.register(MessageType.m_step_by_step_sy_get_award_toc,this.c_step_by_step_sy_get_award,this),MessageManager.register(MessageType.m_step_by_step_sy_fight_result_toc,this.c_step_by_step_sy_fight_result,this)},t.prototype.s_step_by_step_sy_enter=function(t){var e=MessageProtocol.getClass(MessageType.m_step_by_step_sy_enter_tos);e.id,MessageProtocol.sendMessage(MessageType.m_step_by_step_sy_enter_tos,e)},t.prototype.c_step_by_step_sy_enter=function(t){t.result,t.id},t.prototype.s_step_by_step_sy_fight=function(){var t=MessageProtocol.getClass(MessageType.m_step_by_step_sy_fight_tos);MessageProtocol.sendMessage(MessageType.m_step_by_step_sy_fight_tos,t)},t.prototype.c_step_by_step_sy_fight=function(t){t.result,t.loop_num,t.end_fight_time},t.prototype.s_step_by_step_sy_get_award=function(){var t=MessageProtocol.getClass(MessageType.m_step_by_step_sy_get_award_tos);MessageProtocol.sendMessage(MessageType.m_step_by_step_sy_get_award_tos,t)},t.prototype.c_step_by_step_sy_get_award=function(t){t.result,t.loop_num},t.prototype.c_step_by_step_sy_fight_result=function(t){t.loop_num,t.is_win},t}();__reflect(StepByStepSyManager.prototype,"StepByStepSyManager");var SysCommonManager=function(){function t(){this.p_selectPage={},this.m_dataList={},this.m_initReward={}}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){MessageManager.register(MessageType.m_sys_common_change_state_toc,this.c_sys_common_change_state,this),MessageManager.register(MessageType.m_sys_common_notice_sys_common_toc,this.c_sys_common_notice_sys_common,this)},t.prototype.initData=function(t){this.m_dataList={};for(var e=0;e<t.length;e++){this.m_dataList[t[e].id]=t[e];var i=SysCommonJson.getData(t[e].id);i&&1==t[e].state&&(this.p_selectPage[i.func_id]=i.id)}},t.prototype.s_sys_common_change_state=function(t){var e=MessageProtocol.getClass(MessageType.m_sys_common_change_state_tos);e.id=t,MessageProtocol.sendMessage(MessageType.m_sys_common_change_state_tos,e)},t.prototype.c_sys_common_change_state=function(e){switch(e.result){case proto.m_sys_common_change_state_toc.ENUM.success:this.setStateEquip(e.id),Dispatch.dispatch(t.EVENT_SYSCOMMON_CHANGE,e.id);break;case proto.m_sys_common_change_state_toc.ENUM.fail:FloatTipModule.instance.popTipLanguage("l_syscom_change_fail");break;case proto.m_sys_common_change_state_toc.ENUM.function_no_open:FloatTipModule.instance.popTipLanguage("l_game_tips_9");break;case proto.m_sys_common_change_state_toc.ENUM.already_have:FloatTipModule.instance.popTipLanguage("l_syscom_change_have");break;case proto.m_sys_common_change_state_toc.ENUM.none:FloatTipModule.instance.popTipLanguage("l_syscom_change_none")}},t.prototype.c_sys_common_notice_sys_common=function(e){if(!this.m_initReward){this.m_initReward={};var i=Number(StaticDataJson.getData("init_reward").data),s=RewardJson.getData(i).random_reward_list;for(var n in s)this.m_initReward[s[n][1]]=1}for(var o=e.sysCommonDataList,a=0;a<o.length;a++){if(!this.m_dataList[o[a].id]&&!this.m_initReward[o[a].id]){SysCommonJson.getData(o[a].id)}this.m_dataList[o[a].id]=o[a],Dispatch.dispatch(t.EVENT_SYSCOMMON_CHANGE,o[a].id)}},t.prototype.setStateEquip=function(t){var e=SysCommonJson.getFuncIdById(t);for(var i in this.m_dataList){var s=this.m_dataList[i];SysCommonJson.getFuncIdById(s.id)==e&&(s.id==t?s.state=1:s.state=0)}e==FunctionEnum.ROLE_WEAPON},t.prototype.getState=function(t){var e=this.m_dataList[t];return e?e.state:-1},t.prototype.getEquipItemId=function(t){for(var e in this.m_dataList){var i=this.m_dataList[e];if(1==i.state&&SysCommonJson.getFuncIdById(i.id)==t)return i.id}return 0},t.prototype.isEquip=function(t,e){return this.getEquipItemId(t)==e?!0:!1},t.EVENT_SYSCOMMON_CHANGE="EVENT_SYSCOMMON_CHANGE",t}();__reflect(SysCommonManager.prototype,"SysCommonManager");var TaskManager=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){MessageManager.register(MessageType.m_task_get_award_toc,this.c_task_get_award,this),MessageManager.register(MessageType.m_task_notice_task_change_toc,this.c_task_notice_task_change,this)},t.prototype.initData=function(t){this.p_task_data=t,this.setTaskRed()},t.prototype.s_task_get_award=function(){var t=MessageProtocol.getClass(MessageType.m_task_get_award_tos);MessageProtocol.sendMessage(MessageType.m_task_get_award_tos,t)},t.prototype.c_task_get_award=function(e){switch(e.result){case proto.m_task_get_award_toc.ENUM.success:FloatTipModule.instance.popTipLanguage("l_game_tips_8"),this.setTaskRed(),SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_1005),Dispatch.dispatch(t.EVENT_MAIN_STATE_UPGRADE);break;case proto.m_task_get_award_toc.ENUM.fail:FloatTipModule.instance.popTipLanguage("l_game_tips_13");break;case proto.m_task_get_award_toc.ENUM.fail:FloatTipModule.instance.popTipLanguage("l_daily_task_tips_2")}},t.prototype.c_task_notice_task_change=function(e){if(this.p_task_data&&this.p_task_data.task_id!=e.task_info.task_id){TaskJson.getData(this.p_task_data.task_id)}this.p_task_data=e.task_info,this.setTaskRed(),Dispatch.dispatch(t.EVENT_MAIN_TASK_UPGRADE)},t.prototype.getTaskReward=function(){if(0==this.p_task_data.status){var t=TaskJson.getData(this.p_task_data.task_id);if(GuideJson.getData(t.task_guide_id,1)&&GuideModule.instance.startGuide(t.task_guide_id),!(t.function_config_id>0))return void FloatTipModule.instance.popTipLanguage("l_daily_task_tips_3",[t.title]);PopupModule.instance.hidePopAll(),UIModule.instance.hideAllUI(),FunctionManager.instance.executeFunction(t.function_config_id)}else 1==this.p_task_data.status?this.s_task_get_award():FloatTipModule.instance.popTipLanguage("l_game_tips_5")},t.prototype.setTaskRed=function(){var e=!1;1==t.instance.p_task_data.status&&(e=!0),RedNoticeManager.instance.dispatchRed(RedNoticeConfig.RED_CARD_ZHUXIAN,e)},t.EVENT_MAIN_TASK_UPGRADE="EVENT_MAIN_TASK_UPGRADE",t.EVENT_MAIN_STATE_UPGRADE="EVENT_MAIN_STATE_UPGRADE",t}();__reflect(TaskManager.prototype,"TaskManager");var TimeManager=function(){function t(){this.m_pool=[],this.m_handlers={},this.m_currFrame=0,this.m_currTimer=egret.getTimer()}return Object.defineProperty(t,"instance",{get:function(){return this.ms_instance||(this.ms_instance=new t),this.ms_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){StageManager.instance.p_stage.addEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this)},t.prototype.onEnterFrame=function(t){this.m_currFrame++,this.m_currTimer=egret.getTimer();for(var e in this.m_handlers){var i=this.m_handlers[e],s=i.userFrame?this.m_currFrame:this.m_currTimer;if(s>=i.exeTime){var n=i.method,o=i.args;if(i.repeat)for(;s>=i.exeTime&&e in this.m_handlers&&i.repeat;)i.exeTime+=i.delay,n.apply(i.thisObj,o);else this.clearTimer(i.method,i.thisObj),n.apply(i.thisObj,o)}}},t.prototype.create=function(t,e,i,s,n,o,a,r){void 0===o&&(o=!0),void 0===a&&(a=null),void 0===r&&(r=!0);var _="key_"+i.hashCode+"_"+n.toString();if(this.clearTimer(n,i),1>s)return void n.apply(i,a);var h=this.m_pool.length>0?this.m_pool.pop():new TimerHandler;h.userFrame=t,h.repeat=e,h.delay=s,h.method=n,h.args=a,h.thisObj=i,h.exeTime=s+(t?this.m_currFrame:this.m_currTimer),this.m_handlers[_]=h,o&&n.apply(i,a)},t.prototype.doOnce=function(t,e,i,s,n){return void 0===s&&(s=!1),void 0===n&&(n=null),this.create(!1,!1,e,t,i,s,n)},t.prototype.doLoop=function(t,e,i,s,n){return void 0===i&&(i=1e3),void 0===s&&(s=!0),void 0===n&&(n=null),this.create(!1,!0,e,i,t,s,n)},t.prototype.clearTimer=function(t,e){var i="key_"+e.hashCode+"_"+t.toString(),s=this.m_handlers[i];null!=s&&(delete this.m_handlers[i],s.clear(),this.m_pool.push(s))},t}();__reflect(TimeManager.prototype,"TimeManager");var TimerHandler=function(){function t(){this.args=[]}return t.prototype.clear=function(){this.method=null,this.args=null,this.thisObj=null},t}();__reflect(TimerHandler.prototype,"TimerHandler");var TimesManager=function(){function t(){this.m_buyBack=!1,this.m_timesDic={}}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){MessageManager.register(MessageType.m_times_add_times_toc,this.c_times_add_times,this),MessageManager.register(MessageType.m_times_notice_times_change_toc,this.c_times_notice_times_change,this)},t.prototype.addTimesGoto=function(e,i,s,n){void 0===n&&(n=null);var o=this.getTimesById(e);if(0>=o)if(t.instance.getBuyTimesSurplusById(e)<=0)FloatTipModule.instance.popTipLanguage("l_times_tips_1");else{var a,r=this.getItemBuyTimes(e),_=ItemJson.getData(r[0]).name,h=TextUtil.setText(r[2]+_,ColorJson.getColorNum(ColorEnum.R_GREEN)),l=this.getBuyTimesSurplusById(e);a=0>=l?TextUtil.setText(this.getBuyTimesSurplusById(e)+"",ColorJson.getColorNum(ColorEnum.R_RED)):TextUtil.setText(this.getBuyTimesSurplusById(e)+"",ColorJson.getColorNum(ColorEnum.R_GREEN));var c=LanguageJson.getHtmlText("l_times_tips_2",[h,s,a]);PopupModule.instance.showTishi(c,this.sureBuy.bind(this),{timesId:e,backFunc:i,para:n})}else i.apply(null,[n])},t.prototype.addTimesPopup=function(t,e,i,s,n){void 0===e&&(e=null),void 0===i&&(i=!0),void 0===s&&(s=null),void 0===n&&(n=null);var o,a=this.getItemBuyTimes(t),r=ItemJson.getData(a[0]).name,_=TextUtil.setText(a[1]+r,ColorJson.getColorNum(ColorEnum.R_GREEN)),h=this.getBuyTimesSurplusById(t),l="";e?l=LanguageJson.getHtmlText(e,[_]):(o=0>=h?TextUtil.setText(this.getBuyTimesSurplusById(t)+"",ColorJson.getColorNum(ColorEnum.R_RED)):TextUtil.setText(this.getBuyTimesSurplusById(t)+"",ColorJson.getColorNum(ColorEnum.R_GREEN)),l=i?LanguageJson.getHtmlText("l_times_tips_3",[_,o]):LanguageJson.getHtmlText("l_times_tips_4",[_,o])),PopupModule.instance.showTishi(l,this.sureBuy.bind(this),{timesId:t,backFunc:s,para:n})},t.prototype.sureBuy=function(e,i){1==e&&t.instance.addTimes(i.timesId,i.backFunc,i.para)},t.prototype.addTimes=function(t,e,i){if(void 0===e&&(e=null),void 0===i&&(i=null),this.isAddTimes(t)&&!this.m_buyBack){this.m_buyBack=!0,this.m_backFuncBuy=e,this.m_backDataBuy=i;var s=MessageProtocol.getClass(MessageType.m_times_add_times_tos);s.times_id=t,MessageProtocol.sendMessage(MessageType.m_times_add_times_tos,s)}},t.prototype.isAddTimes=function(t){var e=this.getItemBuyTimes(t);return e&&e.length>0?BagManager.instance.isEnoughProp(e):!1},t.prototype.getItemBuyTimes=function(t){for(var e=TimesJson.getData(t),i=this.getBuyTimesById(t),s=0;s<e.buy_prop_list.length;s++){if(0==Number(e.buy_prop_list[s][1]))return[e.buy_prop_list[s][2],e.buy_prop_list[s][3]];if(e.buy_prop_list[s][0]<=Number(i+1)&&Number(i+1)<=e.buy_prop_list[s][1])return[e.buy_prop_list[s][2],e.buy_prop_list[s][3]]}return[]},t.prototype.c_times_add_times=function(e){switch(e.result){case proto.m_times_add_times_toc.ENUM.success:Dispatch.dispatch(t.EVENT_TIEMS_UPDATE+e.times_id),Dispatch.dispatch(t.EVENT_TIEMS_UPDATE_ALL),this.m_backFuncBuy&&this.m_backFuncBuy.apply(null,[this.m_backDataBuy]);break;case proto.m_times_add_times_toc.ENUM.need_ingot:BagManager.instance.noEnoughGold();break;case proto.m_times_add_times_toc.ENUM.need_coin:FloatTipModule.instance.popTipLanguage("l_game_tips_2");break;case proto.m_times_add_times_toc.ENUM.fail:FloatTipModule.instance.popTipLanguage("l_game_tips_18");break;case proto.m_times_add_times_toc.ENUM.times_limit:FloatTipModule.instance.popTipLanguage("l_times_tips_5")}this.m_buyBack=!1,this.m_backFuncBuy=null},t.prototype.c_times_notice_times_change=function(e){for(var i=0;i<e.times_list.length;i++)this.m_timesDic[e.times_list[i].times_id]=e.times_list[i],Dispatch.dispatch(t.EVENT_TIEMS_UPDATE+e.times_list[i].times_id);Dispatch.dispatch(t.EVENT_TIEMS_UPDATE_ALL)},t.prototype.initTimes=function(t){for(var e=0;e<t.length;e++)this.m_timesDic[t[e].times_id]=t[e]},t.prototype.getTimesById=function(t){var e=this.m_timesDic[t];return e?e.value:0},t.prototype.getBuyTimesById=function(t){var e=this.m_timesDic[t];return e?e.buy_times:0},t.prototype.getBuyTimesMaxById=function(t){var e=this.m_timesDic[t];return e?e.max_can_buy_times:0},t.prototype.getBuyTimesSurplusById=function(t){var e=this.getBuyTimesMaxById(t)-this.getBuyTimesById(t);return 0>=e?0:e},t.prototype.getRecoverTimeById=function(t){var e=this.m_timesDic[t];return e?e.recover_time:0},t.prototype.getMaxTimeById=function(t){var e=this.m_timesDic[t];return e?e.max_times:0},t.prototype.getUseTimeById=function(t){var e=this.m_timesDic[t];return e?e.use_times:0},t.EVENT_TIEMS_UPDATE_ALL="EVENT_TIEMS_UPDATE_ALL",t.EVENT_TIEMS_UPDATE="EVENT_TIEMS_UPDATE",t}();__reflect(TimesManager.prototype,"TimesManager");var TurnTableManager=function(){function t(){this.p_showList=[1],this.p_drawExp=0,this.p_drawExpMax=0}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){MessageManager.register(MessageType.m_turn_table_draw_toc,this.c_trun_table_draw,this),MessageManager.register(MessageType.m_turn_table_get_award_toc,this.c_trun_table_get_award,this),MessageManager.register(MessageType.m_turn_table_notice_reset_toc,this.c_turn_table_notice_reset,this),Dispatch.register(PlayerManager.EVENT_PLAYER_INIT,this.setTurnRed,this)},t.prototype.setTurnRed=function(){this.p_drawExpMax=100,RedNoticeManager.instance.dispatchRed(RedNoticeConfig.RED_TURNTABLE_REWARD,this.p_drawExp>=this.p_drawExpMax)},t.prototype.s_trun_table_draw=function(t){var e=MessageProtocol.getClass(MessageType.m_turn_table_draw_tos);e.times=t,MessageProtocol.sendMessage(MessageType.m_turn_table_draw_tos,e),1==t?(FightSkillManager.instance.p_goldDelayTime=5,FightSkillManager.instance.p_rmbDelayTime=5):(FightSkillManager.instance.p_goldDelayTime=10,FightSkillManager.instance.p_rmbDelayTime=10)},t.prototype.c_trun_table_draw=function(e){switch(FightSkillManager.instance.p_goldDelayTime=0,FightSkillManager.instance.p_rmbDelayTime=0,e.result){case proto.m_turn_table_draw_toc.ENUM.success:this.p_showList=e.id_list,this.p_drawExp=e.value,Dispatch.dispatch(t.EVENT_TURNTABLE_DRAW_SUCCESS,e.times),Dispatch.dispatch(t.EVENT_TURNTABLE_EXP_UPDATA),this.setTurnRed();
break;case proto.m_turn_table_draw_toc.ENUM.fail:FloatTipModule.instance.popTipLanguage("l_turntable_tips1");break;case proto.m_turn_table_draw_toc.ENUM.function_no_open:FloatTipModule.instance.popTipLanguage("l_game_tips_9");break;case proto.m_turn_table_draw_toc.ENUM.not_enough_grid:FloatTipModule.instance.popTipLanguage("l_game_tips_10");break;case proto.m_turn_table_draw_toc.ENUM.no_enough_prop:FloatTipModule.instance.popTipLanguage("l_game_tips_20")}},t.prototype.s_trun_table_get_award=function(){var t=MessageProtocol.getClass(MessageType.m_turn_table_get_award_tos);MessageProtocol.sendMessage(MessageType.m_turn_table_get_award_tos,t)},t.prototype.c_trun_table_get_award=function(e){switch(e.result){case proto.m_turn_table_get_award_toc.ENUM.success:RewardModule.instance.receiveByProp(e.prop_list),this.p_drawExp=0,this.setTurnRed(),Dispatch.dispatch(t.EVENT_TURNTABLE_EXP_UPDATA);break;case proto.m_turn_table_get_award_toc.ENUM.fail:FloatTipModule.instance.popTipLanguage("l_game_tips_13");break;case proto.m_turn_table_get_award_toc.ENUM.function_no_open:FloatTipModule.instance.popTipLanguage("l_game_tips_9");break;case proto.m_turn_table_get_award_toc.ENUM.not_enough_grid:FloatTipModule.instance.popTipLanguage("l_game_tips_10");break;case proto.m_turn_table_get_award_toc.ENUM.not_authority:FloatTipModule.instance.popTipLanguage("l_turntable_tips2")}},t.prototype.c_turn_table_notice_reset=function(e){this.p_drawExp=0,this.setTurnRed(),Dispatch.dispatch(t.EVENT_TURNTABLE_EXP_UPDATA,!0)},t.EVENT_TURNTABLE_DRAW_SUCCESS="EVENT_TURNTABLE_DRAW_SUCCESS",t.EVENT_TURNTABLE_EXP_UPDATA="EVENT_TURNTABLE_EXP_UPDATA",t}();__reflect(TurnTableManager.prototype,"TurnTableManager");var VideoManager=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){MessageManager.register(MessageType.m_video_get_award_toc,this.c_video_get_award,this)},t.prototype.s_video_get_award=function(t){var e=MessageProtocol.getClass(MessageType.m_video_get_award_tos);e.id,MessageProtocol.sendMessage(MessageType.m_video_get_award_tos,e)},t.prototype.c_video_get_award=function(t){t.result,t.id,t.award_list},t}();__reflect(VideoManager.prototype,"VideoManager");var VipManager=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){MessageManager.register(MessageType.m_vip_get_vip_award_toc,this.c_vip_get_vip_award,this),MessageManager.register(MessageType.m_vip_notice_vip_data_toc,this.c_vip_notice_vip_data,this)},t.prototype.initData=function(t){this.vip_data=t,this.updateRed()},t.prototype.updateRed=function(){var t=!1;if(this.vip_data&&this.vip_data.vip_award_info)for(var e=0;e<this.vip_data.vip_award_info.length;e++)if(1==this.vip_data.vip_award_info[e].state){t=!0;break}RedNoticeManager.instance.dispatchRed(RedNoticeConfig.RED_VIP_GET_AWARD,t)},t.prototype.c_vip_notice_vip_data=function(e){this.vip_data=e.vip_data,Dispatch.dispatch(t.EVENT_VIP_GET_AWARD),this.updateRed()},t.prototype.s_vip_get_vip_award=function(t){var e=MessageProtocol.getClass(MessageType.m_vip_get_vip_award_tos);e.vip_level=t,MessageProtocol.sendMessage(MessageType.m_vip_get_vip_award_tos,e)},t.prototype.c_vip_get_vip_award=function(e){if(e.result,e.vip_level,e.result==proto.m_vip_get_vip_award_toc.ENUM.success){FloatTipModule.instance.popTipLanguage("l_game_tips_8");var i=!1;if(this.vip_data&&this.vip_data.vip_award_info)for(var s=0;s<this.vip_data.vip_award_info.length;s++)if(this.vip_data.vip_award_info[s].vip_level==e.vip_level){this.vip_data.vip_award_info[s].state=2,i=!0;break}if(!i){var n=new proto.VipAwardInfo;n.vip_level=e.vip_level,n.state=2,this.vip_data.vip_award_info.push(n)}Dispatch.dispatch(t.EVENT_VIP_GET_AWARD),SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_4004),this.updateRed()}else e.result==proto.m_vip_get_vip_award_toc.ENUM.fail?FloatTipModule.instance.popTipLanguage("l_game_tips_13"):e.result==proto.m_vip_get_vip_award_toc.ENUM.already_have?FloatTipModule.instance.popTipLanguage("l_game_tips_5"):e.result==proto.m_vip_get_vip_award_toc.ENUM.not_authority&&FloatTipModule.instance.popTipLanguage("l_game_tips_7")},t.prototype.getVipAwardState=function(t){var e=0;if(this.vip_data&&this.vip_data.vip_award_info)for(var i=0;i<this.vip_data.vip_award_info.length;i++)if(this.vip_data.vip_award_info[i].vip_level==t){e=this.vip_data.vip_award_info[i].state;break}return e},t.prototype.getSelectVip=function(){var t=0,e=this.vip_data.vip_award_info;if(e.length>0){ArrayUtils.setSortArr(e,["vip_level"],[1]);for(var i=0;i<e.length;i++)if(e[i]){t=e[i].vip_level;break}}if(0==t){var s=this.vip_data.vip_level,n=VipLevelJson.getData(s);t=n?s:this.vip_data.vip_level}return t},t.EVENT_VIP_GET_AWARD="EVENT_VIP_GET_AWARD",t}();__reflect(VipManager.prototype,"VipManager");var WithdrawManager=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){MessageManager.register(MessageType.m_shop_withdraw_toc,this.c_shop_withdraw,this),MessageManager.register(MessageType.m_shop_withdraw_history_toc,this.c_shop_withdraw_history,this),MessageManager.register(MessageType.m_shop_withdraw_notify_toc,this.c_shop_withdraw_notify,this)},t.prototype.s_shop_withdraw=function(t){var e=MessageProtocol.getClass(MessageType.m_shop_withdraw_tos);e.id=t,MessageProtocol.sendMessage(MessageType.m_shop_withdraw_tos,e)},t.prototype.c_shop_withdraw=function(t){switch(t.result){case proto.m_shop_withdraw_toc.ENUM.success:GameManager.instance.callToNative("toAppWithdrawal",t.url);break;case proto.m_shop_withdraw_toc.ENUM.unavailable_account:FloatTipModule.instance.popTipLanguage("l_recycle_tips_2");break;case proto.m_shop_withdraw_toc.ENUM.vip_limit:FloatTipModule.instance.popTipLanguage("l_game_tips_3");break;case proto.m_shop_withdraw_toc.ENUM.not_authority:FloatTipModule.instance.popTipLanguage("l_game_tips_20");break;case proto.m_shop_withdraw_toc.ENUM.times_limit:FloatTipModule.instance.popTipLanguage("l_recycle_tips_3");break;case proto.m_shop_withdraw_toc.ENUM.unknown:FloatTipModule.instance.popTipLanguage("l_recycle_tips_4")}},t.prototype.s_shop_withdraw_history=function(){var t=MessageProtocol.getClass(MessageType.m_shop_withdraw_history_tos);MessageProtocol.sendMessage(MessageType.m_shop_withdraw_history_tos,t)},t.prototype.c_shop_withdraw_history=function(t){PopupModule.instance.showPop(PopupConfig.ID_RECYCLE_HISTORY,t.single_withdraw_info,!1)},t.prototype.c_shop_withdraw_notify=function(t){if(PopupModule.instance.havPopupStage(PopupConfig.ID_RECYCLE)){var e="";LanguageJson.getText("l_btn_ok");0==t.status?e=LanguageJson.getText("l_recycle_tips_5"):1==t.status?e=LanguageJson.getText("l_recycle_tips_6"):2==t.status&&(e=LanguageJson.getText("l_recycle_tips_7")),PopupModule.instance.showPop(PopupConfig.ID_RECYCLE_RESULT,{status:t.status},!1)}},t}();__reflect(WithdrawManager.prototype,"WithdrawManager");var GameSocket=function(){function t(){this.m_socketState=t.STATE_CLOSE,this.m_socketType="ws://",this.PACKAGE_HEAD_LENGTH=9,this.isZipMaxLength=500,this.isZipNum=0,this.messageByte=new egret.ByteArray,this.sendByte=new egret.ByteArray}return Object.defineProperty(t.prototype,"socketState",{get:function(){return this.m_socketState},set:function(e){this.m_socketState=e,Dispatch.dispatch(t.EVENT_ON_SOCKET_STATE_CHANGE,this.m_socketState)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){MessageProtocol.initProtoLib(),this.m_socketType=-1!=ServerListManager.instance.p_server_list_url_all.indexOf("https")?"wss://":"ws://",this.creatSocket()},t.prototype.creatSocket=function(){this.m_socket||(this.m_socket=new egret.WebSocket),this.m_socket.type=egret.WebSocket.TYPE_BINARY,this.m_socket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceiveMessage,this),this.m_socket.addEventListener(egret.Event.CONNECT,this.onSocketOpen,this),this.m_socket.addEventListener(egret.Event.CLOSE,this.onSocketClose,this),this.m_socket.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onSocketError,this);var t=this.m_socketType+URIManager.game_host+":"+(URIManager.is_https?URIManager.game_port+1e4:URIManager.game_port);console.log("socket "+t),this.m_socket.connectByUrl(t),MessageProtocol.websocket=this.m_socket,Dispatch.dispatch(ServerListManager.EVENT_LOGIN_SET_INFO,"服务器连接中，请稍后..."),PlatformManager.instance.reportRegister()},t.prototype.closeSocket=function(){this.m_socket&&this.m_socket.close()},t.prototype.reconnection=function(){0==LoginManager.instance.p_isReconnect&&(LoginManager.instance.p_isReconnect=!0,this.closeSocket(),this.m_socket.connectByUrl(this.m_socketType+URIManager.game_host+":"+(URIManager.is_https?URIManager.game_port+1e4:URIManager.game_port)),console.log("WebSocketReconnection"),this.socketState=t.STATE_RECONNECTION)},t.prototype.onSocketOpen=function(e){console.log("WebSocketOpen"),Dispatch.dispatch(ServerListManager.EVENT_LOGIN_SET_INFO,""),this.socketState==t.STATE_RECONNECTION&&(this.socketState=t.STATE_OPEN),this.socketState=t.STATE_OPEN},t.prototype.onSocketClose=function(e){console.log("WebSocketClose"),Dispatch.dispatch(ServerListManager.EVENT_LOGIN_SET_INFO,"服务器连接已断开..."+this.m_socketType+URIManager.game_host+":"+(URIManager.is_https?URIManager.game_port+1e4:URIManager.game_port)),this.socketState=t.STATE_CLOSE},t.prototype.onSocketError=function(e){console.log("WebSocketError"+e.type),Dispatch.dispatch(ServerListManager.EVENT_LOGIN_SET_INFO,"服务器连接失败..."+this.m_socketType+URIManager.game_host+":"+(URIManager.is_https?URIManager.game_port+1e4:URIManager.game_port)),this.socketState=t.STATE_CLOSE},t.prototype.onReceiveMessage=function(t){var e=new egret.ByteArray;this.m_socket.readBytes(e);var i=e.readByte(),s=e.readInt();if(1==i){var n=new egret.ByteArray;e.readBytes(n),n.position=0;var o=new Zlib.Inflate(n.bytes),a=o.decompress();e=new egret.ByteArray(a),e.position=0}var r=MessageProtocol.createMessage(s,e);MessageManager.instance.dispatcherMessage(s,r)},t.EVENT_ON_SOCKET_STATE_CHANGE="EVENT_ON_SOCKET_STATE_CHANGE",t.STATE_OPEN="STATE_OPEN",t.STATE_RECONNECTION="STATE_RECONNECTION",t.STATE_CLOSE="STATE_CLOSE",t}();__reflect(GameSocket.prototype,"GameSocket");var MessageItem=function(){function t(){this.messageType="",this.creatTime="";var t=new Date,e=t.toLocaleString()+":"+t.getMilliseconds();this.creatTime=e}return t}();__reflect(MessageItem.prototype,"MessageItem");var MessageProtocol=function(){function t(){}return t.createMessage=function(e,i){if(null==t.protoLib[e])return Trace.socketLog("不存在msgid:"+e+" proto的结构体"),null;var s=new egret.ByteArray;s.length=0,i.readBytes(s,0,i.bytesAvailable),s.position=0;var n=t.protoLib[e].decode(s.bytes),o=new t.protoLib[e];return this.setCheckObj(n,o),URIManager.isdebug&&Trace.socketLog("接收消息："+e,JSON.stringify(n)),o},t.setCheckObj=function(t,e){if(t&&e)for(var i in t)e[i]=t[i]},t.sendMessageWX=function(e,i){URIManager.isdebug&&Trace.socketLog("发送数据："+e,JSON.stringify(i));var s=t.protoLib[e].encode(i).finish(),n=new egret.ByteArray(s);t.messageByte.length=0,t.sendByte.length=0,t.messageByte=n,this.sendByte.writeByte(0),this.sendByte.writeInt(e),this.sendByte.writeBytes(t.messageByte,0,this.messageByte.length),GameSocket.instance.socketState==GameSocket.STATE_OPEN?(t.websocket.writeBytes(this.sendByte),t.websocket.flush(),Trace.socketLog("数据发送成功:",e)):(GameSocket.instance.reconnection(),Trace.socketLog("没有连接到服务器，不能发送数据",e))},t.sendMessage=function(t,e){this.sendMessageWX(t,e)},t.getClass=function(e){return null==t.protoLib[e]?(Trace.socketLog("不存在msgid:"+e+" proto的结构体"),null):new t.protoLib[e]},t.initProtoLib=function(){for(var e in MessageType.messageList){var i=MessageType.messageList[e];t.protoLib[i.id]=i.name}},t.PACKAGE_HEAD_LENGTH=9,t.messageByte=new egret.ByteArray,t.sendByte=new egret.ByteArray,t.protoLib=new Object,t}();__reflect(MessageProtocol.prototype,"MessageProtocol");var MessageType=function(){function t(){}return t.m_login_login_tos=1,t.m_login_login_toc=2,t.m_login_create_role_tos=3,t.m_login_create_role_toc=4,t.m_login_enter_game_tos=5,t.m_login_heart_beat_tos=6,t.m_login_notice_logout_toc=7,t.m_player_init_player_data_toc=101,t.m_player_notice_player_attr_change_toc=102,t.m_player_notice_player_string_attr_change_toc=103,t.m_player_notice_fun_active_toc=104,t.m_player_notice_server_time_toc=105,t.m_player_change_pk_mode_tos=106,t.m_player_change_pk_mode_toc=107,t.m_player_get_player_attr_tos=108,t.m_player_get_player_attr_toc=109,t.m_player_change_name_tos=110,t.m_player_change_name_toc=111,t.m_player_change_sex_tos=112,t.m_player_change_sex_toc=113,t.m_player_update_client_data_tos=114,t.m_player_delete_client_data_tos=115,t.m_player_adjust_tos=116,t.m_player_adjust_toc=117,t.m_player_customer_url_tos=118,t.m_player_customer_url_toc=119,t.m_player_visitor_binding_tos=120,t.m_player_visitor_binding_toc=121,t.m_player_notice_player_adjust_value_toc=122,t.m_player_get_server_time_tos=123,t.m_player_get_server_time_toc=124,t.m_player_modify_nickname_gender_tos=125,t.m_player_modify_nickname_gender_toc=126,t.m_player_set_player_data_tos=127,t.m_player_set_player_data_toc=128,t.m_scene_enter_scene_tos=201,t.m_scene_enter_scene_toc=202,t.m_scene_notice_prepare_scene_toc=203,t.m_scene_load_scene_tos=204,t.m_scene_load_scene_toc=205,t.m_scene_sync_scene_toc=206,t.m_scene_notice_scene_player_enter_toc=207,t.m_scene_notice_scene_player_leave_toc=208,t.m_scene_player_rebirth_tos=209,t.m_scene_player_rebirth_toc=210,t.m_scene_player_move_tos=211,t.m_scene_player_move_step_tos=212,t.m_scene_player_stop_move_tos=213,t.m_scene_notice_player_move_toc=214,t.m_scene_notice_player_stop_move_toc=215,t.m_scene_notice_player_teleport_toc=216,t.m_scene_notice_correct_player_pos_toc=217,t.m_scene_notice_monster_enter_toc=218,t.m_scene_notice_monster_leave_toc=219,t.m_scene_notice_monster_move_toc=220,t.m_scene_notice_monster_stop_move_toc=221,t.m_scene_notice_monster_teleport_toc=222,t.m_scene_notice_item_enter_toc=223,t.m_scene_notice_item_leave_toc=224,t.m_scene_notice_scene_item_owner_change_toc=225,t.m_scene_notice_player_death_toc=226,t.m_scene_query_player_pos_tos=227,t.m_scene_query_player_pos_toc=228,t.m_scene_notice_obj_hp_change_toc=229,t.m_scene_notice_monster_attr_change_toc=230,t.m_scene_transmit_tos=231,t.m_scene_notice_prepare_transmit_toc=232,t.m_scene_update_npc_date_toc=233,t.m_scene_notice_simplify_monster_pos_toc=234,t.m_scene_notice_start_yuchao_toc=235,t.m_scene_notice_stop_yuchao_toc=236,t.m_scene_get_monster_list_tos=237,t.m_scene_notice_monster_list_toc=238,t.m_scene_notice_anger_change_toc=239,t.m_scene_notice_special_skill_change_toc=240,t.m_scene_notice_show_fanpai_toc=241,t.m_scene_notice_fanpai_tos=242,t.m_scene_notice_fanpai_toc=243,t.m_scene_notice_yu_chao_start_time_toc=244,t.m_scene_notice_boss_state_toc=245,t.m_scene_challenge_boss_tos=246,t.m_scene_send_msg_tos=247,t.m_scene_notice_send_msg_toc=248,t.m_scene_notice_scene_jbxy_state_toc=249,t.m_scene_player_collect_tos=250,t.m_scene_get_gold_ranking_tos=251,t.m_scene_get_gold_ranking_toc=252,t.m_scene_notice_first_gold_ranking_toc=253,t.m_fight_fight_tos=301,t.m_fight_notice_fight_fail_toc=302,t.m_fight_notice_fight_result_toc=303,t.m_fight_notice_add_buff_toc=304,t.m_fight_notice_remove_buff_toc=305,t.m_fight_use_item_tos=306,t.m_fight_use_item_toc=307,t.m_fight_notice_bin_dong_skill_toc=308,t.m_fight_notice_cancel_bin_dong_toc=309,t.m_fight_notice_get_function_monster_award_toc=310,t.m_fight_give_function_monster_award_tos=311,t.m_times_add_times_tos=401,t.m_times_add_times_toc=402,t.m_times_notice_times_change_toc=403,t.m_prop_notice_update_prop_toc=501,t.m_prop_use_item_tos=502,t.m_prop_use_item_toc=503,t.m_prop_sell_item_tos=504,t.m_prop_sell_item_toc=505,t.m_prop_merge_tos=506,t.m_prop_merge_toc=507,t.m_chat_channel_chat_tos=601,t.m_chat_channel_chat_toc=602,t.m_chat_broadcast_channel_msg_toc=603,t.m_chat_broadcast_channel_msg_list_toc=604,t.m_mission_challenge_mission_tos=701,t.m_mission_challenge_mission_toc=702,t.m_mission_notice_mission_result_toc=703,t.m_mission_exit_mission_tos=704,t.m_mission_notice_passed_mission_toc=705,t.m_mission_notice_mission_close_time_toc=706,t.m_mission_notice_mission_round_toc=707,t.m_mission_notice_total_award_toc=708,t.m_mission_notice_mission_ranking_toc=709,t.m_mission_get_award_tos=710,t.m_mission_get_award_toc=711,t.m_mission_notice_mission_schedule_toc=712,t.m_mission_boss_rebirth_tos=713,t.m_mission_boss_rebirth_toc=714,t.m_mission_notice_shi_shi_settle_toc=715,t.m_mission_notice_shi_shi_time_toc=716,t.m_mission_notice_shi_shi_value_toc=717,t.m_mission_guess_get_record_tos=718,t.m_mission_guess_get_record_toc=719,t.m_mission_notice_guess_boss_cost_my_mana_toc=720,t.m_mission_notice_guess_boss_cost_total_mana_toc=721,t.m_mission_notice_guess_boss_mission_result_toc=722,t.m_mission_notice_guess_boss_mission_time_toc=723,t.m_mission_either_notice_state_toc=724,t.m_mission_either_either_tos=725,t.m_mission_either_notice_result_toc=726,t.m_mission_scene_boss_bet_tos=727,t.m_mission_scene_boss_bet_reset_tos=728,t.m_mission_notice_scene_boss_bet_toc=729,t.m_mission_notice_scene_boss_step_toc=730,t.m_mission_notice_scene_boss_result_toc=731,t.m_mission_notice_scene_boss_dao_num_change_toc=732,t.m_mission_notice_new_guess_result_toc=733,t.m_mission_lucky_boss_bet_tos=734,t.m_mission_lucky_boss_bet_toc=735,t.m_mission_lucky_boss_bet_reset_tos=736,t.m_mission_lucky_boss_bet_reset_toc=737,t.m_mission_lucky_boss_bet_modification_toc=738,t.m_mission_lucky_boss_bet_info_toc=739,t.m_mission_lucky_boss_status_tos=740,t.m_mission_lucky_boss_status_toc=741,t.m_mission_notice_lucky_boss_result_toc=742,t.m_mission_notice_lucky_boss_fight_toc=743,t.m_mail_get_mail_info_tos=801,t.m_mail_get_mail_info_toc=802,t.m_mail_read_mail_tos=803,t.m_mail_read_mail_toc=804,t.m_mail_get_item_mail_tos=805,t.m_mail_get_item_mail_toc=806,t.m_mail_delete_mail_tos=807,t.m_mail_delete_mail_toc=808,t.m_mail_add_mail_toc=809,t.m_mail_remove_mail_toc=810,t.m_vip_get_vip_award_tos=901,t.m_vip_get_vip_award_toc=902,t.m_vip_notice_vip_data_toc=903,t.m_debug_debug_tos=10001,t.m_debug_debug_toc=10002,t.m_client_log_client_log_tos=1001,t.m_achievement_get_info_tos=1101,t.m_achievement_get_info_toc=1102,t.m_achievement_get_award_tos=1103,t.m_achievement_get_award_toc=1104,t.m_achievement_notice_update_achievement_data_toc=1105,t.m_rank_get_rank_info_tos=1201,t.m_rank_get_rank_info_toc=1202,t.m_shop_get_shop_info_tos=1301,t.m_shop_get_shop_info_toc=1302,t.m_shop_shop_item_tos=1303,t.m_shop_shop_item_toc=1304,t.m_shop_notice_shop_state_toc=1305,t.m_shop_withdraw_tos=1306,t.m_shop_withdraw_toc=1307,t.m_shop_withdraw_notify_toc=1308,t.m_shop_withdraw_history_tos=1309,t.m_shop_withdraw_history_toc=1310,t.m_activity_restart_all_activity_toc=1401,t.m_activity_update_activity_time_toc=1402,t.m_activity_give_online_award_tos=1403,t.m_activity_give_online_award_toc=1404,t.m_charge_notice_is_open_charge_toc=1501,t.m_charge_charge_tos=1502,t.m_charge_charge_toc=1503,t.m_charge_notice_charge_data_toc=1504,t.m_charge_get_charge_type_tos=1505,t.m_charge_get_charge_type_toc=1506,t.m_invest_get_invest_award_tos=1601,t.m_invest_get_invest_award_toc=1602,t.m_invest_notice_invest_data_update_toc=1603,t.m_everyday_sign_everyday_sign_tos=1701,t.m_everyday_sign_everyday_sign_toc=1702,t.m_everyday_sign_notice_day_toc=1703,t.m_seven_login_give_award_tos=1801,t.m_seven_login_give_award_toc=1802,t.m_seven_login_update_cumulative_day_toc=1803,t.m_platform_function_share_tos=1901,t.m_platform_function_share_toc=1902,t.m_platform_function_get_share_friend_give_tos=1903,t.m_platform_function_get_share_friend_give_toc=1904,t.m_platform_function_notice_share_friend_toc=1905,t.m_platform_function_notice_share_count_toc=1906,t.m_platform_function_notice_platform_vip_level_toc=1907,t.m_platform_function_get_platform_award_info_tos=1908,t.m_platform_function_get_platform_award_info_toc=1909,t.m_platform_function_get_share_task_info_tos=1910,t.m_platform_function_get_share_task_info_toc=1911,t.m_platform_function_get_share_task_award_tos=1912,t.m_platform_function_get_share_task_award_toc=1913,t.m_platform_function_notice_share_task_toc=1914,t.m_platform_function_refresh_open_key_tos=1915,t.m_platform_function_refresh_open_key_toc=1916,t.m_gift_code_gift_code_tos=2001,t.m_gift_code_gift_code_toc=2002,t.m_video_get_award_tos=2101,t.m_video_get_award_toc=2102,t.m_many_people_boss_get_room_list_tos=2201,t.m_many_people_boss_get_room_list_toc=2202,t.m_many_people_boss_join_room_tos=2203,t.m_many_people_boss_join_room_toc=2204,t.m_many_people_boss_create_room_tos=2205,t.m_many_people_boss_create_room_toc=2206,t.m_many_people_boss_start_tos=2207,t.m_many_people_boss_start_toc=2208,t.m_many_people_boss_participate_in_tos=2209,t.m_many_people_boss_participate_in_toc=2210,t.m_many_people_boss_kick_out_player_tos=2211,t.m_many_people_boss_set_is_all_ready_start_tos=2212,t.m_many_people_boss_set_is_all_ready_start_toc=2213,t.m_many_people_boss_ready_tos=2214,t.m_many_people_boss_ready_toc=2215,t.m_many_people_boss_leave_room_tos=2216,t.m_many_people_boss_notice_leave_room_toc=2217,t.m_many_people_boss_notice_player_join_toc=2218,t.m_many_people_boss_notice_player_leave_toc=2219,t.m_many_people_boss_notice_player_ready_toc=2220,t.m_many_people_boss_notice_player_fight_start_toc=2221,t.m_many_people_boss_notice_player_fight_result_toc=2222,t.m_many_people_boss_notice_owner_fight_result_toc=2223,t.m_sys_common_change_state_tos=2301,t.m_sys_common_change_state_toc=2302,t.m_sys_common_notice_sys_common_toc=2303,t.m_daily_task_get_info_tos=2401,t.m_daily_task_get_info_toc=2402,t.m_daily_task_get_award_tos=2403,t.m_daily_task_get_award_toc=2404,t.m_daily_task_notice_update_daily_task_data_toc=2405,t.m_daily_task_notice_update_task_show_toc=2406,t.m_promote_get_promote_record_tos=2501,t.m_promote_get_promote_record_toc=2502,t.m_promote_get_award_tos=2503,t.m_promote_get_award_toc=2504,t.m_promote_notice_player_promote_data_toc=2505,t.m_promote_notice_promote_times_toc=2506,t.m_promote_invitation_code_tos=2507,t.m_promote_invitation_code_toc=2508,t.m_task_get_award_tos=2601,t.m_task_get_award_toc=2602,t.m_task_notice_task_change_toc=2603,t.m_red_packet_notice_player_red_packet_toc=2701,t.m_red_packet_get_red_packet_tos=2702,t.m_red_packet_get_red_packet_toc=2703,t.m_red_packet_notice_player_red_packet_clear_toc=2704,t.m_brave_one_get_info_list_tos=2801,t.m_brave_one_get_info_list_toc=2802,t.m_brave_one_create_tos=2803,t.m_brave_one_create_toc=2804,t.m_brave_one_enter_tos=2805,t.m_brave_one_enter_toc=2806,t.m_brave_one_clean_tos=2807,t.m_brave_one_clean_toc=2808,t.m_brave_one_notice_fight_scene_toc=2809,t.m_brave_one_wait_scene_toc=2810,t.m_brave_one_ready_start_toc=2811,t.m_brave_one_fight_player_toc=2812,t.m_brave_one_win_player_toc=2813,t.m_step_by_step_sy_enter_tos=2901,t.m_step_by_step_sy_enter_toc=2902,t.m_step_by_step_sy_fight_tos=2903,t.m_step_by_step_sy_fight_toc=2904,t.m_step_by_step_sy_get_award_tos=2905,t.m_step_by_step_sy_get_award_toc=2906,t.m_step_by_step_sy_fight_result_toc=2907,t.m_turn_table_draw_tos=3001,t.m_turn_table_draw_toc=3002,t.m_turn_table_get_award_tos=3003,t.m_turn_table_get_award_toc=3004,t.m_turn_table_notice_reset_toc=3005,t.m_shi_shi_room_get_room_list_tos=3101,t.m_shi_shi_room_get_room_list_toc=3102,t.m_shi_shi_room_create_room_tos=3103,t.m_shi_shi_room_create_room_toc=3104,t.m_shi_shi_room_join_room_tos=3105,t.m_shi_shi_room_join_room_toc=3106,t.m_shi_shi_room_start_tos=3107,t.m_shi_shi_room_start_toc=3108,t.m_shi_shi_room_kick_out_player_tos=3109,t.m_shi_shi_room_ready_tos=3110,t.m_shi_shi_room_ready_toc=3111,t.m_shi_shi_room_leave_room_tos=3112,t.m_shi_shi_room_notice_leave_room_toc=3113,t.m_shi_shi_room_notice_player_join_toc=3114,t.m_shi_shi_room_notice_player_leave_toc=3115,t.m_shi_shi_room_notice_player_ready_toc=3116,t.m_shi_shi_room_notice_player_fight_start_toc=3117,t.m_shi_shi_room_notice_room_owner_change_toc=3118,t.m_shi_shi_room_notice_player_fight_result_toc=3119,t.m_shi_shi_room_notice_shi_shi_value_toc=3120,t.m_hero_charge_hero_parts_tos=3201,t.m_hero_charge_hero_parts_toc=3202,t.m_hero_unlock_hero_tos=3203,t.m_hero_unlock_hero_toc=3204,t.m_hero_hero_up_star_tos=3205,t.m_hero_hero_up_star_toc=3206,t.m_hero_notice_hero_unlock_parts_toc=3207,t.m_hero_notice_unlock_hero_toc=3208,t.m_card_get_award_tos=3301,t.m_card_get_award_toc=3302,t.m_card_notice_card_update_toc=3303,t.m_seize_treasure_currency_seize_treasure_type_toc=3401,t.m_seize_treasure_get_treasure_tos=3402,t.m_seize_treasure_get_treasure_toc=3403,t.m_seize_treasure_get_extra_award_tos=3404,t.m_seize_treasure_get_extra_award_toc=3405,t.m_seize_treasure_get_extra_award_status_tos=3406,t.m_seize_treasure_get_extra_award_status_toc=3407,t.m_card_summon_do_summon_tos=3501,t.m_card_summon_do_summon_toc=3502,t.m_shen_long_draw_tos=3601,t.m_shen_long_draw_toc=3602,t.m_shen_long_notice_scene_shen_long_state_toc=3603,t.m_skill_use_skill_tos=3701,t.m_skill_use_skill_toc=3702,t.m_skill_notice_active_skill_change_toc=3703,t.m_tongxingzheng_task_info_notice_toc=3801,t.m_tongxingzheng_task_daily_update_notice_toc=3802,t.m_tongxingzheng_task_month_update_notice_toc=3803,t.m_tongxingzheng_task_daily_reward_collect_tos=3804,t.m_tongxingzheng_task_daily_reward_collect_toc=3805,t.m_tongxingzheng_collect_task_month_reward_tos=3806,t.m_tongxingzheng_collect_task_month_reward_toc=3807,t.m_tongxingzheng_purchase_unlock_tos=3808,t.m_tongxingzheng_purchase_unlock_toc=3809,t.m_tongxingzheng_reward_info_notice_toc=3810,t.m_tongxingzheng_purchase_level_tos=3811,t.m_tongxingzheng_purchase_level_toc=3812,t.m_tongxingzheng_collect_level_reward_tos=3813,t.m_tongxingzheng_collect_level_reward_toc=3814,t.messageList=[{id:1,name:proto.m_login_login_tos},{id:2,name:proto.m_login_login_toc},{id:3,name:proto.m_login_create_role_tos},{id:4,name:proto.m_login_create_role_toc},{id:5,name:proto.m_login_enter_game_tos},{id:6,name:proto.m_login_heart_beat_tos},{id:7,name:proto.m_login_notice_logout_toc},{id:101,name:proto.m_player_init_player_data_toc},{id:102,name:proto.m_player_notice_player_attr_change_toc},{id:103,name:proto.m_player_notice_player_string_attr_change_toc},{id:104,name:proto.m_player_notice_fun_active_toc},{id:105,name:proto.m_player_notice_server_time_toc},{id:106,name:proto.m_player_change_pk_mode_tos},{id:107,name:proto.m_player_change_pk_mode_toc},{id:108,name:proto.m_player_get_player_attr_tos},{id:109,name:proto.m_player_get_player_attr_toc},{id:110,name:proto.m_player_change_name_tos},{id:111,name:proto.m_player_change_name_toc},{id:112,name:proto.m_player_change_sex_tos},{id:113,name:proto.m_player_change_sex_toc},{id:114,name:proto.m_player_update_client_data_tos},{id:115,name:proto.m_player_delete_client_data_tos},{id:116,name:proto.m_player_adjust_tos},{id:117,name:proto.m_player_adjust_toc},{id:118,name:proto.m_player_customer_url_tos},{id:119,name:proto.m_player_customer_url_toc},{id:120,name:proto.m_player_visitor_binding_tos},{id:121,name:proto.m_player_visitor_binding_toc},{id:122,name:proto.m_player_notice_player_adjust_value_toc},{id:123,name:proto.m_player_get_server_time_tos},{id:124,name:proto.m_player_get_server_time_toc},{id:125,name:proto.m_player_modify_nickname_gender_tos},{id:126,name:proto.m_player_modify_nickname_gender_toc},{id:127,name:proto.m_player_set_player_data_tos},{id:128,name:proto.m_player_set_player_data_toc},{id:201,name:proto.m_scene_enter_scene_tos},{id:202,name:proto.m_scene_enter_scene_toc},{id:203,name:proto.m_scene_notice_prepare_scene_toc},{id:204,name:proto.m_scene_load_scene_tos},{id:205,name:proto.m_scene_load_scene_toc},{id:206,name:proto.m_scene_sync_scene_toc},{id:207,name:proto.m_scene_notice_scene_player_enter_toc},{id:208,name:proto.m_scene_notice_scene_player_leave_toc},{id:209,name:proto.m_scene_player_rebirth_tos},{id:210,name:proto.m_scene_player_rebirth_toc},{id:211,name:proto.m_scene_player_move_tos},{id:212,name:proto.m_scene_player_move_step_tos},{id:213,name:proto.m_scene_player_stop_move_tos},{id:214,name:proto.m_scene_notice_player_move_toc},{id:215,name:proto.m_scene_notice_player_stop_move_toc},{id:216,name:proto.m_scene_notice_player_teleport_toc},{id:217,name:proto.m_scene_notice_correct_player_pos_toc},{id:218,name:proto.m_scene_notice_monster_enter_toc},{id:219,name:proto.m_scene_notice_monster_leave_toc},{id:220,name:proto.m_scene_notice_monster_move_toc},{id:221,name:proto.m_scene_notice_monster_stop_move_toc},{id:222,name:proto.m_scene_notice_monster_teleport_toc},{id:223,name:proto.m_scene_notice_item_enter_toc},{id:224,name:proto.m_scene_notice_item_leave_toc},{id:225,name:proto.m_scene_notice_scene_item_owner_change_toc},{id:226,name:proto.m_scene_notice_player_death_toc},{id:227,name:proto.m_scene_query_player_pos_tos},{id:228,name:proto.m_scene_query_player_pos_toc},{id:229,name:proto.m_scene_notice_obj_hp_change_toc},{id:230,name:proto.m_scene_notice_monster_attr_change_toc},{id:231,name:proto.m_scene_transmit_tos},{id:232,name:proto.m_scene_notice_prepare_transmit_toc},{id:233,name:proto.m_scene_update_npc_date_toc},{id:234,name:proto.m_scene_notice_simplify_monster_pos_toc},{id:235,name:proto.m_scene_notice_start_yuchao_toc},{id:236,name:proto.m_scene_notice_stop_yuchao_toc},{id:237,name:proto.m_scene_get_monster_list_tos},{id:238,name:proto.m_scene_notice_monster_list_toc},{id:239,name:proto.m_scene_notice_anger_change_toc},{id:240,name:proto.m_scene_notice_special_skill_change_toc},{id:241,name:proto.m_scene_notice_show_fanpai_toc},{id:242,name:proto.m_scene_notice_fanpai_tos},{id:243,name:proto.m_scene_notice_fanpai_toc},{id:244,name:proto.m_scene_notice_yu_chao_start_time_toc},{id:245,name:proto.m_scene_notice_boss_state_toc},{id:246,name:proto.m_scene_challenge_boss_tos},{id:247,name:proto.m_scene_send_msg_tos},{id:248,name:proto.m_scene_notice_send_msg_toc},{id:249,name:proto.m_scene_notice_scene_jbxy_state_toc},{id:250,name:proto.m_scene_player_collect_tos},{id:251,name:proto.m_scene_get_gold_ranking_tos},{id:252,name:proto.m_scene_get_gold_ranking_toc},{id:253,name:proto.m_scene_notice_first_gold_ranking_toc},{id:301,name:proto.m_fight_fight_tos},{id:302,name:proto.m_fight_notice_fight_fail_toc},{id:303,name:proto.m_fight_notice_fight_result_toc},{id:304,name:proto.m_fight_notice_add_buff_toc},{id:305,name:proto.m_fight_notice_remove_buff_toc},{id:306,name:proto.m_fight_use_item_tos},{id:307,name:proto.m_fight_use_item_toc},{id:308,name:proto.m_fight_notice_bin_dong_skill_toc},{id:309,name:proto.m_fight_notice_cancel_bin_dong_toc},{id:310,name:proto.m_fight_notice_get_function_monster_award_toc},{id:311,name:proto.m_fight_give_function_monster_award_tos},{id:401,name:proto.m_times_add_times_tos},{id:402,name:proto.m_times_add_times_toc},{id:403,name:proto.m_times_notice_times_change_toc},{id:501,name:proto.m_prop_notice_update_prop_toc},{id:502,name:proto.m_prop_use_item_tos},{id:503,name:proto.m_prop_use_item_toc},{id:504,name:proto.m_prop_sell_item_tos},{id:505,name:proto.m_prop_sell_item_toc},{id:506,name:proto.m_prop_merge_tos},{id:507,name:proto.m_prop_merge_toc},{id:601,name:proto.m_chat_channel_chat_tos},{id:602,name:proto.m_chat_channel_chat_toc},{id:603,name:proto.m_chat_broadcast_channel_msg_toc},{id:604,name:proto.m_chat_broadcast_channel_msg_list_toc},{id:701,name:proto.m_mission_challenge_mission_tos},{id:702,name:proto.m_mission_challenge_mission_toc},{id:703,name:proto.m_mission_notice_mission_result_toc},{id:704,name:proto.m_mission_exit_mission_tos},{id:705,name:proto.m_mission_notice_passed_mission_toc},{id:706,name:proto.m_mission_notice_mission_close_time_toc},{id:707,name:proto.m_mission_notice_mission_round_toc},{id:708,name:proto.m_mission_notice_total_award_toc},{id:709,name:proto.m_mission_notice_mission_ranking_toc},{id:710,name:proto.m_mission_get_award_tos},{id:711,name:proto.m_mission_get_award_toc},{id:712,name:proto.m_mission_notice_mission_schedule_toc},{id:713,name:proto.m_mission_boss_rebirth_tos},{id:714,name:proto.m_mission_boss_rebirth_toc},{id:715,name:proto.m_mission_notice_shi_shi_settle_toc},{id:716,name:proto.m_mission_notice_shi_shi_time_toc},{id:717,name:proto.m_mission_notice_shi_shi_value_toc},{id:718,name:proto.m_mission_guess_get_record_tos},{id:719,name:proto.m_mission_guess_get_record_toc},{id:720,name:proto.m_mission_notice_guess_boss_cost_my_mana_toc},{id:721,name:proto.m_mission_notice_guess_boss_cost_total_mana_toc},{id:722,name:proto.m_mission_notice_guess_boss_mission_result_toc},{id:723,name:proto.m_mission_notice_guess_boss_mission_time_toc},{id:724,name:proto.m_mission_either_notice_state_toc},{id:725,name:proto.m_mission_either_either_tos},{id:726,name:proto.m_mission_either_notice_result_toc},{id:727,name:proto.m_mission_scene_boss_bet_tos},{id:728,name:proto.m_mission_scene_boss_bet_reset_tos},{id:729,name:proto.m_mission_notice_scene_boss_bet_toc},{id:730,name:proto.m_mission_notice_scene_boss_step_toc},{id:731,name:proto.m_mission_notice_scene_boss_result_toc},{id:732,name:proto.m_mission_notice_scene_boss_dao_num_change_toc},{id:733,name:proto.m_mission_notice_new_guess_result_toc},{id:734,name:proto.m_mission_lucky_boss_bet_tos},{id:735,name:proto.m_mission_lucky_boss_bet_toc},{id:736,name:proto.m_mission_lucky_boss_bet_reset_tos},{id:737,name:proto.m_mission_lucky_boss_bet_reset_toc},{id:738,name:proto.m_mission_lucky_boss_bet_modification_toc},{id:739,name:proto.m_mission_lucky_boss_bet_info_toc},{id:740,name:proto.m_mission_lucky_boss_status_tos},{id:741,name:proto.m_mission_lucky_boss_status_toc},{id:742,name:proto.m_mission_notice_lucky_boss_result_toc},{id:743,name:proto.m_mission_notice_lucky_boss_fight_toc},{id:801,name:proto.m_mail_get_mail_info_tos},{id:802,name:proto.m_mail_get_mail_info_toc},{id:803,name:proto.m_mail_read_mail_tos},{id:804,name:proto.m_mail_read_mail_toc},{id:805,name:proto.m_mail_get_item_mail_tos},{id:806,name:proto.m_mail_get_item_mail_toc},{id:807,name:proto.m_mail_delete_mail_tos},{id:808,name:proto.m_mail_delete_mail_toc},{id:809,name:proto.m_mail_add_mail_toc},{id:810,name:proto.m_mail_remove_mail_toc},{id:901,name:proto.m_vip_get_vip_award_tos},{id:902,name:proto.m_vip_get_vip_award_toc},{id:903,name:proto.m_vip_notice_vip_data_toc},{id:10001,name:proto.m_debug_debug_tos},{id:10002,name:proto.m_debug_debug_toc},{id:1001,name:proto.m_client_log_client_log_tos},{id:1101,name:proto.m_achievement_get_info_tos},{id:1102,name:proto.m_achievement_get_info_toc},{id:1103,name:proto.m_achievement_get_award_tos},{id:1104,name:proto.m_achievement_get_award_toc},{id:1105,name:proto.m_achievement_notice_update_achievement_data_toc},{id:1201,name:proto.m_rank_get_rank_info_tos},{id:1202,name:proto.m_rank_get_rank_info_toc},{id:1301,name:proto.m_shop_get_shop_info_tos},{id:1302,name:proto.m_shop_get_shop_info_toc},{id:1303,name:proto.m_shop_shop_item_tos},{id:1304,name:proto.m_shop_shop_item_toc},{id:1305,name:proto.m_shop_notice_shop_state_toc},{id:1306,name:proto.m_shop_withdraw_tos},{id:1307,name:proto.m_shop_withdraw_toc},{id:1308,name:proto.m_shop_withdraw_notify_toc},{id:1309,name:proto.m_shop_withdraw_history_tos},{id:1310,name:proto.m_shop_withdraw_history_toc},{id:1401,name:proto.m_activity_restart_all_activity_toc},{id:1402,name:proto.m_activity_update_activity_time_toc},{id:1403,name:proto.m_activity_give_online_award_tos},{id:1404,name:proto.m_activity_give_online_award_toc},{id:1501,name:proto.m_charge_notice_is_open_charge_toc},{id:1502,name:proto.m_charge_charge_tos},{id:1503,name:proto.m_charge_charge_toc},{id:1504,name:proto.m_charge_notice_charge_data_toc},{id:1505,name:proto.m_charge_get_charge_type_tos},{id:1506,name:proto.m_charge_get_charge_type_toc},{id:1601,name:proto.m_invest_get_invest_award_tos},{id:1602,name:proto.m_invest_get_invest_award_toc},{id:1603,name:proto.m_invest_notice_invest_data_update_toc},{id:1701,name:proto.m_everyday_sign_everyday_sign_tos},{id:1702,name:proto.m_everyday_sign_everyday_sign_toc},{id:1703,name:proto.m_everyday_sign_notice_day_toc},{id:1801,name:proto.m_seven_login_give_award_tos},{id:1802,name:proto.m_seven_login_give_award_toc},{id:1803,name:proto.m_seven_login_update_cumulative_day_toc},{id:1901,name:proto.m_platform_function_share_tos},{id:1902,name:proto.m_platform_function_share_toc},{id:1903,name:proto.m_platform_function_get_share_friend_give_tos},{id:1904,name:proto.m_platform_function_get_share_friend_give_toc},{id:1905,name:proto.m_platform_function_notice_share_friend_toc},{id:1906,name:proto.m_platform_function_notice_share_count_toc},{id:1907,name:proto.m_platform_function_notice_platform_vip_level_toc},{id:1908,name:proto.m_platform_function_get_platform_award_info_tos},{id:1909,name:proto.m_platform_function_get_platform_award_info_toc},{id:1910,name:proto.m_platform_function_get_share_task_info_tos},{id:1911,name:proto.m_platform_function_get_share_task_info_toc},{id:1912,name:proto.m_platform_function_get_share_task_award_tos},{id:1913,name:proto.m_platform_function_get_share_task_award_toc},{id:1914,name:proto.m_platform_function_notice_share_task_toc},{id:1915,name:proto.m_platform_function_refresh_open_key_tos},{id:1916,name:proto.m_platform_function_refresh_open_key_toc},{id:2001,name:proto.m_gift_code_gift_code_tos},{id:2002,name:proto.m_gift_code_gift_code_toc},{id:2101,name:proto.m_video_get_award_tos},{id:2102,name:proto.m_video_get_award_toc},{id:2201,name:proto.m_many_people_boss_get_room_list_tos},{id:2202,name:proto.m_many_people_boss_get_room_list_toc},{id:2203,name:proto.m_many_people_boss_join_room_tos},{id:2204,name:proto.m_many_people_boss_join_room_toc},{id:2205,name:proto.m_many_people_boss_create_room_tos},{id:2206,name:proto.m_many_people_boss_create_room_toc},{id:2207,name:proto.m_many_people_boss_start_tos},{id:2208,name:proto.m_many_people_boss_start_toc},{id:2209,name:proto.m_many_people_boss_participate_in_tos},{id:2210,name:proto.m_many_people_boss_participate_in_toc},{id:2211,name:proto.m_many_people_boss_kick_out_player_tos},{id:2212,name:proto.m_many_people_boss_set_is_all_ready_start_tos},{id:2213,name:proto.m_many_people_boss_set_is_all_ready_start_toc},{id:2214,name:proto.m_many_people_boss_ready_tos},{id:2215,name:proto.m_many_people_boss_ready_toc},{id:2216,name:proto.m_many_people_boss_leave_room_tos},{id:2217,name:proto.m_many_people_boss_notice_leave_room_toc},{id:2218,name:proto.m_many_people_boss_notice_player_join_toc},{id:2219,name:proto.m_many_people_boss_notice_player_leave_toc},{id:2220,name:proto.m_many_people_boss_notice_player_ready_toc},{id:2221,name:proto.m_many_people_boss_notice_player_fight_start_toc},{id:2222,name:proto.m_many_people_boss_notice_player_fight_result_toc},{id:2223,name:proto.m_many_people_boss_notice_owner_fight_result_toc},{id:2301,name:proto.m_sys_common_change_state_tos},{id:2302,name:proto.m_sys_common_change_state_toc},{id:2303,name:proto.m_sys_common_notice_sys_common_toc},{id:2401,name:proto.m_daily_task_get_info_tos},{id:2402,name:proto.m_daily_task_get_info_toc},{id:2403,name:proto.m_daily_task_get_award_tos},{id:2404,name:proto.m_daily_task_get_award_toc},{id:2405,name:proto.m_daily_task_notice_update_daily_task_data_toc},{id:2406,name:proto.m_daily_task_notice_update_task_show_toc},{id:2501,name:proto.m_promote_get_promote_record_tos},{id:2502,name:proto.m_promote_get_promote_record_toc},{id:2503,name:proto.m_promote_get_award_tos},{id:2504,name:proto.m_promote_get_award_toc},{id:2505,name:proto.m_promote_notice_player_promote_data_toc},{id:2506,name:proto.m_promote_notice_promote_times_toc},{id:2507,name:proto.m_promote_invitation_code_tos},{id:2508,name:proto.m_promote_invitation_code_toc},{id:2601,name:proto.m_task_get_award_tos},{id:2602,name:proto.m_task_get_award_toc},{id:2603,name:proto.m_task_notice_task_change_toc},{id:2701,name:proto.m_red_packet_notice_player_red_packet_toc},{id:2702,name:proto.m_red_packet_get_red_packet_tos},{id:2703,name:proto.m_red_packet_get_red_packet_toc},{id:2704,name:proto.m_red_packet_notice_player_red_packet_clear_toc},{id:2801,name:proto.m_brave_one_get_info_list_tos},{id:2802,name:proto.m_brave_one_get_info_list_toc},{id:2803,name:proto.m_brave_one_create_tos},{id:2804,name:proto.m_brave_one_create_toc},{id:2805,name:proto.m_brave_one_enter_tos},{id:2806,name:proto.m_brave_one_enter_toc},{id:2807,name:proto.m_brave_one_clean_tos},{id:2808,name:proto.m_brave_one_clean_toc},{id:2809,name:proto.m_brave_one_notice_fight_scene_toc},{id:2810,name:proto.m_brave_one_wait_scene_toc},{id:2811,name:proto.m_brave_one_ready_start_toc},{id:2812,name:proto.m_brave_one_fight_player_toc},{id:2813,name:proto.m_brave_one_win_player_toc},{id:2901,name:proto.m_step_by_step_sy_enter_tos},{id:2902,name:proto.m_step_by_step_sy_enter_toc},{id:2903,name:proto.m_step_by_step_sy_fight_tos},{id:2904,name:proto.m_step_by_step_sy_fight_toc},{id:2905,name:proto.m_step_by_step_sy_get_award_tos},{id:2906,name:proto.m_step_by_step_sy_get_award_toc},{id:2907,name:proto.m_step_by_step_sy_fight_result_toc},{id:3001,name:proto.m_turn_table_draw_tos},{id:3002,name:proto.m_turn_table_draw_toc},{id:3003,name:proto.m_turn_table_get_award_tos},{id:3004,name:proto.m_turn_table_get_award_toc},{id:3005,name:proto.m_turn_table_notice_reset_toc},{id:3101,name:proto.m_shi_shi_room_get_room_list_tos},{id:3102,name:proto.m_shi_shi_room_get_room_list_toc},{id:3103,name:proto.m_shi_shi_room_create_room_tos},{id:3104,name:proto.m_shi_shi_room_create_room_toc},{id:3105,name:proto.m_shi_shi_room_join_room_tos},{id:3106,name:proto.m_shi_shi_room_join_room_toc},{id:3107,name:proto.m_shi_shi_room_start_tos},{id:3108,name:proto.m_shi_shi_room_start_toc},{id:3109,name:proto.m_shi_shi_room_kick_out_player_tos},{id:3110,name:proto.m_shi_shi_room_ready_tos},{id:3111,name:proto.m_shi_shi_room_ready_toc},{id:3112,name:proto.m_shi_shi_room_leave_room_tos},{id:3113,name:proto.m_shi_shi_room_notice_leave_room_toc},{id:3114,name:proto.m_shi_shi_room_notice_player_join_toc},{id:3115,name:proto.m_shi_shi_room_notice_player_leave_toc},{id:3116,name:proto.m_shi_shi_room_notice_player_ready_toc},{id:3117,name:proto.m_shi_shi_room_notice_player_fight_start_toc},{id:3118,name:proto.m_shi_shi_room_notice_room_owner_change_toc},{id:3119,name:proto.m_shi_shi_room_notice_player_fight_result_toc},{id:3120,name:proto.m_shi_shi_room_notice_shi_shi_value_toc},{id:3201,name:proto.m_hero_charge_hero_parts_tos},{id:3202,name:proto.m_hero_charge_hero_parts_toc},{id:3203,name:proto.m_hero_unlock_hero_tos},{id:3204,name:proto.m_hero_unlock_hero_toc},{id:3205,name:proto.m_hero_hero_up_star_tos},{id:3206,name:proto.m_hero_hero_up_star_toc},{id:3207,name:proto.m_hero_notice_hero_unlock_parts_toc},{id:3208,name:proto.m_hero_notice_unlock_hero_toc},{id:3301,name:proto.m_card_get_award_tos},{id:3302,name:proto.m_card_get_award_toc},{id:3303,name:proto.m_card_notice_card_update_toc},{id:3401,name:proto.m_seize_treasure_currency_seize_treasure_type_toc},{id:3402,name:proto.m_seize_treasure_get_treasure_tos},{id:3403,name:proto.m_seize_treasure_get_treasure_toc},{id:3404,name:proto.m_seize_treasure_get_extra_award_tos},{id:3405,name:proto.m_seize_treasure_get_extra_award_toc},{id:3406,name:proto.m_seize_treasure_get_extra_award_status_tos},{id:3407,name:proto.m_seize_treasure_get_extra_award_status_toc},{id:3501,name:proto.m_card_summon_do_summon_tos},{id:3502,name:proto.m_card_summon_do_summon_toc},{id:3601,name:proto.m_shen_long_draw_tos},{id:3602,name:proto.m_shen_long_draw_toc},{id:3603,name:proto.m_shen_long_notice_scene_shen_long_state_toc},{id:3701,name:proto.m_skill_use_skill_tos},{id:3702,name:proto.m_skill_use_skill_toc},{id:3703,name:proto.m_skill_notice_active_skill_change_toc},{id:3801,name:proto.m_tongxingzheng_task_info_notice_toc},{id:3802,name:proto.m_tongxingzheng_task_daily_update_notice_toc},{id:3803,name:proto.m_tongxingzheng_task_month_update_notice_toc},{id:3804,name:proto.m_tongxingzheng_task_daily_reward_collect_tos},{id:3805,name:proto.m_tongxingzheng_task_daily_reward_collect_toc},{id:3806,name:proto.m_tongxingzheng_collect_task_month_reward_tos},{id:3807,name:proto.m_tongxingzheng_collect_task_month_reward_toc},{id:3808,name:proto.m_tongxingzheng_purchase_unlock_tos},{id:3809,name:proto.m_tongxingzheng_purchase_unlock_toc},{id:3810,name:proto.m_tongxingzheng_reward_info_notice_toc},{id:3811,name:proto.m_tongxingzheng_purchase_level_tos},{id:3812,name:proto.m_tongxingzheng_purchase_level_toc},{id:3813,name:proto.m_tongxingzheng_collect_level_reward_tos},{id:3814,name:proto.m_tongxingzheng_collect_level_reward_toc}],t
}();__reflect(MessageType.prototype,"MessageType");var DelayCallUtils=function(){function t(){}return t.delayedCall=function(e,i,s,n){var o="hashId:"+s.hashCode+"func:"+i.toString(),a=t.delayCallDict[o];null==a&&(a=[],t.delayCallDict[o]=a);var r=TweenLite.delayedCall(e,function(){a.splice(a.indexOf(r),1),i.apply(s,n),s=null,n=null,i=null,0==a.length&&(t.delayCallDict[o]=null,delete t.delayCallDict[o])});return a.push(r),r},t.killDelayedCallsTo=function(e,i){var s="hashId:"+i.hashCode+"func:"+e.toString(),n=t.delayCallDict[s];if(null==n||0==n.length)return null;for(;n.length>0;)n[0].kill(),n[0].data=null,n[0].vars=null,n[0].target=null,n.splice(0,1);t.delayCallDict[s]=null,delete t.delayCallDict[s]},t.delayCallDict=[],t}();__reflect(DelayCallUtils.prototype,"DelayCallUtils");var DirectionUtil=function(){function t(){}return t.getRadianByDirection=function(e){return t.DirectionAngleList[e]/360*(2*Math.PI)},t.getRotationByDirection=function(e){return t.DirectionFullAngleList[e]},t.transformPointByDirection=function(e,i,s,n){void 0===s&&(s=null),void 0===n&&(n=!0);var o=i.x,a=i.y;null!=s?(o-=s.x,o=a-s.y):s=new egret.Point(0,0);var r=t.DirectionAngleList[e]/360*(2*Math.PI),_=Math.cos(r)*o-Math.sin(r)*a,h=Math.cos(r)*a+Math.sin(r)*o,l=0,c=0;return n&&(0==e?(l=60,c=-60):4==e&&(l=-60)),this.m_transformPoint.x=_+s.x+l,this.m_transformPoint.y=h+s.y+c,this.m_transformPoint},t.getAngleDistance=function(t,e,i){void 0===i&&(i=100);var s=e.x-t.x,n=e.y-t.y,o=i/egret.Point.distance(t,e);return s=o*s,n=o*n,this.m_angleDistancePt.x=e.x-s,this.m_angleDistancePt.y=e.y-n,this.m_angleDistancePt},t.changeRadianToAngle=function(t){return t/(2*Math.PI)*360},t.getDirectionPoint=function(t,e){var i,s=e.x,n=e.y;switch(t){case 1:s=s,n=n;break;case 2:s=StageManager.instance.p_stageWidth-s,n=n;break;case 3:s=s,n=StageManager.instance.p_stageHeight-n;break;case 4:s=StageManager.instance.p_stageWidth-s,n=StageManager.instance.p_stageHeight-n;break;case 5:s=.5*(StageManager.instance.p_stageWidth-640)+s,n=.5*(StageManager.instance.p_stageHeight-1136)+n;break;case 6:s=.5*(StageManager.instance.p_stageWidth-640)+s,n=n}return i=new egret.Point(s,n)},t.getRotationByPoint=function(t,e){var i=Math.atan2(e.y-t.y,e.x-t.x),s=i*(180/Math.PI);return s},t.DirectionAngleList=[270,-27,0,27,90,27,0,-27],t.DirectionValueList=[0,1,2,3,4,3,2,1],t.DirectionFullAngleList=[270,333,0,27,90,117,180,207],t.m_transformPoint=new egret.Point,t.m_angleDistancePt=new egret.Point,t}();__reflect(DirectionUtil.prototype,"DirectionUtil");var DisplayObjectUtils=function(){function t(){}return t.removeFormParent=function(t){t&&t.parent&&t.parent.removeChild(t)},t.registerEventClick=function(t,e,i,s,n,o){void 0===s&&(s=!1),void 0===n&&(n=SoundEnum.EFFECT_SOUND_1007),void 0===o&&(o=null),this.m_clickList[t.hashCode]={mc:t,setProp:[t.x,t.y,t.scaleX,t.scaleY,t.width,t.height],soundEffectId:n,func:e.bind(i)},(null!=o||s)&&(t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onClickBegin,this),t.addEventListener(egret.TouchEvent.TOUCH_END,this.onClickEnd,this),t.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onClickEndOut,this),null!=o&&(this.m_clickList[t.hashCode].funcOther=o.bind(i))),t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickSound,this)},t.onClickSound=function(t){var e=t.currentTarget;e&&null!=this.m_clickList[e.hashCode]&&(SoundMoude.instance.playSoundEffect(this.m_clickList[e.hashCode].soundEffectId),this.m_clickList[e.hashCode].func(t))},t.onClickBegin=function(t){var e=t.currentTarget;if(null!=this.m_clickList[e.hashCode]){this.m_select_ket=e.hashCode;var i=this.m_clickList[e.hashCode].setProp,s=.1*i[4]*.5;0>=s&&(s=4);var n=.1*i[5]*.5;0>=n&&(n=4),e.x=i[0]+s,e.y=i[1]+n,e.scaleX=i[2]-.1,e.scaleY=i[3]-.1,null!=this.m_clickList[e.hashCode].funcOther&&this.m_clickList[e.hashCode].funcOther(t,1),t.stopPropagation(),t.stopImmediatePropagation()}},t.onClickEnd=function(t){var e=t.currentTarget;if(null!=this.m_clickList[e.hashCode]){this.m_select_ket=0;var i=this.m_clickList[e.hashCode].setProp;e.x=i[0],e.y=i[1],e.scaleX=i[2],e.scaleY=i[3],null!=this.m_clickList[e.hashCode].funcOther&&this.m_clickList[e.hashCode].funcOther(t,2)}},t.onClickEndOut=function(t){var e=t.currentTarget;if(e&&this.m_clickList[e.hashCode]){var i=this.m_clickList[e.hashCode].setProp;e.x=i[0],e.y=i[1],e.scaleX=i[2],e.scaleY=i[3],null!=this.m_clickList[e.hashCode].funcOther&&this.m_clickList[e.hashCode].funcOther(t,3)}},t.removeEventClick=function(t){this.m_clickList[t.hashCode]&&(t.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickSound,this),this.m_clickList[t.hashCode].isButton&&(t.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onClickBegin,this),t.removeEventListener(egret.TouchEvent.TOUCH_END,this.onClickEnd,this),t.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onClickEndOut,this)),delete this.m_clickList[t.hashCode])},t.m_clickList={},t.m_select_ket=0,t}();__reflect(DisplayObjectUtils.prototype,"DisplayObjectUtils");var EaseFuncUtil=function(){function t(){}return t.getEaseFunc=function(t){var e;switch(t){case"Cubic.easeIn":e=Cubic.easeIn;break;case"Cubic.easeInOut":e=Cubic.easeInOut;break;case"Cubic.easeOut":e=Cubic.easeOut;break;case"Linear.easeNone":e=Linear.easeNone;break;case"Back.easeInOut":e=Back.easeInOut;break;case"Back.easeIn":e=Back.easeIn;break;case"Back.easeOut":e=Back.easeOut;break;default:e=Linear.easeNone}return e},t}();__reflect(EaseFuncUtil.prototype,"EaseFuncUtil");var FuncCallBack=function(){function t(t,e){this.func=t,this.thisObj=e}return t.create=function(e,i){return new t(e,i)},t.prototype.call=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.func.apply(this.thisObj,t)},t}();__reflect(FuncCallBack.prototype,"FuncCallBack");var HtmlUtil=function(){function t(){}return t.setTextFlow=function(t,e){return(new egret.HtmlTextParser).parser(this.setText(t,e))},t.setText=function(e,i){e=t.colorStyle(e),e=t.sizeStyle(e),e=t.boldStyle(e),e=t.underStyle(e),e=t.imageStyle(e),e=t.enterStyle(e),e=t.insertRoleName(e),this.transfromInsertArr(i);var s;if(i){t.m_insertRegExp.lastIndex=0;for(var n=0;n<i.length;n++)if(t.m_insertRegExp.lastIndex=0,s=t.m_insertRegExp.exec(e)){if(s[1].length>4){var o=s[1].substr(0,4),a=Number(s[1].substr(4));if("text"==o){e=null!=a&&null!=i[a]?e.replace(s[0],i[a]):e.replace(s[0],"{未定义["+s[1]+"]}");continue}}switch(s[1]){case"text":e=e.replace(s[0],i[n]);break;default:e=e.replace(s[0],"{未定义["+s[1]+"]}")}}}return e},t.transfromInsertArr=function(e){if(null!=e)for(var i=0;i<e.length;i++){var s=e[i]+"";s=t.colorStyle(s),s=t.sizeStyle(s),s=t.boldStyle(s),s=t.underStyle(s),s=t.imageStyle(s),s=t.enterStyle(s),s=t.insertRoleName(s),e[i]=s}},t.colorStyle=function(e){for(var i,s=e;;){if(i=t.m_colorRegExpStart.exec(s),!i)break;s=s.replace(i[0],"<font color='"+ColorJson.getColorStr(Number(i[1]))+"'>")}return s=s.replace(t.m_colorRegExpEnd,"</font>")},t.sizeStyle=function(e){for(var i,s=e;;){if(i=t.m_sizeRegExpStart.exec(s),!i)break;s=s.replace(i[0],"<font size='"+i[1]+"'>")}return s=s.replace(t.m_sizeRegExpEnd,"</font>")},t.boldStyle=function(e){var i=e;return i=i.replace(t.m_boldRegExpStart,"<b>"),i=i.replace(t.m_boldRegExpEnd,"</b>")},t.underStyle=function(e){var i=e;return i=i.replace(t.m_underRegExpStart,"<u><a href='event:3'>"),i=i.replace(t.m_underRegExpEnd,"</a></u>")},t.imageStyle=function(e){var i=e;i=i.replace(/\\/g,"/"),i=i.replace(t.imgRegExpStart," <img src = 'resource/assets/"),i=i.replace(t.imgRegExpEnd,"'></img>\n ");for(var s=i.split("<img src = '"),n=0;n<s.length;n++){var o=s[n],a=o.split("'></img>");if(a.length>=2){var r=URIManager.getVersionUrl(a[0]);i=i.replace(a[0],r)}}return i},t.enterStyle=function(e){var i=e;return i=i.replace(t.m_enterRegExp,"\n")},t.insertRoleName=function(e){var i=e;return PlayerManager.instance.p_playerInfo&&(i=i.replace(t.m_playerNameExp,PlayerManager.instance.p_playerInfo.nickname)),i},t.m_colorRegExpStart=/\|c(\d{3})/g,t.m_colorRegExpEnd=/\$c/g,t.m_sizeRegExpStart=/\|s(\d{1,2})/g,t.m_sizeRegExpEnd=/\$s/g,t.m_boldRegExpStart=/\|b/g,t.m_boldRegExpEnd=/\$b/g,t.m_underRegExpStart=/\|u/g,t.m_underRegExpEnd=/\$u/g,t.imgRegExpStart=/\|img='/g,t.imgRegExpEnd=/'\$img/g,t.m_enterRegExp=/\|n/g,t.m_insertRegExp=/{%([a-zA-Z]{1,4}[0-9]{0,2})}/g,t.m_playerNameExp=/\|playername/g,t}();__reflect(HtmlUtil.prototype,"HtmlUtil");var ImagePools=function(){function t(){}return t.getImage=function(t){var e;return this.imagePool.length>0&&(e=this.imagePool.shift()),null==e?(e=new egret.Bitmap,e.texture=t):e.texture=t,e},t.recoverImage=function(t){null!=t&&(t.parent&&t.parent.removeChild(t),t.texture=null,t.x=0,t.y=0,t.anchorOffsetX=0,t.anchorOffsetY=0,t.scaleX=1,t.scaleY=1,t.rotation=0,t.alpha=1,t.blendMode=egret.BlendMode.NORMAL,this.imagePool.push(t))},t.imagePool=new Array,t}();__reflect(ImagePools.prototype,"ImagePools");var ListUtils=function(){function t(){}return t.refreshList=function(t,e,i){var s=this;if(void 0===i&&(i={resetScrollerHV:!1}),t&&t instanceof eui.List){var n=t.dataProvider;if(n||(n=t.dataProvider=new eui.ArrayCollection),e&&Array.isArray(e)?n.replaceAll(e.concat()):e&&e instanceof eui.ArrayCollection?n.replaceAll(e.source.concat()):console.warn("refreshList 错误的参数array"),i.smart){var o=t.parent;if(o&&o instanceof eui.Scroller){o.stopAnimation();var a=o.viewport.scrollV>=t.contentHeight-o.height;egret.callLater(function(){egret.callLater(function(){a&&(o.viewport.scrollV=Math.max(0,t.contentHeight-o.height))},s)},this)}}else if(i.resetScrollerHV){var r=t.parent;r&&r instanceof eui.Scroller?egret.callLater(function(){r.stopAnimation(),egret.callLater(function(){i.offset&&i.offset.x?r.viewport.scrollH=i.offset.x:r.viewport.scrollH=0;var e=t.contentHeight;i.offset&&i.offset.y?r.viewport.scrollV=Math.min(e-r.height,i.offset.y):r.viewport.scrollV=0},s)},this):console.warn("refreshList list的parent不为eui.Scroller")}else{var _=t.parent;_&&_ instanceof eui.Scroller&&(_.stopAnimation(),egret.callLater(function(){egret.callLater(function(){var e=t.contentHeight-t.height;t.scrollV>e&&(t.scrollV=Math.max(0,e))},s)},this))}}else console.warn("refreshList 错误的参数list")},t}();__reflect(ListUtils.prototype,"ListUtils");var ObjectUtils=function(){function t(){}return t.setGrey=function(t,e,i){if(void 0===e&&(e=!0),void 0===i&&(i=!1),e){var s=[.3,.5,0,0,0,.3,.5,0,0,0,.3,.5,0,0,0,0,0,0,1,0],n=new egret.ColorMatrixFilter(s);t.filters=[n],t.touchEnabled=i}else t.filters=[],t.touchEnabled=!0},t.setGrey2=function(t,e){if(void 0===e&&(e=!0),e){var i=[1,0,0,0,-150,0,1,0,0,-150,0,0,1,0,-150,0,0,0,1,0],s=new egret.ColorMatrixFilter(i);t.filters=[s]}else t.filters=[]},t.clone=function(t){function e(t){function i(){}i.prototype=t;var s=new i;for(var n in s)"object"==typeof s[n]&&(s[n]=e(s[n]));return s}var i=e(t);return i},t.sortObj=function(t){for(var e=Object.keys(t).sort(),i={},s=0;s<e.length;s++)i[e[s]]=t[e[s]];return i},t.getParsingObj=function(t){if(!t||""==t)return null;if("{}"==t||"[]"==t)return[];for(this.objIndex=0,t=this.preParse(t);t.indexOf("{")>=0;){var e=this.findComparedStr(t),i=this.parseObjectToDic(e);t=t.split(e).join(i)}var s=this.objDic[t];for(var n in this.objDic)delete this.objDic[n];return s},t.getValueList=function(t,e){for(var i,s=t,n=[];;){if(i=e.exec(t),!i)break;s=s.replace(i[0],this.NAME_TI),n.push(i[1])}var o=0;i=s.split(",");for(var a=0;a<i.length;a++)this.trim(i[a])==this.NAME_TI&&(i[a]=n[o],o++);return i},t.trim=function(t){if(null==t)return null;var e=/^\s*|\s*$/g;return t.replace(e,"")},t.preParse=function(t){var e=t,i=/\s+/g;for(e=e.replace(i,"");e.indexOf("'")>=0;){var s=e.indexOf("'"),n=e.indexOf("'",s+1),o=e.substring(s,n+1),a=o.split("'").join("").split("=").join(this.REPLACE_EQ)+this.ZIFUC_KEY;e=e.split(o).join(a)}return e},t.findComparedStr=function(t,e,i){void 0===e&&(e="{"),void 0===i&&(i="}");var s=t.indexOf(i),n=t.lastIndexOf(e,s);return t.substring(n,s+1)},t.parseObjectToDic=function(t,e){void 0===e&&(e=1);var i;if(1==e?i=this.parseObject(t):2==e&&(i=this.parseObjectList(t)),!i)return"";this.objIndex++;var s=this.CLASS_PREFIX+this.objIndex;return this.objDic[s]=i,s},t.parseObjectList=function(t){for(var e=t.substring(1,t.length-1);e.indexOf("(")>=0;){var i=this.findComparedStr(e,"(",")"),s=this.parseObjectToList(i);e=e.split(i).join(s)}for(var n=e.split(","),o=0;o<n.length;o++)n[o].indexOf(this.CLASS_PREFIX)>=0&&(n[o]=this.objDic[n[o]]);return n},t.parseObjectToList=function(t){var e=this.getParsingJson(t);this.objIndex++;var i=this.CLASS_PREFIX+this.objIndex;return this.objDic[i]=e,i},t.getParsingJson=function(t){if(!t||""==t||"{}"==t)return{};for(var e=[],i=this.getValueList(t,this.m_xiaoRegExpStart),s=0;s<i.length;s++){for(var n={},o=this.getValueList(i[s],this.m_daRegExpStart),a=0;a<o.length;a++){var r=o[a].split(",");n[r[0]]=r[1]}e.push(n)}return e[0]},t.parseObject=function(t){var e,i=t.substring(1,t.length-1);if(!i)return null;if(i.indexOf("=")<0){e=i.split(",");for(var s=0,n=e.length;n>s;s++)e[s]=this.parseType(e[s]);return e}var o={};e=i.split(",");for(var a=0,r=e.length;r>a;a++){var _=e[a].split("="),h=String(_[0]),l=h.indexOf("[");l>=0&&(h=h.substring(l+1,h.indexOf("]")));var c=this.parseType(_[1]);o[h]=c}return o},t.parseType=function(t){if(!t)return null;if("0"==t||Number(t)>0)return Number(t);if(this.objDic[t]){var e=this.objDic[t];return e}return t.indexOf(this.ZIFUC_KEY)>0&&(t=t.replace(this.ZIFUC_KEY,"")),t.split(this.REPLACE_EQ).join("=")},t.objDic={},t.objIndex=0,t.REPLACE_EQ="<%EQUAL%>",t.ZIFUC_KEY="<%ZIFUC%>",t.CLASS_PREFIX="<%CLASS%>",t.NAME_TI="@#^NAME",t.m_xiaoRegExpStart=/\((.*?)\)/g,t.m_zhRegExpStart=/\[(.*?)\]/g,t.m_daRegExpStart=/{(.*?)}/g,t}();__reflect(ObjectUtils.prototype,"ObjectUtils");var BubbleJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||egret.log(this.FileName+" :不存在["+t+"]项！"),i},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="bubble",t}();__reflect(BubbleJson.prototype,"BubbleJson"),window.BubbleJson=BubbleJson;var Trace=function(){function t(){this.isshow=!1}return t.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setData(LogType.NORMAL,t)},t.socketLog=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setData(LogType.SOCKETLOG,t)},t.fighttLog=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setData(LogType.FIGHTLOG,t)},t.normalLog=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setData(LogType.NORMAL,t)},t.setData=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(URIManager.isdebug){for(var s="",n=0;n<e.length;n++)s+=e[n]+" ";if(s.length>1e3&&s.substring(1,1e3),s=TimeUtil.getSpliceTime(egret.getTimer())+"  "+s,this.logDictArr[t].length>50){this.logDictArr[t].splice(0,10),this.logDict[t]="";for(var n=0;n<this.logDictArr[t].length;n++)this.logDict[t]=this.logDict[t]+this.logDictArr[t][n]+"\n"}this.logDictArr[t].push(s),this.logDict[t]=this.logDict[t]+s+"\n",t!=LogType.SOCKETLOG&&console.log(s)}},t.prototype.init=function(t){this.m_root=t,this.traceModule=new egret.DisplayObjectContainer},t.init=function(){this.logDictArr=[];for(var t=0;t<LogType.NULL;t++)this.logDict[t]="",this.logDictArr[t]=[]},Object.defineProperty(t,"instance",{get:function(){return this.ms_instance||(this.ms_instance=new t),this.ms_instance},enumerable:!0,configurable:!0}),t.logDict=[],t}();__reflect(Trace.prototype,"Trace");var URIManager=function(){function t(){}return Object.defineProperty(t,"is_platform",{get:function(){return""==this.platformId||"nil"==this.platformId||"local"==this.platformId?!1:!0},enumerable:!0,configurable:!0}),t.getVersionUrl=function(e){if(""!=e&&1==t.isdebug&&(e.indexOf("resource/ui")>-1||e.indexOf("index_bg")>-1||e.indexOf("resource/eui_skins")>-1||e.indexOf("resource/json")>-1||e.indexOf("resource/default.res.json")>-1||e.indexOf("resource/default.thm.json")>-1))return e;if("nil"==this.cdn)return e;if(-1!=e.indexOf("https://"))return e;if(e=e.replace(/\\/g,"/"),e=e.replace("resource/",""),window.platform_name&&e.indexOf("index_res/index_bg.jpg")>-1)return"./resource/"+e;if(t.p_assestList&&t.p_assestList[e])return this.m_assetList&&delete this.m_assetList[e],"./resource/"+e;var i;return t.fileList&&(i=t.fileList[e]),e=null!=i?t.cdn+i+"/"+e:t.cdn+t.firstversions+"/"+e,e=e.replace("resource//","resource/")},Object.defineProperty(t,"is_https",{get:function(){return this.m_is_https},enumerable:!0,configurable:!0}),Object.defineProperty(t,"game_host",{get:function(){return this._game_host},enumerable:!0,configurable:!0}),Object.defineProperty(t,"game_port",{get:function(){return this._game_port},enumerable:!0,configurable:!0}),t.initSetting=function(e){t.platformId=e.platform_id&&"nil"!=e.platform_id?e.platform_id:"";var i="";window.location&&window.location.href&&(i=window.location.href);-1==e.cdn.indexOf("http")?(-1!=i.indexOf("https")?(i="https://",this.m_is_https=!0):(i="http://",this.m_is_https=!1),(-1==e.cdn.indexOf("/resource")||-1!=e.cdn.indexOf("./resource")||-1!=e.cdn.indexOf("../resource"))&&(i="")):(i="",this.m_is_https=-1==e.cdn.indexOf("https")?!1:!0),t.isInitSetting=!0,t.cdn=e.cdn?i+e.cdn:"resource/",t.versions=e.versions&&"nil"!=e.versions?e.versions:"",t.firstversions=e.firstversions&&"nil"!=e.firstversions?e.firstversions:"",t.isdebug=e.isdebug,t.channelId=e.channel?e.channel:"",ServerListManager.instance.p_server_list_url_all=i+e.server_list_url_all,ServerListManager.instance.p_server_list_url_recent=i+e.server_list_url_recent,ServerListManager.instance.p_server_list_group_num=e.server_list_group_num},t.analyze=function(t,e){this._game_host=e.game_host?e.game_host:"127.0.0.1",this._game_port=e.game_port?e.game_port:8088},t.getPlatformUrl=function(t,e){for(var i=t;;){this.m_suRegExpStart.lastIndex=0;var s=this.m_suRegExpStart.exec(i);if(!s)break;var n=s[1];i=i.replace(s[0],e[n])}return i},t.p_fb="fb",t.p_google="google",t.p_youke="visitor",t.p_line="line",t.isInitSetting=!1,t.rootUrl=".",t.is_open_charg=1,t.is_native_pay=1,t.is_reviewing=0,t.p_packName="com.goldmaster.game",t.p_imeiKey="3636",t.p_isGuest=!1,t.p_h5Game=!1,t.channelId="Null",t.versions="",t.firstversions="",t.cdn="nil",t.isdebug=!0,t.platformId="",t.m_assetList={},t.m_is_https=!1,t._game_port=8090,t.m_suRegExpStart=/\[(.*?)\]/g,t}();__reflect(URIManager.prototype,"URIManager"),window.URIManager=URIManager;var ArrayUtils=function(){function t(){}return t.setToNumberList=function(t){for(var e=[],i=0;i<t.length;i++)e.push(Number(t[i]));return e},t.setSortNum=function(t,e){void 0===e&&(e=0),t&&t.length>1&&(0==e?t.sort(function(t,e){return t>e?1:-1}):t.sort(function(t,e){return e>t?1:-1}))},t.setSortArr=function(t,e,i){function s(t,e){return void 0===e&&(e=null),function(i,s){var n=0;e&&(n=e.length);var o;for(var a in t){var r=parseInt(a);if(o=parseInt(i[t[a]])-parseInt(s[t[a]]),0!=o)return n>r&&0==e[a]?o:-o}return 0}}void 0===i&&(i=null),null!=t&&t.sort(s(e,i))},t}();__reflect(ArrayUtils.prototype,"ArrayUtils");var JsonUtil=function(){function t(){}return t.startJson=function(){if(1!=this.m_initJsoned)if(this.m_initJsoned=!0,URIManager.isdebug)for(var t=RES.getGroupByName("preloadJson"),e=0;e<t.length;e++)this.setJsonToClass(t[e]);else this.setBinByJszip()},t.setJsonToClass=function(e){for(var i="",s=e.name.split("_"),n=0;n<s.length;n++)i+=s[n].charAt(0).toUpperCase()+s[n].substring(1);var o=egret.getDefinitionByName(i);null!=o&&(SkillAssemblyJson!=o?t.setJson(o):t.setJson2(o)),o&&o.FileName&&(this.m_analyzeData[o.FileName]=!0)},t.setJson=function(t,e){void 0===e&&(e=null);var i=e?e:RES.getRes(t.FileName+"_json");if(null==i)return void console.log("JSON文件初始化失败！:",t.FileName);var s={},n=[],o="",a="";if(o=i[0].client_key,null==o)return void console.log("JSON文件初始化失败 = ",t.FileName);n=o.split("&");for(var r=1;r<i.length;r++){for(var _=0;_<n.length;_++)a=0==_?i[r][n[_]]:a+"_"+i[r][n[_]];s[a]=i[r]}t.jsonData=s},t.setJson2=function(t,e){void 0===e&&(e=null);var i=e?e:RES.getRes(t.FileName+"_json");return null==i?void Trace.log("JSON文件初始化失败！:",t.FileName):void t.setData(i)},t.decodeStr=function(t){var e=JSON.parse(t),i={},s=[],n="",o="";if(n=e[0].client_key,null==n)return void console.log("JSON文件初始化失败 decodeStr");s=n.split("&");for(var a=1;a<e.length;a++){for(var r=0;r<s.length;r++)o=0==r?e[a][s[r]]:o+"_"+e[a][s[r]];i[o]=e[a]}return i},t.setBinByJszip=function(){this.m_zip=new JSZip(RES.getRes("gamedata_bin"));var e,i,s,n,o,a,r=RES.getGroupByName("preloadJson");for(e=0;e<r.length;e++){i="",s=r[e].name.split("_");for(var _=0;_<s.length;_++)i+=s[_].charAt(0).toUpperCase()+s[_].substring(1);o=r[e].name.replace("_json",".json"),a=this.m_zip.file(o),this.m_zip.remove(o);var h="";a?(h=a.asText(),n=h,this.m_jsonStrData[o]=h):console.log("|||||||||||||||||||||||||||||||||","找不到压缩资源",i);var l=egret.getDefinitionByName(i);null!=l?SkillAssemblyJson==l?t.setJson2(l,JSON.parse(n)):t.setJson(l,JSON.parse(n)):console.log("error csvName = "+i)}RES.destroyRes("gamedata_bin")},t.analyzeJsonStr=function(e,i){if(URIManager.isdebug)return i;if(this.m_analyzeData.hasOwnProperty(e)&&1==this.m_analyzeData[e])return i;var s=this.m_jsonStrData[e+".json"];return s&&""!=s?(i=t.decodeStr(s),this.m_analyzeData[e]=!0):console.log(" 解析数据失败 = "+e),i},t.analyze=function(t,e){for(var i=[],s=0;s<e.length;s++)i[e[s].Id]=e[s];t.jsonData=i},t.m_initJsoned=!1,t.m_jsonStrData={},t.m_analyzeData={},t}();__reflect(JsonUtil.prototype,"JsonUtil");var LongUtil=function(){function t(){this._highValue=0,this._lowValue=0}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.toNumber64Uint=function(t,e){void 0===e&&(e=10),this._lowValue=Number(t.low),this._highValue=Number(t.high);for(var i,s,n,o="",a=this._lowValue,r=this._highValue,_=Math.pow(2,32);0!=r||0!=a;)i=r%e,n=i*_+a,s=n%e,o=s.toString(e)+o,r=(r-i)/e,a=(n-s)/e;return Number(o)},t}();__reflect(LongUtil.prototype,"LongUtil");var NumberUtil=function(){function t(){}return t.isNumber=function(t){return"number"==typeof t&&!isNaN(t)},t.parseNumberToZN=function(t){for(var e=new Array("零","壹","贰","叁","肆","伍","陆","柒","捌","玖"),i=new Array("分","角","圆","拾","佰","仟","万","拾","佰","仟","亿","拾","佰","仟","万"),s=100*t,n=s.toString(),o=n.replace(".","").split(""),a=new Array,r=0;r<o.length;){var _=o[r],h=o.length-r-1;"0"!=_?(a.push(e[_]),a.push(i[h])):((2===h||6===h||10===h)&&a.push(i[h]),r+1<o.length&&"0"!=o[r+1]&&2!=h&&6!=h&&10!=h&&a.push(e[_])),r++}return a.join("")},t.numberDecimalism=function(t,e){if(void 0===e&&(e=","),100>t)return String(t);for(var i=String(t),s=i.split(""),n=1,o="",a=s.length-1;a>=0;a--)3>=n?"."!=s[a]?(o=s[a]+o,n++):(o=s[a]+o,n=1):(o=s[a]+e+o,n=2);return o},t.numberToString=function(e,i,s){return void 0===i&&(i=2),void 0===s&&(s=1e3),e=Math.floor(e),0>=e?"0":e>=s?e>=1e9?this.getValueNum(e,1e9,i)+"B":e>=1e6?this.getValueNum(e,1e6,i)+"M":this.getValueNum(e,1e3,i)+"K":t.numberDecimalism(e)},t.getValueNum=function(t,e,i){void 0===i&&(i=1);var s=Number(t/e).toFixed(i),n=s.split(".");if(0==Number(n[1])||""==n[1])return n[0];for(var o=n[1].split(""),a=String(n[1]),r=0,_=o.length-1;_>0;_--)if(0!=o[_]){r=_;break}return a=a.slice(0,r+1),n[0]+"."+a},t.toFixed=function(t,e){void 0===e&&(e=1);for(var i="1",s=0;e>s;s++)i+="0";return t=Math.ceil(t*Number(i))/Number(i)},t.toFixedString=function(t,e){void 0===e&&(e=1);var i=String(t),s="";if(-1==i.indexOf("."))return i;for(var n=i.split("."),o="",a=!1,r=e;r>0;r--)o=n[1].substr(r-1,1),"0"!=o&&(a=!0),s=a?o+s:("0"==o?"":o)+s;return s=n[0]+"."+s},t.getUpsetList=function(t){if(t&&t.length>1){var e=[];for(var i in t)e.push(t[i]);return e}return t},t.randomIndexList=function(t){for(var e=t.slice(),i=[],s=e.length,n=0;s>n;n++){var o=Math.random()*e.length>>0;i.push(e[o]),e.splice(o,1)}return i},t.getDelList=function(t,e){var i=[];if(t&&t.length>1&&e<t.length&&e>0){for(var s=0;e>s;s++){var n=Math.floor(Math.random()*t.length);i.push(t.splice(n,1)[0])}return[t,i]}return[t,[]]},t}();__reflect(NumberUtil.prototype,"NumberUtil");var StringUtil=function(){function t(){}return t.formatString=function(t,e){for(var i=[],s=2;s<arguments.length;s++)i[s-2]=arguments[s];var n,o,a=[];for(var r in AttrSignJson.jsonData)o=AttrSignJson.jsonData[r],o&&a.push(o.sign);for(n=0;n<a.length;++n)if(i.length>0)if(-1!=a[n].indexOf("rate"))if("rate"==a[n])t=t.replace(new RegExp("\\{"+a[n]+"\\}","g"),String(i[0]/100));else{var _=a[n];_=_.substring(-4),t=t.replace(new RegExp("\\{"+a[n]+"\\}","g"),String(i[0]/Number(_)))}else t=-1!=a[n].indexOf("_rate")?t.replace(new RegExp("\\{"+a[n]+"\\}","g"),String(i[0]/100)):t.replace(new RegExp("\\{"+a[n]+"\\}","g"),i[0]);else if(e)if(-1!=a[n].indexOf("_rate1000")){if(-1!=t.indexOf(a[n])){var h=a[n];h=h.substring(-4);var l=a[n].split("_rate1000")[0];t=t.replace(new RegExp("\\{"+a[n]+"\\}","g"),String(Number(e[l])/1e3))}}else if("rate"==a[n])t=t.replace(new RegExp("\\{"+a[n]+"\\}","g"),String(NumberUtil.toFixed(e.p/100,1)));else{if(e.args_json)for(var c=0;c<e.args_json.length;c++){var m=e.args_json[c][0];t=-1!=m.indexOf("_rate")?t.replace(new RegExp("\\{"+m+"\\}","g"),String(NumberUtil.toFixed(e.args_json[c][1]/100))):t.replace(new RegExp("\\{"+m+"\\}","g"),e.args_json[c][1])}else t=-1!=a[n].indexOf("_rate")?t.replace(new RegExp("\\{"+a[n]+"\\}","g"),String(NumberUtil.toFixed(e[a[n]]/100))):t.replace(new RegExp("\\{"+a[n]+"\\}","g"),e[a[n]]);if(-1!=a[n].indexOf("_rate"))t=e.args_json?t.replace(new RegExp("\\{"+a[n]+"\\}","g"),String(NumberUtil.toFixed(e.args_json[a[n]]/100))):t.replace(new RegExp("\\{"+a[n]+"\\}","g"),String(NumberUtil.toFixed(e[a[n]]/100)));else if(e.args_json){if(!e.args_json.hasOwnProperty(a[n]))continue;t=t.replace(new RegExp("\\{"+a[n]+"\\}","g"),e.args_json[a[n]])}else t=t.replace(new RegExp("\\{"+a[n]+"\\}","g"),e[a[n]])}else t=t.replace(new RegExp("\\{"+a[n]+"\\}","g"),"0");return t},t.getStrLength=function(t){for(var e=0,i=0;i<t.length;i++)e+=t.charCodeAt(i)<0||t.charCodeAt(i)>255?2:1;return e},t.getEllipsis=function(t,e){for(var i=0,s="",n=0;n<e.length;n++){var o=e.charAt(n);if(i+=null!=o.match(/[^\x00-\xff]/gi)?2:1,i>2*t){s+="...";break}s+=o}return s},t.getDeciToStr=function(t){var e=String(t),i=e.split(".");return i[1]?i[0]+"d"+i[1]:e},t}();__reflect(StringUtil.prototype,"StringUtil");var TextUtil=function(){function t(){}return t.setText=function(t,e,i){void 0===e&&(e=16777215),void 0===i&&(i=-1);var s=t;return s=i>-1?"<u><a href='event:"+i+"'><font color='"+this.uintColorToStringColor(e)+"'>"+s+"</font></a></u>":"<font color='"+this.uintColorToStringColor(e)+"'>"+s+"</font>"},t.setLink=function(t,e){void 0===e&&(e=0);var i=t.text;i="<u><a href='event:1'>"+i+"</a></u>",0!=e?t.textFlow=this.setTextFlowColor(i,e):t.textFlow=this.setTextFlow(i)},t.setTextFlow=function(t,e){void 0===e&&(e=!1);var i=t;return e?(new egret.HtmlTextParser).parser("<u><a href='event:1'>"+i+"</a></u>"):(new egret.HtmlTextParser).parser(i)},t.setTextFlowColor=function(t,e,i){void 0===e&&(e=16777215),void 0===i&&(i=!1);var s=t;return s="<font color='"+this.uintColorToStringColor(e)+"'>"+s+"</font>",this.setTextFlow(s,i)},t.setTextByColorId=function(t,e,i){void 0===i&&(i=!1);var s=t;return s="<font color='"+ColorJson.getColorStr(e)+"'>"+s+"</font>",i?(new egret.HtmlTextParser).parser("<u><a href='event:1'>"+s+"</a></u>"):(new egret.HtmlTextParser).parser(s)},t.uintColorToStringColor=function(t){var e=t.toString(16);return"#"+e},t.setTextColorByQuality=function(t,e){return"<font color='"+ColorJson.getColorStr(e)+"'>"+t+"</font>"},t.setTextCopy=function(t){var e=document.createElement("input");e.value=t,document.body.appendChild(e),e.select(),e.setSelectionRange(0,e.value.length),document.execCommand("Copy"),document.body.removeChild(e),e.setAttribute("readOnly","readOnly")},t}();__reflect(TextUtil.prototype,"TextUtil");var TimeUtil=function(){function t(){}return t.getTimes=function(t){return 60>t?t+this.SECOND:3600>t?Math.floor(t/60)+this.MINUTE:86400>t?Math.floor(t/3600)+this.HOUR:2592e3>t?Math.floor(t/86400)+this.DAY:31104e3>t?Math.floor(t/2592e3)+this.MONTH:Math.floor(t/31104e3)+this.YEAR},t.getSpliceTime=function(t,e){void 0===e&&(e=":");var i=Math.floor(t/3600),s=Math.floor((t-3600*i)/60),n=t%60,o=10>n?"0"+n:""+n,a=10>s?"0"+s:""+s,r=10>i?"0"+i:""+i;return r+e+a+e+o},t.getSpliceTime2=function(t,e){void 0===e&&(e=[":",":",""]);var i=Math.floor(t/3600),s=Math.floor((t-3600*i)/60),n=t%60,o=10>n?"0"+n:""+n,a=10>s?"0"+s:""+s,r=10>i?"0"+i:""+i;return i>0?r+e[0]+a+e[1]+o+e[2]:s>0?a+e[1]+o+e[2]:o+e[2]},t.getSpliceTime3=function(t){return t>86400?this.getTimes(t):this.getSpliceTime2(t)},t.getSpliceTime4=function(t){return t>86400?this.toDurTimestring(1e3*t,"d天h时m分"):this.getSpliceTime2(t)},t.getSpliceTime5=function(t){if(t>86400)return this.toDurTimestring(1e3*t,"d天h时m分");var e=Math.floor(t/3600),i=Math.floor((t-3600*e)/60),s=t%60,n="";return e>0?(n=e+"小时",i>0&&(n+=i+"分钟"),s>0&&(n+=s+"秒"),n):i>0?(n=i+"分钟",s>0&&(n+=s+"秒"),n):s+"秒"},t.getSpliceTime6=function(t){return this.toDurTimestring(1e3*t,"d天")},t.getTampTimeByDate=function(t,e,i){void 0===e&&(e="月-日"),void 0===i&&(i=!1);var s=i?t.getUTCFullYear():t.getFullYear(),n=i?t.getUTCMonth():t.getMonth(),o=i?t.getUTCDate():t.getDate(),a=i?t.getUTCHours():t.getHours(),r=i?t.getUTCMinutes():t.getMinutes(),_=i?t.getUTCSeconds():t.getSeconds();switch(e){case"week":return this.toCHSNum(t.getDay());case"mm-dd":return this.fillZeros((n+1).toString(),2)+"-"+this.fillZeros(o.toString(),2);case"月-日":return this.fillZeros((n+1).toString(),1)+"月"+this.fillZeros(o.toString(),2)+"日";case"yyyy-mm-dd":return s+"-"+this.fillZeros((n+1).toString(),2)+"-"+this.fillZeros(o.toString(),2);case"yyyy-m-d":return s+"-"+(n+1).toString()+"-"+o;case"yyyy年m月d日":return s+"年"+(n+1).toString()+"月"+o+"日";case"mm-dd  hh-mm":return this.fillZeros((n+1).toString(),2)+"-"+this.fillZeros(o.toString(),2)+"  "+this.fillZeros(a.toString(),2)+":"+this.fillZeros(r.toString(),2);case"hh-mm":return this.fillZeros(a.toString(),2)+":"+this.fillZeros(r.toString(),2);case"hh":return this.fillZeros(a.toString(),2);case"hh:mm:ss":return this.fillZeros(a.toString(),2)+":"+this.fillZeros(r.toString(),2)+":"+this.fillZeros(_.toString(),2);case"yyy/mm/dd  hh:mm:ss":return s+"/"+this.fillZeros((n+1).toString(),2)+"/"+this.fillZeros(o.toString(),2)+"   "+this.fillZeros(a.toString(),2)+":"+this.fillZeros(r.toString(),2)+":"+this.fillZeros(_.toString(),2)}return t.toString()},t.getTampTimeByUnix=function(e,i,s){void 0===i&&(i="yyy/mm/dd  hh:mm:ss"),void 0===s&&(s=!1);var n=new Date(1e3*e);return t.getTampTimeByDate(n,i,s)},t.toDurTimestring=function(t,e){void 0===e&&(e="hh:mm:ss");var i=Math.floor(t%1e3/10);t/=1e3;var s=Math.floor(t%60);t/=60;var n=Math.floor(t%60);t/=60;var o=Math.floor(t);t/=24;var a=Math.floor(t);switch(e){case"hh:mm:ss":return this.fillZeros(o.toString(),2)+":"+this.fillZeros(n.toString(),2)+":"+this.fillZeros(s.toString(),2);case"hh:mm":return this.fillZeros(o.toString(),2)+":"+this.fillZeros(n.toString(),2);case"mm:ss":return this.fillZeros(n.toString(),2)+":"+this.fillZeros(s.toString(),2);case"h:m:s":return o+":"+n+":"+s;case"hh:mm:ss:ss.s":return this.fillZeros(o.toString(),2)+":"+this.fillZeros(n.toString(),2)+":"+this.fillZeros(s.toString(),2)+":"+i.toFixed(1);case"mm:ss:ms":return this.fillZeros(n.toString(),2)+":"+this.fillZeros(s.toString(),2)+":"+this.fillZeros(i.toString(),2);case"h:m:s:ss.s":return o+":"+n+":"+s+":"+i.toFixed(1);case"h小时m分钟s秒":return o+"小时"+n+"分"+s+"秒";case"H小时M分钟S秒":break;case"h小时":return o+"小时";case"h小时m分":return o+"小时"+n+"分";case"d天h时m分":return a+"天"+Number(o%24)+"时"+n+"分";case"d天h小时":return a+"天"+Number(o%24)+"小时";case"d天":return a+"天";case"m分钟s秒":return n+"分钟"+s+"秒";case"simple":return a>0?a+"天":Number(o%24)>0?Number(o%24)+"小时":n>0?n+"分钟":s+"秒";case"all":return a+"天"+Number(o%24)+"小时"+n+"分"+s+"秒"}return t.toString()},t.fillZeros=function(t,e,i){for(void 0===i&&(i="0");t.length<e;)t=i+t;
return t},t.formatZero=function(t){return 10>t?"0"+t:t.toString()},t.toTimeConfig=function(e){for(var i="",s=0;s<e.length;s++)0==s?i=e[s]+"":i+=t.formatZero(Number(e[s]));return i},t.toCHSNum=function(t){switch(t){case 1:return"一";case 2:return"二";case 3:return"三";case 4:return"四";case 5:return"五";case 6:return"六";case 7:return"日"}},t.showTime=function(t,e,i,s){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===s&&(s=0);var n=new Date(1e3*ServerTimeManager.instance.timer);return n.getHours()>1?n.setDate(n.getDate()+1):n.setDate(n.getDate()),n.setHours(t),n.setMinutes(e),n.setSeconds(i),n.setMilliseconds(s),n.getTime()/1e3},t.SECOND="秒",t.MINUTE="分钟",t.HOUR="小时",t.DAY="天",t.MONTH="月",t.YEAR="年",t.date=new Date,t}();__reflect(TimeUtil.prototype,"TimeUtil");var BuffEffectJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},t.FileName="buff_effect",t}();__reflect(BuffEffectJson.prototype,"BuffEffectJson"),window.BuffEffectJson=BuffEffectJson;var BuffJson=function(){function t(){}return t.getData=function(t,e){var i=String(t+"_"+e),s=this.jsonData[i];return s||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),s},t.FileName="buff",t}();__reflect(BuffJson.prototype,"BuffJson"),window.BuffJson=BuffJson;var CardBookJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},t.getBookTypeList=function(){var t=[];for(var e in this.jsonData){var i=this.jsonData[e];i&&t.push(i.card_book_id)}return ArrayUtils.setSortNum(t),t},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="card_book",t}();__reflect(CardBookJson.prototype,"CardBookJson"),window.CardBookJson=CardBookJson;var CardJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="card",t}();__reflect(CardJson.prototype,"CardJson"),window.CardJson=CardJson;var SmGameBase=function(t){function e(){var e=t.call(this)||this;return e.m_smTimes=-1,e.m_smBuyTimeLimt=0,e.m_smBuyTimeCount=0,e.m_currAddTime=0,e.m_smStep=-1,e.m_smBuyStepLimt=0,e.m_smBuyStepCount=0,e.m_currAddStep=0,e}return __extends(e,t),e.prototype.closeGame=function(t){PopupModule.instance.showTishi(t,this.sureCloseGame.bind(this)),TimeManager.instance.clearTimer(this.doSmGametime,this)},e.prototype.sureCloseGame=function(t){1==t?PopupModule.instance.hidePop(this.m_baseId):this.startGameDo()},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),e&&e.smBackFunc&&(this.m_smBackFunc=e.smBackFunc),this.m_smTimes=-1,e&&e.smTime&&(this.m_smTimes=e.smTime),this.m_smBuyTime=null,e&&e.smBuyTime&&(this.m_smBuyTime=e.smBuyTime),this.m_smBuyTimeLimt=0,this.m_smBuyTimeCount=1,e&&e.smBuyTimeLimt&&(this.m_smBuyTimeLimt=e.smBuyTimeLimt),this.m_smStep=-1,e&&e.smStepIdx&&(this.m_smStep=e.smStepIdx,this.setStepText()),this.m_smBuyStep=null,e&&e.smBuyStep&&(this.m_smBuyStep=e.smBuyStep),this.m_smBuyStepLimt=0,this.m_smBuyStepCount=1,e&&e.smBuyStepLimt&&(this.m_smBuyStepLimt=e.smBuyStepLimt),e&&e.smGuideId&&GuideModule.instance.startGuide(e.smGuideId))},e.prototype.startGameDo=function(){this.m_smTimes>0&&TimeManager.instance.doLoop(this.doSmGametime,this)},e.prototype.doSmGametime=function(){this.m_smTimes-=1,this.m_smTimes<=0&&(this.m_smTimes=0,TimeManager.instance.clearTimer(this.doSmGametime,this),this.timeOver())},e.prototype.timeOver=function(){if(this.m_currAddTime=0,this.m_smBuyTime)if(this.m_smBuyTimeLimt>0&&this.m_smBuyTimeCount>this.m_smBuyTimeLimt)PopupModule.instance.showTishiSingle("很遗憾，您未在规定的时间内完成挑战！",this.sureLeaveGame.bind(this));else{var t=0,e=0;if(NumberUtil.isNumber(this.m_smBuyTime[0]))t=this.m_smBuyTime[0],e=this.m_smBuyTime[1],this.m_currAddTime=this.m_smBuyTime[2];else{for(var i=0;i<this.m_smBuyTime.length;i++)if(this.m_smBuyTimeCount>=this.m_smBuyTime[i][0]&&this.m_smBuyTimeCount<=this.m_smBuyTime[i][1]){t=this.m_smBuyTime[i][2],e=this.m_smBuyTime[i][3],this.m_currAddTime=this.m_smBuyTime[i][4];break}0==t&&(t=this.m_smBuyTime[this.m_smBuyTime.length-1][2],e=this.m_smBuyTime[this.m_smBuyTime.length-1][3],this.m_currAddTime=this.m_smBuyTime[this.m_smBuyTime.length-1][4])}PopupModule.instance.showPop(PopupConfig.ID_SM_BUY_TIME,{itemId:t,itemCount:e,addValue:this.m_currAddTime,funcBack:this.buySuccess.bind(this)},!1)}else PopupModule.instance.showTishiSingle("很遗憾，未在规定的时间内完成挑战！",this.sureLeaveGame.bind(this))},e.prototype.doSmGameStep=function(){return this.m_smStep>-1?this.m_smStep<1?(this.m_smStep=0,TimeManager.instance.clearTimer(this.doSmGametime,this),this.stepOver(),this.setStepText(),!1):(this.m_smStep-=1,this.setStepText(),!0):!0},e.prototype.stepOver=function(){if(this.m_currAddStep=0,this.m_smBuyStep)if(this.m_smBuyStepLimt>0&&this.m_smBuyStepCount>this.m_smBuyStepLimt)PopupModule.instance.showTishiSingle("很遗憾，您未在规定的步数内完成挑战！",this.sureLeaveGame.bind(this));else{var t=0,e=0;if(NumberUtil.isNumber(this.m_smBuyStep[0]))t=this.m_smBuyStep[0],e=this.m_smBuyStep[1],this.m_currAddStep=this.m_smBuyStep[2];else{for(var i=0;i<this.m_smBuyStep.length;i++)if(this.m_smBuyStepCount>=this.m_smBuyStep[i][0]&&this.m_smBuyStepCount<=this.m_smBuyStep[i][1]){t=this.m_smBuyStep[i][2],e=this.m_smBuyStep[i][3],this.m_currAddStep=this.m_smBuyStep[i][4];break}0==t&&(t=this.m_smBuyStep[this.m_smBuyStep.length-1][2],e=this.m_smBuyStep[this.m_smBuyStep.length-1][3],this.m_currAddStep=this.m_smBuyStep[this.m_smBuyStep.length-1][4])}PopupModule.instance.showPop(PopupConfig.ID_SM_BUY_STEP,{itemId:t,itemCount:e,addValue:this.m_currAddStep,funcBack:this.buySuccess.bind(this)},!1)}else PopupModule.instance.showTishiSingle("很遗憾，未在规定的步数内完成挑战！",this.sureLeaveGame.bind(this))},e.prototype.buySuccess=function(t){var e=t[0],i=t[1];e?(1==i?(this.m_smBuyTime&&(this.m_smBuyTimeCount+=1),this.m_smTimes=this.m_currAddTime+1):(this.m_smBuyStep&&(this.m_smBuyStepCount+=1),this.m_smStep=this.m_currAddStep,this.setStepText()),this.m_smTimes>0&&TimeManager.instance.doLoop(this.doSmGametime,this,1e3,!0)):PopupModule.instance.hidePop(this.m_baseId)},e.prototype.setStepText=function(){},e.prototype.sureLeaveGame=function(t){PopupModule.instance.hidePop(this.m_baseId)},e.prototype.successSmGame=function(){DelayCallUtils.killDelayedCallsTo(this.successSmGame,this),null!=this.m_smBackFunc&&this.m_smBackFunc.call(this)},e.prototype.hide=function(e,i){TimeManager.instance.clearTimer(this.doSmGametime,this),DelayCallUtils.killDelayedCallsTo(this.successSmGame,this),this.m_smBackFunc=null,t.prototype.hide.call(this,e,i)},e}(PopupBase);__reflect(SmGameBase.prototype,"SmGameBase");var CardSummonJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||egret.log(this.FileName+" :不存在["+t+"]项！"),i},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="card_summon",t}();__reflect(CardSummonJson.prototype,"CardSummonJson"),window.CardSummonJson=CardSummonJson;var Main=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){RES.setMaxLoadingThread(10),Trace.init();var e=new AssetAdapter;this.stage.registerImplementation("eui.IAssetAdapter",e),this.stage.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),egret.ImageLoader.crossOrigin="anonymous",egret.TextField.default_fontFamily="Microsoft YaHei",egret.TextField.defaultTouchEnabled=!1,RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.itemLoaderError,this),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onInitializeConfigComplete,this),RES.loadConfig("resource/initialize.res.json","resource/"),window.alert=function(t){},window.XiaoAQi_NativeSDK&&H5Manager.instance.initData()},e.prototype.onInitializeConfigComplete=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onInitializeConfigComplete,this),0!=URIManager.isInitSetting?[3,1]:(GameManager.instance.getResByUrl(this.settingComplete.bind(this)),[3,3]);case 1:return[4,PlatformManager.instance.initPlatform()];case 2:t.sent(),this.loadVersionFile(),t.label=3;case 3:return[2]}})})},e.prototype.settingComplete=function(t,e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return URIManager.initSetting(t),[4,PlatformManager.instance.initPlatform()];case 1:return e.sent(),this.loadVersionFile(),[2]}})})},e.prototype.loadVersionFile=function(){""!=URIManager.versions?RES.getResByUrl(URIManager.cdn+"filelist/"+URIManager.versions+".json",this.versionFileListComplete,this,RES.ResourceItem.TYPE_JSON):this.loadResConfig()},e.prototype.versionFileListComplete=function(t,e){URIManager.fileList=t,this.loadResConfig()},e.prototype.loadResConfig=function(t){void 0===t&&(t=""),null!=RES.getVirtualUrl?RES.getVirtualUrl=URIManager.getVersionUrl:RES.getRealURL=URIManager.getVersionUrl,RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},e.prototype.onConfigComplete=function(t){StageManager.instance.init(this),RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),new eui.Theme("resource/default.thm.json",this.stage),GamePreLoadManager.instance.preloadLogin(),Dispatch.register(GamePreLoadManager.EVENT_LOGIN_COMPLETE,this.initLogin,this)},e.prototype.initLogin=function(){Dispatch.remove(GamePreLoadManager.EVENT_LOGIN_COMPLETE,this.initLogin,this),LoginManager.instance.init(),StageManager.instance.initUIStage(),CreatRoleManager.instance.init(),UIModule.instance.createLoginUI()},e.prototype.itemLoaderError=function(t){egret.log("加载失败",t.resItem.url,t.resItem.type),Dispatch.dispatch("EVENT_LOADING_ERROR:"+t.resItem.url)},e}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var UIModule=function(t){function e(){var e=t.call(this)||this;return e.m_showUIList=[],e.m_redClickList={},e.m_rechargeList={},e.m_initPoint=new egret.Point(0,0),e.m_rectangle=new egret.Rectangle,e.m_time=0,e.m_timeNext=-1,e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.m_instance||(this.m_instance=new e),this.m_instance},enumerable:!0,configurable:!0}),e.prototype.init=function(t){this.m_root=t,UIConfig.initUI(),this.m_middleUILayer||(this.m_upUILayer=new egret.DisplayObjectContainer,this.m_upUILayer.touchEnabled=!1,this.m_middleUILayer=new egret.DisplayObjectContainer,this.m_middleUILayer.touchEnabled=!1,this.m_downUILayer1=new egret.DisplayObjectContainer,this.m_downUILayer1.touchEnabled=!1,this.m_downUILayer2=new egret.DisplayObjectContainer,this.m_downUILayer2.touchEnabled=!1,this.m_downUILayer3=new egret.DisplayObjectContainer,this.m_downUILayer3.touchEnabled=!1),this.m_root.addChild(this.m_downUILayer1),this.m_root.addChild(this.m_downUILayer2),this.m_root.addChild(this.m_downUILayer3),this.m_root.addChild(this.m_middleUILayer),this.m_root.addChild(this.m_upUILayer),MissionUIModule.instance.init(),ChatMoude.instance.init(),PromptModule.instance.init(),EntranceModule.instance.init(),FightUIModule.instance.init(),GuideModule.instance.init(),SoundMoude.instance.init(),this.m_maskImg||(this.m_maskImg=new eui.Image("commonUI_box"),this.m_maskImg.scale9Grid=e.instance.getRectangle(),this.m_maskImg.alpha=.8),Dispatch.register(StageManager.EVENT_STAGE_RESIZE,this.stageResize,this);var i=LanguageJson.getText("l_paopao_tip_huishou"),s=(StageManager.instance.p_stageWidth-640)/2+105;RedNoticeManager.instance.registerRedBubbleTipMsg(this.m_downUILayer3,i,3,!0,[s,119],[RedNoticeConfig.RED_WITHDRAW_TISHI])},e.prototype.setWithdrawTips=function(){GameManager.instance.isShield||this.m_time>0||this.m_timeNext>0&&ServerTimeManager.instance.timer<this.m_timeNext||(this.m_timeList||(this.m_timeList=StaticDataJson.parseStrToList("tixian_time_list")),RedNoticeManager.instance.dispatchRed(RedNoticeConfig.RED_WITHDRAW_TISHI,!0,{redType:2}),this.m_time=Math.floor(Math.random()*this.m_timeList[1])+this.m_timeList[0],TimeManager.instance.doLoop(this.refreshTime,this,1e3),this.m_timeNext=ServerTimeManager.instance.timer+this.m_timeList[2]+Math.floor(Math.random()*this.m_timeList[3]))},e.prototype.refreshTime=function(){return this.m_time<=0?void this.stopWithdrawTips():void this.m_time--},e.prototype.stopWithdrawTips=function(){TimeManager.instance.clearTimer(this.refreshTime,this),RedNoticeManager.instance.dispatchRed(RedNoticeConfig.RED_WITHDRAW_TISHI,!1,{redType:2})},e.prototype.showDebug=function(){!URIManager.is_platform&&ChatMoude.instance.p_isDebug&&(this.m_debugView||(this.m_debugView=new DebugView),this.m_debugView.show())},e.prototype.initShow=function(){this.m_commonHead||(this.m_commonHead=new CommonHeadView),this.showDebug(),this.stageResize()},e.prototype.gotoMainScene=function(){this.m_mainFight&&this.m_mainFight.hide(),MinMapModule.instance.removeMiniMap(),this.m_sysNoticeView&&this.m_sysNoticeView.hide(),this.m_eventBubble&&this.m_eventBubble.hide(),this.m_godDragonBtn&&this.m_godDragonBtn.hide(),this.m_mainScene||(this.m_mainScene=new MainSceneView),this.m_mainScene.show(),this.stageResize(),this.setPosition()},e.prototype.hideMainFight=function(){this.m_mainFight&&this.m_mainFight.hide(),MinMapModule.instance.removeMiniMap(),this.m_sysNoticeView&&this.m_sysNoticeView.hide()},e.prototype.leaveMainScene=function(){this.m_mainScene&&this.m_mainScene.hide(),this.m_mainFight||(this.m_mainFight=new MainFightView),this.m_mainFight.show(),SceneModule.instance.isSceneWorld&&(MinMapModule.instance.createMiniMap(),this.m_sysNoticeView||(this.m_sysNoticeView=new SysNoticeView),this.m_sysNoticeView.show()),SceneModule.instance.isMissionScene?(this.m_eventBubble&&this.m_eventBubble.hide(),this.m_godDragonBtn&&this.m_godDragonBtn.hide()):SceneModule.instance.isBossEventShow?this.setEventBubble():this.setPosition(),SceneMainModule.instance.destroyResAll(),this.stageResize()},e.prototype.setEventBubble=function(t){void 0===t&&(t=!0),t?(this.m_eventBubble||(this.m_eventBubble=new EventBubble),this.m_eventBubble.show()):this.m_eventBubble&&this.m_eventBubble.hide(),this.setPosition()},e.prototype.setGodDragonBtn=function(t){void 0===t&&(t=!0),t?(this.m_godDragonBtn||(this.m_godDragonBtn=new GodDragonBtn),this.m_godDragonBtn.showView(),this.m_downUILayer1.addChild(this.m_godDragonBtn)):this.m_godDragonBtn&&this.m_godDragonBtn.hide()},e.prototype.setPosition=function(){},e.prototype.createLoginUI=function(){this.m_loginUI||(this.m_loginUI=new LoginUI),this.m_root.addChild(this.m_loginUI)},e.prototype.removeLoginUI=function(){this.m_loginUI&&this.m_loginUI.parent&&(this.m_loginUI.parent.removeChild(this.m_loginUI),this.m_loginUI.destroy(),this.m_loginUI=null)},e.prototype.createRoleUI=function(){this.m_creatRoleUI||(this.m_creatRoleUI=new CreatRoleUI),this.m_root.addChild(this.m_creatRoleUI),GameManager.instance.callToNative("toAppReportRegister","")},e.prototype.removeRoleUI=function(){this.m_creatRoleUI&&(this.m_creatRoleUI.hide(),this.m_creatRoleUI=null),GameManager.instance.isShield?PopupModule.instance.showPop(PopupConfig.ID_WELCOME,null,!1):SceneManager.instance.isCourseGuide()},e.prototype.showUI=function(t,e){if(void 0===e&&(e=null),!UIConfig.p_uiDict[t]){if(null==UIConfig.p_uiClassDict[t])return void PopupModule.instance.showTishi("未注册UIId为："+t+"的UI");UIConfig.p_uiDict[t]=new UIConfig.p_uiClassDict[t]}UIConfig.p_uiDict[t].setId(t,e)},e.prototype.addPopup=function(t){-1==this.m_showUIList.indexOf(t.id)&&this.m_showUIList.push(t.id),this.m_middleUILayer.addChild(t),this.m_maskImg.width=StageManager.instance.p_stageWidth,this.m_maskImg.height=StageManager.instance.p_stageHeight,this.m_middleUILayer.addChildAt(this.m_maskImg,0),this.setUICommonHead()},e.prototype.hideUI=function(t,i){void 0===i&&(i=null),UIConfig.p_uiDict[t]&&UIConfig.p_uiDict[t].hide.call(UIConfig.p_uiDict[t],i);var s=this.m_showUIList.indexOf(t);if(-1!=s&&this.m_showUIList.splice(s,1),0==this.m_showUIList.length){var n=e.instance.mainSceneCommonhead;this.m_commonHead.show(n[0],n[1],n[2]),TexturePool.instance.destoryAtlasFrom(TextureFrom.UI_EFFECT),DisplayObjectUtils.removeFormParent(this.m_maskImg)}else this.setUICommonHead()},e.prototype.setUICommonHead=function(){var t=UIConfig.p_uiDict[this.m_showUIList[this.m_showUIList.length-1]];t.itemIdList&&t.itemIdList.length>0?this.m_commonHead.show(t.itemIdList,t.uiTitle,t.showNotice):this.m_commonHead.hide()},e.prototype.closeCurrUI=function(){var t=UIConfig.p_uiDict[this.m_showUIList[this.m_showUIList.length-1]];t&&t.close()},e.prototype.isCloseUI=function(t){void 0===t&&(t=!0);var e=UIConfig.p_uiDict[this.m_showUIList[this.m_showUIList.length-1]];return e?e.isCloseUI(t):!0},e.prototype.hideAllUI=function(){for(;this.m_showUIList.length>0;)this.hideUI(this.m_showUIList[this.m_showUIList.length-1],{c_allClose:1});this.m_showUIList=[],DisplayObjectUtils.removeFormParent(this.m_maskImg),TexturePool.instance.destoryAtlasFrom(TextureFrom.UI_EFFECT)},e.prototype.getIsShow=function(t){return this.m_showUIList.indexOf(t)>-1?!0:!1},Object.defineProperty(e.prototype,"showUIList",{get:function(){return this.m_showUIList},enumerable:!0,configurable:!0}),e.prototype.stageResize=function(){var t=StageManager.instance.p_stageWidth,e=StageManager.instance.p_stageHeight;this.m_loginUI&&this.m_loginUI.parent&&this.m_loginUI.setXY(),this.m_creatRoleUI&&this.m_creatRoleUI.parent&&this.m_creatRoleUI.setXY(),this.m_maskImg&&null!=this.m_maskImg.parent&&(this.m_maskImg.width=t,this.m_maskImg.height=e),this.m_godDragonBtn&&this.m_godDragonBtn.parent&&this.m_godDragonBtn.setXY(),this.m_middleUILayer.width=t,this.m_middleUILayer.height=e,this.m_downUILayer1.width=t,this.m_downUILayer1.height=e},e.prototype.regiestChargeDis=function(t){this.m_rechargeList[t.hashCode]=t,t.visible=ChargeManager.instance.isOpenRecharge},e.prototype.checkChargeDis=function(){var t=ChargeManager.instance.isOpenRecharge;for(var e in this.m_rechargeList){var i=this.m_rechargeList[e];i&&(i.visible=t)}},e.prototype.getPointByFunctionId=function(t,e,i){return void 0===e&&(e=!1),void 0===i&&(i=0),this.m_mainFight&&this.m_mainFight.parent?this.m_mainFight.getPointByFuncId(t,e):this.m_mainScene&&this.m_mainScene.parent?this.m_mainScene.getPointByFuncId(t,e):[0,0]},e.prototype.getBlessPoint=function(t){if(void 0===t&&(t=!1),this.m_godDragonBtn){var e=this.m_godDragonBtn;return t?[e.x+e.width/2,e.y+e.height/2]:[e.x,e.y]}return[0,0]},Object.defineProperty(e.prototype,"pointGold",{get:function(){return[StageManager.instance.p_stageWidth-360,20]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pointRmb",{get:function(){return[StageManager.instance.p_stageWidth-225,20]},enumerable:!0,configurable:!0}),e.prototype.getCdTime=function(t){return this.m_mainFight?this.m_mainFight.getCdTime(t):0},e.prototype.stopAuto=function(t){this.m_mainFight&&this.m_mainFight.stopAuto(t)},e.prototype.getRectangle=function(){return this.m_rectangle.x=2,this.m_rectangle.y=2,this.m_rectangle.width=6,this.m_rectangle.height=6,this.m_rectangle},Object.defineProperty(e.prototype,"mainSceneCommonhead",{get:function(){return[[ItemEnum.GOLD,ItemEnum.RMB],"",!0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"downUILayer2",{get:function(){return this.m_downUILayer2},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"downUILayer3",{get:function(){return this.m_downUILayer3},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"downUILayer1",{get:function(){return this.m_downUILayer1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"middleUILayer",{get:function(){return this.m_middleUILayer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"upUILayer",{get:function(){return this.m_upUILayer},enumerable:!0,configurable:!0}),e}(egret.HashObject);__reflect(UIModule.prototype,"UIModule");var AccessPopup=function(t){function e(){var e=t.call(this)||this;return e.m_layout=new eui.TileLayout,e.m_typeList=new eui.ArrayCollection,e.m_itemId=0,e.m_disposeUrlList.push("accessUI_json"),e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/accessUI/AccessSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){this.u_scrollerItem.horizontalScrollBar=null,this.u_scrollerItem.verticalScrollBar=null,this.m_layout.requestedColumnCount=1,this.u_listAccess.itemRenderer=AccessRender,this.u_listAccess.layout=this.m_layout,this.u_listAccess.dataProvider=this.m_typeList,this.m_layout.verticalGap=0,this.u_txtPath2.text=LanguageJson.getHtmlText("l_access_otherPath"),this.u_txtBlank.textFlow=LanguageJson.getHtmlTextFlow("l_closePop_tip")},e.prototype.showView=function(e){if(void 0===e&&(e=null),this.checkComplete(this.showView,e)){t.prototype.showView.call(this,e),this.m_itemId=Number(e.c_itemId);var i=ShopJson.getAccessShopJson(this.m_itemId);i&&!ShopManager.instance.isLimitSoldout(i.id)?(this.u_mcItem.visible=!1,this.m_buyItemView||(this.m_buyItemView=new ShopBuyView(!1),this.m_buyItemView.p_isFromAccess=!0,this.m_buyItemView.horizontalCenter=0,this.m_buyItemView.y=80),this.addChild(this.m_buyItemView),this.m_buyItemView.show(i),DisplayObjectUtils.removeFormParent(this.m_item),this.u_mcAccess.y=390,this.u_scrollerItem.height=130):(this.u_mcItem.visible=!0,DisplayObjectUtils.removeFormParent(this.m_buyItemView),this.m_item||(this.m_item=new ItemIcon,this.m_item.horizontalCenter=0,this.m_item.y=40,this.u_mcItem.addChild(this.m_item)),this.u_itemName.text=ItemJson.getName(this.m_itemId),this.m_item.setData(this.m_itemId,0),this.u_mcAccess.y=300,this.u_scrollerItem.height=220),this.m_typeList.source=this.getViewList(),this.u_scrollerItem.viewport.scrollV=0}},e.prototype.getViewList=function(){var t=ItemJson.getData(this.m_itemId).output_list;if(t&&t.length>0){for(var e=[],i=0;i<t.length;i++){var s=FunctionConfigJson.getData(t[i]);(s.function_id!=FunctionEnum.FIRST_RECHARGE||ChargeManager.instance.isFirstOpenCharge)&&(FunctionManager.instance.getOpenFuncId(s.function_id)?s.is_open=1:s.is_open=0,e.push(s))}return ArrayUtils.setSortArr(e,["is_open"],[1]),e}return[]},e.prototype.hide=function(e,i){void 0===i&&(i=null),t.prototype.hide.call(this,e,i)},e.prototype.sureHide=function(e,i){void 0===e&&(e=null),void 0===i&&(i=null),t.prototype.sureHide.call(this,e,i)},e}(PopupBase);__reflect(AccessPopup.prototype,"AccessPopup");var AccessRender=function(t){function e(){return t.call(this,"resource/eui_skins/accessUI/render/AccessRenderSkin.exml")||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnGoto,this.onGetItem,this,!0)},e.prototype.dataChanged=function(){this.checkComplete(this.dataChanged)&&(t.prototype.dataChanged.call(this),this.m_vo=this.data,this.u_imgIcon.source=null,this.u_imgIcon.source=PublicCon.PATH_ENTRANCE_RES+this.m_vo.icon_id+".png",this.u_txtName.textFlow=HtmlUtil.setTextFlow(this.m_vo.item_access),this.u_btnGoto.visible=FunctionManager.instance.getOpenFuncId(this.m_vo.function_id))},e.prototype.onGetItem=function(t){PopupModule.instance.hidePopAll(),FunctionManager.instance.executeFunction(this.m_vo.id)},e}(ItemRendererBase);__reflect(AccessRender.prototype,"AccessRender");var AccreditUI=function(t){function e(){var e=t.call(this)||this;return e.m_btnImgList=[],e.m_disposeUrlList.push("accreditUI_json"),e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/accreditUI/AccreditUISkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){this.u_txtMsg.textFlow=LanguageJson.getHtmlTextFlow("l_accredit_msg");for(var t=[URIManager.p_fb,URIManager.p_google],e=.5*(this.width-(159*t.length+5*(t.length-1))),i=0;i<t.length;i++){var s=new eui.Image("loginUI_btn_"+t[i]);s.width=159,s.height=105,s.x=e+(s.width+5)*i,s.y=302,s.name=t[i],this.addChild(s),this.m_btnImgList.push(s),this.registerEventClick(s,this.onStartLogin,this,!0)}},e.prototype.initEvent=function(){this.setCloseBtn(this.u_btnClose)},e.prototype.onStartLogin=function(t){var e=t.target.name;this.bingdingGame(e)},e.prototype.bingdingGame=function(t){if(URIManager.p_h5Game){var e=H5Manager.instance.loginGame(t);if(console.log("H5动态授权绑定："+e),""!=e&&null!=e&&void 0!=e){var i=JSON.parse(e);PlayerManager.instance.s_visitor_binding(i.acc_id,i.channel)}}else GameManager.instance.callToNative("toAppAccredit",t)},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&t.prototype.showView.call(this,e)},e.prototype.hide=function(e,i){void 0===i&&(i=null),t.prototype.hide.call(this,e,i)},Object.defineProperty(e.prototype,"width",{get:function(){return 640},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 510},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isClickBMask",{get:function(){return!1},enumerable:!0,configurable:!0}),e}(PopupBase);__reflect(AccreditUI.prototype,"AccreditUI");var AchievementUI=function(t){function e(){var e=t.call(this)||this;return e.m_typeId=1,e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/achievementUI/AchievementUISkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnPage1,this.onSelect,this,!0),this.registerEventClick(this.u_btnPage2,this.onSelect,this,!0),this.registerEventClick(this.u_btnPage3,this.onSelect,this,!0)},e.prototype.onSelect=function(t){var e=t.currentTarget.name,i=Number(e.slice(7,8));i!=this.m_typeId&&(this.m_typeId=i,this.upData())},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),e&&e.typeId?this.m_typeId=e.typeId:this.m_typeId=1,Dispatch.register(AchievementManager.EVENT_ACHIEVE_GET_INFO,this.showAchieveListInfo,this),Dispatch.register(DailyTaskManager.EVENT_DAILY_TASK_GET_INFO,this.showDailyListInfo,this),Dispatch.register(DailyTaskManager.EVENT_DAILY_TASK_UPDATE,this.setDailyRed,this,!0),Dispatch.register(AchievementManager.EVENT_ACHIEVE_DATA_UPDATE,this.setAchieveRed,this,!0),this.upData())},e.prototype.upData=function(){for(var t=1;3>=t;t++)t==this.m_typeId?this["u_imgPage"+t].source="achievementUI_json.achievementUI_"+t+"_2":this["u_imgPage"+t].source="achievementUI_json.achievementUI_"+t+"_1";1==this.m_typeId?DailyTaskManager.instance.s_daily_task_get_info():AchievementManager.instance.s_achievement_get_info()},e.prototype.showAchieveListInfo=function(){2==this.m_typeId?(this.m_targetTaskView||(this.m_targetTaskView=new TargetTaskView,this.m_targetTaskView.x=38,this.m_targetTaskView.y=204),this.addChild(this.m_targetTaskView),this.m_targetTaskView.show(),this.m_dailyTaskView&&this.m_dailyTaskView.hide(),this.m_achieveTaskView&&this.m_achieveTaskView.hide()):3==this.m_typeId&&(this.m_achieveTaskView||(this.m_achieveTaskView=new AchieveTaskView,this.m_achieveTaskView.x=38,this.m_achieveTaskView.y=204),this.addChild(this.m_achieveTaskView),this.m_achieveTaskView.show(),this.m_dailyTaskView&&this.m_dailyTaskView.hide(),this.m_targetTaskView&&this.m_targetTaskView.hide())},e.prototype.showDailyListInfo=function(){this.m_dailyTaskView||(this.m_dailyTaskView=new DailyTaskView,this.m_dailyTaskView.x=38,this.m_dailyTaskView.y=204),this.addChild(this.m_dailyTaskView),this.m_dailyTaskView.show(),this.m_targetTaskView&&this.m_targetTaskView.hide(),this.m_achieveTaskView&&this.m_achieveTaskView.hide()},e.prototype.setDailyRed=function(){this.u_imgRed1.visible=DailyTaskManager.instance.setDailyRed()},e.prototype.setAchieveRed=function(){this.u_imgRed2.visible=AchievementManager.instance.setRed(1),this.u_imgRed3.visible=AchievementManager.instance.setRed(2)},e.prototype.hide=function(e,i){this.m_dailyTaskView&&this.m_dailyTaskView.hide(),this.m_targetTaskView&&this.m_targetTaskView.hide(),this.m_achieveTaskView&&this.m_achieveTaskView.hide(),Dispatch.remove(AchievementManager.EVENT_ACHIEVE_GET_INFO,this.showAchieveListInfo,this),Dispatch.remove(DailyTaskManager.EVENT_DAILY_TASK_GET_INFO,this.showDailyListInfo,this),Dispatch.remove(DailyTaskManager.EVENT_DAILY_TASK_UPDATE,this.setDailyRed,this),Dispatch.remove(AchievementManager.EVENT_ACHIEVE_DATA_UPDATE,this.setDailyRed,this),t.prototype.hide.call(this,e,i)},e}(UIBase);__reflect(AchievementUI.prototype,"AchievementUI");var AchievementRender=function(t){function e(){var e=t.call(this,"resource/eui_skins/achievementUI/render/AchievementRenderSkin.exml")||this;return e.m_jindu_max=340,e.m_type=0,e.m_done=0,e}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_txtReward.text=LanguageJson.getText("l_daily_task_reward")},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnGo,this.onGo,this,!0)},e.prototype.onGo=function(t){if(1==this.m_data.state)AchievementManager.instance.s_achievement_get_award(this.m_type);else if(0==this.m_data.state){if(!(this.m_json.function_config_id>0))return void FloatTipModule.instance.popTipLanguage("l_game_tips_7");PopupModule.instance.hidePopAll(),UIModule.instance.hideAllUI(),FunctionManager.instance.executeFunction(this.m_json.function_config_id),SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_1007)}else FloatTipModule.instance.popTipLanguage("l_game_tips_5")},e.prototype.dataChanged=function(){this.checkComplete(this.dataChanged)&&(t.prototype.dataChanged.call(this),Dispatch.remove(AchievementManager.EVENT_ACHIEVE_DATA_UPDATE+this.m_type,this.upData,this),this.m_type=this.data,Dispatch.register(AchievementManager.EVENT_ACHIEVE_DATA_UPDATE+this.m_type,this.upData,this),this.showData(),this.upState())},e.prototype.showData=function(t){void 0===t&&(t=!1),this.data&&this.m_data&&t&&this.flyIcon(),this.m_done=0,this.m_data=AchievementManager.instance.getAchieveDataByType(this.m_type),this.m_data?(this.m_done=Number(this.m_data.value),this.m_json=AchievementJson.getData(this.m_type,this.m_data.id)):this.m_json=AchievementJson.getData(this.m_type,1),this.u_txtName.text=this.m_json.objective,this.u_txtDesc.text=this.m_json.name,this.u_txtJindu.text=this.m_done+"/"+this.m_json.approach_list[this.m_json.approach_list.length-1],this.u_itemIcon.source=BagManager.instance.getIconPath(this.m_json.award_list[0][0]),this.u_txtCount.text="x"+this.m_json.award_list[0][2],this.u_grpReward.x=this.u_txtReward.x+this.u_txtReward.width+10;var e=this.m_done/this.m_json.approach_list[this.m_json.approach_list.length-1]*this.m_jindu_max;this.u_jindu.width=e>this.m_jindu_max?this.m_jindu_max:e},e.prototype.upState=function(){this.u_imgReceived.visible=!1,this.u_btnGo.visible=!0,this.m_data&&2==this.m_data.state?(this.u_btnGo.visible=!1,this.u_imgReceived.visible=!0):this.m_data&&1==this.m_data.state?(this.u_imgGo.source="commonsUI_json.commonsUI_btn_2",this.u_txtGo.text=LanguageJson.getText("l_btn_receive"),this.u_imgRed.visible=!0):(this.u_imgGo.source="commonsUI_json.commonsUI_btn_1",this.u_imgRed.visible=!1,this.m_json.function_config_id>0?this.u_txtGo.text=LanguageJson.getText("l_btn_go"):this.u_txtGo.text=LanguageJson.getText("l_btn_receive"))
},e.prototype.upData=function(t){void 0===t&&(t=!1),this.showData(t),this.upState(),1!=this.m_data.state&&Dispatch.dispatch(AchievementManager.EVENT_ACHIEVE_RESET_LIST)},e.prototype.flyIcon=function(){var t=this.localToGlobal(this.u_grpReward.x+20,this.u_grpReward.y+20),e=this.m_json.award_list[0][0],i=this.m_json.award_list[0][1];i>40&&(i=40),FlyResModule.instance.playResEffect2([t.x,t.y],BagManager.instance.getPointByItem(e,!0),e,i)},e.prototype.onRemoveStage=function(e){t.prototype.onRemoveStage.call(this,e),Dispatch.remove(AchievementManager.EVENT_ACHIEVE_DATA_UPDATE+this.m_type,this.upData,this)},e}(ItemRendererBase);__reflect(AchievementRender.prototype,"AchievementRender");var DailyTaskRender=function(t){function e(){var e=t.call(this,"resource/eui_skins/achievementUI/render/AchievementRenderSkin.exml")||this;return e.m_jindu_max=340,e.m_done=0,e}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_txtReward.text=LanguageJson.getText("l_daily_task_reward")},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnGo,this.onGo,this,!0)},e.prototype.onGo=function(t){if(1==this.m_data.state)DailyTaskManager.instance.s_daily_task_get_award(this.m_id);else if(0==this.m_data.state){if(!(this.m_json.function_config_id>0))return void FloatTipModule.instance.popTipLanguage("l_game_tips_7");PopupModule.instance.hidePopAll(),UIModule.instance.hideAllUI(),FunctionManager.instance.executeFunction(this.m_json.function_config_id)}else FloatTipModule.instance.popTipLanguage("l_game_tips_5")},e.prototype.dataChanged=function(){this.checkComplete(this.dataChanged)&&(t.prototype.dataChanged.call(this),Dispatch.remove(DailyTaskManager.EVENT_DAILY_TASK_RECEIVE_SUCCESS+this.m_id,this.flyIcon,this),this.m_id=this.data,Dispatch.register(DailyTaskManager.EVENT_DAILY_TASK_RECEIVE_SUCCESS+this.m_id,this.flyIcon,this),this.upData())},e.prototype.upData=function(){this.m_done=0,this.m_data=DailyTaskManager.instance.getDailyTaskById(this.m_id),this.m_json=DailyTaskJson.getData(this.m_id),this.m_data&&(this.m_done=Number(this.m_data.value)),this.u_txtName.text=this.m_json.objective,this.u_txtDesc.text=this.m_json.name,this.u_txtJindu.text=this.m_done+"/"+this.m_json.approach_list[this.m_json.approach_list.length-1],this.u_itemIcon.source=BagManager.instance.getIconPath(this.m_json.award_list[0][0]),this.u_txtCount.text="x"+this.m_json.award_list[0][2],this.u_grpReward.x=this.u_txtReward.x+this.u_txtReward.width+10,this.u_imgReceived.visible=!1,this.u_btnGo.visible=!0,this.m_data&&2==this.m_data.state?(this.u_jindu.width=this.m_jindu_max,this.u_btnGo.visible=!1,this.u_imgReceived.visible=!0):this.m_data&&1==this.m_data.state?(this.u_jindu.width=this.m_jindu_max,this.u_imgGo.source="commonsUI_json.commonsUI_btn_2",this.u_txtGo.text="Receive",this.u_imgRed.visible=!0):(this.u_jindu.width=this.m_done/this.m_json.approach_list[1]*this.m_jindu_max,this.u_imgGo.source="commonsUI_json.commonsUI_btn_1",this.u_imgRed.visible=!1,this.m_json.function_config_id>0?this.u_txtGo.text="GO":this.u_txtGo.text="Receive")},e.prototype.flyIcon=function(){if(this.m_data){var t=this.localToGlobal(this.u_grpReward.x+20,this.u_grpReward.y+20),e=this.m_json.award_list[0][0],i=this.m_json.award_list[0][1];i>40&&(i=40),FlyResModule.instance.playResEffect2([t.x,t.y],BagManager.instance.getPointByItem(e,!0),e,i)}},e.prototype.onRemoveStage=function(e){t.prototype.onRemoveStage.call(this,e),Dispatch.remove(DailyTaskManager.EVENT_DAILY_TASK_RECEIVE_SUCCESS+this.m_id,this.flyIcon,this)},e}(ItemRendererBase);__reflect(DailyTaskRender.prototype,"DailyTaskRender");var AchieveTaskView=function(t){function e(){var e=t.call(this)||this;return e.m_layout=new eui.TileLayout,e.m_typeList=new eui.ArrayCollection,e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/achievementUI/view/AchievemenViewSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.u_scrollerItem.horizontalScrollBar=null,this.u_scrollerItem.verticalScrollBar=null,this.m_layout.requestedColumnCount=1,this.u_listItem.itemRenderer=AchievementRender,this.u_listItem.layout=this.m_layout,this.u_listItem.dataProvider=this.m_typeList},e.prototype.show=function(t){void 0===t&&(t=null),this.checkComplete(this.show,t)&&(this.recoverAllTexture(this,!0),Dispatch.register(AchievementManager.EVENT_ACHIEVE_RESET_LIST,this.upList,this,!0))},e.prototype.upList=function(){this.m_typeList.source=AchievementManager.instance.getTaskList(2)},e.prototype.hide=function(){Dispatch.remove(AchievementManager.EVENT_ACHIEVE_RESET_LIST,this.upList,this),DisplayObjectUtils.removeFormParent(this)},e}(ComponentBase);__reflect(AchieveTaskView.prototype,"AchieveTaskView");var DailyTaskView=function(t){function e(){var e=t.call(this)||this;return e.m_layout=new eui.TileLayout,e.m_typeList=new eui.ArrayCollection,e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/achievementUI/view/AchievemenViewSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.u_scrollerItem.horizontalScrollBar=null,this.u_scrollerItem.verticalScrollBar=null,this.m_layout.requestedColumnCount=1,this.u_listItem.itemRenderer=DailyTaskRender,this.u_listItem.layout=this.m_layout,this.u_listItem.dataProvider=this.m_typeList},e.prototype.show=function(t){void 0===t&&(t=null),this.checkComplete(this.show,t)&&(this.recoverAllTexture(this,!0),Dispatch.register(DailyTaskManager.EVENT_DAILY_TASK_UPDATE,this.upList,this,!0))},e.prototype.upList=function(){this.m_typeList.source=DailyTaskManager.instance.getTaskList()},e.prototype.hide=function(){Dispatch.remove(DailyTaskManager.EVENT_DAILY_TASK_UPDATE,this.upList,this),DisplayObjectUtils.removeFormParent(this)},e}(ComponentBase);__reflect(DailyTaskView.prototype,"DailyTaskView");var TargetTaskView=function(t){function e(){var e=t.call(this)||this;return e.m_layout=new eui.TileLayout,e.m_typeList=new eui.ArrayCollection,e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/achievementUI/view/AchievemenViewSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.u_scrollerItem.horizontalScrollBar=null,this.u_scrollerItem.verticalScrollBar=null,this.m_layout.requestedColumnCount=1,this.u_listItem.itemRenderer=AchievementRender,this.u_listItem.layout=this.m_layout,this.u_listItem.dataProvider=this.m_typeList},e.prototype.show=function(t){void 0===t&&(t=null),this.checkComplete(this.show,t)&&(this.recoverAllTexture(this,!0),Dispatch.register(AchievementManager.EVENT_ACHIEVE_RESET_LIST,this.upList,this,!0))},e.prototype.upList=function(){this.m_typeList.source=AchievementManager.instance.getTaskList(1)},e.prototype.hide=function(){Dispatch.remove(AchievementManager.EVENT_ACHIEVE_RESET_LIST,this.upList,this),DisplayObjectUtils.removeFormParent(this)},e}(ComponentBase);__reflect(TargetTaskView.prototype,"TargetTaskView");var BagUI=function(t){function e(){var e=t.call(this)||this;return e.m_layout=new eui.TileLayout,e.m_typeList=new eui.ArrayCollection,e.m_isUse=!1,e.m_disposeUrlList.push("bagUI_json"),e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/bagUI/BagUISkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.x=0,this.y=.5*(StageManager.instance.p_stageHeight-this.height);var e=.5*(StageManager.MIN_STAGE_WIDTH-StageManager.instance.p_stageWidth);this.u_imgBg.x+=e,this.u_imgBg.width+=StageManager.instance.p_stageWidth-StageManager.MIN_STAGE_WIDTH,this.u_scrollItem.x+=e,this.m_itemIcon||(this.m_itemIcon=new ItemIcon,this.m_itemIcon.x=0,this.m_itemIcon.y=0,this.m_itemIcon.p_isShowTip=!1,this.m_itemIcon.scaleX=this.m_itemIcon.scaleY=1),this.u_txtUse.text=LanguageJson.getText("l_btn_use"),this.u_txtAccessTit.text=LanguageJson.getText("l_bag_source"),this.u_scrollItem.horizontalScrollBar=null,this.u_scrollItem.verticalScrollBar=null,this.m_layout.requestedColumnCount=5,this.m_layout.horizontalGap=15,this.m_layout.verticalGap=15,this.u_listItem.itemRenderer=BagRender,this.u_listItem.layout=this.m_layout,this.u_listItem.dataProvider=this.m_typeList},e.prototype.initEvent=function(){this.registerEventClick(this.u_btnUse,this.onUse,this,!0)},e.prototype.onUse=function(t){this.m_isUse&&8==this.m_itemJson.type||e.p_scene_data.c_id&&BagManager.instance.c_prop_use(e.p_scene_data.c_id,1)},e.prototype.onHarvest=function(t){e.p_scene_data&&(this.m_rewardList=t,this.m_itemJson&&8==this.m_itemJson.type?(this.playDragonClip(),this.m_isUse=!0,this.u_btnUse.touchEnabled=!1,this.u_listItem.touchEnabled=!1):RewardModule.instance.receiveByProp(this.m_rewardList,4,2))},e.prototype.playDragonClip=function(){this.m_harvest||(this.m_harvest=new DragonMovieClip,this.m_harvest.x=550,this.m_harvest.y=330,this.m_harvest.scaleX=this.m_harvest.scaleY=.6,this.m_harvest.setMC("resource/assets/dragon/baoxiang","baoxiangg"),this.m_harvest.p_funcEventList=[{c_func:this.setOpenBaoxiang.bind(this),c_eventKey:"my_event"}],this.m_harvest.p_funcPlayComplete=this.onRecive.bind(this)),this.addChild(this.m_harvest),this.m_harvest.play("stand",1)},e.prototype.setOpenBaoxiang=function(){this.m_rewardList&&RewardModule.instance.receiveByProp(this.m_rewardList,4,2)},e.prototype.onRecive=function(){this.m_harvest&&(this.m_harvest.stop(),DisplayObjectUtils.removeFormParent(this.m_harvest)),this.m_isUse=!1,this.u_btnUse.touchEnabled=!0,this.u_listItem.touchEnabled=!0},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),this.u_grpExist.visible=!0,this.u_grpMask.visible=!1,this.m_isUse=!1,this.u_btnUse.touchEnabled=!0,this.u_listItem.touchEnabled=!0,this.u_scrollItem.viewport.scrollV=0,Dispatch.register(BagManager.EVENT_BAG_ADDNEW,this.upgradeItem,this,!0),Dispatch.register(BagManager.EVENT_BAG_DETAIL,this.onDetail,this),Dispatch.register(BagManager.EVENT_BAOXIANG_EFFECTS,this.onHarvest,this))},e.prototype.upgradeItem=function(){var t=BagManager.instance.getBagList();t[0]?(e.p_scene_data.c_id=t[0].c_id,e.p_scene_data.c_rid=t[0].c_rid,this.onDetail()):(t.length=40,this.u_grpExist.visible=!1,this.u_grpMask.visible=!0,this.m_itemIcon.hide()),this.m_typeList.source=t},e.prototype.onDetail=function(){if(e.p_scene_data){this.m_itemJson=ItemJson.getData(e.p_scene_data.c_id);String(BagManager.instance.getNum(this.m_itemJson.id)),ColorJson.getColorNum(this.m_itemJson.quality);this.u_txtName.text=this.m_itemJson.name,this.u_txtDetail.textFlow=HtmlUtil.setTextFlow(this.m_itemJson.text);var t=ItemTypeJson.getData(this.m_itemJson.type);t&&1==t.use_type?this.u_btnUse.visible=!0:this.u_btnUse.visible=!1,this.u_grpAccess.y=this.u_txtDetail.y+this.u_txtDetail.textHeight+15;var i=HtmlUtil.setText(ItemJson.getSource(this.m_itemJson.id));this.u_txtAccess.textFlow=TextUtil.setTextFlow(TextUtil.setText(i,15787184)),this.m_itemIcon.setData(this.m_itemJson.id,0),this.u_grpItemIcon.addChild(this.m_itemIcon)}},e.prototype.hide=function(e,i){void 0===i&&(i=null),t.prototype.hide.call(this,e,i),this.u_scrollItem.stopAnimation(),Dispatch.remove(BagManager.EVENT_BAG_ADDNEW,this.upgradeItem,this),Dispatch.remove(BagManager.EVENT_BAG_DETAIL,this.onDetail,this),Dispatch.remove(BagManager.EVENT_BAOXIANG_EFFECTS,this.onHarvest,this),this.m_harvest&&(this.m_harvest.destory(),this.m_harvest=null)},e.prototype.isCloseUI=function(){return this.m_isUse?!1:!0},e.p_scene_data={c_id:0,c_rid:0},e}(UIBase);__reflect(BagUI.prototype,"BagUI");var BagPage=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(PageBase);__reflect(BagPage.prototype,"BagPage");var ItemMergePopup=function(t){function e(){var e=t.call(this)||this;return e.m_disposeUrlList.push("mergeUI_json"),e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/bagUI/popup/ItemMergePopupSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.m_itemIcon||(this.m_itemIcon=new ItemIcon,this.m_itemIcon.x=135,this.m_itemIcon.y=15,this.m_itemIcon.scaleX=this.m_itemIcon.scaleY=.6),this.addChild(this.m_itemIcon),this.u_descTip.textFlow=LanguageJson.getHtmlTextFlow("l_bag_desc2")},e.prototype.initEvent=function(){t.prototype.initEvent.call(this)},e.prototype.showView=function(e){if(void 0===e&&(e=null),this.checkComplete(this.showView,e)){t.prototype.showView.call(this,e);var i=Number(e.itemId);if(this.m_json=ItemJson.getData(i),this.m_json){var s=BagManager.instance.getNum(this.m_json.id);this.m_itemIcon.setData(this.m_json.id),this.u_txtName.text=this.m_json.name,this.u_txtName.textColor=ColorJson.getColorNum(this.m_json.quality),this.u_txtHave.textFlow=LanguageJson.getHtmlTextFlow("l_bag_item_have",[s]),this.u_txtDesc.textFlow=HtmlUtil.setTextFlow(this.m_json.text)}}},e.prototype.hide=function(e,i){void 0===i&&(i=null),t.prototype.hide.call(this,e,i)},Object.defineProperty(e.prototype,"width",{get:function(){return 600},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 320},enumerable:!0,configurable:!0}),e}(PopupBase);__reflect(ItemMergePopup.prototype,"ItemMergePopup");var ItemUsePopup=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/bagUI/popup/ItemUsePopupSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.m_itemIcon||(this.m_itemIcon=new ItemIcon,this.addChild(this.m_itemIcon),this.m_itemIcon.p_isShowTip=!1,this.m_itemIcon.scaleX=this.m_itemIcon.scaleY=.6,this.m_itemIcon.x=28,this.m_itemIcon.y=13.5),this.u_txtDescTitle.textFlow=HtmlUtil.setTextFlow("【"+LanguageJson.getText("l_bag_desc")+"】"),this.u_txtSourTitle.textFlow=HtmlUtil.setTextFlow("【"+LanguageJson.getText("l_bag_source")+"】")},e.prototype.initEvent=function(){t.prototype.initEvent.call(this)},e.prototype.showView=function(e){if(void 0===e&&(e=null),this.checkComplete(this.showView,e)){var i=e.itemId;this.m_itemJson=ItemJson.getData(i),this.m_itemIcon.setData(i,0),this.u_txtName.text=this.m_itemJson.name,i==ItemEnum.EXP||i==ItemEnum.VIP_EXP?this.u_txtHoldings.visible=!1:(this.u_txtHoldings.visible=!0,this.u_txtHoldings.textFlow=HtmlUtil.setTextFlow(LanguageJson.getHtmlText("l_bag_item_have")+NumberUtil.numberDecimalism(BagManager.instance.getNum(i))),this.u_txtHoldings.textColor=ColorJson.getColorNum(this.m_itemJson.quality)),this.u_txtSource.textFlow=HtmlUtil.setTextFlow(ItemJson.getSource(this.m_itemJson.id)),this.u_txtDescribe.textFlow=HtmlUtil.setTextFlow(this.m_itemJson.text);var s=this.u_txtDescribe.y+this.u_txtDescribe.textHeight;this.u_grpSource.y=s+10,this.u_imgBg2.height=this.u_grpSource.y+this.u_grpSource.height-this.u_imgBg2.y+10,this.u_imgBg.height=this.u_imgBg2.y+this.u_imgBg2.height+20,t.prototype.showView.call(this,e)}},Object.defineProperty(e.prototype,"width",{get:function(){return 315},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 287.5},enumerable:!0,configurable:!0}),e}(PopupBase);__reflect(ItemUsePopup.prototype,"ItemUsePopup");var BagRender=function(t){function e(){return t.call(this,"resource/eui_skins/bagUI/render/BagRenderSkin.exml")||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this),this.m_itemIcon||(this.m_itemIcon=new ItemIcon,this.m_itemIcon.x=5,this.m_itemIcon.y=5,this.m_itemIcon.p_isShowTip=!1)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChoose,this)},e.prototype.onChoose=function(t){this.m_voData&&this.m_voData.c_rid!=BagUI.p_scene_data.c_rid&&(BagUI.p_scene_data.c_id=this.m_voData.c_id,BagUI.p_scene_data.c_rid=this.m_voData.c_rid,Dispatch.dispatch(BagManager.EVENT_BAG_DETAIL))},e.prototype.onRemoveStage=function(e){t.prototype.onRemoveStage.call(this,e),this.m_voData&&Dispatch.remove(BagManager.EVENT_BAG_UPGRADE+this.m_voData.c_id,this.setState,this),Dispatch.remove(BagManager.EVENT_BAG_DETAIL,this.setChoState,this)},e.prototype.dataChanged=function(){if(this.checkComplete(this.dataChanged))if(t.prototype.dataChanged.call(this),this.m_voData&&Dispatch.remove(BagManager.EVENT_BAG_UPGRADE+this.m_voData.c_id,this.setState,this),Dispatch.remove(BagManager.EVENT_BAG_DETAIL,this.setChoState,this),this.m_voData=this.data,this.m_voData){this.u_imgBj.visible=!1,this.addChildAt(this.m_itemIcon,1);var e=ItemJson.getData(this.m_voData.c_id);e&&0==e.is_stacked?this.m_itemIcon.setData(this.m_voData.c_id,1):this.m_itemIcon.setData(this.m_voData.c_id),this.m_itemIcon.p_isShowTip=!1,Dispatch.register(BagManager.EVENT_BAG_UPGRADE+this.m_voData.c_id,this.setState,this,!0),Dispatch.register(BagManager.EVENT_BAG_DETAIL,this.setChoState,this,!0)}else this.m_itemIcon&&this.m_itemIcon.hide(),this.u_imgBj.visible=!0,this.u_imgSelected.visible=!1},e.prototype.setState=function(){if(null!=this.m_voData&&null!=this.m_itemIcon){var t=ItemJson.getData(this.m_voData.c_id);t&&0==t.is_stacked?this.m_itemIcon.count=1:this.m_itemIcon.count=BagManager.instance.getNum(this.m_voData.c_id)}},e.prototype.setChoState=function(){null!=this.m_voData&&(this.m_voData.c_rid==BagUI.p_scene_data.c_rid?this.u_imgSelected.visible=!0:this.u_imgSelected.visible=!1)},Object.defineProperty(e.prototype,"tweenType",{get:function(){return 0},enumerable:!0,configurable:!0}),e}(ItemRendererBase);__reflect(BagRender.prototype,"BagRender");var EventBubble=function(t){function e(){var e=t.call(this)||this;return e.m_state=0,e.initView(),e.initEvent(),e}return __extends(e,t),e.prototype.initView=function(){this.m_imgHeadBg=new eui.Image("commonUI_json.commonUI_entrance_bj"),this.addChild(this.m_imgHeadBg),this.m_imgHead=new eui.Image,this.m_imgHead.touchEnabled=!1,this.m_imgHead.x=-8,this.m_imgHead.y=-20,this.addChild(this.m_imgHead),RedNoticeManager.instance.registerRedBubbleTipMsg(this,"{%text}",4,!0,[85,36],[RedNoticeConfig.RED_BOSS_SHOW_TIPS])},e.prototype.initEvent=function(){this.registerEventClick(this.m_imgHeadBg,this.onClickEvent,this)},e.prototype.onClickEvent=function(){PopupModule.instance.showPop(PopupConfig.ID_BOSS_EVENT)},e.prototype.show=function(){Dispatch.register(SceneManager.EVENT_BOSS_EVENT,this.setInfo,this,!0),Dispatch.register(StageManager.EVENT_STAGE_RESIZE,this.stageResize,this,!0),UIModule.instance.downUILayer1.addChild(this)},e.prototype.setInfo=function(){this.m_data=SceneModule.instance.p_bossInfo;var t=MissionJson.getData(this.m_data.mission_type,this.m_data.mission_id);t&&(this.m_monsterData=MonsterJson.getData(t.boss_id),this.m_imgHead.source=PublicCon.PATH_BOSS_EVENT+"head/small/"+this.m_monsterData.icon_id+".png",TimeManager.instance.clearTimer(this.setRedView,this),this.setRedView())},e.prototype.setRedView=function(){1==this.m_state?RedNoticeManager.instance.dispatchRed(RedNoticeConfig.RED_BOSS_SHOW_TIPS,!1,[]):RedNoticeManager.instance.dispatchRed(RedNoticeConfig.RED_BOSS_SHOW_TIPS,!0,[this.m_monsterData.notice]),0==this.m_state?this.m_state=1:this.m_state=0,TimeManager.instance.doLoop(this.setRedView,this,4e3,!1)},e.prototype.hide=function(){Dispatch.remove(SceneManager.EVENT_BOSS_EVENT,this.setInfo,this),Dispatch.remove(StageManager.EVENT_STAGE_RESIZE,this.stageResize,this),TimeManager.instance.clearTimer(this.setRedView,this),DisplayObjectUtils.removeFormParent(this)},e.prototype.stageResize=function(){this.x=5,this.y=280},Object.defineProperty(e.prototype,"width",{get:function(){return 320},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 86},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(EventBubble.prototype,"EventBubble");var BossEventPopup=function(t){function e(){var e=t.call(this)||this;return e.m_time=10,e.m_waitNum=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/bossEventUI/popup/BossEventPopUpSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.m_rewardGroup||(this.m_rewardGroup=new RewardGroupUI,this.m_rewardGroup.spaceX=30,this.m_rewardGroup.y=300,this.addChild(this.m_rewardGroup)),this.u_textReach.text=LanguageJson.getText("l_boss_event_reach"),this.u_textShed.text=LanguageJson.getText("l_boss_event_drop");var e=.5*(StageManager.MIN_STAGE_WIDTH-StageManager.instance.p_stageWidth);this.u_mcLeft.x+=e},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnBack,this.close,this,!0),this.registerEventClick(this.u_btnTo,this.onEnterMission,this,!0)},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView)&&(t.prototype.showView.call(this,e),this.m_msg=SceneModule.instance.p_bossInfo,this.m_jsonData=MissionJson.getData(this.m_msg.mission_type,this.m_msg.mission_id),this.m_monsterJson=MonsterJson.getData(this.m_jsonData.boss_id),this.setBgUI(),this.setMonsterName(),this.setMonsterTalk(),this.setMonsterHead(),this.setRewardData(),this.setBossTime())},e.prototype.setOpenShow=function(){var t=Math.floor(.5*(StageManager.instance.p_stageWidth-this.width)),e=Math.floor(.5*(StageManager.instance.p_stageHeight-this.height+StageManager.instance.p_liuHeight));this.x=-this.width;var i=this.showPoint();this.y=i.y-.3*this.height/2,this.scaleX=0,this.scaleY=0,TweenLite.killTweensOf(this);var s=this.tweenShowTime>0?this.tweenShowTime:.3;TweenLite.to(this,s,{scaleX:1,scaleY:1,x:t,y:e,onComplete:this.showEffectOver.bind(this)})},e.prototype.onHideGather=function(t,e){var i,s=this.closePoint();i=this.tweenHideTime>0?this.tweenHideTime:.3,TweenLite.to(this,i,{scaleX:0,scaleY:0,x:-this.width,y:s.y,ease:Back.easeIn,onComplete:this.sureHide.bind(this),onCompleteParams:[t,e]})},e.prototype.setRewardData=function(){var t=this.m_jsonData.drop_look_list;if(this.m_rewardGroup.scroller.viewport.scrollH=0,this.m_rewardGroup.scaleX=this.m_rewardGroup.scaleY=.58,t.length>4)this.m_rewardGroup.visualWidth=574,this.m_rewardGroup.x=470;else{this.m_rewardGroup.visualWidth=0;var e=40*t.length+15*(t.length-1);this.m_rewardGroup.x=(this.width-e)/2}this.m_rewardGroup.setDataByList(t,t.length)},e.prototype.onEnterMission=function(){SceneManager.instance.c_scene_challenge_boss_tos()},e.prototype.setBgUI=function(){this.u_imgBg.source=PublicCon.PATH_BOSS_EVENT+"theme/"+this.m_monsterJson.icon_id+".jpg"},e.prototype.setMonsterHead=function(){this.u_imgMonst_Head.source=PublicCon.PATH_BOSS_EVENT+"popup/"+this.m_monsterJson.icon_id+".png"},e.prototype.setMonsterName=function(){this.u_textName.text=this.m_monsterJson.name},e.prototype.setMonsterTalk=function(){this.u_textDesc.text=this.m_monsterJson.desc},e.prototype.setBossTime=function(){1==this.m_msg.state?(this.m_time=this.m_msg.time-ServerTimeManager.instance.timer,TimeManager.instance.doLoop(this.countDowDTime,this)):2==this.m_msg.state&&this.setFightState()},e.prototype.countDowDTime=function(){return this.m_time<=0?(this.setFightState(),void TimeManager.instance.clearTimer(this.countDowDTime,this)):(this.m_time-=1,void(this.u_textTime.text=TimeUtil.getSpliceTime2(this.m_time)))},e.prototype.setFightState=function(){TimeManager.instance.doLoop(this.timeDoGo,this)},e.prototype.timeDoGo=function(){var t=["",".","..","..."];this.u_textTime.text=LanguageJson.getText("l_boss_event_state")+t[this.m_waitNum],this.m_waitNum+=1,this.m_waitNum>3&&(this.m_waitNum=0)},Object.defineProperty(e.prototype,"isClickBMask",{get:function(){return!1},enumerable:!0,configurable:!0}),e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i),TimeManager.instance.clearTimer(this.timeDoGo,this),TimeManager.instance.clearTimer(this.countDowDTime,this)},e}(PopupBase);__reflect(BossEventPopup.prototype,"BossEventPopup");var BossEventView=function(t){function e(){var e=t.call(this)||this;return e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/bossEventUI/view/BossEventViewSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){},e.prototype.show=function(){this.checkComplete(this.show)&&(Dispatch.register(StageManager.EVENT_STAGE_RESIZE,this.stageResize,this,!0),UIModule.instance.downUILayer3.addChild(this),this.m_msg=SceneModule.instance.p_bossInfo,this.m_missionData=MissionJson.getData(this.m_msg.mission_type,this.m_msg.mission_id),this.showUIEffect())},e.prototype.showUIEffect=function(){this.m_dragon||(this.m_dragon=new DragonMovieClip,this.addChildAt(this.m_dragon,1),this.m_dragon.y=.5*StageManager.instance.p_stageHeight,this.m_dragon.p_funcPlayComplete=this.showEventBubble.bind(this));var t="bossEvent_"+this.m_missionData.boss_id;this.m_dragon.setMC(PublicCon.PATH_DRAGON_RES+t,t,"stand",1),this.m_dragon.x=.5*StageManager.instance.p_stageWidth,this.m_dragon.play("stand",1)},e.prototype.stageResize=function(){this.u_imgBg.x=.5*StageManager.instance.p_stageWidth,this.u_imgBg.y=.5*StageManager.instance.p_stageHeight,this.u_imgBg.width=this.width=StageManager.instance.p_stageWidth,this.u_imgBg.height=this.height=StageManager.instance.p_stageHeight},e.prototype.showEventBubble=function(){UIModule.instance.setEventBubble(),this.hide()},e.prototype.hide=function(){DisplayObjectUtils.removeFormParent(this),Dispatch.remove(StageManager.EVENT_STAGE_RESIZE,this.stageResize,this),this.m_dragon&&(this.m_dragon.destory(),this.m_dragon=null)},e}(ComponentBase);__reflect(BossEventView.prototype,"BossEventView");var CardBookUI=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e.m_disposeUrlList.push("cardMainUI_json"),e.m_currList.push({funcKey:FunctionEnum.MAIN_TASK,pageMc:new TaskPage}),e.m_currList.push({funcKey:FunctionEnum.CARD_BOOK_1,pageMc:new CardBookPage(2)}),e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/cardBookUI/CardMainUISkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.m_effectOpenType=5,this.m_effectCloseType=5,this.m_pageSelect.p_width=122,this.m_pageSelect.p_height=60;var e=.5*(StageManager.MIN_STAGE_WIDTH-StageManager.instance.p_stageWidth),i=[{key:FunctionEnum.MAIN_TASK,btnNameBj:"cardMainUI_tab0_",posXY:[68+e,179]},{key:FunctionEnum.CARD_BOOK_1,btnNameBj:"cardMainUI_tab1_",posXY:[109+e,308]}];this.m_pageSelect.setDataList(i);var s=[{key:FunctionEnum.MAIN_TASK,redList:[RedNoticeConfig.RED_CARD_ZHUXIAN],redPosXY:[80,-5]},{key:FunctionEnum.CARD_BOOK_1,redList:[RedNoticeConfig.RED_CARD_YAOZU],redPosXY:[80,-5]}];this.m_pageSelect.setRedList(s),this.u_mcLeft.x+=e},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnColse,this.close,this,!0)},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i)},e.prototype.sureHide=function(i,s){void 0===i&&(i=null),void 0===s&&(s=null),t.prototype.sureHide.call(this,i,s);for(var n in e.p_taskUrlList)RES.destroyRes(e.p_taskUrlList[n]);e.p_taskUrlList=[]},Object.defineProperty(e.prototype,"itemIdList",{get:function(){return[]},enumerable:!0,configurable:!0}),e.p_taskUrlList=[],e}(UIBase);__reflect(CardBookUI.prototype,"CardBookUI");var CardRewardEnum=function(){function t(){}return t.CARD_BOOK=1,t.CARD_TITLE=2,t.CARD_CARD=3,t}();__reflect(CardRewardEnum.prototype,"CardRewardEnum");var CardBookPage=function(t){function e(e){var i=t.call(this)||this;return i.m_viewList=[],i.m_bookType=e,i.m_disposeUrlList.push("cardBookUI_json"),i}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/cardBookUI/page/CardBookPageSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this);var e=.5*(StageManager.MIN_STAGE_WIDTH-StageManager.instance.p_stageWidth);this.u_scrollerItem.x+=e/2,this.u_imgMask.width=StageManager.instance.p_stageWidth},e.prototype.initEvent=function(){t.prototype.initEvent.call(this)},e.prototype.selectOpenShow=function(t,e){if(2==e)for(var i in this.m_viewList)this.m_viewList[i].titleId!=t&&2==this.m_viewList[i].moveType&&this.m_viewList[i].setHideView();this.setRowsY(!0,t,e)},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),e&&e.u_bookType&&(this.m_bookType=e.u_bookType),e&&e.u_titleId?this.setTitleList(e.u_titleId):this.setTitleList(),Dispatch.register(CardTitieView.EVENT_CARD_TITLE_SELECT,this.selectOpenShow,this))},e.prototype.setTitleList=function(t){void 0===t&&(t=-1),this.u_scrollerItem.viewport.scrollV=0,this.m_json=CardBookJson.getData(this.m_bookType);for(var e=this.m_json.card_title_list,i=0;i<e.length;i++){var s;this.m_viewList[i]?s=this.m_viewList[i]:(s=new CardTitieView,this.m_viewList[i]=s,this.u_mcContent.addChild(s)),i==this.m_viewList.length-1?s.updateData(e[i],this.setRowsY.bind(this),t):s.updateData(e[i],null,t)}},e.prototype.setRowsY=function(t,e,i){void 0===t&&(t=!1),void 0===e&&(e=-1),void 0===i&&(i=-1);for(var s=0,n=0,o=0;o<this.m_viewList.length;o++){var a=this.m_viewList[o];a.setRoy(n,t),a.titleId==e&&(s=n),n=a.roy+a.height+5}if(this.u_mcContent.height=n,s>0){var r=n-s-this.u_scrollerItem.height;0>=r&&(s+=r),0>=s&&(s=0),TweenLite.to(this.u_scrollerItem.viewport,.2,{scrollV:s})}},e.prototype.hide=function(e){void 0===e&&(e=null),Dispatch.remove(CardTitieView.EVENT_CARD_TITLE_SELECT,this.selectOpenShow,this);for(var i=0;i<this.m_viewList.length;i++)this.m_viewList[i].hide();t.prototype.hide.call(this)},e}(PageBase);__reflect(CardBookPage.prototype,"CardBookPage");var CardInfoPopup=function(t){function e(){var e=t.call(this)||this;return e.m_itemList=[],e.touchEnabled=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/cardBookUI/popup/CardInfoPopupSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_txtReward.textFlow=LanguageJson.getHtmlTextFlow("l_daily_task_reward"),this.u_txtBlank.textFlow=LanguageJson.getHtmlTextFlow("l_closePop_tip")},e.prototype.initEvent=function(){t.prototype.initEvent.call(this)},e.prototype.showView=function(e){if(void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),e&&e.cardId)){var i=e.cardId,s=!1;e.isReceived&&(s=e.isReceived);var n=CardJson.getData(i),o=ItemJson.getData(i);this.u_txtTitle.text=o.name,this.u_txtTitle.textColor=ColorJson.getColorNum(o.quality),this.u_condition.text=n.unlock_desc,this.u_txtMsg.textFlow=HtmlUtil.setTextFlow(n.desc),this.u_imgTitle.source=PublicCon.PATH_CARDBOOK+"head/"+i+".png";var a=RewardJson.getAnyListById(n.reward);this.u_txtReward.right=622+58*(a.length-1),this.m_itemList=[];for(var r=0;r<a.length;r++){var _=new CardRewardItem;_.x=(_.width+15)*r,_.y=0,_.show(a[r][0],a[r][1],s),this.u_itemList.addChild(_),this.m_itemList.push(_)}var h=this.u_txtMsg.textHeight;h>75?this.u_scrollerItem.height=75:this.u_scrollerItem.height=h}},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i)},e.prototype.sureHide=function(e,i){void 0===e&&(e=null),void 0===i&&(i=null),t.prototype.sureHide.call(this,e,i);for(var s=0;s<this.m_itemList.length;s++)this.m_itemList[s].hide()},e}(PopupBase);__reflect(CardInfoPopup.prototype,"CardInfoPopup");var CardRewardPopup=function(t){function e(){var e=t.call(this)||this;return e.m_itemList=[],e.touchEnabled=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/cardBookUI/popup/CardRewardPopupSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_txtReward.textFlow=LanguageJson.getHtmlTextFlow("l_daily_task_reward"),this.u_txtBlank.textFlow=LanguageJson.getHtmlTextFlow("l_closePop_tip")
},e.prototype.initEvent=function(){t.prototype.initEvent.call(this)},e.prototype.showView=function(e){if(void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),e&&e.titleId)){var i=e.titleId,s=!1;e.isReceived&&(s=e.isReceived);var n=CardTitleJson.getData(i);this.u_txtTitle.text=n.name,this.u_txtTitle.textColor=ColorJson.getColorNum(n.quality),this.u_condition.text=n.unlock_desc,this.u_txtMsg.textFlow=HtmlUtil.setTextFlow(n.desc),this.u_imgTitle.source=PublicCon.PATH_CARDBOOK+"rewardTitle/"+i+".png";var o=RewardJson.getAnyListById(n.reward);this.u_txtReward.right=622+58*(o.length-1),this.m_itemList=[];for(var a=0;a<o.length;a++){var r=new CardRewardItem;r.x=(r.width+15)*a,r.y=0,r.show(o[a][0],o[a][1],s),this.u_itemList.addChild(r),this.m_itemList.push(r)}var _=this.u_txtMsg.textHeight;_>75?this.u_scrollerItem.height=75:this.u_scrollerItem.height=_}},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i)},e.prototype.sureHide=function(e,i){void 0===e&&(e=null),void 0===i&&(i=null),t.prototype.sureHide.call(this,e,i);for(var s=0;s<this.m_itemList.length;s++)this.m_itemList[s].hide()},e}(PopupBase);__reflect(CardRewardPopup.prototype,"CardRewardPopup");var CardRewardItem=function(t){function e(){var e=t.call(this)||this;return e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/cardBookUI/view/CardRewardItemSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.u_imgReceive.touchEnabled=!1,this.m_itemIcon||(this.m_itemIcon=new ItemIcon,this.addChildAt(this.m_itemIcon,0))},e.prototype.initEvent=function(){},e.prototype.show=function(t,e,i){void 0===i&&(i=!1),this.checkComplete(this.show,t,e,i)&&(this.m_itemIcon.setData(t,e),this.u_imgReceive.visible=i,ObjectUtils.setGrey(this.m_itemIcon,i,!0))},e.prototype.hide=function(){DisplayObjectUtils.removeFormParent(this)},Object.defineProperty(e.prototype,"width",{get:function(){return 100},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 100},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(CardRewardItem.prototype,"CardRewardItem");var CardTitieView=function(t){function e(){var e=t.call(this)||this;return e.m_viewList=[],e.m_jinDuWidth=351,e.m_type=1,e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/cardBookUI/view/CardTitieViewSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.touchEnabled=!1},e.prototype.initEvent=function(){this.registerEventClick(this.u_btnShow,this.onShow,this),this.registerEventClick(this.u_btnReward,this.onReward,this)},e.prototype.onShow=function(t){TweenLite.killTweensOf(this.u_mcContent),1==this.m_type?(this.m_type=2,this.u_mcContent.visible=!0,this.skin.height=this.height,this.u_mcBg.height=this.contentHeight+20,TweenLite.to(this.u_mcContent,.11,{scaleY:1,alpha:1,onComplete:this.setContent.bind(this)})):this.setHideView(),Dispatch.dispatch(e.EVENT_CARD_TITLE_SELECT,this.m_titleId,this.m_type)},e.prototype.setHideView=function(){this.m_type=1,this.skin.height=this.height,TweenLite.to(this.u_mcContent,.11,{scaleY:0,alpha:0,onComplete:this.setContent.bind(this)})},e.prototype.setContent=function(){1==this.m_type?(this.u_mcContent.alpha=0,this.u_mcContent.scaleY=0,this.u_imgArrow.scaleY=1,this.u_mcContent.visible=!1,this.u_mcBg.height=0):(this.u_mcContent.alpha=1,this.u_mcContent.scaleY=1,this.u_imgArrow.scaleY=-1,this.u_mcContent.visible=!0)},e.prototype.onReward=function(t){var e=CardManager.instance.getTitleStateById(this.m_titleId);0==e?PopupModule.instance.showPop(PopupConfig.ID_CARD_BOOK_REWARD,{titleId:this.m_titleId,isReceived:!1},!1):1==e?CardManager.instance.s_card_get_award(2,this.m_titleId):PopupModule.instance.showPop(PopupConfig.ID_CARD_BOOK_REWARD,{titleId:this.m_titleId,isReceived:!0},!1)},e.prototype.updateData=function(t,e,i){if(void 0===e&&(e=null),void 0===i&&(i=-1),this.checkComplete(this.updateData,t,e,i)){this.m_titleId=t,this.m_json=CardTitleJson.getData(this.m_titleId),this.u_txtName.text=this.m_json.name,this.u_imgTitle.source=PublicCon.PATH_CARDBOOK+"title/"+this.m_titleId+".png";for(var s=0;s<this.m_json.card_item_list.length;s++){var n;this.m_viewList[s]?n=this.m_viewList[s]:(n=new CardView,this.m_viewList[s]=n,this.u_mcContent.addChild(n)),n.x=10+Math.floor(s%6)*(n.width+14),n.y=15+Math.floor(s/6)*(n.height+15),n.show(this.m_json.card_item_list[s])}i&&i==this.m_titleId?(this.m_type=2,this.skin.height=92+this.contentHeight,this.u_mcBg.height=this.contentHeight+20):(this.m_type=1,this.skin.height=92,this.u_mcBg.height=0),this.setContent(),null!=e&&e.call(this,!1,i),Dispatch.register(CardManager.EVENT_CARD_REWARD_RECEIVED+CardRewardEnum.CARD_TITLE,this.setBoxEff,this),Dispatch.register(CardManager.EVENT_CARD_REWARD_RECEIVED+CardRewardEnum.CARD_CARD,this.upRed,this),Dispatch.register(CardManager.EVENT_CARD_UPDATA,this.upCardRed,this),this.setJindu(),this.setBoxEff(this.m_titleId),this.setCardRed()}},e.prototype.upRed=function(t){this.m_json.card_item_list.indexOf(t)>-1&&(this.setJindu(),this.setBoxEff(this.m_titleId),this.setCardRed())},e.prototype.setCardRed=function(){this.u_imgRed.visible=CardManager.instance.getRedByTitleId(this.m_titleId)},e.prototype.upCardRed=function(t){this.m_json.card_item_list.indexOf(t)>-1&&this.setCardRed()},e.prototype.setBoxEff=function(t){if(t==this.m_titleId){var e=CardManager.instance.getTitleStateById(this.m_titleId);this.u_imgEff.visible=1==e?!0:!1,2==e?ObjectUtils.setGrey(this.u_btnReward,!0,!0):ObjectUtils.setGrey(this.u_btnReward,!1,!0)}},e.prototype.setJindu=function(){for(var t=0,e=0;e<this.m_json.card_item_list.length;e++){var i=CardManager.instance.getCardDataById(this.m_json.card_item_list[e]);i&&2==i.state&&(t+=1)}this.u_txtJindu.text=t+"/"+this.m_json.card_item_list.length,this.u_jindu.width=t/this.m_json.card_item_list.length*this.m_jinDuWidth},e.prototype.setRoy=function(t,e){void 0===e&&(e=!1),this.m_roy=t,e?TweenLite.to(this,.11,{y:t}):this.y=t},e.prototype.hide=function(){Dispatch.remove(CardManager.EVENT_CARD_REWARD_RECEIVED+CardRewardEnum.CARD_TITLE,this.setBoxEff,this),Dispatch.remove(CardManager.EVENT_CARD_REWARD_RECEIVED+CardRewardEnum.CARD_CARD,this.upRed,this),Dispatch.remove(CardManager.EVENT_CARD_UPDATA,this.upCardRed,this);for(var t=0;t<this.m_viewList.length;t++)this.m_viewList[t].hide()},Object.defineProperty(e.prototype,"titleId",{get:function(){return this.m_titleId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"moveType",{get:function(){return this.m_type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"roy",{get:function(){return this.m_roy},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return 849},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 1==this.m_type?92:92+this.contentHeight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contentHeight",{get:function(){return this.u_mcContent.height},enumerable:!0,configurable:!0}),e.EVENT_CARD_TITLE_SELECT="EVENT_CARD_TITLE_SELECT",e}(ComponentBase);__reflect(CardTitieView.prototype,"CardTitieView");var CardView=function(t){function e(){var e=t.call(this)||this;return e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/cardBookUI/view/CardViewSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){},e.prototype.initEvent=function(){this.registerEventClick(this.u_btnClick,this.onClick,this)},e.prototype.onClick=function(t){this.m_data?0==this.m_data.state?this.m_data.num>=this.m_json.goal_count?CardManager.instance.s_card_get_award(3,this.m_cardId):PopupModule.instance.showPop(PopupConfig.ID_CARD_BOOK_INFO,{cardId:this.m_cardId,isReceived:!1},!1):PopupModule.instance.showPop(PopupConfig.ID_CARD_BOOK_INFO,{cardId:this.m_cardId,isReceived:!0},!1):PopupModule.instance.showPop(PopupConfig.ID_CARD_BOOK_INFO,{cardId:this.m_cardId,isReceived:!1},!1)},e.prototype.show=function(t){if(this.checkComplete(this.show,t)){this.m_cardId=t,this.m_json=CardJson.getData(t);var e=ItemJson.getData(this.m_cardId);e&&(this.u_imgIcon.source=ItemJson.getIconPath(this.m_cardId),this.u_imgQuality.source="commonUI_json.commonUI_icon_q_"+e.quality),Dispatch.register(CardManager.EVENT_CARD_UPDATA,this.upCardData,this),Dispatch.register(CardManager.EVENT_CARD_REWARD_RECEIVED+CardRewardEnum.CARD_CARD,this.upCardData,this),this.setCardData()}},e.prototype.upCardData=function(t){this.m_cardId==t&&this.setCardData()},e.prototype.setCardData=function(){var t=0;this.u_imgReceived.visible=!1,this.u_imgRed.visible=!1,this.m_data=CardManager.instance.getCardDataById(this.m_cardId),this.m_data&&(t=this.m_data.num,2==this.m_data.state?this.u_imgReceived.visible=!0:t>=this.m_json.goal_count&&(this.u_imgRed.visible=!0)),t>0?(this.u_txtCount.text=t+"/"+this.m_json.goal_count,ObjectUtils.setGrey(this,!1,!0)):(this.u_txtCount.textFlow=LanguageJson.getHtmlTextFlow("l_card_none"),ObjectUtils.setGrey(this,!0,!0))},e.prototype.hide=function(){Dispatch.remove(CardManager.EVENT_CARD_UPDATA,this.upCardData,this),Dispatch.remove(CardManager.EVENT_CARD_REWARD_RECEIVED+CardRewardEnum.CARD_CARD,this.upCardData,this)},Object.defineProperty(e.prototype,"width",{get:function(){return 116},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 138},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(CardView.prototype,"CardView");var CardPopup=function(t){function e(){var e=t.call(this)||this;return e.m_cards=[],e.m_fanArr=[],e.m_type=1,e.m_awardIds=[],e.m_otherIds=[],e.m_awardList=[],e.m_maxCardNum=8,e.m_isComp=!1,e.m_serverTime=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/cardUI/popup/CardPopupSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this)},e.prototype.showView=function(e){var i=this;if(void 0===e&&(e=null),this.checkComplete(this.showView,e)){t.prototype.showView.call(this,e),this.m_otherIds=[],this.m_awardIds=[],this.m_awardList=[],this.m_fanArr=[],this.m_time=(Number(StaticDataJson.getData("monster_function_fanpai_time").data)+750)/1e3,this.u_txtCountdown.textFlow=LanguageJson.getHtmlTextFlow("l_game_unit_s",[this.m_time]);var s=e;s.award_list.forEach(function(t){i.m_awardIds.push(t.id),i.m_awardList=i.m_awardList.concat(t.prop_list)}),this.m_type=s.special_event_type;var n=MonsterFunctionFanpaiJson.getJsonDatas(this.m_type);n.forEach(function(t){i.m_awardIds.indexOf(t.id)<0&&i.m_otherIds.push(t.id)}),this.m_otherIds=NumberUtil.randomIndexList(this.m_otherIds),this.m_awardIds=NumberUtil.randomIndexList(this.m_awardIds),this.resetCard(),this.createAnimation()}},e.prototype.resetCard=function(){this.m_cards.forEach(function(t){t.visible=!1})},e.prototype.createAnimation=function(){for(var t=function(t){var i=e.createCard(t);DelayCallUtils.delayedCall(.15*t,function(){i.move()},e)},e=this,i=0;i<this.m_maxCardNum;i++)t(i);DelayCallUtils.delayedCall(1.2,this.resetEvent,this)},e.prototype.createCard=function(t){var e;return this.m_cards.length>t?e=this.m_cards[t]:(e=new CardRenderView,e.cardId=t,this.addChild(e),this.m_cards.push(e)),e.reset(),e},e.prototype.resetEvent=function(){this.startCountDown(),DelayCallUtils.killDelayedCallsTo(this.resetEvent,this);for(var t=0;t<this.m_cards.length;t++){var e=this.m_cards[t];e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.tapCard,this)}},e.prototype.startCountDown=function(){this.m_serverTime=ServerTimeManager.instance.timerValue,this.u_txtCountdown.visible=!0,TimeManager.instance.doLoop(this.countDown,this,200)},e.prototype.countDown=function(){var t=ServerTimeManager.instance.timerValue-this.m_serverTime,e=this.m_time-t/1e3;this.u_txtCountdown.textFlow=LanguageJson.getHtmlTextFlow("l_game_unit_s",[e>>0]),0>=e&&(this.autoOpenCard(),this.cleanTimer())},e.prototype.cleanTimer=function(){TimeManager.instance.clearTimer(this.countDown,this),this.u_txtCountdown.visible=!1},e.prototype.autoOpenCard=function(){for(var t=[0,1,2,3,4,5,6,7],e=t.length-1;e>=0;e--)this.m_fanArr.indexOf(t[e])>=0&&t.splice(e,1);for(var i,e=this.m_fanArr.length;e<this.m_awardIds.length;e++){var s=Math.floor(Math.random()*t.length);i=this.m_cards[t[s]],this.m_fanArr.push(t[s]),t.splice(s,1),DelayCallUtils.delayedCall(.5*e,this.openCard.bind(this,i,e),this)}},e.prototype.tapCard=function(t){var e=t.currentTarget;this.m_fanArr.indexOf(e.cardId)<0&&this.m_fanArr.push(e.cardId),this.m_fanArr.length<3&&(this.m_serverTime=ServerTimeManager.instance.timerValue),this.openCard(e)},e.prototype.openCard=function(t,e){void 0===e&&(e=-1);var i=e>-1?e:this.m_fanArr.length-1,s=MonsterFunctionFanpaiJson.getData(this.m_type,this.m_awardIds[i]);t.openCard(s),this.m_fanArr.length>=3&&(this.removeCardEvent(),this.cleanTimer(),DelayCallUtils.delayedCall(1.5,this.openAllCard,this))},e.prototype.openAllCard=function(){DelayCallUtils.killDelayedCallsTo(this.openAllCard,this);for(var t=0,e=0;e<this.m_cards.length;e++)if(this.m_fanArr.indexOf(e)<0){var i=this.m_cards[e],s=MonsterFunctionFanpaiJson.getData(this.m_type,this.m_otherIds[t]);i.openCard(s),t++}DelayCallUtils.delayedCall(1,this.showPop,this)},e.prototype.showPop=function(){DelayCallUtils.killDelayedCallsTo(this.showPop,this),this.m_isComp=!0,this.close(),FightManager.instance.showPopupAward(9,this.m_awardList)},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i),this.removeCardEvent()},e.prototype.removeCardEvent=function(){for(var t=0;t<this.m_cards.length;t++){var e=this.m_cards[t];e.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.tapCard,this)}},e.prototype.sureHide=function(e,i){void 0===e&&(e=null),void 0===i&&(i=null),t.prototype.sureHide.call(this,e,i)},Object.defineProperty(e.prototype,"isClickBMask",{get:function(){return!1},enumerable:!0,configurable:!0}),e}(PopupBase);__reflect(CardPopup.prototype,"CardPopup"),window.showCardPopup=function(t){void 0===t&&(t=[1,2,3]);var e=new proto.m_fight_notice_get_function_monster_award_toc;e.award_list=[];for(var i=0;i<t.length;i++){var s=new proto.m_fight_notice_get_function_monster_award_toc.FunctionMonsterAward;s.id=t[i],s.prop_list=[];var n=new proto.Prop;n.prop_id=2,n.num=1e4*Math.random()+300>>0,s.prop_list.push(n),e.award_list.push(s)}e.special_event_type=4,PopupModule.instance.showPop(PopupConfig.ID_CARD_POPUP,e)};var CardRenderView=function(t){function e(){var e=t.call(this)||this;return e.cardId=0,e.m_isOpen=!1,e.m_interWidth=105,e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/cardUI/view/CardSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.touchEnabled=!1,this.m_icon||(this.m_icon=new ItemIcon,this.m_icon.horizontalCenter=0,this.m_icon.scaleX=.6,this.m_icon.scaleY=.6,this.m_icon.bottom=20,this.u_imgGp.addChildAt(this.m_icon,1)),this.m_icon.p_isShowQuality=!1},e.prototype.initEvent=function(){},e.prototype.reset=function(){this.u_imgBg.visible=!0,this.u_imgBg.scaleX=1,this.u_imgGp.visible=!1,this.u_imgGp.scaleX=0,this.x=514,this.y=450,this.visible=!1,this.m_isOpen=!1},e.prototype.move=function(){this.visible=!0;var t,e;t=(1136-4*this.u_imgBg.width)/2+this.cardId%4*this.m_interWidth,e=this.cardId<4?(640-2*this.u_imgBg.height-20)/2:640-2*this.u_imgBg.height-20,TweenLite.to(this,.2,{x:t,y:e,alpha:1,ease:Linear.easeOut})},e.prototype.openCard=function(t){this.m_isOpen||(this.m_json=t,this.m_icon.setData(this.m_json.reward_item_list[0],this.m_json.reward_item_list[1]),this.m_isOpen=!0,TweenLite.to(this.u_imgBg,.3,{scaleX:0,onComplete:this.changeCard.bind(this)}))},e.prototype.changeCard=function(){this.u_imgBg.visible=!1,this.u_imgGp.visible=!0,TweenLite.to(this.u_imgGp,.3,{scaleX:1})},e.prototype.onRemoveStage=function(t){this.onRemoveStage(t),this.m_icon&&this.m_icon.hide()},e.prototype.onAddStage=function(t){this.onAddStage(t),this.m_icon&&this.addChildAt(this.m_icon,1),this.m_json&&this.m_icon.setData(this.m_json.reward_item_list[0],this.m_json.reward_item_list[1])},e}(ComponentBase);__reflect(CardRenderView.prototype,"CardRenderView");var DragonMovieClip=function(t){function e(){var e=t.call(this)||this;return e.m_url="",e.m_animationKey="",e.m_value=0,e.p_loopNum=0,e.p_loadPointY=-1,e.touchEnabled=!1,e.touchChildren=!1,e}return __extends(e,t),e.prototype.addRemoveStageListener=function(){this.hasEventListener(egret.Event.REMOVED_FROM_STAGE)||this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removedFromStage,this)},e.prototype.removedFromStage=function(){this.addEventListener(egret.Event.ADDED_TO_STAGE,this.addedToStage,this),this.stop()},e.prototype.addedToStage=function(){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.addedToStage,this),this.play()},e.prototype.setLoadIcon=function(){-1!=this.p_loadPointY&&(this.m_loadImg||(this.m_loadImg=new eui.Image("commonUI_jiazai"),this.m_loadImg.anchorOffsetX=21,this.m_loadImg.anchorOffsetY=21,this.m_loadImg.horizontalCenter=0),this.m_loadImg.y=this.p_loadPointY,this.m_value=0,this.addChild(this.m_loadImg),this.m_loadImg.rotation=this.m_value,TimeManager.instance.doLoop(this.doTimeZhuan,this,20))},e.prototype.doTimeZhuan=function(){this.m_value>=360&&(this.m_value=0),this.m_loadImg.rotation=this.m_value,this.m_value+=10},e.prototype.setMC=function(t,e,i,s){void 0===i&&(i="stand"),void 0===s&&(s=0),null!=this.m_url&&TextureLoadManager.instance.closeLoad(this.m_url,this),this.m_url=t,this.m_buildKey=e,this.m_animationKey=i,this.p_loopNum=s},e.prototype.playHero=function(t){var e=HeroJson.getData(t);if(null!=e){var i=PublicCon.PATH_UI_ROLE+"hero_"+e.avatar_id,s="hero_"+e.avatar_id;this.setMC(i,s),this.play(i)}},e.prototype.play=function(t,e){void 0===t&&(t="stand"),void 0===e&&(e=0),""!=this.m_url&&this.m_url&&(this.m_animationKey=t,0!=e&&this.p_loopNum!=e&&(this.p_loopNum=e),this.setLoadIcon(),TextureLoadManager.instance.requestLoadDragon(this.m_url,this,LoaderPriority.DRAGON,!1))},e.prototype.playReuse=function(t,e){void 0===t&&(t="stand"),void 0===e&&(e=0),this.m_mc&&this.m_animationKey!=t&&(this.m_animationKey=t,0!=e&&this.p_loopNum!=e&&(this.p_loopNum=e),this.m_mc.animation.stop(),this.m_mc.animation.gotoAndPlayByFrame(this.m_animationKey,1,this.p_loopNum))},e.prototype.onloadComplete=function(t){this.setCloseMc();var e=TexturePool.instance.getTextureDragon(t,this.hashCode),i=t.split("/"),s=i[i.length-2]+"/"+i[i.length-1];null==dragonBones.EgretFactory.factory.getDragonBonesData(s)&&dragonBones.EgretFactory.factory.parseDragonBonesData(e[0],s),null==dragonBones.EgretFactory.factory.getTextureAtlasData(s)&&dragonBones.EgretFactory.factory.parseTextureAtlasData(e[1],e[2],s),this.m_mc=dragonBones.EgretFactory.factory.buildArmatureDisplay(this.m_buildKey),null!=this.p_funcEventList&&this.m_mc.addDBEventListener(dragonBones.EventObject.FRAME_EVENT,this.onEventComplete,this),1==this.p_loopNum&&this.m_mc.addDBEventListener(dragonBones.EventObject.LOOP_COMPLETE,this.onLoopComplete,this),this.addChildAt(this.m_mc,0),this.m_mc.animation.gotoAndPlayByFrame(this.m_animationKey,1,this.p_loopNum),null!=this.p_funcLoadComplete&&this.p_funcLoadComplete.call(this,t)},e.prototype.onLoopComplete=function(t){null!=this.p_funcPlayComplete&&this.p_funcPlayComplete.call(this),this.stop()},e.prototype.onEventComplete=function(t){if(null!=this.p_funcEventList)for(var e in this.p_funcEventList)if(this.p_funcEventList[e].c_eventKey==t.eventObject.name){this.p_funcEventList[e].c_func(this,t.eventObject.name);break}},e.prototype.onloadError=function(t){this.stop()},e.prototype.stop=function(){TextureLoadManager.instance.closeLoad(this.m_url,this),this.setCloseMc(),TexturePool.instance.destoryTextureDragon(this.m_url,this.hashCode)},e.prototype.setCloseMc=function(){TimeManager.instance.clearTimer(this.doTimeZhuan,this),DisplayObjectUtils.removeFormParent(this.m_mc),DisplayObjectUtils.removeFormParent(this.m_loadImg),this.m_mc&&(this.m_mc.removeDBEventListener(dragonBones.EventObject.LOOP_COMPLETE,this.onLoopComplete,this),this.m_mc.removeDBEventListener(dragonBones.EventObject.FRAME_EVENT,this.onEventComplete,this),this.m_mc.animation.stop(),this.m_mc.dispose()),DisplayObjectUtils.removeFormParent(this.m_mc),this.m_mc=null},e.prototype.destory=function(){this.stop(),DisplayObjectUtils.removeFormParent(this.m_loadImg),this.m_loadImg=null,DisplayObjectUtils.removeFormParent(this),this.p_funcLoadComplete=null,this.p_funcPlayComplete=null,this.p_funcEventList=null},e}(egret.DisplayObjectContainer);__reflect(DragonMovieClip.prototype,"DragonMovieClip",["ITextureLoadEvent"]);var EffectMovieClip=function(t){function e(){var e=t.call(this)||this;return e.m_loopNum=-1,e.m_pivotX=.5,e.m_pivotY=.5,e.m_gotoAndStopFrame=-1,e.isInverted=!1,e.m_isStill=!1,e.m_framNum=-1,e.m_isOrder=!0,e.touchEnabled=!1,e.touchChildren=!1,e}return __extends(e,t),e.prototype.addRemoveStageListener=function(){this.hasEventListener(egret.Event.REMOVED_FROM_STAGE)||this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removedFromStage,this)},e.prototype.removedFromStage=function(){this.addEventListener(egret.Event.ADDED_TO_STAGE,this.addedToStage,this),TextureLoadManager.instance.closeLoad(this.m_url,this),null!=this.m_mc&&this.m_mc.dispose()},e.prototype.addedToStage=function(){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.addedToStage,this),this.play()},e.prototype.setMC=function(t,e,i,s){void 0===e&&(e=-1),void 0===i&&(i=12),void 0===s&&(s=TextureFrom.UI_EFFECT),null!=this.m_url&&TextureLoadManager.instance.closeLoad(this.m_url,this),this.m_url=s+t,-1==this.m_url.indexOf(".png")&&(this.m_url+=".png"),this.m_fps=i,this.m_loopNum=e},Object.defineProperty(e.prototype,"onCompleteFunc",{set:function(t){this.m_onCompleteFunc=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onCompleteFunParam",{set:function(t){this.m_onCompleteFunParam=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onLoadCompleteFunc",{set:function(t){this.m_onLoadCompleteFunc=t},enumerable:!0,configurable:!0}),e.prototype.regiestFrameFunc=function(t,e,i){void 0===i&&(i=!0),this.m_framBackFunc=e,this.m_framNum=t,this.m_isOrder=i},e.prototype.play=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),""!=this.m_url&&this.m_url&&(this.m_isStill=!1,0!=t&&(this.m_fps=t),0!=e&&(this.m_loopNum=e),this.m_gotoAndStopFrame=-1,-1==this.m_loopNum&&this.addRemoveStageListener(),TextureLoadManager.instance.requestLoadTextureAtlas(this.m_url,this,LoaderPriority.UIEFFECT,!0))},e.prototype.gotoAndPlay=function(t){this.m_gotoAndStopFrame=t,this.m_loopNum=1,TextureLoadManager.instance.requestLoadTextureAtlas(this.m_url,this,LoaderPriority.UIEFFECT,!0)},e.prototype.still=function(){this.m_isStill=!0,this.m_isStill&&this.m_mc&&this.m_mc.stop()},e.prototype.stop=function(){TextureLoadManager.instance.closeLoad(this.m_url,this),null!=this.m_mc&&this.m_mc.dispose(),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.removedFromStage,this),this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.removedFromStage,this)},e.prototype.onloadComplete=function(t){var e=TexturePool.instance.getTextureAtlas(this.m_url);if(this.isInverted){for(var i=[],s=e.length-1;s>=0;s--)i.push(e[s]);e=i}if(this.m_mc?(this.m_mc.removieAllFrameScript(),this.m_mc.removeEventListeners(),this.m_mc.resetTextures(e,this.m_fps,this.m_loopNum)):(this.m_mc=new MovieClip(e,this.m_fps,this.m_loopNum),this.m_mc.touchEnabled=!1),0!=this.m_pivotX&&Math.abs(this.m_pivotX)<1?this.m_mc.anchorOffsetX=this.m_mc.texture.textureWidth*this.m_pivotX:this.m_mc.anchorOffsetX=.5*this.m_mc.texture.textureWidth+this.pivotX,0!=this.m_pivotY&&Math.abs(this.m_pivotY)<1?this.m_mc.anchorOffsetY=this.m_mc.texture.textureHeight*this.m_pivotY:this.m_mc.anchorOffsetY=.5*this.m_mc.texture.textureHeight+this.pivotY,this.m_isStill||this.m_mc.play(),(null!=this.m_onCompleteFunc||-1!=this.m_loopNum)&&(-1==this.m_gotoAndStopFrame?this.m_mc.addEventListener(egret.Event.COMPLETE,this.onPlayComplete,this):this.m_mc.addFrameScript(this.m_gotoAndStopFrame,this.onPlayComplete.bind(this))),this.m_framNum>0&&null!=this.m_framBackFunc)if(this.m_isOrder)this.m_mc.addFrameScript(this.m_framNum,this.m_framBackFunc);else{var n=this.m_mc.numFrames-this.m_framNum;this.m_mc.addFrameScript(n,this.m_framBackFunc)}this.addChild(this.m_mc),null!=this.m_onLoadCompleteFunc&&this.m_onLoadCompleteFunc()},e.prototype.onPlayComplete=function(t){-1!=this.m_loopNum&&(-1==this.m_gotoAndStopFrame?(this.m_mc.stop(),this.m_mc.removeEventListeners(),this.m_mc.removeFromParent()):(this.m_mc.stop(),this.m_mc.removieAllFrameScript())),null!=this.m_onCompleteFunc&&(this.m_onCompleteFunParam?this.m_onCompleteFunc(this.m_onCompleteFunParam):this.m_onCompleteFunc())},e.prototype.destory=function(){this.stop(),TextureLoadManager.instance.closeLoad(this.m_url,this),this.m_mc&&(this.m_mc.dispose(),this.m_mc=null),this.parent&&this.parent.removeChild(this),this.m_onCompleteFunc=null},e.prototype.removeFromParent=function(){this.stop(),this.parent&&this.parent.removeChild(this)},Object.defineProperty(e.prototype,"mc",{get:function(){return this.m_mc},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pivotX",{get:function(){return this.m_pivotX},set:function(t){this.m_pivotX=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pivotY",{get:function(){return this.m_pivotY},set:function(t){this.m_pivotY=t},enumerable:!0,configurable:!0}),e}(egret.DisplayObjectContainer);__reflect(EffectMovieClip.prototype,"EffectMovieClip",["ITextureLoadEvent"]);var AttrListView=function(t){function e(){var e=t.call(this)||this;return e.m_layout=new eui.TileLayout,e.m_typeList=new eui.ArrayCollection,e.textColor=0,e.initView(),e}return __extends(e,t),e.prototype.initView=function(){this.list_equip=new eui.List,this.addChild(this.list_equip)},e.prototype.setVerticalGap=function(t){this.m_layout.verticalGap=t},e.prototype.setData=function(t,e){if(void 0===e&&(e=null),e?this.list_equip.itemRenderer=e:this.list_equip.itemRenderer=AttrRender,this.list_equip.dataProvider=this.m_typeList,this.m_layout.requestedColumnCount=1,this.m_layout.requestedRowCount=t.length,this.list_equip.layout=this.m_layout,0!=this.textColor)for(var i=0;i<t.length;i++)t[i].nameColor=this.textColor;this.m_typeList.source=t},e.prototype.setData2=function(t,e){if(void 0===e&&(e=null),e?this.list_equip.itemRenderer=e:this.list_equip.itemRenderer=AttrRender,this.list_equip.dataProvider=this.m_typeList,this.m_layout.requestedColumnCount=3,this.m_layout.horizontalGap=-30,this.list_equip.layout=this.m_layout,0!=this.textColor)for(var i=0;i<t.length;i++)t[i].nameColor=this.textColor;this.m_typeList.source=t},e}(eui.Component);__reflect(AttrListView.prototype,"AttrListView");var AttrRender=function(t){function e(){var e=t.call(this)||this;return e.m_isComplete=!1,e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/commonsUI/AttrItemSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.m_isComplete=!0,this.dataChanged()},e.prototype.dataChanged=function(){if(this.m_isComplete&&this.data){var t="";t=this.data.nameColor&&0!=this.data.nameColor?HtmlUtil.setText(TextUtil.setText(this.data.name,this.data.nameColor)+" +"+NumberUtil.numberToString(this.data.value)):HtmlUtil.setText(TextUtil.setText(this.data.name,3687517)+" +"+NumberUtil.numberToString(this.data.value)),this.data.addMsg&&""!=this.data.addMsg&&(t+=" "+this.data.addMsg),this.txtName.textFlow=TextUtil.setTextFlow(t),this.data.value_delta?(this.mcChange.visible=!0,this.txtValue.textFlow=HtmlUtil.setTextFlow(NumberUtil.numberToString(this.data.value_delta)),DelayCallUtils.killDelayedCallsTo(this.setMcChangeX,this),DelayCallUtils.delayedCall(.2,this.setMcChangeX,this),Number(this.data.value_delta)>0?this.imgJiantou.scaleY=1:this.imgJiantou.scaleY=-1):this.mcChange.visible=!1}},e.prototype.setMcChangeX=function(){this.mcChange.x=this.txtName.textWidth+5},e}(eui.ItemRenderer);__reflect(AttrRender.prototype,"AttrRender");var BitmapLabel=function(t){function e(){var e=t.call(this)||this;return e.m_label=new egret.TextField,e.m_label.bold=!0,0==GameManager.instance.p_isTexture?(e.addChild(e.m_label),e):(e.m_bitmap=new egret.Bitmap,e.addChild(e.m_bitmap),e)}return __extends(e,t),Object.defineProperty(e.prototype,"size",{set:function(t){this.m_label.size=GameManager.instance.p_isTexture?2*t:t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontFamily",{set:function(t){this.m_label.fontFamily=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textAlign",{set:function(t){this.m_label.textAlign=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textColor",{set:function(t){this.m_label.textColor=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strokeColor",{set:function(t){this.m_label.strokeColor=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stroke",{set:function(t){this.m_label.stroke=GameManager.instance.p_isTexture?2*t:t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this.m_label.text},set:function(t){this.m_label.width=0/0,this.m_label.textFlow=TextUtil.setTextFlow(t),this.draw()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textFlow",{get:function(){return this.m_label.textFlow},set:function(t){this.m_label.width=0/0,this.m_label.textFlow=t,this.draw()},enumerable:!0,configurable:!0}),e.prototype.draw=function(){0!=GameManager.instance.p_isTexture&&(null==this.m_labelTexture&&(this.m_labelTexture=new egret.RenderTexture),this.m_labelTexture.drawToTexture(this.m_label,null,1),this.m_bitmap.smoothing=!0,this.m_bitmap.texture=this.m_labelTexture,this.m_bitmap.scaleX=.5,this.m_bitmap.scaleY=.5)},e.prototype.dispose=function(){this.m_labelTexture&&(this.m_labelTexture.dispose(),this.m_labelTexture=null),this.m_label.text="",this.m_label.textFlow=null,this.m_bitmap&&(this.m_bitmap.texture=null)},e.prototype.destory=function(){this.m_label&&(DisplayObjectUtils.removeFormParent(this.m_label),this.m_label.text=null,this.m_label=null),this.m_labelTexture&&(this.m_labelTexture.dispose(),this.m_labelTexture=null),this.m_bitmap&&(DisplayObjectUtils.removeFormParent(this.m_bitmap),this.m_bitmap.texture=null,this.m_bitmap=null)},e}(egret.DisplayObjectContainer);__reflect(BitmapLabel.prototype,"BitmapLabel");var CommonHeadView=function(t){function e(){var e=t.call(this)||this;return e.m_itemCount=2,e.m_itemIdList=[],e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/commonsUI/head/CommonHeadSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.touchEnabled=!1,this.m_noticeView||(this.m_noticeView=new WorldNoticeView(this.u_mcNotice,this.u_imgNotice,this.u_txtNotice),this.m_noticeView.show());var t=UIModule.instance.mainSceneCommonhead;this.show(t[0],t[1],t[2])},e.prototype.initEvent=function(){for(var t=0;t<this.m_itemCount;t++)this["u_mcMoney"+t]&&(this["u_mcMoney"+t].touchChildren=!1,this.registerEventClick(this["u_mcMoney"+t],this.onAddMoney,this));this.registerEventClick(this.u_btnEntrance,this.onEntrance,this,!0),this.registerEventClick(this.u_btnAdd,this.onCharge,this,!0),this.registerEventClick(this.u_btnClose,this.onClose,this,!0)},e.prototype.onAddMoney=function(t){if(UIModule.instance.isCloseUI()){var e=Number(String(t.target.name).slice(9)),i=this.m_itemIdList[e];i==ItemEnum.GOLD||i==ItemEnum.RMB?this.onCharge(null):PopupModule.instance.showAccess(i)
}},e.prototype.onCharge=function(t){UIModule.instance.isCloseUI()&&(-1!=UIModule.instance.showUIList.indexOf(UIConfig.ID_CHARGE)?Dispatch.dispatch(ShopHallUI.EVENT_GOTO_VIPLEVEL):ChargeManager.instance.openCharge())},e.prototype.onEntrance=function(t){UIModule.instance.isCloseUI()&&(this.m_menuView||(this.m_menuView=new MenuView),this.m_menuView.show())},e.prototype.onClose=function(t){UIModule.instance.closeCurrUI()},e.prototype.show=function(t,e,i){void 0===e&&(e=""),void 0===i&&(i=!0),this.checkComplete(this.show,t,e,i)&&(""==e?this.u_mcLeft.visible=!1:(this.u_mcLeft.visible=!0,this.u_txtTitle.text=e),i?this.m_noticeView.show():this.m_noticeView.hide(),this.setItemList(t),0==UIModule.instance.showUIList.length?UIModule.instance.downUILayer2.addChild(this):UIModule.instance.upUILayer.addChild(this),Dispatch.register(BagManager.EVENT_BAG_UPGRADE,this.setItemNum,this),Dispatch.register(StageManager.EVENT_STAGE_RESIZE,this.stageResize,this,!0),Dispatch.register(SceneManager.EVENT_ENTER_SCENE,this.setScene,this,!0))},e.prototype.hide=function(){this.m_noticeView.hide(),Dispatch.remove(StageManager.EVENT_STAGE_RESIZE,this.stageResize,this),Dispatch.remove(BagManager.EVENT_BAG_UPGRADE,this.setItemNum,this),Dispatch.remove(SceneManager.EVENT_ENTER_SCENE,this.setScene,this),DisplayObjectUtils.removeFormParent(this)},e.prototype.setScene=function(){this.setEntranceShow()},e.prototype.setEntranceShow=function(){0==UIModule.instance.showUIList.length?SceneModule.instance.isMainScene?this.u_btnEntrance.visible=!1:this.u_btnEntrance.visible=!0:this.u_btnEntrance.visible=!1},e.prototype.setItemList=function(t){if(this.checkComplete(this.setItemList,t)&&this.m_itemIdList!=t){this.m_itemIdList=t;for(var e=0;e<this.m_itemCount;e++)this["u_mcMoney"+e]&&(this.m_itemIdList&&this.m_itemIdList[e]?(this["u_mcMoney"+e].visible=!0,this.m_itemIdList[e]==ItemEnum.GOLD?this["u_imgMoney"+e].source="commonUI_icon_gold":this.m_itemIdList[e]==ItemEnum.RMB?this["u_imgMoney"+e].source="commonUI_icon_juan":this["u_imgMoney"+e].source=BagManager.instance.getIconPath(this.m_itemIdList[e]),this["u_txtMoney"+e].text=NumberUtil.numberToString(BagManager.instance.getNum(this.m_itemIdList[e]),2,1e6)):this["u_mcMoney"+e].visible=!1)}},e.prototype.setItemNum=function(t){if(this.m_itemIdList&&this.m_itemIdList.length>0&&this.m_itemIdList.indexOf(t)>-1){var e=this.m_itemIdList.indexOf(t);this["u_txtMoney"+e]&&(this["u_txtMoney"+e].text=NumberUtil.numberToString(BagManager.instance.getNum(t),2,1e6))}},e.prototype.stageResize=function(){this.x=StageManager.instance.p_stageWidth-StageManager.MIN_STAGE_WIDTH,this.u_mcLeft.x=-this.x,this.m_noticeView&&this.m_noticeView.setStageResize()},Object.defineProperty(e.prototype,"goldPoint",{get:function(){if(this.parent&&this.m_itemIdList&&this.m_itemIdList.length>0){var t=this.u_mcMoney0.x+this.u_mcMoney0.width/2,e=this.u_mcMoney0.y+this.u_mcMoney0.height/2,i=this.parent.localToGlobal(t,e);return[i.x,i.y]}return[0,0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return StageManager.MIN_STAGE_WIDTH},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(CommonHeadView.prototype,"CommonHeadView");var CardTitleJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="card_title",t}();__reflect(CardTitleJson.prototype,"CardTitleJson"),window.CardTitleJson=CardTitleJson;var FloatTipData=function(){function t(t,e,i,s){void 0===i&&(i=!0),this.p_bHasIcon=!0,"string"==egret.getQualifiedClassName(t)?(this.p_text=t,this.p_textFlow=HtmlUtil.setTextFlow(this.p_text),this.p_text=null):this.p_textFlow=t,this.p_uiClass=e,this.p_bHasIcon=i,this.p_iconSrc=s}return t}();__reflect(FloatTipData.prototype,"FloatTipData");var FloatTipModule=function(){function t(){this.m_dict={},this.m_poolDict=[]}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.popTipLanguageComb=function(t,e){void 0===e&&(e=null);for(var i="",s=0;s<t.length;s++)i+=LanguageJson.getText(t[s]);this.popTip(LanguageJson.getHtmlText(i,e))},t.prototype.popTipLanguage=function(t,e){void 0===e&&(e=null),this.popTip(LanguageJson.getHtmlText(t,e))},t.prototype.popTip=function(e,i,s){void 0===i&&(i=380),void 0===s&&(s=t.LAYER_UI),this.popImplTip(new FloatTipData(e,FloatTipUI),i)},t.prototype.popImplTip=function(e,i,s){if(void 0===i&&(i=1028),void 0===s&&(s=t.LAYER_UI),null!=e){var n=this.m_poolDict.length<=0?new e.p_uiClass:this.m_poolDict.shift();null==this.m_dict[i]&&(this.m_dict[i]=new Array);var o=this.m_dict[i];switch(o.push(n),n.originY=i,n.displayObject.x=Math.floor(.5*(StageManager.instance.p_stageWidth-1136)),n.setData(e,!0,this.onCompleted,this),s){case t.LAYER_UI:PopupModule.instance.pop(n.displayObject);break;case t.LAYER_SCENEUI:StageManager.instance.sceneUILayer.addChild(n.displayObject)}}},t.prototype.calcPos=function(t){var e=this.m_dict[t];if(null!=e&&e.length>1)for(var i=e,s=i[i.length-1].y,n=1;n<i.length;++n)s-=i[i.length-n-1].height+4,i[i.length-n-1].y=s},t.prototype.onCompleted=function(t){if(null!=t){var e=this.m_dict[t.originY];if(e.length>0){var i=e.indexOf(t);-1!=i&&e.splice(i,1),0==e.length&&(this.m_dict[t.originY]=null)}t.onDestroy(),this.m_poolDict.push(t)}},t.LAYER_UI="LAYER_UI",t.LAYER_SCENEUI="LAYER_SCENEUI",t.offY=8,t.offX=40,t}();__reflect(FloatTipModule.prototype,"FloatTipModule");var FloatIconData=function(t){function e(){var e=t.call(this)||this;return e.initView(),e}return __extends(e,t),e.prototype.initView=function(){this.m_group||(this.m_group=new eui.Group,this.m_group.horizontalCenter=0,this.addChild(this.m_group)),this.m_itemIcon||(this.m_itemIcon=new eui.Image,this.m_itemIcon.width=40,this.m_itemIcon.height=40,this.m_itemIcon.x=0,this.m_itemIcon.y=0,this.m_group.addChild(this.m_itemIcon)),this.m_txtContent||(this.m_txtContent=new eui.Label,this.m_txtContent.x=40,this.m_txtContent.y=0,this.m_txtContent.textColor=8140848,this.m_txtContent.stroke=1.5,this.m_txtContent.strokeColor=16645365,this.m_txtContent.bold=!0,this.m_txtContent.size=22,this.m_txtContent.verticalCenter=0,this.m_group.addChild(this.m_txtContent))},e.prototype.setData=function(t,e,i,s,n){void 0===i&&(i=0),void 0===s&&(s=null),void 0===n&&(n=null),this.isMove=!0,this.m_itemIcon.source=BagManager.instance.getIconPath(t),this.m_txtContent.text=e,this.alpha=0;var o=40+this.m_txtContent.textWidth;this.x=null==s?(StageManager.instance.p_stageWidth-o)/2:s,this.y=null==n?(StageManager.instance.p_stageHeight-40)/2:n,TweenLite.to(this,.2,{delay:i,alpha:1,onComplete:this.setStay.bind(this)})},e.prototype.setDataByUrl=function(t,e,i,s,n){void 0===i&&(i=0),void 0===s&&(s=null),void 0===n&&(n=null),this.isMove=!0,this.m_itemIcon.source=t,this.m_txtContent.text=e,this.alpha=0;var o=40+this.m_txtContent.textWidth;this.x=null==s?(StageManager.instance.p_stageWidth-o)/2:s,this.y=null==n?(StageManager.instance.p_stageHeight-40)/2:n,TweenLite.to(this,.2,{delay:i,alpha:1,onComplete:this.setStay.bind(this)})},e.prototype.setStay=function(){TweenLite.to(this,.7,{delay:.2,y:this.y-100,alpha:0,onComplete:this.onDestroy.bind(this)})},e.prototype.onDestroy=function(){this.isMove=!1,DisplayObjectUtils.removeFormParent(this)},e}(eui.Component);__reflect(FloatIconData.prototype,"FloatIconData");var FloatIconModule=function(){function t(){this.m_poolDict=[],this.m_poolDict=[]}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.rewardAddByOne=function(t,e,i,s){void 0===i&&(i=null),void 0===s&&(s=null);var n;n=this.getInfo();var o="";e>=0&&(o="+"+e),n.setData(t,o,0,i,s)},t.prototype.rewardSetByUrl=function(t,e,i,s){void 0===i&&(i=null),void 0===s&&(s=null);var n;n=this.getInfo();var o="";e>=0&&(o="+"+e),n.setDataByUrl(t,o,0,i,s)},t.prototype.rewardSetByUrlList=function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=null);for(var s,n=0;n<t.length;n++){var o="";t[n][1]>=0&&(o="+"+t[n][1]),s=this.getInfo(),s.setDataByUrl(t[n][0],o,.15*n,e,i)}},t.prototype.rewardAddByList=function(t,e,i){for(var s,n=0;n<t.length;n++){var o="";t[n][1]>=0&&(o="+"+t[n][1]),s=this.getInfo(),s.setData(t[n][0],o,.15*n,e,i)}},t.prototype.rewardAddByProp=function(t,e,i){for(var s,n=0;n<t.length;n++){var o="";t[n].num>=0&&(o="+"+t[n].num),s=this.getInfo(),s.setData(t[n].prop_id,o,.15*n,e,i)}},t.prototype.getInfo=function(){var t;return t=this.m_poolDict[this.m_poolDict.length-1]&&!this.m_poolDict[this.m_poolDict.length-1].isMove?this.m_poolDict.pop():new FloatIconData,StageManager.instance.p_stage.addChild(t),this.m_poolDict.unshift(t),t},t.LAYER_UI="LAYER_UI",t.LAYER_SCENEUI="LAYER_SCENEUI",t}();__reflect(FloatIconModule.prototype,"FloatIconModule");var FloatTipUI=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/eui_skins/commonsUI/floatTip/FloatTipUISkin.exml",e}return __extends(e,t),e}(FloatTipBase);__reflect(FloatTipUI.prototype,"FloatTipUI",["ISimplePoolObject","IFloatTipUI"]);var HsliderView=function(t){function e(e){void 0===e&&(e="resource/eui_skins/commonsUI/hslider/HSliderViewSkin.exml");var i=t.call(this)||this;return i.m_percenValue=1,i.once(egret.Event.COMPLETE,i.onCompleted,i),i.skinName=e,i}return __extends(e,t),e.prototype.onCompleted=function(){this.m_imgX=this.u_imgHighlight.x,this.m_imgWidth=this.u_imgHighlight.width-this.u_btnThumb.width+15,this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initEvent=function(){this.u_btnThumb.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onStartMove,this),this.u_btnThumb.addEventListener(egret.TouchEvent.TOUCH_END,this.stopMove,this),this.u_btnThumb.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.stopMoveState,this),this.addEventListener(egret.TouchEvent.ADDED_TO_STAGE,this.onAddStage,this),null!=this.p_funcSetGray&&this.p_funcSetGray.apply(this)},e.prototype.onAddStage=function(t){StageManager.instance.p_stage.addEventListener(egret.TouchEvent.TOUCH_END,this.stopMoveState,this)},e.prototype.onStartMove=function(t){this.m_stageX=t.stageX,this.m_thumbX=this.u_btnThumb.x,StageManager.instance.p_stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onMove,this),t.stopPropagation(),t.stopImmediatePropagation()},e.prototype.onMove=function(t){this.u_btnThumb.x=this.m_thumbX+(t.stageX-this.m_stageX),this.u_btnThumb.x<=this.m_imgX?this.u_btnThumb.x=this.m_imgX:this.u_btnThumb.x>=this.m_imgX+this.m_imgWidth&&(this.u_btnThumb.x=this.m_imgX+this.m_imgWidth),this.m_percenValue=this.u_btnThumb.x/(this.m_imgX+this.m_imgWidth),this.u_imgHighlight.width=this.m_percenValue*this.m_imgWidth,null!=this.p_funcProgress&&this.p_funcProgress.apply(this,[this.m_percenValue]),t.stopPropagation(),t.stopImmediatePropagation()},e.prototype.stopMoveState=function(t){StageManager.instance.p_stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onMove,this),null!=this.p_funcEnd&&this.p_funcEnd.apply(this,[this.m_percenValue])},e.prototype.stopMove=function(t){StageManager.instance.p_stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onMove,this),null!=this.p_funcEnd&&this.p_funcEnd.apply(this,[this.m_percenValue])},e.prototype.initView=function(t){void 0===t&&(t=1),this.checkComplete(this.initView,t)&&(this.m_percenValue=t,this.m_percenValue>=1&&(this.m_percenValue=1),this.m_percenValue<=0&&(this.m_percenValue=0),this.u_btnThumb.x=this.m_imgX+this.m_imgWidth*this.m_percenValue,this.u_imgHighlight.width=this.m_percenValue*this.m_imgWidth)},e.prototype.setHsliderGray=function(t){this.touchEnabled=!t,t?(this.u_btnThumb.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onStartMove,this),this.u_btnThumb.removeEventListener(egret.TouchEvent.TOUCH_END,this.stopMove,this)):(this.u_btnThumb.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onStartMove,this),this.u_btnThumb.addEventListener(egret.TouchEvent.TOUCH_END,this.stopMove,this))},Object.defineProperty(e.prototype,"valuePercen",{get:function(){return this.m_percenValue},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(HsliderView.prototype,"HsliderView");var ImageLabel=function(t){function e(e,i,s){void 0===e&&(e=""),void 0===i&&(i=0),void 0===s&&(s="right");var n=t.call(this)||this;return n.m_imgKey="",n.m_text="",n.m_gap=0,n.m_layout="right",n.m_head="null",n.m_numOffsetY=0,n.m_imgKey=e,n.m_bitMap=[],n.m_gap=i,n.m_layout=s,n.touchChildren=!1,n.touchEnabled=!1,n}return __extends(e,t),e.prototype.resetKey=function(t,e){void 0===e&&(e=0),this.m_imgKey=t,this.m_gap=e},Object.defineProperty(e.prototype,"head",{get:function(){return this.m_head},set:function(t){this.m_head=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"text",{set:function(t){this.m_text=t,this.transfrom()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"offsetY",{set:function(t){this.m_numOffsetY=t},enumerable:!0,configurable:!0}),e.prototype.transfrom=function(){for(var t=0;t<this.m_bitMap.length;t++)this.removeChild(this.m_bitMap[t]),this.m_bitMap[t].$bitmapData=null,this.m_bitMap[t]=null;this.m_bitMap.length=0;var e;"null"!=this.m_head&&(e=RES.getRes(this.m_imgKey+this.m_head),this.m_bitMap.push(new egret.Bitmap(e)));for(var i=0;i<this.m_text.length;i++){var s=this.m_text.charAt(i);e=RES.getRes(this.m_imgKey+s),this.m_bitMap.push(new egret.Bitmap(e))}this.resetPosition()},e.prototype.resetPosition=function(){var t=0,e=0,i="";if("right"==this.m_layout)for(e=this.m_bitMap.length-1;e>=0;e--)this.m_bitMap[e].x=t-this.m_bitMap[e].width,i=this.m_text.charAt(e),0/0!=Number(i)?this.m_bitMap[e].anchorOffsetY=this.m_bitMap[e].height+this.m_numOffsetY:this.m_bitMap[e].anchorOffsetY=this.m_bitMap[e].height,t+=-this.m_bitMap[e].width-this.m_gap,this.addChild(this.m_bitMap[e]);else for(e=0;e<this.m_bitMap.length;e++)this.m_bitMap[e].x=t,i=this.m_text.charAt(e),0/0!=Number(i)?this.m_bitMap[e].anchorOffsetY=this.m_bitMap[e].height+this.m_numOffsetY:this.m_bitMap[e].anchorOffsetY=this.m_bitMap[e].height,t+=this.m_bitMap[e].width+this.m_gap,this.addChild(this.m_bitMap[e])},e.prototype.destory=function(){for(var t=0;t<this.m_bitMap.length;t++)this.m_bitMap[t].parent&&this.m_bitMap[t].parent.removeChild(this.m_bitMap[t]),this.m_bitMap[t].$bitmapData=null,this.m_bitMap[t]=null;this.m_bitMap.length=0,this.m_bitMap=null,this.parent&&this.parent.removeChild(this)},e}(egret.DisplayObjectContainer);__reflect(ImageLabel.prototype,"ImageLabel");var ItemFloat=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setItem=function(t,e,i,s){void 0===e&&(e=0),void 0===i&&(i=0),void 0===s&&(s=0),this.m_item=ItemIconModule.instance.getItemIcon(),this.addChild(this.m_item),this.m_item.setData(t[0],t[1]),this.m_item.p_isShowTip=!1,0==i?(this.m_item.x=0,this.m_item.y=0,this.m_item.scaleX=1,this.m_item.scaleY=1,this.m_item.alpha=1):1==i?(this.m_item.scaleX=.2,this.m_item.scaleY=.2,this.m_item.x=30,this.m_item.y=30,this.m_item.alpha=0,e>0?TweenLite.to(this.m_item,.3,{delay:e,alpha:1,scaleX:1,scaleY:1,x:0,y:0}):TweenLite.to(this.m_item,.3,{alpha:1,scaleX:1,scaleY:1,x:0,y:0})):2==i?(this.m_item.scaleX=2,this.m_item.scaleY=2,this.m_item.x=-80,this.m_item.y=-80,this.m_item.alpha=0,e>0?TweenLite.to(this.m_item,.3,{delay:e,alpha:1,scaleX:1,scaleY:1,x:0,y:0,ease:Back.easeIn}):TweenLite.to(this.m_item,.3,{alpha:1,scaleX:1,scaleY:1,x:0,y:0,ease:Back.easeIn})):3==i&&(this.m_item.scaleX=3,this.m_item.scaleY=3,this.m_item.x=-200,this.m_item.y=-200,this.m_item.alpha=0,this.m_item.p_isShowTip=!1,e>0?(TweenLite.to(this.m_item,.3,{delay:e,alpha:1,scaleX:1,scaleY:1,x:0,y:0,ease:Back.easeIn,onComplete:this.setShowTips.bind(this)}),DelayCallUtils.delayedCall(e+.4,this.showEffect,this)):TweenLite.to(this.m_item,.3,{alpha:1,scaleX:1,scaleY:1,x:0,y:0,ease:Back.easeIn,onComplete:this.setShowTips.bind(this)}))},e.prototype.setShowTips=function(){this.m_item.p_isShowTip=!0},e.prototype.showEffect=function(){this.m_effect||(this.m_effect=new EffectMovieClip,this.m_effect.setMC("resource/assets/uiEffect/item/receiveItem"),this.m_effect.x=60,this.m_effect.y=60,this.m_effect.onCompleteFunc=this.removeEffect.bind(this)),this.addChild(this.m_effect),this.m_effect.play(12,1)},e.prototype.removeEffect=function(){this.m_effect&&(this.m_effect.destory(),this.m_effect=null)},e.prototype.floatItem=function(t,e,i,s,n,o,a,r,_){void 0===i&&(i=0),void 0===s&&(s=!0),void 0===o&&(o=null),void 0===a&&(a=1.1),void 0===r&&(r=!0),void 0===_&&(_=1),this.m_backFunc=e,this.m_item=ItemIconModule.instance.getItemIcon(),this.addChild(this.m_item),this.m_item.setData(t[0],0),this.m_item.p_isShowTip=!1,this.scaleX=this.scaleY=_,this.x=n[0],this.y=n[1],i>0?DelayCallUtils.delayedCall(i,this.startFly,this,[n,t[1],s,o,a,r]):this.startFly(n,t[1],s,o,a,r)},e.prototype.startFly=function(t,e,i,s,n,o){void 0===n&&(n=1.1),void 0===o&&(o=!0),DelayCallUtils.killDelayedCallsTo(this.startFly,this);var a=Math.floor(e/100);10>a&&(a=10),a>=30&&(a=30),i&&this.m_item.itemId==ItemEnum.GOLD?(s||(s=UIModule.instance.pointGold),FlyResModule.instance.playResEffect3(t,s,this.m_item.itemId,a),TweenLite.to(this,n,{onComplete:this.endFly.bind(this)})):i&&this.m_item.itemId==ItemEnum.RMB?(s||(s=UIModule.instance.pointRmb),FlyResModule.instance.playResEffect3(t,s,this.m_item.itemId,a),TweenLite.to(this,n,{onComplete:this.endFly.bind(this)})):i&&this.m_item.itemId==ItemEnum.EXP?(s||(s=[.5*StageManager.instance.p_stageWidth,StageManager.instance.p_stageHeight]),FlyResModule.instance.playResEffect3(t,s,this.m_item.itemId,a),TweenLite.to(this,n,{onComplete:this.endFly.bind(this)})):(StageManager.instance.popToplayer.addChild(this),s||(s=UIModule.instance.getPointByFunctionId(FunctionEnum.BAG_SYS,!1,this.m_item.itemId)),o?TweenLite.to(this,n,{x:s[0]+30,y:s[1]+30,ease:Back.easeIn,scaleX:.3,scaleY:.3,onComplete:this.endFly.bind(this)}):TweenLite.to(this,n,{x:s[0]+30,y:s[1]+30,scaleX:.3,scaleY:.3,onComplete:this.endFly.bind(this)}))},e.prototype.endFly=function(){DelayCallUtils.killDelayedCallsTo(this.startFly,this),DelayCallUtils.killDelayedCallsTo(this.showEffect,this),this.removeEffect(),null!=this.m_backFunc&&this.m_backFunc.apply(null,[this])},e.prototype.hide=function(){this.m_backFunc=null,DelayCallUtils.killDelayedCallsTo(this.startFly,this),DelayCallUtils.killDelayedCallsTo(this.showEffect,this),this.removeEffect(),TweenLite.killTweensOf(this),this.m_item&&this.m_item.parent&&(TweenLite.killTweensOf(this.m_item),ItemIconModule.instance.recoverItemGrid(this.m_item)),DisplayObjectUtils.removeFormParent(this)},Object.defineProperty(e.prototype,"itemBase",{get:function(){return this.m_item},enumerable:!0,configurable:!0}),e}(eui.Component);__reflect(ItemFloat.prototype,"ItemFloat");var ItemFloatModule=function(t){function e(){var e=t.call(this)||this;return e.m_itemListMax=[],e.m_itemList=[],e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.m_instance||(this.m_instance=new e),this.m_instance},enumerable:!0,configurable:!0}),e.prototype.floatItem=function(t,e,i,s,n){void 0===e&&(e=0),void 0===i&&(i=!0),void 0===s&&(s=null),void 0===n&&(n=1.1);var o=t.parent.localToGlobal(t.x+t.width/2,t.y+t.height/2);this.flyItem([t.itemId,t.itemCount],[o.x,o.y],s,e,i,n)},e.prototype.floatItemList=function(t,e){void 0===e&&(e=!0);for(var i=0;i<t.length;i++)this.floatItem(t[i],.01*i,e)},e.prototype.floatRewardGroup=function(t,e){void 0===e&&(e=!0),t.gridList&&t.gridList.length>0&&this.floatItemList(t.gridList,e)},e.prototype.floatItemListByItemFloat=function(t,e,i,s){void 0===e&&(e=!1),void 0===i&&(i=1),void 0===s&&(s=!1);for(var n=0;n<t.length;n++)if(t[n]&&t[n].parent){var o=t[n].parent.localToGlobal(t[n].x,t[n].y);this.flyItem([t[n].itemBase.itemId,t[n].itemBase.itemCount],[o.x,o.y],null,.05*n,e,i,s)}},e.prototype.backFlyItem=function(t){var e=this.m_itemList.indexOf(t);this.m_itemList.splice(e,1),t.hide(),this.m_itemListMax.push(t)},e.prototype.flyItem=function(t,e,i,s,n,o,a,r){void 0===i&&(i=null),void 0===s&&(s=0),void 0===n&&(n=!0),void 0===o&&(o=1.1),void 0===a&&(a=!0),void 0===r&&(r=1);var _;_=this.m_itemListMax.length>0?this.m_itemListMax.shift():new ItemFloat,_.floatItem(t,this.backFlyItem.bind(this),s,n,e,i,o,a,r),this.m_itemList.push(_)},e.prototype.flyItemList=function(t,e,i,s,n){void 0===i&&(i=null),void 0===s&&(s=0),void 0===n&&(n=!0);for(var o=0;o<t.length;o++)this.flyItem([t[o].prop_id,t[o].num],e,i)},e}(egret.HashObject);__reflect(ItemFloatModule.prototype,"ItemFloatModule");var ItemIcon=function(t){function e(){var e=t.call(this)||this;return e.p_isShowTip=!0,e.p_isShowQuality=!0,e}return __extends(e,t),e.prototype.initView=function(){this.m_imgQuality||(this.m_imgQuality=new eui.Image,this.m_imgQuality.touchEnabled=!1,this.m_imgQuality.scale9Grid=new egret.Rectangle(5,5,30,30),this.m_imgQuality.width=this.width,this.m_imgQuality.height=this.height,this.addChild(this.m_imgQuality)),this.m_imgIcon||(this.m_imgIcon=new eui.Image,this.m_imgIcon.horizontalCenter=0,this.m_imgIcon.verticalCenter=0,this.addChild(this.m_imgIcon)),this.m_txtCount||(this.m_txtCount=new eui.Label,this.m_txtCount.textAlign="right",this.m_txtCount.stroke=2,this.m_txtCount.fontFamily="Microsoft YaHei",this.m_txtCount.textColor=15787184,this.m_txtCount.strokeColor=3355443,this.m_txtCount.multiline=!1,this.m_txtCount.wordWrap=!1,this.m_txtCount.bold=!0,this.m_txtCount.size=14,this.m_txtCount.right=8,this.m_txtCount.bottom=10,this.addChild(this.m_txtCount)),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)},e.prototype.setVo=function(t){this.setData(t.prop_id,t.num)},e.prototype.setData=function(t,e){void 0===e&&(e=-1),this.initView(),this.m_data=ItemJson.getData(t),this.m_itemId=t,this.m_imgIcon.source=null,this.m_imgIcon.source=BagManager.instance.getIconPath(t),this.m_data.quality<=1?this.m_imgQuality.source="commonUI_icon_bg":this.m_imgQuality.source="commonUI_icon_q_"+this.m_data.quality,this.m_imgQuality.visible=this.p_isShowQuality,-1==e&&(e=BagManager.instance.getNum(this.m_data.id)),this.count=e,this.m_itemCount=e},Object.defineProperty(e.prototype,"count",{set:function(t){0>=t?this.countMsg="":this.countMsg=NumberUtil.numberToString(t)+""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"countMsg",{set:function(t){null!=this.m_txtCount&&(""!=t?this.m_txtCount.textFlow=TextUtil.setTextFlow(t):this.m_txtCount.text=t)},enumerable:!0,configurable:!0}),e.prototype.hide=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),DisplayObjectUtils.removeFormParent(this.m_imgIcon),this.m_imgIcon=null,DisplayObjectUtils.removeFormParent(this.m_imgQuality),this.m_imgQuality=null,DisplayObjectUtils.removeFormParent(this.m_txtCount),this.m_txtCount=null,this.m_data=null,this.scaleX=1,this.scaleY=1,this.alpha=1,this.visible=!0,this.p_isShowTip=!0,this.p_isShowQuality=!0,TweenLite.killTweensOf(this),DisplayObjectUtils.removeFormParent(this)},e.prototype.onClick=function(t){this.p_isShowTip&&PopupModule.instance.showPop(PopupConfig.ID_ITEM_USE,{itemId:this.m_itemId},!1)},Object.defineProperty(e.prototype,"itemId",{get:function(){return this.m_itemId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemCount",{get:function(){return this.m_itemCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemJson",{get:function(){return this.m_data},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return 120},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 120},enumerable:!0,configurable:!0}),e}(eui.Component);__reflect(ItemIcon.prototype,"ItemIcon");var ItemIconModule=function(t){function e(){var e=t.call(this)||this;return e.m_list=[],e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.m_instance||(this.m_instance=new e),this.m_instance},enumerable:!0,configurable:!0}),e.prototype.getItemIcon=function(){var t;return t=this.m_list.length>0?this.m_list.shift():new ItemIcon},e.prototype.recoverItemGrid=function(t){t.hide(),this.m_list.push(t)},e}(egret.HashObject);__reflect(ItemIconModule.prototype,"ItemIconModule");var NumberClip=function(t){function e(e,i){void 0===e&&(e=""),void 0===i&&(i="");var s=t.call(this)||this;return s._valueArr=[],s._xDirection=!0,s._spaceX=0,s._spaceY=0,s.m_oldValue=-1,s._anchorX=Number.NaN,s._anchorY=Number.NaN,s.m_bitmapList=[],s.m_beatTime=.5,s.m_isNeedBeat=!1,s.m_beatW=0,s.m_beatH=0,s.m_valueContent=new egret.Sprite,s._contentWidth=0,s._contentHeight=0,s.m_needScroll=!1,s.m_scrollSpriteList=[],s.m_animalList=[],s.addChild(s.m_valueContent),""!=e&&""!=i&&(s.m_fileName=e,s.m_key=i,RES.hasRes(e)&&(s.spriteSheet=RES.getRes(e))),s}return __extends(e,t),e.prototype.resetSheet=function(t,e){this.m_fileName=t,this.m_key=e,RES.hasRes(t)&&(this.spriteSheet=RES.getRes(t))},Object.defineProperty(e.prototype,"value",{get:function(){return Number(this._valueArr.join(""))},set:function(t){t=Math.floor(t),this.m_oldValue=this.value,this._valueArr=t.toString().split(""),this.m_needScroll&&(this.m_needScroll=!1,this.scrollAnimal()),this.changeValue()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"valueStr",{set:function(t){this.m_oldValue=this.value,this._valueArr=t.toString().split(""),this.m_needScroll&&(this.m_needScroll=!1,this.scrollAnimal()),this.changeValue()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"beatTime",{set:function(t){this.m_beatTime=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"beatValue",{set:function(t){TweenLite.killTweensOf(this),TweenLite.to(this,this.m_beatTime,{value:t,ease:Linear.easeIn})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rollValue",{set:function(t){this._valueArr=t.toString().split(""),this.changeValue()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"xDirection",{get:function(){return this._xDirection},set:function(t){this._xDirection=t,this.changeValue()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"anchorOffsetX",{get:function(){return this._anchorX},set:function(t){this._anchorX=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"anchorOffsetY",{get:function(){return this._anchorY},set:function(t){this._anchorY=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spaceX",{get:function(){return this._spaceX},set:function(t){this._spaceX=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spaceY",{get:function(){return this._spaceY},set:function(t){this._spaceY=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._contentWidth*(this._xDirection?this._valueArr.length:1)+this._spaceX*(this._xDirection?this._valueArr.length-1:0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._contentHeight*(this._xDirection?1:this._valueArr.length)+this._spaceY*(this._xDirection?0:this._valueArr.length-1)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spriteSheet",{get:function(){return this.m_spriteSheet},set:function(t){this.m_spriteSheet=t,this.creatBeatBitmap(),this.changeValue()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isNeedBeat",{set:function(t){this.m_isNeedBeat=t,this.m_isNeedBeat&&this.creatBeatBitmap()},enumerable:!0,configurable:!0}),e.prototype.creatBeatBitmap=function(){if(this.m_spriteSheet){var t=this.m_spriteSheet.getTexture(this.m_key+"0");this.m_beatW=t.textureWidth,this.m_beatH=t.textureHeight,this._contentWidth=t.textureWidth,this._contentHeight=t.textureHeight}},e.prototype.getBeatSprite=function(){if(this.m_spriteSheet){for(var t,e,i=new egret.Sprite,s=0;10>s;s++)e=this.spriteSheet.getTexture(this.m_key+s),t=new eui.Image(e),t.x=0,t.y=e.textureHeight*s,i.addChild(t);return e=this.spriteSheet.getTexture(this.m_key+0),t=new eui.Image(e),t.x=0,t.y=10*e.textureHeight,i.addChild(t),t=null,i}return null},Object.defineProperty(e.prototype,"scrollValue",{set:function(t){this.m_needScroll=!0,this.value=t},enumerable:!0,configurable:!0}),e.prototype.scrollAnimal=function(){if(null!=this.spriteSheet){var t,e;if(this.m_valueContent.visible=!1,this.m_scrollSpriteList.length<this._valueArr.length){var i,s=this._valueArr.length-this.m_scrollSpriteList.length;for(t=0;s>t;t++)i=NumberClipPool.instance.getScrollSprite(this.m_fileName),null==i&&(i=this.getBeatSprite()),this.m_scrollSpriteList.push(i)}for(t=0;t<this.m_scrollSpriteList.length;t++)this.m_scrollSpriteList[t]&&(this.m_scrollSpriteList[t].parent&&this.m_scrollSpriteList[t].parent.removeChild(this.m_scrollSpriteList[t]),TweenLite.killTweensOf(this.m_scrollSpriteList[t]));var n,o;for(e=0;e<this._valueArr.length;e++)o=this.m_scrollSpriteList[e],n=new egret.Rectangle,n.x=0,n.y=Number(this._valueArr[e])*this.m_beatH,n.width=this.m_beatW,n.height=this.m_beatH,o.scrollRect=n,o.x=(this.m_beatW+this._spaceX)*e,this.addChild(o);for(TweenLite.killTweensOf(this),DelayCallUtils.killDelayedCallsTo(this.scrollOver,this),t=0;t<this.m_animalList.length;t++)TweenLite.killTweensOf(this.m_animalList[t]);var a=this.m_oldValue.toString().split(""),r=!1;for(e=0;e<this._valueArr.length;e++)a.length!=this._valueArr.length?this.m_animalList.push(this.to(this.m_scrollSpriteList[e],e+1,Number(this._valueArr[e]),this.m_beatW,this.m_beatH)):r?this.m_animalList.push(this.to(this.m_scrollSpriteList[e],e+1,Number(this._valueArr[e]),this.m_beatW,this.m_beatH)):a[e]!=this._valueArr[e]&&(r=!0,this.m_animalList.push(this.to(this.m_scrollSpriteList[e],e+1,Number(this._valueArr[e]),this.m_beatW,this.m_beatH)));DelayCallUtils.delayedCall(this._valueArr.length*NumberClipAnimal.ScrollOneTime+NumberClipAnimal.ScrollBackTime,this.scrollOver,this)}},e.prototype.scrollOver=function(){this.m_valueContent.visible=!0;for(var t;this.m_scrollSpriteList.length>0;)t=this.m_scrollSpriteList.pop(),t.parent&&t.parent.removeChild(t),NumberClipPool.instance.pushScrollSprite(this.m_fileName,t)},e.prototype.to=function(t,e,i,s,n){return new NumberClipAnimal(t,e,i,s,n)},e.prototype.changeValue=function(){if(this.spriteSheet||(this.m_spriteSheet=RES.getRes(this.m_fileName)),this.spriteSheet){var t,i,s,n,o;if(this.m_bitmapList.length<this._valueArr.length){var a,r=this._valueArr.length-this.m_bitmapList.length;for(t=0;r>t;t++)a=new eui.Image,this.m_bitmapList.push(a)}for(t=0;t<this.m_bitmapList.length;t++)this.m_bitmapList[t].parent&&this.m_bitmapList[t].parent.removeChild(this.m_bitmapList[t]);if(this.xDirection)for(i=0;i<this._valueArr.length;i++)o=this.spriteSheet.getTexture(this.m_key+this._valueArr[i]),this.m_bitmapList[i].texture=o,this.m_valueContent.addChild(this.m_bitmapList[i]),this.m_bitmapList[i].x=(o.textureWidth+this._spaceX)*i,s=this.m_bitmapList[i].x,n=o.textureHeight;this.m_valueContent.width=s,this.m_valueContent.height=n,this.cacheAsBitmap=!0,Dispatch.dispatch(e.EVENT_NUMBERCLIP_CHANGED+this.hashCode)}},e.EVENT_NUMBERCLIP_CHANGED="EVENT_NUMBERCLIP_CHANGED",e}(egret.Sprite);__reflect(NumberClip.prototype,"NumberClip");var NumberClipAnimal=function(){function t(e,i,s,n,o){function a(){this.m_totalBackTime=t.ScrollBackTime,this.m_curBackTime=0,TweenLite.to(this.m_sp,.11,{blurFilter:{blurY:0}}),TweenLite.to(this.m_this,this.m_totalBackTime,{backkTime:this.m_totalBackTime,ease:Back.easeOut})}this.m_beatW=0,this.m_beatH=0,this.m_totalBeatH=0,this.m_index=0,this.m_value=0,this.m_curScrollTime=0,this.m_totalScrollTime=0,this.m_curBackTime=0,this.m_totalBackTime=0,this.m_sp=e,this.m_index=i,this.m_value=s,this.m_beatW=n,this.m_beatH=o,this.m_totalBeatH=10*this.m_beatH,this.m_totalScrollTime=i*t.ScrollOneTime,this.m_this=this,TweenLite.to(this.m_sp,.11,{blurFilter:{blurY:3}}),TweenLite.to(this.m_this,this.m_totalScrollTime,{scrollTime:this.m_totalScrollTime,ease:Linear.easeNone,onComplete:a.bind(this.m_this)})
}return Object.defineProperty(t.prototype,"scrollTime",{get:function(){return this.m_curScrollTime},set:function(t){this.m_curScrollTime=t,this.updateBeatTime()},enumerable:!0,configurable:!0}),t.prototype.updateBeatTime=function(){var e,i=0,s=0;e=this.m_sp.scrollRect,s=0==this.m_value?9:this.m_value-1,e&&(this.m_curScrollTime<=this.m_index*t.ScrollOneTime?(i=this.m_curScrollTime/this.m_totalScrollTime*(this.m_totalBeatH+this.m_index*this.m_totalBeatH)+s*this.m_beatH,i%=this.m_totalBeatH,e.y=i,e.height=this.m_beatH,this.m_sp.scrollRect=e):(i=this.m_value*this.m_beatH,e.y=i,e.height=this.m_beatH,this.m_sp.scrollRect=e))},Object.defineProperty(t.prototype,"backkTime",{get:function(){return this.m_curBackTime},set:function(t){this.m_curBackTime=t,this.updateBackTime()},enumerable:!0,configurable:!0}),t.prototype.updateBackTime=function(){var t,e=0,i=0;t=this.m_sp.scrollRect,i=0==this.m_value?9:this.m_value-1,i*=this.m_beatH,t&&(e=this.m_curBackTime/this.m_totalBackTime*this.m_beatH,e+=i,t.y=e,t.height=this.m_beatH,this.m_sp.scrollRect=t)},t.ScrollOneTime=.25,t.ScrollBackTime=.25,t}();__reflect(NumberClipAnimal.prototype,"NumberClipAnimal");var NumberClipPool=function(){function t(){this.m_scrollSpriteDict={}}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.pushScrollSprite=function(t,e){var i;null==this.m_scrollSpriteDict[t]&&(i=[],this.m_scrollSpriteDict[t]=i),i=this.m_scrollSpriteDict[t],-1==i.indexOf(e)&&i.push(e)},t.prototype.getScrollSprite=function(t){if(!this.m_scrollSpriteDict[t])return null;var e=this.m_scrollSpriteDict[t];return 0==e.length?null:e.pop()},t}();__reflect(NumberClipPool.prototype,"NumberClipPool");var NumberStep=function(t){function e(e,i,s,n){void 0===e&&(e="jie"),void 0===i&&(i=!1),void 0===s&&(s=640),void 0===n&&(n=0);var o=t.call(this)||this;return o.m_gap1=30,o.m_gap2=18,o.m_levelImageList=[],o.m_contentWidth=0,o.m_spaceX=0,o.m_type="",o.m_isNum=!1,o.m_contentWidth=s,o.m_spaceX=n,o.m_isNum=i,o.m_type=e,o}return __extends(e,t),Object.defineProperty(e.prototype,"showType",{set:function(t){this.m_type=t},enumerable:!0,configurable:!0}),e.prototype.resetData=function(t,e,i,s){void 0===t&&(t="jie"),void 0===e&&(e=!1),void 0===i&&(i=640),void 0===s&&(s=0),this.m_contentWidth=i,this.m_spaceX=s,this.m_isNum=e,this.m_type=t},Object.defineProperty(e.prototype,"value",{set:function(t){this.m_value=t,this.updateValue()},enumerable:!0,configurable:!0}),e.prototype.updateValue=function(){for(t=0;t<this.m_levelImageList.length;t++)this.m_levelImageList[t].parent&&this.m_levelImageList[t].parent.removeChild(this.m_levelImageList[t]);var t,e=0,i=0,s=0;e=Math.floor(this.m_value/100),i=Math.floor(this.m_value/10),s=this.m_value%10;var n=[];if(this.m_isNum?n=String(this.m_value).split(""):(e>0?(n.push(String(e)),n.push("b"),i=Math.floor(this.m_value%100/10),i>0?(1!=i&&n.push(String(i)),n.push("10")):n.push("0")):i>0&&(1!=i&&n.push(String(i)),n.push("10")),0!=s?n.push(String(s)):0==e&&0==i&&n.push(String(s))),n.push(this.m_type),this.m_levelImageList.length<n.length){var o=n.length-this.m_levelImageList.length;for(t=0;o>t;t++)this.m_levelImageList.push(new eui.Image)}var a=0;for(t=0;t<n.length;t++)t==n.length-1?(this.m_levelImageList[t].x=a+t*(this.m_isNum?this.m_gap2+6:this.m_gap1+1),this.m_levelImageList[t].source="text_level_"+this.m_type):(this.m_levelImageList[t].source=(this.m_isNum?"text_level_":"text_level_cn_")+n[t],this.m_levelImageList[t].x=a+t*(this.m_isNum?this.m_gap2:this.m_gap1)),this.addChild(this.m_levelImageList[t]);this.x=.5*(this.m_contentWidth-this.width)},e}(eui.Component);__reflect(NumberStep.prototype,"NumberStep");var NumberView=function(t){function e(e,i,s){void 0===e&&(e="num_level_"),void 0===i&&(i=0),void 0===s&&(s=-4);var n=t.call(this)||this;return n.m_iconList=[],n.m_spacingKey={},n.p_isAnchorOffsetX=!1,n.p_isAnchorOffsetY=!1,n.p_isDoller=!1,n.p_isScience=!1,n.p_isMoney=!1,n.m_value=0,n.p_spaceX=s,n.m_textKey=e,n.m_contentWidth=i,n}return __extends(e,t),e.prototype.resetData=function(t,e,i){void 0===t&&(t="num_level_"),void 0===e&&(e=0),void 0===i&&(i=-4),this.p_spaceX=i,this.m_textKey=t,this.m_contentWidth=e},e.prototype.setLevel=function(t,e){void 0===e&&(e=["l","v","d"]);var i=String(t).split("");e&&e.length>0&&(i=e.concat(i)),this.setMsg(i)},e.prototype.setStep=function(t,e){void 0===e&&(e=["jie"]);var i=0,s=0,n=0;i=Math.floor(t/100),s=Math.floor(t/10),n=t%10;var o=[];i>0?(o.push(String(i)),o.push("b"),s=Math.floor(t%100/10),s>0?(1!=s&&o.push(String(s)),o.push("10")):o.push("0")):s>0&&(1!=s&&o.push(String(s)),o.push("10")),0!=n?o.push(String(n)):0==i&&0==s&&o.push(String(n)),o=o.concat(e),this.setMsg(o)},Object.defineProperty(e.prototype,"numValue",{get:function(){return this.m_value},set:function(t){t=Math.floor(t),this.m_value=t;var e;e=this.p_isMoney&&t>0?String(t/1e3).split(""):this.p_isDoller&&t>0?String(NumberUtil.numberDecimalism(t,"d")).split(""):this.p_isScience?NumberUtil.numberToString(t).split(""):String(t).split(""),this.p_qianStr&&this.p_qianStr.length>0&&(e=this.p_qianStr.concat(e)),this.setMsg(e)},enumerable:!0,configurable:!0}),e.prototype.setNumValue=function(t,e){void 0===e&&(e=.5),TweenLite.killTweensOf(this),0==this.m_value?this.numValue=t:TweenLite.to(this,e,{numValue:t,ease:Linear.easeIn})},e.prototype.setNumValueTo=function(t,e,i){void 0===i&&(i=.5),this.m_value=t,TweenLite.killTweensOf(this),TweenLite.to(this,i,{numValue:e,ease:Linear.easeIn})},e.prototype.setValueW=function(t,e,i,s){if(void 0===e&&(e=0),void 0===i&&(i=0),void 0===s&&(s=""),""!=s&&(this.m_textKey=s),e>0&&t>=e&&e>=1e4){var n;if(i>0){var o=Number(t/1e4).toFixed(i),a=o.split("."),r=Number(a[1]);n=a[0]+"d"+r.toString()+"w"}else n=Math.floor(t/1e4).toString()+"w";this.setMsgString(n)}else this.numValue=t},e.prototype.setMsgString=function(t,e){void 0===e&&(e=""),""!=e&&(this.m_textKey=e);var i=t.split("");this.setMsg(i)},e.prototype.setMsg=function(t){var e;for(e=0;e<this.m_iconList.length;e++)this.m_iconList[e].parent&&this.removeChild(this.m_iconList[e]);for(e=0;e<t.length;e++){var i;this.m_iconList[e]?i=this.m_iconList[e]:(i=new eui.Image,this.m_iconList[e]=i),e==t.length-1&&0==i.width&&i.addEventListener(egret.Event.COMPLETE,this.setXY,this),i.y=0,i.source=null,i.source=this.m_textKey+t[e],this.addChild(i)}0!=i.width&&this.setXY()},e.prototype.setXY=function(){for(var t=0;t<this.m_iconList.length;t++){var e=void 0;if(this.m_iconList[t].parent){var i=0;e=this.m_iconList[t],0==t?(e.x=0,this.m_width=e.width):(this.m_iconList[t-1]&&(i=this.getSpacingX(this.m_iconList[t-1].source)),0==i&&(i=this.m_iconList[t-1].width+this.p_spaceX),e.x=this.m_iconList[t-1].x+i,this.m_width=e.x+e.width+2)}}this.m_contentWidth>0&&(this.x=(this.m_contentWidth-this.width)/2),this.p_isAnchorOffsetX&&(this.anchorOffsetX=.5*this.m_width),this.p_isAnchorOffsetY&&(this.anchorOffsetY=.5*this.height),null!=this.p_backFunc&&this.p_backFunc.apply(null)},e.prototype.showEffect=function(t){void 0===t&&(t=.12);for(var e=0;e<this.m_iconList.length;e++)if(this.m_iconList[e].parent){var i=this.m_iconList[e],s=i.x;i.x=s-2*i.width-20,i.y=2*-i.height-20,i.alpha=0,i.scaleX=4,i.scaleY=4,TweenLite.to(i,.2,{delay:.12*e+t,alpha:1,scaleX:1,scaleY:1,x:s,y:0,ease:Circ.easeIn})}},e.prototype.setSpacingX=function(t){void 0===t&&(t=null);for(var e=0;e<t.length;e++)this.m_spacingKey[t[e].key]=t[e]},e.prototype.getSpacingX=function(t){var e=this.m_spacingKey[t];return e&&e.key==t?e.spacing:0},e.prototype.hide=function(){TweenLite.killTweensOf(this);for(var t=0;t<this.m_iconList.length;t++)this.m_iconList[t].source=null,this.m_iconList[t]=null;this.m_iconList=null,DisplayObjectUtils.removeFormParent(this)},Object.defineProperty(e.prototype,"width",{get:function(){return this.m_width},enumerable:!0,configurable:!0}),e}(eui.Component);__reflect(NumberView.prototype,"NumberView");var PowerView=function(t){function e(e){void 0===e&&(e=0);var i=t.call(this)||this;return i.m_contentWidth=0,i.m_contentWidth=e,i.initView(),i}return __extends(e,t),e.prototype.initView=function(){this.m_bg||(this.m_bg=new eui.Image,this.m_bg.source="commonUI_power_bj",this.addChild(this.m_bg)),this.m_numberView||(this.m_numberView=new NumberView("num_zhanli_",0,0),this.addChild(this.m_numberView),this.m_numberView.y=4,this.m_numberView.p_backFunc=this.setXY.bind(this)),this.setPostXY()},e.prototype.setXY=function(){this.m_wan&&this.m_wan.parent?(this.m_numberView.x=65+(180-this.m_numberView.width-this.m_wan.width)/2,this.m_wan.x=this.m_numberView.x+this.m_numberView.width+3):this.m_numberView.x=65+(180-this.m_numberView.width)/2},Object.defineProperty(e.prototype,"value",{set:function(t){this.m_wan&&this.m_wan.parent&&this.removeChild(this.m_wan),t=Math.floor(t),this.m_numberView.numValue=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"valueStr",{set:function(t){t>1e5?(t=Math.floor(t/1e4),this.m_wan||(this.m_wan=new eui.Image,this.m_wan.y=15,this.m_wan.source="numberText_json.num_zhanli_w"),this.addChild(this.m_wan)):(this.m_wan&&this.m_wan.parent&&this.removeChild(this.m_wan),t=Math.floor(t)),this.m_numberView.numValue=t},enumerable:!0,configurable:!0}),e.prototype.setPostXY=function(){this.m_contentWidth>0&&(this.x=(this.m_contentWidth-this.width)/2)},Object.defineProperty(e.prototype,"width",{get:function(){return 261},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 45},enumerable:!0,configurable:!0}),e}(eui.Component);__reflect(PowerView.prototype,"PowerView");var RewardGroupUI=function(t){function e(){var e=t.call(this)||this;return e.m_spaceX=6,e.m_spaceY=0,e.m_scroller=new eui.Scroller,e.m_group=new eui.Group,e.m_gridList=[],e.m_visualWidth=0,e.m_visualHeight=0,e.m_isShowTip=!0,e.m_colNum=5,e.m_isMultiLine=!1,e.addChild(e.m_scroller),e.m_scroller.addChild(e.m_group),e.m_scroller.viewport=e.m_group,e.m_scroller.horizontalScrollBar=null,e.m_scroller.verticalScrollBar=null,e.touchEnabled=!1,e}return __extends(e,t),e.prototype.stopTap=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.tabHandler,this)},e.prototype.tabHandler=function(t){t.stopPropagation(),t.stopImmediatePropagation()},e.prototype.setDataByList=function(t,e,i,s){void 0===e&&(e=-1),void 0===i&&(i=0),void 0===s&&(s=!1);for(var n=[],o=0;o<t.length;o++){var a=new proto.Prop;a.prop_id=Number(t[o][0]),0>i?a.num=0:0==i?a.num=Number(t[o][1]):a.num=i,n.push(a)}-1==e&&(e=t.length),this.setData(n,e,s)},e.prototype.setGroupFormat=function(t,e){void 0===e&&(e=!1),this.m_colNum=t,this.m_isMultiLine=e},e.prototype.setDataByRewardId=function(t){this.setData(RewardJson.getPropListById(t),this.m_colNum,this.m_isMultiLine)},e.prototype.setDataByProp=function(t,e,i,s){void 0===e&&(e=-1),void 0===i&&(i=0),void 0===s&&(s=!1);for(var n=[],o=0;o<t.length;o++)n.push([t[o].prop_id,t[o].num]);this.setDataByList(n,e,i,s)},e.prototype.setData=function(t,e,i){void 0===i&&(i=!1),this.reset();for(var s,n,o=0,a=0,r=0,_=0;_<t.length;_++)n=t[_],i?(s=ItemIconModule.instance.getItemIcon(),s.p_isShowTip=this.m_isShowTip,s.setData(n.prop_id,n.num),s.x=_%e==0?0:_%e*(s.width+this.m_spaceX),o=Math.floor(_/e),0==o?s.y=0:s.y=o*(s.height+this.m_spaceY),this.m_gridList.push(s),this.m_group.addChild(s),a=Math.max(a,s.x+s.width),r=s.y+s.height):e>_&&(s=ItemIconModule.instance.getItemIcon(),s.p_isShowTip=this.m_isShowTip,s.setData(n.prop_id,n.num),s.x=_%e==0?0:_%e*(s.width+this.m_spaceX),s.y=0,this.m_gridList.push(s),this.m_group.addChild(s),a=Math.max(a,s.x+s.width),r=s.y+s.height);this.m_scroller.stopAnimation(),this.m_scroller.viewport.scrollV=0,this.m_scroller.viewport.scrollH=0,this.m_scroller.width=0==this.m_visualWidth?a:this.m_visualWidth,this.m_scroller.height=0==this.m_visualHeight?r:this.m_visualHeight,0!=this.m_visualWidth?this.m_visualWidth>a?this.m_scroller.scrollPolicyH=eui.ScrollPolicy.OFF:this.m_scroller.scrollPolicyH=eui.ScrollPolicy.ON:this.m_scroller.width<=a&&(this.m_scroller.scrollPolicyH=eui.ScrollPolicy.OFF),0!=this.m_visualHeight?this.m_visualHeight>r?this.m_scroller.scrollPolicyV=eui.ScrollPolicy.OFF:this.m_scroller.scrollPolicyV=eui.ScrollPolicy.ON:this.m_scroller.height<=r&&(this.m_scroller.scrollPolicyV=eui.ScrollPolicy.OFF)},e.prototype.showAnimal=function(){TweenLite.killTweensOf(this.m_scroller.viewport),this.m_scroller.stopAnimation(),this.m_scroller.viewport.scrollV=0;var t,e=0,i=0;for(t=0;t<this.m_gridList.length;t++)this.m_gridList[t].scaleX=1,this.m_gridList[t].scaleY=0;for(this.alpha=1,t=0;t<this.m_gridList.length;t++)if(TweenLite.to(this.m_gridList[t],.3,{scaleX:1,scaleY:1,delay:.12+.09*t,ease:Circ.easeOut}),this.m_isMultiLine&&this.m_visualHeight>0){e=Math.ceil((t+1)/this.m_colNum);var s=e*(this.m_gridList[t].height+this.m_spaceY)-this.m_spaceY>(0==this.m_visualHeight?this.m_scroller.height:this.m_visualHeight);e>=1&&s&&(i=e-Math.ceil(this.m_visualHeight/(this.m_gridList[t].height+this.m_spaceY)),TweenLite.to(this.m_scroller.viewport,.3,{scrollV:i*(this.m_gridList[t].height+this.m_spaceY),delay:.15*t,ease:Linear.easeNone}))}},Object.defineProperty(e.prototype,"showTip",{get:function(){return this.m_isShowTip},set:function(t){this.m_isShowTip=t;for(var e=0;e<this.m_gridList.length;e++)this.m_gridList[e].p_isShowTip=this.m_isShowTip},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scroller",{get:function(){return this.m_scroller},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spaceX",{set:function(t){this.m_spaceX=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spaceY",{set:function(t){this.m_spaceY=t},enumerable:!0,configurable:!0}),e.prototype.reset=function(){for(var t=0;t<this.m_gridList.length;t++)this.m_gridList[t].parent&&this.m_gridList[t].parent.removeChild(this.m_gridList[t]),ItemIconModule.instance.recoverItemGrid(this.m_gridList[t]);this.m_gridList=[]},Object.defineProperty(e.prototype,"gridList",{get:function(){return this.m_gridList},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visualWidth",{set:function(t){this.m_visualWidth=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visualHeight",{set:function(t){this.m_visualHeight=t},enumerable:!0,configurable:!0}),e}(eui.Component);__reflect(RewardGroupUI.prototype,"RewardGroupUI");var RuleModule=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.showRole=function(t,e){void 0===e&&(e="注意事项"),PopupModule.instance.showPop(PopupConfig.ID_RULE,{txtMsg:t,titleMsg:e},!1)},t.prototype.showStaticMsg=function(t,e){void 0===e&&(e="注意事项")},t}();__reflect(RuleModule.prototype,"RuleModule");var RulePopup=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/commonsUI/rule/RulePopupSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initEvent=function(){this.setCloseBtn(this.u_btnClose)},e.prototype.showView=function(e){if(void 0===e&&(e=null),this.checkComplete(this.showView,e)){var i="注意事项";e.txtMsg&&(i=e.txtMsg),this.u_txtMsg.textFlow=HtmlUtil.setTextFlow(i);var s=this.u_txtMsg.textHeight;s>600?this.u_scrollerItem.height=600:360>=s?this.u_scrollerItem.height=360:this.u_scrollerItem.height=s+4,this.u_imgBj.height=this.u_scrollerItem.height+45+70,t.prototype.showView.call(this,e)}},Object.defineProperty(e.prototype,"width",{get:function(){return 540},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.u_imgBj.height},enumerable:!0,configurable:!0}),e}(PopupBase);__reflect(RulePopup.prototype,"RulePopup");var ScrollImage=function(t){function e(e,i,s){void 0===i&&(i=-1),void 0===s&&(s=-1);var n=t.call(this)||this;return n.m_speedX=1,n.m_speedY=-1,n.m_amendX=0,n.m_amendY=0,n.m_rx=0,n.m_ry=0,n.m_offsetX=0,n.m_offsetY=0,n.m_texture=e,n.m_titleWidth=n.m_texture.textureWidth,n.m_titleHeight=n.m_texture.textureHeight,n.m_canvaWidth=-1==i?n.m_titleWidth:i,n.m_canvaHeight=-1==s?n.m_titleHeight:s,n.m_image=new egret.Bitmap,n.m_image.fillMode=egret.BitmapFillMode.REPEAT,n.m_image.texture=n.m_texture,n.addChild(n.m_image),n.resetData(n.m_canvaWidth,n.m_canvaHeight),n}return __extends(e,t),e.prototype.resetData=function(t,e){void 0===t&&(t=-1),void 0===e&&(e=-1),this.m_canvaWidth=t,this.m_canvaHeight=e,this.m_image.width=(Math.ceil(this.m_canvaWidth/this.m_titleWidth)+1)*this.m_titleWidth,this.m_image.height=(Math.ceil(this.m_canvaHeight/this.m_titleHeight)+1)*this.m_titleHeight,this.scrollRect=new egret.Rectangle(0,0,this.m_canvaWidth,this.m_canvaHeight),this.m_amendX=this.m_speedX>0?-this.m_titleWidth:0,this.m_amendY=this.m_speedY>0?-this.m_titleHeight:0,EnterFrameManager.instance.addEnterFrame(this.enterFrame,this)},e.prototype.addEnterFrame=function(){EnterFrameManager.instance.addEnterFrame(this.enterFrame,this)},e.prototype.removeEnterFrame=function(){EnterFrameManager.instance.removeEnterFrame(this.enterFrame,this)},e.prototype.enterFrame=function(){this.m_rx+=this.m_speedX,this.m_ry+=this.m_speedY,this.m_image.x=(this.m_rx+this.m_offsetX)%this.m_titleWidth+this.m_amendX,this.m_image.y=(this.m_ry+this.m_offsetY)%this.m_titleHeight+this.m_amendY},Object.defineProperty(e.prototype,"speedX",{get:function(){return this.m_speedX},set:function(t){this.m_speedX=t,this.m_amendX=this.m_speedX>0?-this.m_titleWidth:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"speedY",{get:function(){return this.m_speedY},set:function(t){this.m_speedY=t,this.m_amendY=this.m_speedY>0?-this.m_titleHeight:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"offsetX",{get:function(){return this.m_offsetX},set:function(t){this.m_offsetX=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"offsetY",{get:function(){return this.m_offsetY},set:function(t){this.m_offsetY=t},enumerable:!0,configurable:!0}),e.prototype.removeFromParent=function(){this.parent&&this.parent.removeChild(this)},e.prototype.destory=function(){DisplayObjectUtils.removeFormParent(this.m_image),DisplayObjectUtils.removeFormParent(this),this.m_image.texture=null,this.m_image=null,this.m_texture=null,EnterFrameManager.instance.removeEnterFrame(this.enterFrame,this)},e}(egret.DisplayObjectContainer);__reflect(ScrollImage.prototype,"ScrollImage");var ScrollObtainBox=function(t){function e(e,i,s){void 0===e&&(e=560),void 0===i&&(i=90),void 0===s&&(s=!0);var n=t.call(this)||this;return n.m_renderList=[],n.m_idx=0,n.m_idxCount=-1,n.m_listArr=[],n.addEventListener(egret.TouchEvent.REMOVED_FROM_STAGE,n.onRemoveState,n),n.initView(e,i,s),n}return __extends(e,t),e.prototype.onRemoveState=function(t){this.stopMove()},e.prototype.initView=function(t,e,i){void 0===t&&(t=560),void 0===e&&(e=90),void 0===i&&(i=!0),this.m_widthBox=t,this.m_heightBox=e,this.m_spGun||(this.m_spGun=new eui.Group,this.addChild(this.m_spGun),this.m_spGun.touchChildren=!1,this.m_spGun.touchEnabled=!1,this.m_spGun.touchThrough=!1);var s=new egret.Shape;s.graphics.beginFill(16711680),s.graphics.drawRect(0,0,this.m_widthBox,this.m_heightBox),s.graphics.endFill(),this.addChild(s),this.m_spGun.mask=s,this.m_numMax=Math.ceil(this.m_heightBox/25);for(var n=1;n<=this.m_numMax;n++){var o=new ScrollObtainRender(this.setNextCycle.bind(this),this.m_widthBox,this.m_numMax);o.y=25*(n-1),this.m_spGun.addChild(o),this.m_renderList.push(o)}},e.prototype.setNextCycle=function(t){this.m_idx+=1,this.m_idx>this.m_idxCount&&(this.m_idx=1),t.setMsgText(this.m_listArr[this.m_idx-1])},e.prototype.setDataList=function(t,e){if(this.m_idxCount=-1,t){this.m_listArr=[];for(var i=0;i<t.length;i++){var s=e.apply(this,[t[i]]);this.m_listArr.push(s)}this.setStartDo()}},e.prototype.setMsgList=function(t){var e;if(t){for(this.m_listArr=[],e=0;e<t.length;e++)this.m_listArr.push(t[e]);this.setStartDo()}},e.prototype.addMsgList=function(t){var e;if(t&&t.length>0){for(e=0;e<t.length;e++)this.m_listArr.push(t[e]);this.setStartDo()}},e.prototype.setStartDo=function(){var t;if(this.m_listArr&&this.m_listArr.length>0){if(-1==this.m_idxCount)for(t=0;t<this.m_renderList.length&&(this.m_listArr&&this.m_listArr[t]);t++)this.m_renderList[t].setMsgText(this.m_listArr[t]),this.m_idx=t+1;this.m_idxCount=this.m_listArr.length}for(t=0;t<this.m_renderList.length;t++)this.m_listArr&&this.m_listArr[t]?this.m_renderList[t].visible=!0:this.m_renderList[t].visible=!1;if(this.m_listArr&&this.m_listArr.length>=this.m_numMax)this.m_heightBox%25!=0&&TimeManager.instance.doLoop(this.doMove,this,2500);else for(TimeManager.instance.clearTimer(this.doMove,this),t=0;t<this.m_renderList.length;t++)this.m_renderList[t].y=25*t},e.prototype.doMove=function(){for(var t=0;t<this.m_renderList.length;t++)this.m_renderList[t].moveToY()},e.prototype.stopMove=function(){TimeManager.instance.clearTimer(this.doMove,this)},Object.defineProperty(e.prototype,"width",{get:function(){return this.m_widthBox},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.m_heightBox},enumerable:!0,configurable:!0}),e}(eui.Component);__reflect(ScrollObtainBox.prototype,"ScrollObtainBox");var ScrollObtainRender=function(t){function e(e,i,s){var n=t.call(this)||this;return n.m_numMax=s,n.m_widthBox=i,n.m_cycleFunc=e,n.initView(),n}return __extends(e,t),e.prototype.initView=function(){this.x=0,this.m_txtMsg||(this.m_txtMsg=new eui.Label,this.addChild(this.m_txtMsg),this.m_txtMsg.size=16,this.m_txtMsg.stroke=1,this.m_txtMsg.strokeColor=0,this.m_txtMsg.multiline=!1,this.m_txtMsg.wordWrap=!0,this.m_txtMsg.textAlign="left",this.m_txtMsg.textColor=15787184,this.m_txtMsg.width=this.width-2,this.m_txtMsg.x=2,this.m_txtMsg.y=4)},e.prototype.setMsgText=function(t){this.m_txtMsg.textFlow=TextUtil.setTextFlow(t)},e.prototype.moveToY=function(){this.y-=this.height,this.y<=-this.height&&(this.m_cycleFunc.apply(null,[this]),this.y=(this.m_numMax-1)*this.height),0==this.y?this.m_txtMsg.alpha=.5:this.y==this.height?this.m_txtMsg.alpha=.75:this.m_txtMsg.alpha=1},e.prototype.getChar=function(t,e){var i=new egret.ByteArray;return i.writeUTFBytes(t),i.length<e?t:(i.position=0,i.readUTFBytes(e)+"...")},Object.defineProperty(e.prototype,"width",{get:function(){return this.m_widthBox},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 25},enumerable:!0,configurable:!0}),e}(eui.Component);__reflect(ScrollObtainRender.prototype,"ScrollObtainRender");var SelectOptions=function(){function t(t,e){void 0===e&&(e=null),this.m_viewList={},this.p_soundEffectId=SoundEnum.EFFECT_SOUND_1007,this.p_width=149,this.p_height=70,this.m_parent=t,this.m_selectFunc=e}return t.prototype.setDataList=function(t,e){void 0===e&&(e="");for(var i in this.m_viewList)this.m_viewList[i].hide();var s={};if(LanguageJson.getData(e))for(var n=LanguageJson.getText(e),o=n.split("|"),a=0;a<o.length;a++){var r=o[a].split("_");s[r[0]]=r[1]}for(var _=0;_<t.length;_++){var h;this.m_viewList[t[_].key]?h=this.m_viewList[t[_].key]:(h=new SelectOptionsBtn(this.setSelect.bind(this),this.p_width,this.p_height,this.p_soundEffectId),this.m_viewList[t[_].key]=h),h.setDataList(t[_],s[t[_].key]),this.m_parent.addChild(h)}},t.prototype.setRedList=function(t){for(var e in t){var i=this.m_viewList[t[e].key];i&&RedNoticeManager.instance.registerRed(i,t[e].redList,t[e].redPosXY)}},t.prototype.setSelectCheck=function(t){if(null!=this.p_selectCheck){var e=this.p_selectCheck.apply(this,[t]);return void(""!=e&&FloatTipModule.instance.popTip(e))}this.setSelect(t)},t.prototype.setSelect=function(t){this.m_selectKey=t;for(var e in this.m_viewList)this.m_viewList[e].key==this.m_selectKey?this.m_viewList[e].setSelect(!0):this.m_viewList[e].setSelect(!1);null!=this.m_selectFunc&&this.m_selectFunc(this.m_selectKey)},Object.defineProperty(t.prototype,"selectKey",{get:function(){return this.m_selectKey},enumerable:!0,configurable:!0}),t}();__reflect(SelectOptions.prototype,"SelectOptions");var SelectOptionsBtn=function(t){function e(e,i,s,n){void 0===n&&(n=SoundEnum.EFFECT_SOUND_1007);var o=t.call(this)||this;return o.m_txtNameKey="",o.m_imgBjKey="",o.m_imgNameKey="",o.m_selectBool=!1,o.m_backFunc=e,o.m_soundEffectId=n,i>0&&s>0?(o.width=i,o.height=s):o.addEventListener(egret.TouchEvent.TOUCH_TAP,o.onSelect,o),o}return __extends(e,t),e.prototype.onSelect=function(t){this.m_selectBool||this.m_backFunc.apply(this,[this.m_key])},e.prototype.setDataList=function(t,e){this.m_key=t.key,this.m_imgBjKey=t.btnNameBj?t.btnNameBj:"",""==this.m_imgBjKey||this.m_imgBj||(this.m_imgBj=new eui.Image,this.addChild(this.m_imgBj)),this.m_imgNameKey=t.btnName?t.btnName:"",""==this.m_imgNameKey||this.m_imgName||(this.m_imgName=new eui.Image,this.addChild(this.m_imgName)),this.m_txtNameKey=e,this.m_txtNameKey&&""!=this.m_txtNameKey&&(this.m_txtName||(this.m_txtName=new eui.Label,this.m_txtName.textColor=15787184,this.m_txtName.size=20,this.m_txtName.touchEnabled=!1,this.addChild(this.m_txtName)),this.m_txtName.text=this.m_txtNameKey,this.m_txtName.x=(this.width-this.m_txtName.textWidth)/2,this.m_txtName.y=25),this.m_imgBj&&(this.m_imgBj.source=this.m_imgBjKey+"1"),this.m_imgName&&(this.m_imgName.source=this.m_imgNameKey+"1"),t.posXY&&t.posXY[0]&&(this.x=t.posXY[0]),t.posXY&&t.posXY[1]&&(this.y=t.posXY[1]),this.width>0&&this.height>0&&(DisplayObjectUtils.removeEventClick(this),DisplayObjectUtils.registerEventClick(this,this.onSelect,this,!0,this.m_soundEffectId))},e.prototype.setSelect=function(t){this.m_selectBool=t,this.m_imgBj&&(this.m_imgBj.source=this.m_selectBool?this.m_imgBjKey+"2":this.m_imgBjKey+"1"),this.m_imgName&&(this.m_imgName.source=this.m_selectBool?this.m_imgNameKey+"1":this.m_imgNameKey+"2")},e.prototype.hide=function(){DisplayObjectUtils.removeFormParent(this)},Object.defineProperty(e.prototype,"key",{get:function(){return this.m_key},enumerable:!0,configurable:!0}),e}(egret.DisplayObjectContainer);__reflect(SelectOptionsBtn.prototype,"SelectOptionsBtn");var CourseUI=function(t){function e(){var e=t.call(this)||this;return e.m_selectId=1,e.m_disposeUrlList.push("courseUI_json"),e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/courseUI/CourseUISkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnClose,this.close,this,!0),this.registerEventClick(this.u_btnLeft,this.onReduce,this),this.registerEventClick(this.u_btnRight,this.onAdd,this)},e.prototype.onReduce=function(t){void 0===t&&(t=null),this.m_selectId<=1||(this.m_selectId--,this.setState())},e.prototype.onAdd=function(t){void 0===t&&(t=null),this.m_selectId>=4||(this.m_selectId++,this.setState(),4==this.m_selectId&&(this.u_grpMc.visible=!0,Dispatch.remove(StageManager.EVENT_STAGE_CLICK,this.onAdd,this)))},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),this.m_selectId=1,this.u_grpMc.visible=!1,this.setState(),Dispatch.register(StageManager.EVENT_STAGE_CLICK,this.onAdd,this))},e.prototype.setState=function(){this.u_imgIcon.source="courseUI_json.courseUI_tips"+this.m_selectId,this.u_txtMsg.textFlow=LanguageJson.getHtmlTextFlow("l_course_msg_"+this.m_selectId);for(var t=1;4>=t;t++)t==this.m_selectId?this["u_imgDian"+t].source="courseUI_json.courseUI_icon1":this["u_imgDian"+t].source="courseUI_json.courseUI_icon2";this.m_selectId>1?this.u_btnLeft.source="courseUI_json.courseUI_arrow2":this.u_btnLeft.source="courseUI_json.courseUI_arrow1",this.m_selectId<4?this.u_btnRight.source="courseUI_json.courseUI_arrow2":this.u_btnRight.source="courseUI_json.courseUI_arrow1"},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i),Dispatch.remove(StageManager.EVENT_STAGE_CLICK,this.onAdd,this),PlayerManager.instance.getSetingMsg(GameSetConfig.k_course_guide)||PlayerManager.instance.setingMsg(GameSetConfig.k_course_guide,"1"),GameManager.instance.isShield||PopupModule.instance.showPop(PopupConfig.ID_WELCOME,null,!1)},Object.defineProperty(e.prototype,"isClickBMask",{get:function(){return this.m_selectId<4?!1:!0},enumerable:!0,configurable:!0}),e}(PopupBase);__reflect(CourseUI.prototype,"CourseUI");var CreatRoleUI=function(t){function e(){var e=t.call(this)||this;return e.m_sex=1,e.m_nan_index=0,e.m_nv_index=0,e.m_timeNum=25,e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/creatRoleUI/CreatRoleUISkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.setXY(),this.u_txtTishi.textFlow=LanguageJson.getHtmlTextFlow("l_createRole_tishi"),this.u_txtSex.textFlow=LanguageJson.getHtmlTextFlow("l_createRole_sex"),this.m_sex=1,Math.floor(6*Math.random())<2&&(this.m_sex=0),this.m_time=this.m_timeNum,this.doTime(),this.setNameRole(),this.setSexView(),URIManager.is_platform&&GameSocket.instance.init()},e.prototype.initEvent=function(){this.u_txtName.addEventListener(egret.TouchEvent.CHANGE,this.stopTime,this),this.registerEventClick(this.u_btnGame,this.onGame,this,!0),this.registerEventClick(this.u_btnMan,this.onMan,this,!0),this.registerEventClick(this.u_btnWoman,this.onWoman,this,!0),this.registerEventClick(this.u_btnRandomName,this.onRandomName,this,!0),Dispatch.register(CreatRoleManager.EVENT_CREATE_ROLE_COM,this.setHide,this)},e.prototype.onGame=function(t){return""==this.u_txtName.text?void FloatTipModule.instance.popTipLanguage("l_createRole_tips_5"):void(CreatRoleManager.instance.p_is_send_creat_role||(CreatRoleManager.instance.p_is_send_creat_role=!0,CreatRoleManager.instance.m_create_role_tos(this.u_txtName.text,this.m_sex)))},e.prototype.onMan=function(t){0!=this.m_sex&&(this.m_sex=0,this.setSexView())},e.prototype.onWoman=function(t){1!=this.m_sex&&(this.m_sex=1,this.setSexView())},e.prototype.setSexView=function(){0==this.m_sex?(this.u_imgSex0.visible=!0,this.u_imgSex1.visible=!1):(this.u_imgSex0.visible=!1,this.u_imgSex1.visible=!0)},e.prototype.onRandomName=function(t){this.setNameRole(),this.stopTime()},e.prototype.setNameRole=function(){0==this.m_sex?(this.m_nan_index++,this.m_nan_index>LoginManager.instance.p_random_man_name.length-1&&(this.m_nan_index=0),this.u_txtName.text=LoginManager.instance.p_random_man_name[this.m_nan_index]):(this.m_nv_index++,this.m_nv_index>LoginManager.instance.p_random_women_name.length-1&&(this.m_nv_index=0),this.u_txtName.text=LoginManager.instance.p_random_women_name[this.m_nv_index])},e.prototype.doTime=function(){return this.m_time<=0?(this.onGame(null),void DelayCallUtils.killDelayedCallsTo(this.doTime,this)):(this.u_txtTime.text=this.m_time+"s",this.m_time-=1,void DelayCallUtils.delayedCall(1,this.doTime,this))},e.prototype.stopTime=function(t){void 0===t&&(t=null),DelayCallUtils.killDelayedCallsTo(this.doTime,this),this.u_txtTime.text=""},e.prototype.setHide=function(){TweenLite.to(this,.6,{alpha:0,onComplete:UIModule.instance.removeRoleUI.bind(UIModule.instance)})},e.prototype.hide=function(){DelayCallUtils.killDelayedCallsTo(this.doTime,this),this.u_txtName.removeEventListener(egret.TouchEvent.CHANGE,this.stopTime,this),this.removeEventClick(this.u_btnGame),this.removeEventClick(this.u_btnMan),this.removeEventClick(this.u_btnWoman),this.removeEventClick(this.u_btnRandomName),Dispatch.remove(CreatRoleManager.EVENT_CREATE_ROLE_COM,this.setHide,this),DisplayObjectUtils.removeFormParent(this)},e.prototype.setXY=function(){this.x=Math.floor(.5*(StageManager.instance.p_stageWidth-this.width)),this.y=Math.floor(.5*(StageManager.instance.p_stageHeight-this.height))},Object.defineProperty(e.prototype,"width",{get:function(){return StageManager.MIN_STAGE_WIDTH},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return StageManager.MIN_STAGE_HEIGHT
},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(CreatRoleUI.prototype,"CreatRoleUI");var CreateRolePopup=function(t){function e(){var e=t.call(this)||this;return e.m_sex=1,e.m_man_nameIndex=0,e.m_woman_nameIndex=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/creatRoleUI/popup/CreateRolePopupSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_txtSex.textFlow=LanguageJson.getHtmlTextFlow("l_createRole_sex"),this.u_txtTips.textFlow=LanguageJson.getHtmlTextFlow("l_createRole_tishi")},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnMan,this.onMan,this,!0),this.registerEventClick(this.u_btnWonman,this.onWoman,this,!0),this.registerEventClick(this.u_btnSure,this.onSure,this,!0),this.registerEventClick(this.u_btnRandom,this.onRandom,this,!0),Dispatch.register(PlayerManager.EVENT_CREATE_ROLE_COM,this.onHide,this)},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),this.m_sex=1,Math.floor(6*Math.random())<2&&(this.m_sex=0),this.setSex(),this.setName())},e.prototype.onRandom=function(t){this.setName()},e.prototype.setName=function(){for(var t=[],e=Math.round(8*Math.random()+5),i=0;e>=i;i++){var s=Math.ceil(25*Math.random()),n=Math.round(Math.random());.2>n?t.push(String.fromCharCode(65+s)):t.push(String.fromCharCode(97+s))}this.u_txtName.text=t.join(""),0==this.m_sex?(this.m_man_nameIndex++,this.m_man_nameIndex>LoginManager.instance.p_random_man_name.length-1&&(this.m_man_nameIndex=0),this.u_txtName.text=LoginManager.instance.p_random_man_name[this.m_man_nameIndex]):(this.m_woman_nameIndex++,this.m_woman_nameIndex>LoginManager.instance.p_random_women_name.length-1&&(this.m_woman_nameIndex=0),this.u_txtName.text=LoginManager.instance.p_random_women_name[this.m_woman_nameIndex])},e.prototype.onHide=function(){PopupModule.instance.showTishiSingle(LanguageJson.getHtmlText("l_createRole_tips_9"),this.showClose.bind(this),null,LanguageJson.getHtmlText("l_btn_go"))},e.prototype.showClose=function(t){PopupModule.instance.hidePop(PopupConfig.ID_CREATE_ROLE)},e.prototype.onSure=function(t){return""==this.u_txtName.text?void FloatTipModule.instance.popTipLanguage("l_createRole_tips_5"):void PlayerManager.instance.s_modify_nickname_gender(this.m_sex,this.u_txtName.text)},e.prototype.onMan=function(t){0!=this.m_sex&&(this.m_sex=0,this.setSex())},e.prototype.onWoman=function(t){1!=this.m_sex&&(this.m_sex=1,this.setSex())},e.prototype.setSex=function(){0==this.m_sex?(this.u_imgBoy.visible=!0,this.u_imgGirl.visible=!1):(this.u_imgBoy.visible=!1,this.u_imgGirl.visible=!0)},e.prototype.hide=function(e,i){this.removeEventClick(this.u_btnSure),this.removeEventClick(this.u_imgMan),this.removeEventClick(this.u_imgWonman),this.removeEventClick(this.u_btnRandom),Dispatch.remove(PlayerManager.EVENT_CREATE_ROLE_COM,this.onHide,this),t.prototype.hide.call(this,e,i)},Object.defineProperty(e.prototype,"isClickBMask",{get:function(){return!1},enumerable:!0,configurable:!0}),e}(PopupBase);__reflect(CreateRolePopup.prototype,"CreateRolePopup");var DebugItemRender=function(t){function e(){var e=t.call(this)||this;return e.once(egret.Event.COMPLETE,e.onComplete,e),e.skinName="resource/ui/debug/debugItemSkin.exml",e.touchEnabled=!1,e}return __extends(e,t),e.prototype.onComplete=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.doHandler,this),this.dataChanged()},e.prototype.dataChanged=function(){this.txt_type&&this.data&&(this.txt_name.multiline=!1,this.txt_name.wordWrap=!1,this.m_data=this.data,"发"==this.m_data.messageType?(this.txt_type.textFlow=TextUtil.setTextFlowColor(this.m_data.messageType+" "+this.m_data.creatTime,12940324),this.txt_name.textFlow=TextUtil.setTextFlowColor(MessageProtocol.protoLib[this.m_data.messageId].name+"",12940324)):(this.txt_type.textFlow=TextUtil.setTextFlowColor(this.m_data.messageType+" "+this.m_data.creatTime,3687517),this.txt_name.textFlow=TextUtil.setTextFlowColor(MessageProtocol.protoLib[this.m_data.messageId].name+"",3687517)))},e.prototype.doHandler=function(){Dispatch.dispatch(DebugModule.EVENT_SELECT_MESSAGE_ID_DATA,this.m_data)},e}(eui.ItemRenderer);__reflect(DebugItemRender.prototype,"DebugItemRender");var DebugModule=function(){function t(){this.isRecord=!1}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(t){this.m_root=t},t.prototype.showDebugUI=function(){this.isRecord=!0,this.debugUI||(this.debugUI=new DebugUI,this.debugUI.name="debugUI"),this.m_root.addChild(this.debugUI),this.rectify()},t.prototype.hideDebugUI=function(){this.m_root.removeChild(this.debugUI)},t.prototype.rectify=function(){this.debugUI&&(this.debugUI.x=0,this.debugUI.y=0)},t.EVENT_SELECT_MESSAGE_ID_DATA="EVENT_SELECT_MESSAGE_ID_DATA",t}();__reflect(DebugModule.prototype,"DebugModule");var DebugUI=function(t){function e(){var e=t.call(this)||this;return e.m_messageDataPro=new eui.ArrayCollection,e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/ui/debug/debugUI.exml",e}return __extends(e,t),e.prototype.initView=function(){this.group_message.visible=!1,this.group_content.visible=!1,this.list_message.itemRenderer=DebugItemRender;var t=new eui.TileLayout;t.verticalGap=-15,t.requestedColumnCount=1,this.list_message.layout=t,this.list_message.dataProvider=this.m_messageDataPro;var e=new eui.Image("commonUI_box");e.x=this.btn_show.x+100,this.addChild(e),e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.chargeHandler,this)},e.prototype.chargeHandler=function(){ChargeManager.instance.requestRecharge(99999,1)},e.prototype.initEvent=function(){this.btn_close.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeHandler,this),this.btn_hide.addEventListener(egret.TouchEvent.TOUCH_TAP,this.hideContent,this),this.btn_show.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showHandler,this),Dispatch.register(DebugModule.EVENT_SELECT_MESSAGE_ID_DATA,this.showContent,this)},e.prototype.showHandler=function(){this.group_message.visible=!this.group_message.visible,this.group_message.visible&&this.updateMessage()},e.prototype.updateMessage=function(){},e.prototype.closeHandler=function(){this.group_message.visible=!1},e.prototype.showContent=function(t){var e=JSON.stringify(t.messageData),i=JSON.stringify(JSON.parse(e),null,"	");this.txt_content.text=i,this.group_content.visible=!0},e.prototype.hideContent=function(){this.group_content.visible=!1},e}(ComponentBase);__reflect(DebugUI.prototype,"DebugUI");var DrawCardPage=function(t){function e(){var e=t.call(this)||this;return e.m_checkBtnState=!0,e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/drawCardUI/DrawCardUISkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_txtRewardPreview.text=LanguageJson.getText("l_card_summon_review"),this.u_txtRewardPreview.anchorOffsetX=this.u_txtRewardPreview.width/2,this.u_txtDrawCardDesc.text=LanguageJson.getText("l_card_summon_desc"),this.u_txtTenDraw.text=LanguageJson.getText("l_card_summon_ten");var e=JSON.parse(StaticDataJson.getData("card_summon_once_cost_list").data);e&&(e[0]==ItemEnum.GOLD?this.u_imgOneUnit.source="commonUI_icon_gold":e[0]==ItemEnum.RMB?this.u_imgOneUnit.source="commonUI_icon_juan":this.u_imgOneUnit.source=BagManager.instance.getIconPath(e[0]),this.u_txtOnePrice.text=e[1]+"");var i=JSON.parse(StaticDataJson.getData("card_summon_tentimes_cost_list").data);i&&(this.u_txtTenPrice.text=i[1]+"")},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnRewardPreview,this.onRewardPreview,this,!0),this.registerEventClick(this.u_gpOneDraw,this.onOnceDraw,this,!0),this.registerEventClick(this.u_btnTenDraw,this.onTenDraw,this,!0),RedNoticeManager.instance.registerRed(this.u_gpOneDraw,[RedNoticeConfig.RED_CHOU_KA],[162,8])},e.prototype.onRewardPreview=function(){PopupModule.instance.showPop(PopupConfig.ID_DRAW_CARD_REWARD)},e.prototype.onOnceDraw=function(){if(this.m_checkBtnState){if(this.m_checkBtnState=!1,DelayCallUtils.killDelayedCallsTo(this.onBtnStateComplete,this),DelayCallUtils.delayedCall(.5,this.onBtnStateComplete,this),this.m_freeTimes<=0){var t=JSON.parse(StaticDataJson.getData("card_summon_once_cost_list").data);return void(t&&(BagManager.instance.getNum(t[0])<t[1]?BagManager.instance.noEnoughRmb():DrawCardManager.instance.s_card_summon_do_summon(1)))}DrawCardManager.instance.s_card_summon_do_summon(1)}},e.prototype.onTenDraw=function(){if(this.m_checkBtnState){this.m_checkBtnState=!1,DelayCallUtils.killDelayedCallsTo(this.onBtnStateComplete,this),DelayCallUtils.delayedCall(.5,this.onBtnStateComplete,this);var t=JSON.parse(StaticDataJson.getData("card_summon_tentimes_cost_list").data);t&&(BagManager.instance.getNum(t[0])<t[1]?BagManager.instance.noEnoughRmb():DrawCardManager.instance.s_card_summon_do_summon(2))}},e.prototype.onBtnStateComplete=function(){this.m_checkBtnState=!0},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),Dispatch.register(DrawCardManager.EVENT_CARD_SUMMON,this.getPropList,this,!1),Dispatch.register(TimesManager.EVENT_TIEMS_UPDATE+TimesEnum.CARD_SUMMON_TIMES,this.setTimes,this,!0))},e.prototype.setTimes=function(){this.m_freeTimes=TimesManager.instance.getTimesById(TimesEnum.CARD_SUMMON_TIMES),this.m_freeTimes<=0?(this.u_imgOneUnit.visible=!0,this.u_txtOnePrice.visible=!0,this.u_txtCountDown.visible=!0,this.u_txtOneDraw.text=LanguageJson.getText("l_card_summon_one"),this.m_recoverTime=TimesManager.instance.getRecoverTimeById(TimesEnum.CARD_SUMMON_TIMES),this.m_recoverTime>ServerTimeManager.instance.timer&&TimeManager.instance.doLoop(this.timeDo,this)):(this.u_imgOneUnit.visible=!1,this.u_txtOnePrice.visible=!1,this.u_txtCountDown.visible=!1,this.u_txtOneDraw.text=LanguageJson.getText("l_card_summon_free"))},e.prototype.timeDo=function(){var t=this.m_recoverTime-ServerTimeManager.instance.timer;return 0>=t?void TimeManager.instance.clearTimer(this.timeDo,this):void(this.u_txtCountDown.textFlow=LanguageJson.getHtmlTextFlow("l_game_tips_28",[TimeUtil.getSpliceTime4(t)]))},e.prototype.getPropList=function(){var t=DrawCardManager.instance.p_prop;if(t){if(PopupModule.instance.havPopupStage(PopupConfig.ID_DRAW_CARD_SUMMON))return PopupModule.instance.hidePop(PopupConfig.ID_DRAW_CARD_SUMMON),DelayCallUtils.killDelayedCallsTo(this.getPropList,this),void DelayCallUtils.delayedCall(.21,this.getPropList,this);PopupModule.instance.showPop(PopupConfig.ID_DRAW_CARD_SUMMON,t)}},e.prototype.hide=function(e){void 0===e&&(e=null),t.prototype.hide.call(this,e),Dispatch.remove(DrawCardManager.EVENT_CARD_SUMMON,this.getPropList,this),Dispatch.remove(TimesManager.EVENT_TIEMS_UPDATE+TimesEnum.CARD_SUMMON_TIMES,this.setTimes,this),TimeManager.instance.clearTimer(this.timeDo,this)},e}(PageBase);__reflect(DrawCardPage.prototype,"DrawCardPage");var DrawCardRewardPopup=function(t){function e(){var e=t.call(this)||this;return e.m_layout=new eui.TileLayout,e.m_typeList=new eui.ArrayCollection,e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/drawCardUI/popup/DrawCardRewardPopupSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_txtRewrdTitle.text=LanguageJson.getText("l_card_summon_review"),this.u_scrollerItem.horizontalScrollBar=null,this.u_scrollerItem.verticalScrollBar=null,this.m_layout.requestedColumnCount=6,this.m_layout.paddingTop=20,this.m_layout.paddingLeft=20,this.m_layout.paddingBottom=20,this.m_layout.paddingRight=20,this.m_layout.horizontalGap=20,this.m_layout.verticalGap=20,this.u_listItem.itemRenderer=DrawCardRewardRender,this.u_listItem.layout=this.m_layout,this.u_listItem.dataProvider=this.m_typeList;var e=JSON.parse(StaticDataJson.getData("card_summon_book_list").data);e&&(this.m_typeList.source=e)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnClose,this.close,this,!0)},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&t.prototype.showView.call(this,e)},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i)},e.prototype.sureHide=function(e,i){void 0===e&&(e=null),void 0===i&&(i=null),t.prototype.sureHide.call(this,e,i)},e}(PopupBase);__reflect(DrawCardRewardPopup.prototype,"DrawCardRewardPopup");var DrawCardSummonPopup=function(t){function e(){var e=t.call(this)||this;return e.m_layout=new eui.TileLayout,e.m_typeList=new eui.ArrayCollection,e.m_checkBtnState=!0,e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/drawCardUI/popup/DrawCardSummonPopupSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_txtSummonTitle.text=LanguageJson.getText("l_game_tips_29"),this.u_scrollerItem.horizontalScrollBar=null,this.u_scrollerItem.verticalScrollBar=null,this.m_layout.requestedColumnCount=10,this.m_layout.horizontalGap=20,this.m_layout.verticalGap=20,this.u_listItem.itemRenderer=DrawCardSummonRender,this.u_listItem.layout=this.m_layout,this.u_listItem.dataProvider=this.m_typeList,this.u_txtClose.text=LanguageJson.getText("l_btn_ok")},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnClose,this.onHidePopup,this,!0),this.registerEventClick(this.u_btnDraw,this.onDraw,this,!0)},e.prototype.showView=function(e){if(void 0===e&&(e=null),this.checkComplete(this.showView,e)){t.prototype.showView.call(this,e);var i=e;if(i.length>1){var s=JSON.parse(StaticDataJson.getData("card_summon_tentimes_cost_list").data);s&&(s[0]==ItemEnum.GOLD?this.u_imgUnit.source="commonUI_icon_gold":s[0]==ItemEnum.RMB?this.u_imgUnit.source="commonUI_icon_juan":this.u_imgUnit.source=BagManager.instance.getIconPath(s[0]),this.u_txtPrice.text=s[1]+""),this.u_scrollerItem.width=1136,this.u_scrollerItem.height=210,this.u_listItem.width=1580,this.u_listItem.height=210,this.u_btnDraw.source="drawCardUI_json.drawCardUI_btn_2",this.u_txtDraw.text=LanguageJson.getText("l_card_summon_ten"),this.u_scrollerItem.viewport.scrollH=0,DelayCallUtils.killDelayedCallsTo(this.scrollToRight,this),DelayCallUtils.delayedCall(.5,this.scrollToRight,this)}else{var s=JSON.parse(StaticDataJson.getData("card_summon_once_cost_list").data);s&&(s[0]==ItemEnum.GOLD?this.u_imgUnit.source="commonUI_icon_gold":s[0]==ItemEnum.RMB?this.u_imgUnit.source="commonUI_icon_juan":this.u_imgUnit.source=BagManager.instance.getIconPath(s[0]),this.u_txtPrice.text=s[1]+""),this.u_scrollerItem.width=140,this.u_scrollerItem.height=210,this.u_listItem.width=140,this.u_listItem.height=210,this.u_btnDraw.source="drawCardUI_json.drawCardUI_btn_1",this.u_txtDraw.text=LanguageJson.getText("l_card_summon_one"),this.u_scrollerItem.viewport.scrollH=0}this.m_typeList.source=i}},e.prototype.scrollToRight=function(){TweenLite.killTweensOf(this),TweenLite.to(this.u_scrollerItem.viewport,1,{scrollH:444})},e.prototype.onHidePopup=function(){var t=this.u_listItem.getChildAt(this.u_listItem.numChildren-1);t.p_tweenFinishBool&&this.close()},e.prototype.onDraw=function(){if(this.m_checkBtnState){this.m_checkBtnState=!1,DelayCallUtils.killDelayedCallsTo(this.onBtnStateComplete,this),DelayCallUtils.delayedCall(.5,this.onBtnStateComplete,this);var t=this.u_listItem.getChildAt(this.u_listItem.numChildren-1);if(t.p_tweenFinishBool){var e=DrawCardManager.instance.p_prop;if(e.length>1){var i=JSON.parse(StaticDataJson.getData("card_summon_tentimes_cost_list").data);i&&(BagManager.instance.getNum(i[0])<i[1]?BagManager.instance.noEnoughRmb():DrawCardManager.instance.s_card_summon_do_summon(2))}else{var s=JSON.parse(StaticDataJson.getData("card_summon_once_cost_list").data);s&&(BagManager.instance.getNum(s[0])<s[1]?BagManager.instance.noEnoughRmb():DrawCardManager.instance.s_card_summon_do_summon(1))}}}},e.prototype.onBtnStateComplete=function(){this.m_checkBtnState=!0},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i),this.u_scrollerItem.stopAnimation()},e.prototype.sureHide=function(e,i){void 0===e&&(e=null),void 0===i&&(i=null),t.prototype.sureHide.call(this,e,i)},Object.defineProperty(e.prototype,"isClickBMask",{get:function(){return!1},enumerable:!0,configurable:!0}),e}(PopupBase);__reflect(DrawCardSummonPopup.prototype,"DrawCardSummonPopup");var DrawCardRewardRender=function(t){function e(){return t.call(this,"resource/eui_skins/drawCardUI/popup/render/DrawCardRewardRenderSkin.exml")||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShow,this)},e.prototype.onShow=function(t){var e=this.data;if(e){var i=e[0];i&&PopupModule.instance.showPop(PopupConfig.ID_ITEM_USE,{itemId:i},!1)}},e.prototype.dataChanged=function(){if(this.checkComplete(this.dataChanged)){t.prototype.dataChanged.call(this);var e=this.data;if(e){var i=e[0],s=(CardJson.getData(i),ItemJson.getData(i));s&&(this.u_imgIcon.source=ItemJson.getIconPath(i),this.u_txtName.text=ItemJson.getName(i))}}},e}(ItemRendererBase);__reflect(DrawCardRewardRender.prototype,"DrawCardRewardRender");var DrawCardSummonRender=function(t){function e(){return t.call(this,"resource/eui_skins/drawCardUI/popup/render/DrawCardSummonRenderSkin.exml")||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShow,this)},e.prototype.onShow=function(t){var e=this.data;if(e){var i=e.prop_id;i&&PopupModule.instance.showPop(PopupConfig.ID_ITEM_USE,{itemId:i},!1)}},e.prototype.dataChanged=function(){if(this.checkComplete(this.dataChanged)){t.prototype.dataChanged.call(this);var e=this.data;if(e){var i=e.prop_id,s=(CardJson.getData(i),ItemJson.getData(i));s&&(this.u_imgIcon.source=ItemJson.getIconPath(i),this.u_txtName.text=ItemJson.getName(i))}}},Object.defineProperty(e.prototype,"tweenType",{get:function(){return 1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"toTime",{get:function(){return.25},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lastTime",{get:function(){return.15},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"delayTime",{get:function(){return.1},enumerable:!0,configurable:!0}),e.prototype.onRemoveStage=function(e){t.prototype.onRemoveStage.call(this,e)},e}(ItemRendererBase);__reflect(DrawCardSummonRender.prototype,"DrawCardSummonRender");var EntranceConfig=function(){function t(){}return t.regiestIconClass=function(){this.entranceBaseDic[FunctionEnum.FIRST_RECHARGE]=FirstChargeIcon,this.entranceBaseDic[FunctionEnum.WITHDRAWAL_SYS]=WithdrawIcon},t.regiestIconRedEnum=function(){this.iconRedEnumDic[FunctionEnum.SHARE_SYS]=[RedNoticeConfig.RED_SHARE,RedNoticeConfig.RED_PROMOTE],this.iconRedEnumDic[FunctionEnum.ACTIVITY_HALL]=[RedNoticeConfig.RED_SEVEN_LOGIN,RedNoticeConfig.RED_SIGN_IN,RedNoticeConfig.RED_LUCKY_DRAW,RedNoticeConfig.RED_CHOU_KA],this.iconRedEnumDic[FunctionEnum.SEVEN_LOGIN_SYS]=[RedNoticeConfig.RED_SEVEN_LOGIN],this.iconRedEnumDic[FunctionEnum.MAIL_SYS]=[RedNoticeConfig.RED_MAIL_INFO],this.iconRedEnumDic[FunctionEnum.ACHIEVEMENT_SYS]=[RedNoticeConfig.RED_ACHIEVEMENT]},t.setBubbleRedEnum=function(t,e){this.m_bubbleRedEnumDic[t]=e},t.getBubbleRedEnum=function(t){return this.m_bubbleRedEnumDic[t]?this.m_bubbleRedEnumDic[t]:null},t.ENTRANCE_UP=1,t.ENTRANCE_RIGHT=2,t.ENTRANCE_DOWN=3,t.ENTRANCE_LEFT=4,t.entranceBaseDic={},t.iconRedEnumDic={},t.m_bubbleRedEnumDic={},t}();__reflect(EntranceConfig.prototype,"EntranceConfig");var EntranceModule=function(){function t(){this.m_entranceHideDec={},this.m_entranceShowList=[],this.m_isBattleType=-1,this.m_specialFunction={}}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){EntranceConfig.regiestIconClass(),EntranceConfig.regiestIconRedEnum(),Dispatch.register(PlayerManager.EVENT_PLAYER_INIT,this.initCreateEntrance,this)},t.prototype.initData=function(){},t.prototype.initCreateEntrance=function(){if(!(this.m_entranceShowList.length>0))for(var t=StaticDataJson.parseStrToList("entrance_list"),e=0;e<t.length;e++){var i=new EntranceShow(e+1,t[e][0],t[e][1]);this.m_entranceShowList.push(i),UIModule.instance.downUILayer2.addChild(i)}},t.prototype.setEntranceVisible=function(t,e,i,s){void 0===i&&(i=-1),void 0===s&&(s=!0);var n=FunctionIconJson.getDataByFuncIdAcId(e,i);for(var o in n)this.setEntranceVBItem(t,n[o],s)},t.prototype.setEntranceVBItem=function(t,e,i){null!=e&&(t&&this.m_entranceShowList[e.enter_type-1]&&this.m_entranceShowList[e.enter_type-1].getIconPoint(e)||!t&&this.m_entranceHideDec[e.enter_type+"_"+e.index]>0||(t?delete this.m_entranceHideDec[e.enter_type+"_"+e.index]:this.m_entranceHideDec[e.enter_type+"_"+e.index]=1,e&&this.refreshEntrance(e.enter_type,i,e)))},t.prototype.refreshEntrance=function(t,e,i){if(void 0===t&&(t=0),void 0===e&&(e=!1),void 0===i&&(i=null),!(this.m_entranceShowList.length<=0))for(var s=0;s<this.m_entranceShowList.length;s++)if(0==t)this.m_entranceShowList[s].refreshDataAll(e,i);else if(t==s+1){this.m_entranceShowList[s].refreshDataAll(e,i);break}},t.prototype.isShowEntrance=function(t){if(null==t)return!1;if(!this.getSpecialFunction(t.function_id))return!1;if(t.function_id>0&&!FunctionManager.instance.getOpenFuncId(t.function_id))return!1;if(1==this.m_entranceHideDec[t.enter_type+"_"+t.index])return!1;if(t.activity_id>0&&ActivityManager.instance.isClose(t.activity_id))return!1;if(1==t.is_reviewing&&1==URIManager.is_reviewing)return!1;if(null==t.show_type_list)return!1;var e=2;return SceneModule.instance.isMainScene?e=1:SceneModule.instance.isMissionScene&&(e=3),-1==t.show_type_list.indexOf(e)?!1:!0},t.prototype.getSpecialFunction=function(t){if(null!=this.m_specialFunction[t]){var e=this.m_specialFunction[t];return e.apply(null)}return!0},t}();__reflect(EntranceModule.prototype,"EntranceModule");var EntranceShow=function(t){function e(e,i,s){void 0===i&&(i=0),void 0===s&&(s=0);var n=t.call(this)||this;if(n.m_jsonInitList=[],n.m_jsonShowList=[],n.m_iconShowDic={},n.m_off=5,n.m_falg=1,n.touchEnabled=!1,n.m_type=e,n.m_widthLimit=i,n.m_heighLimit=s,n.m_sp=new egret.DisplayObjectContainer,n.m_sp.touchEnabled=!1,n.addChild(n.m_sp),n.m_spRed=new egret.DisplayObjectContainer,n.m_spRed.touchChildren=!1,n.m_spRed.touchEnabled=!1,n.m_jsonInitList=FunctionIconJson.getListByType(n.m_type),Dispatch.register(StageManager.EVENT_STAGE_RESIZE,n.stageResize,n,!0),(1==n.m_type||2==n.m_type)&&!n.m_imgClose){n.m_imgClose=new eui.Image,n.addChild(n.m_imgClose),n.m_imgClose.anchorOffsetX=12.5,n.m_imgClose.anchorOffsetY=19.5,n.m_imgClose.source="commonUI_btn_close_1",n.m_imgClose.addEventListener(egret.TouchEvent.TOUCH_TAP,n.onClick,n),1==n.m_type?(n.m_imgClose.x=33,n.m_imgClose.y=45,n.m_spRed.x=33,n.m_spRed.y=45):(n.m_imgClose.x=55,n.m_imgClose.y=-20,n.m_spRed.x=60,n.m_spRed.y=-30);for(var o=[],a=[],r=0;r<n.m_jsonInitList.length;r++)if(-1==a.indexOf(n.m_jsonInitList[r].function_id)){var _=EntranceConfig.iconRedEnumDic[n.m_jsonInitList[r].function_id];_&&_.length>0&&(o=o.concat(_))}RedNoticeManager.instance.registerRed(n.m_spRed,o,[0,-30])}return n.refreshDataAll(),n}return __extends(e,t),e.prototype.onClick=function(t){TweenLite.killTweensOf(this.m_sp),1==this.m_falg?(this.m_falg=2,this.m_sp.touchChildren=!1,this.m_imgClose.scaleX=-1,1==this.m_type?TweenLite.to(this.m_sp,.3,{y:20,alpha:0,ease:Cubic.easeIn,onComplete:this.sureClsoe.bind(this)}):(TweenLite.to(this.m_sp,.3,{x:StageManager.instance.p_stageWidth+30,alpha:0,ease:Cubic.easeIn,onComplete:this.sureClsoe.bind(this)}),TweenLite.to(this.m_imgClose,.3,{x:80}))):(this.m_falg=1,this.m_sp.touchChildren=!0,this.addChild(this.m_sp),this.m_imgClose.scaleX=1,this.m_spRed.parent&&this.m_spRed.parent.removeChild(this.m_spRed),1==this.m_type?TweenLite.to(this.m_sp,.3,{y:0,alpha:1,ease:Cubic.easeIn}):(TweenLite.to(this.m_sp,.3,{x:0,alpha:1,ease:Cubic.easeIn}),TweenLite.to(this.m_imgClose,.3,{x:55}))),SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_1007)},e.prototype.setShowOrHide=function(t,e){void 0===e&&(e=1),this.m_type==e&&this.m_falg!=t&&this.onClick(null)},Object.defineProperty(e.prototype,"falg",{get:function(){return this.m_falg},enumerable:!0,configurable:!0}),e.prototype.sureClsoe=function(){this.addChild(this.m_spRed),this.m_sp.parent&&this.removeChild(this.m_sp)},e.prototype.stageResize=function(){1==this.m_type?(this.x=StageManager.instance.p_stageWidth-60,DelayCallUtils.killDelayedCallsTo(this.setBtnXY,this),DelayCallUtils.delayedCall(.2,this.setBtnXY,this)):2==this.m_type?(this.x=StageManager.instance.p_stageWidth-95,this.y=100):3==this.m_type?(this.x=StageManager.instance.p_stageWidth-75,this.y=StageManager.instance.p_stageHeight-250):(this.x=10,this.y=100)},e.prototype.refreshDataAll=function(t,e){void 0===t&&(t=!1),void 0===e&&(e=null);var i;for(i=0;i<this.m_jsonShowList.length;i++){var s=this.m_iconShowDic[this.m_jsonShowList[i].enter_type+"_"+this.m_jsonShowList[i].index];s&&s.hide()}this.m_jsonShowList=[];var n=[];for(i=0;i<this.m_jsonInitList.length;i++){var o=this.m_jsonInitList[i];EntranceModule.instance.isShowEntrance(o)&&n.push(o)}n.length>0?(this.m_jsonShowList=n,this.setBtnXY(t,e),this.m_imgClose&&(this.m_imgClose.visible=!0)):this.m_imgClose&&(this.m_imgClose.visible=!1)},e.prototype.setBtnXY=function(t,e){void 0===t&&(t=!1),void 0===e&&(e=null);for(var i=1,s=-1,n=1,o=0,a=0,r=0,_=0,h=0;h<this.m_jsonShowList.length;h++){var l=void 0,c=void 0,m=void 0,p=0,u=this.m_jsonShowList[h].enter_type+"_"+this.m_jsonShowList[h].index;if(this.m_iconShowDic[u]?m=this.m_iconShowDic[u]:(m=this.getIcon(this.m_jsonShowList[h].function_id,this.m_jsonShowList[h].activity_id),m.setData(this.m_jsonShowList[h]),this.m_iconShowDic[u]=m),m.show(),this.m_sp.addChildAt(m,0),1==this.m_type||3==this.m_type){if(1==this.m_type?(n=1,-1==s&&(s=(m.width+this.m_off)*this.m_jsonShowList.length<StageManager.instance.p_stageWidth-200?StageManager.instance.p_stageWidth-100:this.m_widthLimit),1==i&&(p=100)):(n=-1,s=this.m_widthLimit),a+p+m.width>=s&&(i+=1,a=0,r+=o+this.m_off,o=0),i>3)break;l=-a-m.width,c=n*r,a+=m.width+this.m_off,m.height>o&&(o=m.height),m.setPost(l,c,t,e),a>_&&(_=a)}else if(2==this.m_type||4==this.m_type){if(r+m.height>this.m_heighLimit&&(i+=1,r=0,a+=o+this.m_off,o=0),i>10)break;n=2==this.m_type?-1:1,l=n*a,c=r,r+=m.height+this.m_off,m.width>o&&(o=m.width),m.setPost(l,c,t,e)}}1==this.m_type&&(StageManager.instance.p_stageWidth>730+_?this.y=0:this.y=160)},e.prototype.getIcon=function(t,e){return EntranceConfig.entranceBaseDic[t]?new EntranceConfig.entranceBaseDic[t]:e>0?new FunctionActivityIcon:new FunctionIcon},e.prototype.getIconPoint=function(t){if(t){var e=this.m_iconShowDic[t.enter_type+"_"+t.index];if(e)return e.pointXY}return null},e.prototype.getIconById=function(t){for(var e=0;e<this.m_jsonShowList.length;e++){var i=this.m_jsonShowList[e].function_id;if(t==i)return this.m_iconShowDic[i]}return null},e.prototype.showOrHideIcon=function(t){void 0===t&&(t=!0);for(var e in this.m_iconShowDic){var i=this.m_iconShowDic[e];i&&(t?(i.show(),this.m_sp.addChildAt(i,0)):i.hide())}},Object.defineProperty(e.prototype,"jsonShowList",{get:function(){return this.m_jsonShowList},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this.m_type},enumerable:!0,configurable:!0}),e}(eui.Component);__reflect(EntranceShow.prototype,"EntranceShow");var FunctionActivityIcon=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.show=function(){if(t.prototype.show.call(this),this.m_json&&this.m_json.is_activity_time>0){if(this.m_activityInfo=ActivityManager.instance.getInfoById(this.m_json.activity_id),null==this.m_activityInfo)return;ActivityManager.instance.isReady(this.m_activityInfo.activity_id)?this.setReady():ActivityManager.instance.isOpen(this.m_activityInfo.activity_id)?this.setOpen():this.setLabelMsg()}},e.prototype.setReady=function(){if(this.m_activityInfo){var t=new Date(1e3*this.m_activityInfo.start_time),e=TimeUtil.fillZeros(String(t.getHours()),2)+":"+TimeUtil.fillZeros(String(t.getMinutes()),2)+" 开启";this.setLabelMsg(TextUtil.setText(e,ColorJson.getColorNum(ColorEnum.C_GREEN)))}},e.prototype.setOpen=function(){this.m_endTime=ActivityManager.instance.getActivityEndTime(this.m_activityInfo.activity_id),TimeManager.instance.doLoop(this.activityTime,this)},e.prototype.activityTime=function(){var t=this.m_endTime-ServerTimeManager.instance.timer;if(0>=t)TimeManager.instance.clearTimer(this.activityTime,this),this.setLabelMsg();else{var e=TimeUtil.getSpliceTime4(t);this.setLabelMsg(TextUtil.setText(e,ColorJson.getColorNum(ColorEnum.C_GREEN)))}},e.prototype.hide=function(){TimeManager.instance.clearTimer(this.activityTime,this),t.prototype.hide.call(this)},e}(FunctionIcon);__reflect(FunctionActivityIcon.prototype,"FunctionActivityIcon");var ChatChannelJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},t.getDataList=function(){var t=[];for(var e in this.jsonData)t.push(this.jsonData[e]);return ArrayUtils.setSortArr(t,["index"],[0]),t},Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="chat_channel",t}();__reflect(ChatChannelJson.prototype,"ChatChannelJson"),window.ChatChannelJson=ChatChannelJson;var CusServiceIcon=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.onClick=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),""!=PlayerManager.instance.p_kefuUrl&&PlayerManager.instance.gotoKefu()},e}(FunctionIcon);__reflect(CusServiceIcon.prototype,"CusServiceIcon");var FirstChargeIcon=function(t){function e(){var e=t.call(this,!1)||this;return e.touchEnabled=!1,e}return __extends(e,t),e.prototype.setData=function(t){this.m_json=t},e.prototype.setPost=function(t,e,i,s){void 0===i&&(i=!1),void 0===s&&(s=null),this.x=t,this.y=e},e.prototype.show=function(){this.m_effects||(this.m_effects=new EffectMovieClip,this.m_effects.touchEnabled=!1,this.m_effects.touchChildren=!1,this.m_effects.x=.5*this.width,this.m_effects.y=.5*this.height,this.m_effects.setMC("resource/assets/uiEffect/firstRecharge/firstRechargeIcon")),this.m_effects.play(),this.addChild(this.m_effects),this.m_maskImg||(this.m_maskImg=new eui.Image("commonUI_box"),this.m_maskImg.scale9Grid=UIModule.instance.getRectangle(),this.m_maskImg.alpha=0,this.m_maskImg.x=5,this.m_maskImg.y=10,this.m_maskImg.width=110,this.m_maskImg.height=100,this.m_maskImg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)),this.addChild(this.m_maskImg),this.m_txtTime||(this.m_txtTime=new eui.Label,this.m_txtTime.y=105,this.m_txtTime.textColor=ColorJson.green,this.m_txtTime.stroke=1,this.m_txtTime.strokeColor=2302755,this.m_txtTime.touchEnabled=!1,this.m_txtTime.textAlign="center",this.m_txtTime.size=16,this.m_txtTime.horizontalCenter=0),this.addChild(this.m_txtTime),this.m_time=TimeUtil.showTime(2),TimeManager.instance.doLoop(this.timeDo,this)},e.prototype.hide=function(){t.prototype.hide.call(this),this.m_effects&&(this.m_effects.destory(),this.m_effects=null),TimeManager.instance.clearTimer(this.timeDo,this)},e.prototype.timeDo=function(){var t=this.m_time-ServerTimeManager.instance.timer;
return 0>=t?void(this.m_time=this.m_time+86400):void(this.m_txtTime.text=TimeUtil.getSpliceTime2(t))},Object.defineProperty(e.prototype,"width",{get:function(){return 120},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 120},enumerable:!0,configurable:!0}),e}(FunctionIcon);__reflect(FirstChargeIcon.prototype,"FirstChargeIcon");var TurntableIcon=function(t){function e(){var e=t.call(this,!1)||this;return e.touchEnabled=!1,e}return __extends(e,t),e.prototype.setData=function(t){this.m_json=t,RedNoticeManager.instance.registerRed(this,[RedNoticeConfig.RED_TURNTABLE_REWARD],[95,15])},e.prototype.setPost=function(t,e,i,s){void 0===i&&(i=!1),void 0===s&&(s=null),this.x=t,this.y=e},e.prototype.show=function(){this.m_effects||(this.m_effects=new EffectMovieClip,this.m_effects.touchEnabled=!1,this.m_effects.touchChildren=!1,this.m_effects.x=.5*this.width,this.m_effects.y=.5*this.height,this.m_effects.setMC("resource/assets/uiEffect/turntable/turntableEntrance")),this.m_effects.play(),this.addChild(this.m_effects),this.m_maskImg||(this.m_maskImg=new eui.Image("commonUI_box"),this.m_maskImg.scale9Grid=UIModule.instance.getRectangle(),this.m_maskImg.alpha=0,this.m_maskImg.x=5,this.m_maskImg.y=10,this.m_maskImg.width=110,this.m_maskImg.height=100,this.m_maskImg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)),this.addChild(this.m_maskImg),this.m_txtTime||(this.m_txtTime=new eui.Label,this.m_txtTime.y=112,this.m_txtTime.textColor=ColorJson.green,this.m_txtTime.stroke=1,this.m_txtTime.strokeColor=2302755,this.m_txtTime.touchEnabled=!1,this.m_txtTime.textAlign="center",this.m_txtTime.size=16,this.m_txtTime.horizontalCenter=0),this.addChild(this.m_txtTime),this.m_time=TimeUtil.showTime(2),TimeManager.instance.doLoop(this.timeDo,this)},e.prototype.hide=function(){this.m_effects&&(this.m_effects.destory(),this.m_effects=null),TimeManager.instance.clearTimer(this.timeDo,this),t.prototype.hide.call(this)},e.prototype.timeDo=function(){var t=this.m_time-ServerTimeManager.instance.timer;return 0>=t?void(this.m_time=this.m_time+86400):void(this.m_txtTime.text=TimeUtil.getSpliceTime2(t))},Object.defineProperty(e.prototype,"width",{get:function(){return 120},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 120},enumerable:!0,configurable:!0}),e}(FunctionIcon);__reflect(TurntableIcon.prototype,"TurntableIcon");var WithdrawIcon=function(t){function e(){var e=t.call(this,!1)||this;return e.touchEnabled=!1,e}return __extends(e,t),e.prototype.setData=function(t){this.m_json=t,RedNoticeManager.instance.registerRed(this,[RedNoticeConfig.RED_WITHDRAW],[95,15])},e.prototype.setPost=function(t,e,i,s){void 0===i&&(i=!1),void 0===s&&(s=null),this.x=t,this.y=e},e.prototype.show=function(){this.m_effects||(this.m_effects=new EffectMovieClip,this.m_effects.touchEnabled=!1,this.m_effects.touchChildren=!1,this.m_effects.x=.5*this.width,this.m_effects.y=.5*this.height,this.m_effects.setMC("resource/assets/uiEffect/entrance/drawMoney")),this.m_effects.play(),this.addChild(this.m_effects),this.m_txtTime||(this.m_txtTime=new eui.Label,this.m_txtTime.textColor=ColorJson.green,this.m_txtTime.stroke=1,this.m_txtTime.strokeColor=2302755,this.m_txtTime.touchEnabled=!1,this.m_txtTime.textAlign="center",this.m_txtTime.size=16,this.m_txtTime.x=26,this.m_txtTime.y=105),this.addChild(this.m_txtTime),this.setArrow(),this.m_maskImg||(this.m_maskImg=new eui.Image("commonUI_box"),this.m_maskImg.scale9Grid=UIModule.instance.getRectangle(),this.m_maskImg.alpha=0,this.m_maskImg.x=5,this.m_maskImg.y=10,this.m_maskImg.width=110,this.m_maskImg.height=100,this.m_maskImg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)),this.addChild(this.m_maskImg),this.m_time=TimeUtil.showTime(2),TimeManager.instance.doLoop(this.timeDo,this),Dispatch.register(AchievementManager.EVENT_ACHIEVE_DATA_UPDATE,this.setArrow,this)},e.prototype.setArrow=function(){var t=AchievementManager.instance.getAchieveDataByType(AchievementManager.instance.p_WithdrawalType);t&&t.id<=4&&1==t.state?(this.m_arrowImg||(this.m_arrowImg=new eui.Image("commonsUI_json.commonsUI_jiantou"),this.m_arrowImg.rotation=90,this.m_arrowImg.x=190,this.m_arrowImg.y=40,this.m_arrowImg.touchEnabled=!1),this.addChild(this.m_arrowImg),this.m_type=1,this.moveArrwoShow()):this.m_arrowImg&&(TweenLite.killTweensOf(this.m_arrowImg),DisplayObjectUtils.removeFormParent(this.m_arrowImg))},e.prototype.moveArrwoShow=function(){1==this.m_type?(this.m_type=2,TweenLite.to(this.m_arrowImg,.4,{x:220,onComplete:this.moveArrwoShow.bind(this)})):(this.m_type=1,TweenLite.to(this.m_arrowImg,.6,{x:190,onComplete:this.moveArrwoShow.bind(this)}))},e.prototype.hide=function(){t.prototype.hide.call(this),this.m_effects&&(this.m_effects.destory(),this.m_effects=null),this.m_arrowImg&&(TweenLite.killTweensOf(this.m_arrowImg),DisplayObjectUtils.removeFormParent(this.m_arrowImg)),TimeManager.instance.clearTimer(this.timeDo,this),Dispatch.remove(AchievementManager.EVENT_ACHIEVE_DATA_UPDATE,this.setArrow,this)},e.prototype.timeDo=function(){var t=this.m_time-ServerTimeManager.instance.timer;return 0>=t?void(this.m_time=this.m_time+86400):void(this.m_txtTime.text=TimeUtil.getSpliceTime2(t))},Object.defineProperty(e.prototype,"width",{get:function(){return 120},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 120},enumerable:!0,configurable:!0}),e}(FunctionIcon);__reflect(WithdrawIcon.prototype,"WithdrawIcon");var BubbleTip=function(t){function e(e,i,s){void 0===e&&(e=null),void 0===i&&(i=0),void 0===s&&(s=0);var n=t.call(this)||this;return n.touchChildren=!1,n.touchEnabled=!1,n.m_parentWidth=i,n.m_parentHeight=s,n.m_pointInit=e,n.once(egret.Event.COMPLETE,n.onCompleted,n),n.skinName="resource/eui_skins/commonsUI/entrance/BubbleTipSkin.exml",n}return __extends(e,t),e.prototype.showMsg=function(t,e,i,s){if(this.checkComplete(this.showMsg,t,e,i,s))if(TweenLite.killTweensOf(this),this.m_parentMc=t,this.m_direction=e.c_direction,this.m_isFloat=e.c_isFloat,1==i){var n=!1,o=e.c_tipMsg;this.u_txtMsg.textFlow=HtmlUtil.setTextFlow(o,s),this.u_imgBj.width=2*this.u_txtMsg.x+this.u_txtMsg.textWidth,this.u_imgBj.height=2*this.u_txtMsg.y+this.u_txtMsg.textHeight,this.u_imgBj.visible=!0,this.onIconComplete(n)}else this.u_txtMsg.visible=!1,this.u_imgArrow.visible=!1,this.u_imgBj.visible=!1,this.u_imgBj.source="resource/assets/functionIcon/bubble/"+e.c_iconName+".png",this.onIconComplete()},e.prototype.onIconComplete=function(t){void 0===t&&(t=!1),this.setPosition(),this.m_parentMc.addChild(this),this.m_currX=this.x,this.m_currY=this.y,this.alpha=0,1==this.m_direction||3==this.m_direction?(this.scaleX=1,this.scaleY=0,TweenLite.to(this,.6,{scaleY:1,alpha:1,ease:Circ.easeIn,onComplete:this.sureMove.bind(this)})):(this.scaleX=0,this.scaleY=1,TweenLite.to(this,.6,{scaleX:1,alpha:1,ease:Circ.easeIn,onComplete:this.sureMove.bind(this)}))},e.prototype.sureMove=function(){TweenLite.killTweensOf(this),this.m_isFloat&&this.gotoMove()},e.prototype.gotoMove=function(){if(this.x==this.m_currX&&this.m_currY==this.y)switch(this.m_direction){case 1:TweenLite.to(this,.8,{y:this.m_currY+10,ease:Circ.easeOut,onComplete:this.gotoMove.bind(this)});break;case 2:TweenLite.to(this,.8,{x:this.m_currX+10,ease:Circ.easeOut,onComplete:this.gotoMove.bind(this)});break;case 3:TweenLite.to(this,.8,{y:this.m_currY-10,ease:Circ.easeOut,onComplete:this.gotoMove.bind(this)});break;case 4:TweenLite.to(this,.8,{x:this.m_currX-10,ease:Circ.easeOut,onComplete:this.gotoMove.bind(this)})}else TweenLite.to(this,.6,{x:this.m_currX,y:this.m_currY,ease:Circ.easeIn,onComplete:this.gotoMove.bind(this)})},e.prototype.hide=function(){TweenLite.killTweensOf(this),1==this.m_direction||3==this.m_direction?TweenLite.to(this,.3,{scaleY:0,alpha:0,x:this.m_currX,y:this.m_currY,ease:Circ.easeIn,onComplete:this.sureHide.bind(this)}):TweenLite.to(this,.3,{scaleX:0,alpha:0,x:this.m_currX,y:this.m_currY,ease:Circ.easeIn,onComplete:this.sureHide.bind(this)})},e.prototype.sureHide=function(){DisplayObjectUtils.removeFormParent(this)},e.prototype.setPosition=function(){if(this.m_pointInit)this.x=this.m_pointInit[0],this.y=this.m_pointInit[1];else switch(this.m_direction){case 1:this.x=(this.m_parentWidth-this.width)/2,this.y=this.m_parentHeight+10;break;case 2:this.x=-this.width-10,this.y=(this.m_parentHeight-this.height)/2;break;case 3:this.x=(this.m_parentWidth-this.width)/2-6,this.y=-this.height-10;break;case 4:this.x=this.width-10,this.y=(this.m_parentHeight-this.height)/2}switch(this.m_direction){case 1:this.u_imgArrow.x=this.width/2,this.u_imgArrow.y=-2.2,this.u_imgArrow.rotation=180;break;case 2:this.u_imgArrow.x=this.width+2.1,this.u_imgArrow.y=this.height/2,this.u_imgArrow.rotation=270;break;case 3:this.u_imgArrow.x=this.width/2,this.u_imgArrow.y=this.height+2,this.u_imgArrow.rotation=0;break;case 4:this.u_imgArrow.x=-2.2,this.u_imgArrow.y=this.height/2,this.u_imgArrow.rotation=90}},Object.defineProperty(e.prototype,"width",{get:function(){return this.u_imgBj.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.u_imgBj.height},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(BubbleTip.prototype,"BubbleTip");var ExchangeShopUI=function(t){function e(){var e=t.call(this)||this;return e.m_dataArr=[],e.m_layout=new eui.TileLayout,e.m_typeList=new eui.ArrayCollection,e.m_disposeUrlList.push("exchangeShopUI_json"),e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/exchangeShopUI/ExchangeShopUISkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_scrollerItem.horizontalScrollBar=null,this.u_scrollerItem.verticalScrollBar=null,this.m_layout.requestedColumnCount=5,this.m_layout.horizontalGap=20,this.m_layout.verticalGap=20,this.u_listItem.itemRenderer=ExchangeShopRender,this.u_listItem.layout=this.m_layout,this.u_listItem.dataProvider=this.m_typeList;var e=TreasureHuntTypeJson.getData(LuckyDrawManager.instance.p_typeId);this.m_dataArr=ShopJson.getListByType(e.shop_type),this.m_typeList.source=this.m_dataArr,ShopManager.instance.p_defId=this.m_dataArr[0].id,this.u_txtTitle.text=LanguageJson.getText("l_exchange_shop_title"),this.u_txtExchange.text=LanguageJson.getText("l_btn_exchange"),this.m_wit=.5*(StageManager.MIN_STAGE_WIDTH-StageManager.instance.p_stageWidth),this.u_mcItem.x+=this.m_wit,this.u_mcRight.x-=this.m_wit},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnExchange,this.onBuy,this,!0),this.registerEventClick(this.u_btnClose,this.close,this,!0)},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),Dispatch.register(ExchangeShopRender.EVENT_SHOW_DETAIL,this.onDetail,this,!0))},e.prototype.onDetail=function(){this.m_shopJson&&Dispatch.remove(BagManager.EVENT_BAG_UPGRADE+this.m_shopJson.buy_item_list[0][0],this.upItemNum,this),this.m_shopJson=ShopJson.getData(ShopManager.instance.p_defId),this.u_imgItem.source=ItemJson.getIconPath(this.m_shopJson.buy_item_list[0][0]);var t=ItemJson.getData(this.m_shopJson.item_list[0][0]);t.type==ItemTypeEnum.HERO_CHIP?(this.u_mcItem.visible=!1,this.u_heroName.visible=!0,this.u_heroName.text=t.name,this.removeItemEf(),this.m_roleDr||(this.m_roleDr=new DragonMovieClip,this.m_roleDr.x=170+this.m_wit,this.m_roleDr.y=630),this.addChildAt(this.m_roleDr,0),this.m_roleDr.playHero(t.connect_id)):(this.u_heroName.visible=!1,this.u_mcItem.visible=!0,this.u_itemName.text=t.name,this.removeRoleDr(),this.m_itemEf||(this.m_itemEf=new EffectMovieClip,this.m_itemEf.x=216,this.m_itemEf.y=200),this.u_mcItem.addChild(this.m_itemEf),this.m_itemEf.play()),Dispatch.register(BagManager.EVENT_BAG_UPGRADE+this.m_shopJson.buy_item_list[0][0],this.upItemNum,this,!0)},e.prototype.upItemNum=function(){var t=BagManager.instance.getNum(this.m_shopJson.buy_item_list[0][0]),e=this.m_shopJson.buy_item_list[0][1];this.u_btnExchange.visible=t>=e?!0:!1,this.u_txtHave.textFlow=LanguageJson.getHtmlTextFlow("l_exchange_shop_have",[t])},e.prototype.onBuy=function(t){ShopManager.instance.s_shop_shop_item(ShopManager.instance.p_defId,this.m_shopJson.buy_item_list[0][1])},e.prototype.buySuccess=function(t,e){},e.prototype.refreshList=function(){this.m_typeList.source=this.m_dataArr,this.m_typeList.refresh()},e.prototype.removeRoleDr=function(){this.m_roleDr&&(this.m_roleDr.destory(),this.m_roleDr=null)},e.prototype.removeItemEf=function(){this.m_itemEf&&(this.m_itemEf.destory(),this.m_itemEf=null)},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i),Dispatch.remove(ExchangeShopRender.EVENT_SHOW_DETAIL,this.onDetail,this)},e.prototype.sureHide=function(e,i){void 0===e&&(e=null),void 0===i&&(i=null),this.removeRoleDr(),this.removeItemEf(),t.prototype.sureHide.call(this,e,i)},Object.defineProperty(e.prototype,"itemIdList",{get:function(){return[]},enumerable:!0,configurable:!0}),e}(PopupBase);__reflect(ExchangeShopUI.prototype,"ExchangeShopUI");var ExchangeShopRender=function(t){function e(){return t.call(this,"resource/eui_skins/exchangeShopUI/render/ExchangeShopRenderSkin.exml")||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this),this.m_itemIcon||(this.m_itemIcon=new ItemIcon,this.addChildAt(this.m_itemIcon,0),this.m_itemIcon.x=0,this.m_itemIcon.y=0,this.m_itemIcon.p_isShowTip=!1,this.m_itemIcon.scaleX=this.m_itemIcon.scaleY=.83)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickEvent,this)},e.prototype.onClickEvent=function(t){this.m_data&&this.m_data.id!=ShopManager.instance.p_defId&&(ShopManager.instance.p_defId=this.m_data.id,Dispatch.dispatch(e.EVENT_SHOW_DETAIL))},e.prototype.dataChanged=function(){this.checkComplete(this.dataChanged)&&(t.prototype.dataChanged.call(this),this.m_data=this.data,this.m_itemIcon.setData(this.m_data.item_list[0][0],this.m_data.item_list[0][1]),this.u_txtCost.text=this.m_data.buy_item_list[0][1]+"",this.u_itemIcon.source=ItemJson.getIconPath(this.m_data.buy_item_list[0][0]),Dispatch.register(e.EVENT_SHOW_DETAIL,this.setSelect,this,!0),Dispatch.register(ShopManager.SHOP_BUY_SUCCESS,this.buySuccess,this))},e.prototype.setSelect=function(){this.m_data.id==ShopManager.instance.p_defId?this.u_imgSelect.visible=!0:this.u_imgSelect.visible=!1},e.prototype.buySuccess=function(t,e){this.m_data&&this.m_data.id==t&&(FloatTipModule.instance.popTipLanguage("l_shop_exchange_success"),ItemFloatModule.instance.floatItem(this.m_itemIcon),SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_1015))},e.prototype.onAddStage=function(e){t.prototype.onAddStage.call(this,e),this.m_itemIcon&&(this.addChildAt(this.m_itemIcon,0),this.m_itemIcon.p_isShowTip=!1,this.m_itemIcon.scaleX=this.m_itemIcon.scaleY=.83),this.m_data&&this.m_itemIcon.setData(this.m_data.item_list[0][0],this.m_data.item_list[0][1])},e.prototype.onRemoveStage=function(e){t.prototype.onRemoveStage.call(this,e),this.m_itemIcon&&this.m_itemIcon.hide()},e.EVENT_SHOW_DETAIL="EVENT_SHOW_DETAIL",e}(ItemRendererBase);__reflect(ExchangeShopRender.prototype,"ExchangeShopRender");var FightUIModule=function(t){function e(){var e=t.call(this)||this;return e.p_itemList=[],e.p_iconList=[],e.p_simpleList=[],e.p_doubleList=[],e.p_obtainList=[],e.p_gaoList=[],e.p_huoqiuList=[],e.p_shunYiList=[],e.p_showList=[],e.p_forzentList=[],e.p_forzentUseList=[],e.p_guanBoList=[],e.p_daoGuangList=[],e.p_shouJiList=[],e.p_lotteryList=[],e.p_baoZhaList=[],e.p_pointXY=new egret.Point,e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.m_instance||(this.m_instance=new e),this.m_instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){Dispatch.register(StageManager.EVENT_STAGE_RESIZE,this.stageResize,this)},e.prototype.setResidualBlood=function(t,e){void 0===t&&(t=!0),void 0===e&&(e=0),DelayCallUtils.killDelayedCallsTo(this.closeResidualBlood,this),t?(null==this.m_residualBlood&&(this.m_residualBlood=new eui.Image("userMainUI_d_boss_coming"),this.m_residualBlood.scale9Grid=new egret.Rectangle(63,59,5,5),this.m_residualBlood.touchEnabled=!1),this.m_residualBlood.width=StageManager.instance.p_stageWidth,this.m_residualBlood.height=StageManager.instance.p_stageHeight,this.m_residualBlood.alpha=0,UIModule.instance.downUILayer3.addChild(this.m_residualBlood),this.tweenBloodEffect(),e>0&&DelayCallUtils.delayedCall(e,this.closeResidualBlood,this)):this.m_residualBlood&&(DisplayObjectUtils.removeFormParent(this.m_residualBlood),TweenMax.killTweensOf(this.m_residualBlood))},e.prototype.tweenBloodEffect=function(t){void 0===t&&(t=!0),TweenMax.to(this.m_residualBlood,.5,{alpha:t?1:0,ease:Sine.easeInOut,onComplete:this.tweenBloodEffect.bind(this),onCompleteParams:[!t]})},e.prototype.closeResidualBlood=function(){this.setResidualBlood(!1)},e.prototype.showOtherMana=function(t,e,i){if(void 0===i&&(i=11),!(t instanceof AvatarOtherPlayer)||PlayerManager.instance.p_playerIsShow){var s=Math.ceil(this.getCountByValue(i)/2);4>=s&&(s=4),FlyResModule.instance.flyOtherPlayMana(t,e,s)}},e.prototype.showMyMana=function(t,e,i,s){if(void 0===e&&(e=11),void 0===i&&(i=10),void 0===s&&(s=-1),null!=t.parent){var n=0;t.jsonMonster&&(n=t.jsonMonster.show_mana_type),s>-1&&(n=s);var o=t.jsonMonster.shake_mana_list;if(o&&o.length>0&&CameraModule.instance.setCameraShake(o[0],o[1]),n==FightSkillManager.type_shenlong){var a=void 0;a=this.p_doubleList.length>0?this.p_doubleList.shift():new ManaDouble,a.show(t,e),SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_4003)}else if(1==n){var r=void 0;r=this.p_simpleList.length>0?this.p_simpleList.shift():new ManaSimple,r.show(t,e)}else if(2==n){var _=void 0;_=this.p_obtainList.length>0?this.p_obtainList.shift():new ManaObtain,_.show(t,e),SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_3050)}else if(3==n){var h=void 0;h=this.p_gaoList.length>0?this.p_gaoList.shift():new ManaGao,h.show(t,e),SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_3050)}else{var l=void 0;l=this.p_iconList.length>0?this.p_iconList.shift():new ManaIcon,l.show(t,e)}this.showMyGold(t,e);var c=this.getCountByValue(i),m=Math.ceil(c/4);8>m&&(m=8),FlyResModule.instance.flyExpPlayer(PlayerManager.instance.p_mainPlayer,t,m,.8)}},e.prototype.showMyGold=function(t,e){for(var i=this.getCountByValue(e),s=0;i>s;s++){var n=void 0;n=this.p_itemList.length>0?this.p_itemList.shift():new ManaItem,0==s||s==Math.ceil(i/2)||s==i-1?n.show(t,.1*s,!0):n.show(t,.1*s)}},e.prototype.getCountByValue=function(t){this.m_manaList||(StaticDataJson.getData("attack_mana_list")?this.m_manaList=StaticDataJson.parseStrToList("attack_mana_list"):this.m_manaList=[[20,4],[100,5],[200,6],[300,7],[400,8],[500,9],[600,10],[800,11],[1200,14],[1500,15],[1700,20]]);for(var e=this.m_manaList[this.m_manaList.length-1][1],i=0;i<this.m_manaList.length;i++)if(t<this.m_manaList[i][0]){e=this.m_manaList[i][1];break}return e},e.prototype.showGuangBo=function(t,e,i,s){if(void 0===i&&(i=-1),void 0===s&&(s=null),!(t instanceof AvatarOtherPlayer)||PlayerManager.instance.p_playerIsShow&&PlayerManager.instance.p_playerEffectIsShow){var n;n=this.p_guanBoList.length>0?this.p_guanBoList.shift():new AttackGuanBo,n.showGuangBo(t,e,i,s)}},e.prototype.showDaoGuang=function(t,e,i,s,n){if(!(t instanceof AvatarOtherPlayer)||PlayerManager.instance.p_playerIsShow&&PlayerManager.instance.p_playerEffectIsShow){var o;o=this.p_daoGuangList.length>0?this.p_daoGuangList.shift():new AttackDaoGuang,o.showDaoGuang(t,e,i,s,n)}},e.prototype.showShouJi=function(t,e,i,s){if(void 0===i&&(i=0),void 0===s&&(s=0),null!=t){var n;n=this.p_shouJiList.length>0?this.p_shouJiList.shift():new AttackShouJi,n.showShouJi(t,e,i,s)}},e.prototype.showHuoQiu=function(t,e){if(null!=t&&null!=e){var i;i=this.p_huoqiuList.length>0?this.p_huoqiuList.shift():new AttackHuoQiu,i.showHuoQiu(t,e)}},e.prototype.showZhaDan=function(t,e){if(void 0===e&&(e=!1),null!=t){var i;i=this.p_baoZhaList.length>0?this.p_baoZhaList.shift():new BaozhaEffect,i.show(t,e)}},e.prototype.showForzen=function(t){var e;e=this.p_forzentList.length>0?this.p_forzentList.shift():new ForzenEffect,e.show(t)},e.prototype.showShunyi=function(t,e,i){var s;s=this.p_shunYiList.length>0?this.p_shunYiList.shift():new ShunYiEffect,s.show(t,e,i)},e.prototype.showEffect=function(t,e,i){var s;s=this.p_showList.length>0?this.p_showList.shift():new ShowEffect,s.show(t,e,i)},e.prototype.showMonsterComing=function(t){void 0===t&&(t=null),this.m_monsterComing||(this.m_monsterComing=new MonsterComing),this.m_monsterComing.show(t),this.setResidualBlood(!0,2),SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_2007)},e.prototype.showMonsterPreCome=function(t){this.m_monsterPre||(this.m_monsterPre=new MonsterPreCome),this.m_monsterPre.y=70,this.m_monsterPre.show(t),SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_2008)},e.prototype.hideMonsterPreCome=function(){this.m_monsterPre&&(this.m_monsterPre.hide(),this.m_monsterPre=null)},e.prototype.setStartSkill=function(t,e,i){var s=SceneItemModule.instance.getPlayer(t);if(s){switch(s.setAttackSkill(e,i),e){case FightSkillManager.type_lightning:s.setShenLong();break;case FightSkillManager.type_huoqiu:s.setHuoqiu();break;case FightSkillManager.type_dizhen:s.setDizhen();break;case FightSkillManager.type_shenlong:s.setShandianlian()}t==PlayerManager.instance.playerId&&this.setAttackSkill(e,i)}},e.prototype.showBossComing=function(t){void 0===t&&(t=0),this.m_bossComing||(this.m_bossComing=new BossComing),t>0?(this.m_bossComing.show(t),this.setResidualBlood(!0,3),SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_2007),DelayCallUtils.delayedCall(1,this.bossPlayEffect,this)):this.m_bossComing.hideClose()},e.prototype.showGodDragonBuf=function(t,e){this.m_godDragonEffect||(this.m_godDragonEffect=new GodDragonFlyEffect,this.m_godDragonEffect.x=t,this.m_godDragonEffect.y=e),this.m_godDragonEffect.show()},e.prototype.hideGodDragonBuf=function(){this.m_godDragonEffect&&this.m_godDragonEffect.hideClose()},e.prototype.bossPlayEffect=function(){var t=Math.floor(3*Math.random());0==t?SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_3601):1==t?SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_3602):SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_3603)},e.prototype.showBossEvent=function(){this.m_bossEvent||(this.m_bossEvent=new BossEventView),this.m_bossEvent.show()},e.prototype.showCountDown=function(t,e,i,s){void 0===s&&(s=null),SceneModule.instance.isMainScene||1e3*e-ServerTimeManager.instance.timerValue<=0||(this.m_countDown||(this.m_countDown=new CountDownView),this.m_countDown.y=70,this.m_countDown.show(t,1e3*e,i,s))},e.prototype.hideCountDown=function(){this.m_countDown&&(this.m_countDown.hide(),this.m_countDown=null)},e.prototype.showRageSkill=function(){this.m_rageSkill||(this.m_rageSkill=new RageSkill),this.m_rageSkill.show()},e.prototype.getAttackTime=function(t,e){return void 0===e&&(e=0),this.m_configAttack||(this.m_configAttack=StaticDataJson.parseStrToList("attack_effect_speed")),t/this.m_configAttack[0]*this.m_configAttack[1]+e},e.prototype.getPoolLottery=function(t,e){if(null!=t){var i;i=this.p_lotteryList.length>0?this.p_lotteryList.shift():new LotteryEffect,i.show(t,e)}},e.prototype.stageResize=function(){var t=StageManager.instance.p_stageWidth,e=StageManager.instance.p_stageHeight;this.m_residualBlood&&this.m_residualBlood.parent&&(this.m_residualBlood.width=t,this.m_residualBlood.height=e),this.m_rageSkill&&this.m_rageSkill.parent&&this.m_rageSkill.stageResize()},e.prototype.setAttackSkill=function(t,e){this.m_attackSkillView||(this.m_attackSkillView=new MainAttackSkillView),this.m_attackSkillView.show(t,e)},e.prototype.hideAttackSkill=function(){this.m_attackSkillView&&this.m_attackSkillView.hide()},e.prototype.geAvatarPartsUrl=function(t,e,i){void 0===i&&(i=TextureFrom.EFFECT);var s=HeroPartsJson.getData(t),n="",o=0;switch(e){case 1:n="wuqi/",o=s.icon_wuqi;break;case 2:n="daoguang/",o=s.icon_wuqi;break;case 3:n="parts/",o=s.icon_parts}return i+PublicCon.PATH_SCENE_WEAPON+n+o+"/"},e}(egret.HashObject);__reflect(FightUIModule.prototype,"FightUIModule");var AttackDaoGuang=function(){function t(){this.m_fps=12}return t.prototype.showDaoGuang=function(t,e,i,s,n){this.m_skillPlayer=t;var o=ActiveSkillJson.getData(n).fps.split("|");this.m_fps=Number(this.m_skillPlayer instanceof AvatarPlayer&&o.length>=2?o[this.m_skillPlayer.playerData.sex]:o[0]);var a=FightUIModule.instance.geAvatarPartsUrl(i,2);this.m_iconUrl=a+e+"_"+this.getTextureIdxByDirection(s)+".png",this.m_direction=s,TextureLoadManager.instance.requestLoadTextureAtlas(this.m_iconUrl,this,LoaderPriority.EFFECT)},t.prototype.onloadComplete=function(t){if(this.m_iconUrl==t){if(null==this.m_skillPlayer.mc)return void this.destory();this.m_iconMC?this.m_iconMC.resetTextures(TexturePool.instance.getTextureAtlas(this.m_iconUrl),this.m_fps):(this.m_iconMC=new MovieClip(TexturePool.instance.getTextureAtlas(this.m_iconUrl),this.m_fps),this.m_iconMC.touchEnabled=!1,this.m_iconMC.smoothing=!0),this.m_iconMC.currentFrame=1,this.m_iconMC.play(),this.m_iconMC.addEventListener(egret.Event.COMPLETE,this.skillPlayComplete,this),this.m_iconMC.anchorOffsetX=.5*this.m_iconMC.texture.textureWidth,this.m_iconMC.anchorOffsetY=.5*this.m_iconMC.texture.textureHeight,this.m_iconMC.x=this.m_skillPlayer.jsonAvatar.offset_list[0],this.m_iconMC.y=this.m_skillPlayer.jsonAvatar.offset_list[1],this.m_skillPlayer.addChild(this.m_iconMC),this.shiftDirectionHandle()}},t.prototype.shiftDirectionHandle=function(){5==this.m_direction||6==this.m_direction||7==this.m_direction?this.m_iconMC.scaleX=-1*this.m_iconMC.scaleX:0!=this.m_direction&&4!=this.m_direction&&(this.m_iconMC.scaleX=1*this.m_iconMC.scaleX)},t.prototype.skillPlayComplete=function(t){this.destory()},t.prototype.getTextureIdxByDirection=function(t){var e;switch(t){case 5:e=3;break;case 6:e=2;break;case 7:e=1;break;default:e=t}return e},t.prototype.destory=function(){TextureLoadManager.instance.closeLoad(this.m_iconUrl,this),null!=this.m_iconMC&&(this.m_iconMC.removeEventListener(egret.Event.COMPLETE,this.skillPlayComplete,this),DisplayObjectUtils.removeFormParent(this.m_iconMC),this.m_iconMC.removeEventListeners(),this.m_iconMC.removeFromParent(),this.m_iconMC.dispose(),this.m_iconMC=null),-1==FightUIModule.instance.p_daoGuangList.indexOf(this)&&FightUIModule.instance.p_daoGuangList.push(this)},t}();__reflect(AttackDaoGuang.prototype,"AttackDaoGuang",["ITextureLoadEvent"]);var AttackGuanBo=function(t){function e(){var e=t.call(this)||this;return e.m_initPoint=new egret.Point,e.m_goPoint=new egret.Point,e.m_time=0,e}return __extends(e,t),e.prototype.showGuangBo=function(t,e,i,s){void 0===s&&(s=null),this.m_parent=s,s?(this.m_initPoint.x=t.parent.x,this.m_initPoint.y=t.parent.y,this.m_goPoint.x=e.parent.x,this.m_goPoint.y=e.parent.y):(this.m_initPoint.x=t.x+t.pointCentered[0],this.m_initPoint.y=t.y+t.pointCentered[1],this.m_goPoint.x=e.x+e.pointCentered[0],this.m_goPoint.y=e.y+e.pointCentered[1]),0>=i?this.m_iconUrl=TextureFrom.EFFECT+PublicCon.PATH_EFFECT_PLAYER+"attackSkill/attack":this.m_iconUrl=FightUIModule.instance.geAvatarPartsUrl(i,3)+"guangbo",TextureLoadManager.instance.requestLoadTextureAtlas(this.m_iconUrl,this,LoaderPriority.EFFECT,!1)},e.prototype.onloadComplete=function(t){null==this.m_iconMC?(this.m_iconMC=new MovieClip(TexturePool.instance.getTextureAtlas(t)),this.m_iconMC.scaleX=this.m_iconMC.scaleY=.6):this.m_iconMC.resetTextures(TexturePool.instance.getTextureAtlas(t)),this.m_iconMC.anchorOffsetX=.5*this.m_iconMC.texture.textureWidth,this.m_iconMC.anchorOffsetY=.5*this.m_iconMC.texture.textureHeight,this.m_iconMC.play(),null!=this.m_parent?this.m_parent.addChild(this.m_iconMC):SceneLayerModule.instance.upEffectLayer.addChild(this.m_iconMC),this.m_iconMC.x=this.m_initPoint.x,this.m_iconMC.y=this.m_initPoint.y;var e=this.m_goPoint.y-this.m_initPoint.y,i=this.m_goPoint.x-this.m_initPoint.x,s=180*Math.atan2(e,i)/Math.PI,n=egret.Point.distance(this.m_goPoint,this.m_initPoint);this.m_iconMC.rotation=s;var o=FightUIModule.instance.getAttackTime(n);TweenLite.to(this.m_iconMC,.001*o,{x:this.m_goPoint.x,y:this.m_goPoint.y,ease:Linear.easeNone,onComplete:this.recover.bind(this)}),this.m_time=.001*o+2,TimeManager.instance.doLoop(this.timeGoto,this)},e.prototype.timeGoto=function(){this.m_time<=0&&this.recover(),this.m_time-=1},e.prototype.recover=function(){TimeManager.instance.clearTimer(this.timeGoto,this),this.setClose()},e.prototype.setClose=function(){TextureLoadManager.instance.closeLoad(this.m_iconUrl,this),null!=this.m_iconMC&&(DisplayObjectUtils.removeFormParent(this.m_iconMC),this.m_iconMC.removeEventListeners(),this.m_iconMC.removeFromParent(),this.m_iconMC.dispose(),this.m_iconMC.stop(),this.m_iconMC=null),-1==FightUIModule.instance.p_guanBoList.indexOf(this)&&FightUIModule.instance.p_guanBoList.push(this)},e}(egret.HashObject);__reflect(AttackGuanBo.prototype,"AttackGuanBo",["ITextureLoadEvent"]);var AttackHuoQiu=function(t){function e(){var e=t.call(this)||this;return e.m_initPoint=new egret.Point,e.m_goPoint=new egret.Point,e.m_time=0,e}return __extends(e,t),e.prototype.showHuoQiu=function(t,e){this.m_initPoint.x=t.x+t.pointCentered[0],this.m_initPoint.y=t.y+t.pointCentered[1],this.m_goPoint.x=e.x+e.pointCentered[0],this.m_goPoint.y=e.y+e.pointCentered[1];var i=TextureFrom.EFFECT+PublicCon.PATH_EFFECT_MONSTER+"huoqiu/huoQiuAttack";TextureLoadManager.instance.requestLoadTextureAtlas(i,this,LoaderPriority.EFFECT,!1)},e.prototype.onloadComplete=function(t){null==this.m_iconMC?(this.m_iconMC=new MovieClip(TexturePool.instance.getTextureAtlas(t)),this.m_iconMC.scaleX=this.m_iconMC.scaleY=.4):this.m_iconMC.resetTextures(TexturePool.instance.getTextureAtlas(t)),this.m_iconMC.anchorOffsetX=.5*this.m_iconMC.texture.textureWidth,this.m_iconMC.anchorOffsetY=.5*this.m_iconMC.texture.textureHeight,this.m_iconMC.play(),SceneLayerModule.instance.upEffectLayer.addChild(this.m_iconMC),this.m_iconMC.x=this.m_initPoint.x,this.m_iconMC.y=this.m_initPoint.y;var e=(this.m_goPoint.y-this.m_initPoint.y,this.m_goPoint.x-this.m_initPoint.x,egret.Point.distance(this.m_goPoint,this.m_initPoint)),i=FightUIModule.instance.getAttackTime(e,FightSkillManager.huoQiu_speed);FlyResModule.instance.p_startPoint.x=this.m_initPoint.x,FlyResModule.instance.p_startPoint.y=this.m_initPoint.y,FlyResModule.instance.p_endPoint.x=this.m_goPoint.x,FlyResModule.instance.p_endPoint.y=this.m_goPoint.y;var s=[],n=egret.Point.interpolate(FlyResModule.instance.p_startPoint,FlyResModule.instance.p_endPoint,.7);s.push(this.getRoundRandomPoint(n.x,n.y,150,260));var o=egret.Point.interpolate(FlyResModule.instance.p_startPoint,FlyResModule.instance.p_endPoint,.3);s.push(this.getRoundRandomPoint(o.x,o.y,200,120)),s.push({x:this.m_goPoint.x,y:this.m_goPoint.y}),TweenMax.to(this.m_iconMC,.001*i,{bezier:s,ease:Linear.easeNone,onComplete:this.recover.bind(this)}),this.m_time=.001*i+2,TimeManager.instance.doLoop(this.timeGoto,this)},e.prototype.timeGoto=function(){this.m_time<=0&&this.recover(),this.m_time-=1},e.prototype.recover=function(){TimeManager.instance.clearTimer(this.timeGoto,this),this.setClose()},e.prototype.setClose=function(){null!=this.m_iconMC&&(DisplayObjectUtils.removeFormParent(this.m_iconMC),this.m_iconMC.removeEventListeners(),this.m_iconMC.removeFromParent(),this.m_iconMC.dispose(),this.m_iconMC.stop(),this.m_iconMC=null),-1==FightUIModule.instance.p_huoqiuList.indexOf(this)&&FightUIModule.instance.p_huoqiuList.push(this)},e.prototype.getRoundRandomPoint=function(t,e,i,s){var n=2*Math.PI*Math.random(),o=(Math.random()*i+50)*Math.cos(n)+t,a=(Math.random()*s+150)*Math.sin(n)+e;return{x:o,y:a}},e}(egret.HashObject);__reflect(AttackHuoQiu.prototype,"AttackHuoQiu",["ITextureLoadEvent"]);var AttackShouJi=function(){function t(){}return t.prototype.showShouJi=function(t,e,i,s){this.m_voPlayer=t;
var n;switch(n=e?e.playerData.hero_arms_id:PlayerManager.instance.p_mainPlayer.playerData.hero_arms_id,s){case-1:this.m_iconUrl=TextureFrom.EFFECT+PublicCon.PATH_EFFECT_PLAYER+"attackSkill/attackShouJi";break;case FightSkillManager.type_huoqiu:this.m_iconUrl=TextureFrom.EFFECT+PublicCon.PATH_EFFECT_PLAYER+"attackSkill/huoQiuShouJi";break;case FightSkillManager.type_dizhen:this.m_iconUrl=TextureFrom.EFFECT+PublicCon.PATH_EFFECT_PLAYER+"attackSkill/diZhenShouJi";break;case FightSkillManager.type_baoza:this.m_iconUrl=TextureFrom.EFFECT+PublicCon.PATH_EFFECT_PLAYER+"attackSkill/zaDanShouJi";break;default:this.m_iconUrl=FightUIModule.instance.geAvatarPartsUrl(n,3)+"guangboshouji"}if(TextureLoadManager.instance.requestLoadTextureAtlas(this.m_iconUrl,this,LoaderPriority.EFFECT),i>0&&t instanceof AvatarPlayer&&this.m_voPlayer.jsonAvatar){this.m_hurtView||(this.m_hurtView=new NumberView("num_mana_j_"),this.m_hurtView.p_isAnchorOffsetX=!0,this.m_hurtView.setSpacingX([{key:"num_mana_j_l",spacing:110}]));var o=this.m_voPlayer.jsonAvatar.name_off_list[0],a=this.m_voPlayer.jsonAvatar.name_off_list[1]-50;this.m_hurtView.x=o,this.m_hurtView.y=a,this.m_voPlayer.addChild(this.m_hurtView),this.m_hurtView.setMsgString("l"+i),this.m_hurtView.scaleX=1,this.m_hurtView.scaleY=1,this.m_hurtView.alpha=1,TweenMax.from(this.m_hurtView,.5,{scaleX:2,scaleY:2});var r=[{x:this.m_hurtView.x,y:this.m_hurtView.y-40},{x:this.m_hurtView.x,y:this.m_hurtView.y+20}];EffectModule.instance.bezier(this.m_hurtView,900,r[0],r[1],Linear.easeNone,this.onPlayComplete.bind(this)),TweenMax.to(this.m_hurtView,.3,{delay:.7,alpha:0,scaleX:.3,scaleY:.3})}},t.prototype.onPlayComplete=function(){this.m_hurtView&&DisplayObjectUtils.removeFormParent(this.m_hurtView),this.setRemoveEff()},t.prototype.onloadComplete=function(t){if(this.m_iconUrl==t){if(null==this.m_voPlayer||null==this.m_voPlayer.mc||null==this.m_voPlayer.jsonAvatar)return void this.destory();this.m_iconMC?this.m_iconMC.resetTextures(TexturePool.instance.getTextureAtlas(this.m_iconUrl)):(this.m_iconMC=new MovieClip(TexturePool.instance.getTextureAtlas(this.m_iconUrl)),this.m_iconMC.touchEnabled=!1),this.m_iconMC.currentFrame=0,this.m_voPlayer.addChild(this.m_iconMC),this.m_iconMC.scaleX=1,this.m_iconMC.scaleY=1,this.m_iconMC.addEventListener(egret.Event.COMPLETE,this.skillPlayComplete,this),this.m_iconMC.anchorOffsetX=.5*this.m_iconMC.texture.textureWidth,this.m_iconMC.anchorOffsetY=.5*this.m_iconMC.texture.textureHeight;var e=this.m_voPlayer.pointCentered;this.m_iconMC.x=e[0],this.m_iconMC.y=e[1],this.m_voPlayer.jsonAvatar.shouji_off_list&&this.m_voPlayer.jsonAvatar.shouji_off_list[0]&&(this.m_iconMC.x+=this.m_voPlayer.jsonAvatar.shouji_off_list[0]),this.m_voPlayer.jsonAvatar.shouji_off_list&&this.m_voPlayer.jsonAvatar.shouji_off_list[1]&&(this.m_iconMC.y+=this.m_voPlayer.jsonAvatar.shouji_off_list[1]),this.m_voPlayer.jsonAvatar.shouji_off_list&&this.m_voPlayer.jsonAvatar.shouji_off_list[2]&&(this.m_iconMC.scaleX=this.m_voPlayer.jsonAvatar.shouji_off_list[2],this.m_iconMC.scaleY=this.m_voPlayer.jsonAvatar.shouji_off_list[3]),this.m_iconMC.play()}},t.prototype.skillPlayComplete=function(t){this.destory()},t.prototype.destory=function(){TextureLoadManager.instance.closeLoad(this.m_iconUrl,this),null!=this.m_iconMC&&(this.m_iconMC.removeEventListener(egret.Event.COMPLETE,this.skillPlayComplete,this),DisplayObjectUtils.removeFormParent(this.m_iconMC),this.m_iconMC.removeEventListeners(),this.m_iconMC.removeFromParent(),this.m_iconMC.dispose(),this.m_iconMC=null),this.setRemoveEff()},t.prototype.setRemoveEff=function(){this.m_iconMC&&this.m_iconMC.parent||this.m_hurtView&&this.m_hurtView.parent||-1==FightUIModule.instance.p_shouJiList.indexOf(this)&&FightUIModule.instance.p_shouJiList.push(this)},t}();__reflect(AttackShouJi.prototype,"AttackShouJi",["ITextureLoadEvent"]);var BossComing=function(t){function e(){var e=t.call(this)||this;return e.m_imgList=[],e.m_imgScrollWidth=209,e.m_imgScrollHeight=63,e.m_imgRoyList=[230,250,209],e.m_imgScrollList=[],e.m_imgUpList=[],e.m_imgDownList=[],e.touchChildren=!1,e.touchEnabled=!1,e}return __extends(e,t),e.prototype.show=function(t){if(!this.parent){TweenLite.killTweensOf(this),UIModule.instance.downUILayer3.addChild(this),this.setMc(),this.alpha=1,this.m_upImg.alpha=0,this.m_downImg.alpha=0,this.setBreatheImage(this.m_upImg),this.setBreatheImage(this.m_downImg),TimeManager.instance.doLoop(this.timeDo,this,40),Dispatch.register(StageManager.EVENT_STAGE_RESIZE,this.stageResize,this,!0);var e=MonsterJson.getAvatarPath(t);if(""!=e){var i=StageManager.instance.p_stageWidth/2,s=StageManager.instance.p_stageHeight/2;this.m_effectMonster.setMC(e),this.addChild(this.m_effectMonster),this.m_effectMonster.alpha=0,this.m_effectMonster.scaleX=.7,this.m_effectMonster.scaleY=.7,this.m_effectMonster.x=i-200,this.m_effectMonster.y=s+30,this.m_effectMonster.play(),TweenLite.to(this.m_effectMonster,.3,{delay:.3,alpha:1,scaleX:1,scaleY:1,x:i-150,y:s})}this.m_effect.alpha=0,TweenLite.to(this.m_effect,.2,{delay:.3,alpha:1,onComplete:this.showEffect.bind(this)}),this.m_times=5,TimeManager.instance.doLoop(this.timeOutBossComing,this)}},e.prototype.timeOutBossComing=function(){this.m_times<=0&&this.hideClose(),this.m_times-=1},e.prototype.setMc=function(){this.m_maskImg||(this.m_maskImg=new eui.Image("commonUI_box"),this.m_maskImg.scale9Grid=UIModule.instance.getRectangle(),this.m_maskImg.alpha=.3,this.addChild(this.m_maskImg)),this.m_upImg||(this.m_upImg=new eui.Image("bossHeadUI_men"),this.m_upImg.x=-15,this.m_upImg.scale9Grid=new egret.Rectangle(18,63,19,74),this.addChild(this.m_upImg)),this.m_downImg||(this.m_downImg=new eui.Image("bossHeadUI_men"),this.m_downImg.x=-15,this.m_downImg.scaleY=-1,this.m_downImg.scale9Grid=new egret.Rectangle(18,63,19,74),this.addChild(this.m_downImg));for(var t=0;4>t;t++){var e=new eui.Image("bossHeadUI_xian");(0==t||3==t)&&(e.scaleY=-1),e.x=-30,e.scale9Grid=new egret.Rectangle(11,3,8,24),this.addChild(e),this.m_imgList.push(e)}this.m_effectMonster||(this.m_effectMonster=new EffectMovieClip),this.m_effect||(this.m_effect=new EffectMovieClip,this.m_effect.setMC(PublicCon.PATH_EFFECT_MONSTER+"coming"),this.m_effect.onLoadCompleteFunc=this.loadCom.bind(this))},e.prototype.showEffect=function(){var t=StageManager.instance.p_stageWidth,e=StageManager.instance.p_stageHeight;this.m_effect.x=.5*t,this.m_effect.y=.5*e,this.m_effect.scaleX=1,this.m_effect.scaleY=1,this.m_effect.alpha=1,this.addChild(this.m_effect),this.m_effect.play()},e.prototype.loadCom=function(){this.m_effect.mc.addEventListener(egret.Event.COMPLETE,this.playCom,this)},e.prototype.playCom=function(){this.m_effect.mc.stop(),this.m_effect.mc.removeEventListener(egret.Event.COMPLETE,this.playCom,this);var t=StageManager.instance.p_stageWidth;TweenLite.killTweensOf(this.m_effectMonster),TweenLite.to(this.m_effect,.3,{alpha:0,scaleX:.2,scaleY:.2}),TweenLite.to(this.m_effectMonster,.3,{alpha:0,x:.5*t,scaleX:.2,scaleY:.2,onComplete:this.stopEffect.bind(this)})},e.prototype.stopEffect=function(){this.m_effect.stop(),TweenLite.killTweensOf(this.m_effect),DisplayObjectUtils.removeFormParent(this.m_effect),this.m_effect.mc&&this.m_effect.mc.removeEventListener(egret.Event.COMPLETE,this.playCom,this),this.m_effectMonster.stop(),TweenLite.killTweensOf(this.m_effectMonster),DisplayObjectUtils.removeFormParent(this.m_effectMonster)},e.prototype.timeDo=function(){this.moveImage(this.m_imgUpList,1),this.moveImage(this.m_imgDownList,-1)},e.prototype.moveImage=function(t,e){for(var i in t)t[i].x-=5*e;1==e?t[0]&&t[0].x<=-this.m_imgScrollWidth&&this.m_imgScrollList.push(t.shift()):t[0]&&t[0].x>=StageManager.instance.p_stageWidth&&this.m_imgScrollList.push(t.shift());var s=t[t.length-1];1==e?s&&s.x+this.m_imgScrollWidth<=StageManager.instance.p_stageWidth&&this.setAddImage(t,e):s&&s.x>=0&&this.setAddImage(t,e)},e.prototype.setImageScroll=function(t,e){var i=0;if(t.length>0){var s=t[t.length-1];i=1==e?s.x+this.m_imgScrollWidth:s.x}var n=0;StageManager.instance.p_stageWidth>i&&(n=Math.ceil((StageManager.instance.p_stageWidth-i)/this.m_imgScrollWidth));for(var o=0;n>o;o++)this.setAddImage(t,e)},e.prototype.setAddImage=function(t,e){var i;i=this.m_imgScrollList.length>0?this.m_imgScrollList.shift():new eui.Image("bossHeadUI_coming");var s=t[t.length-1];s?i.x=s.x+this.m_imgScrollWidth*e:1==e?i.x=0:i.x=StageManager.instance.p_stageWidth-this.m_imgScrollWidth,1==e?i.y=this.m_imgRoyList[2]:i.y=StageManager.instance.p_stageHeight-this.m_imgRoyList[2]-this.m_imgScrollHeight,this.addChild(i),t.push(i)},e.prototype.stageResize=function(){var t=StageManager.instance.p_stageWidth,e=StageManager.instance.p_stageHeight;this.m_maskImg&&null!=this.m_maskImg.parent&&(this.m_maskImg.width=t,this.m_maskImg.height=e),this.m_effect&&this.m_effect.parent&&(this.m_effect.x=.5*t,this.m_effect.y=.5*e),TweenLite.killTweensOf(this.m_effectMonster),this.m_effectMonster.alpha=1,this.m_effectMonster.scaleX=1,this.m_effectMonster.scaleY=1,this.m_effectMonster.x=t/2-150,this.m_effectMonster.y=e/2,this.m_upImg.width=t+30,this.m_downImg.width=t+30,this.m_downImg.y=e;for(var i=0;i<this.m_imgList.length;i++)this.m_imgList[i].width=t+60,0==i||1==i?this.m_imgList[i].y=this.m_imgRoyList[i]:this.m_imgList[i].y=e-this.m_imgRoyList[i-2];this.setImageScroll(this.m_imgUpList,1),this.setImageScroll(this.m_imgDownList,-1)},e.prototype.setBreatheImage=function(t){1==t.alpha?TweenLite.to(t,.8,{alpha:0,ease:Linear.easeNone,onComplete:this.setBreatheImage.bind(this),onCompleteParams:[t]}):TweenLite.to(t,1.1,{alpha:1,ease:Linear.easeNone,onComplete:this.setBreatheImage.bind(this),onCompleteParams:[t]})},e.prototype.hideClose=function(){TimeManager.instance.clearTimer(this.timeOutBossComing,this),TweenLite.killTweensOf(this.m_upImg),TweenLite.killTweensOf(this.m_downImg),TimeManager.instance.clearTimer(this.timeDo,this),Dispatch.remove(StageManager.EVENT_STAGE_RESIZE,this.stageResize,this),null!=this.parent&&TweenLite.to(this,.5,{alpha:0,onComplete:this.sureHide.bind(this)})},e.prototype.sureHide=function(){this.stopEffect(),DisplayObjectUtils.removeFormParent(this)},e}(egret.DisplayObjectContainer);__reflect(BossComing.prototype,"BossComing");var MonsterComing=function(t){function e(){var e=t.call(this)||this;return e.m_maskImg||(e.m_maskImg=new eui.Image("commonUI_box"),e.m_maskImg.scale9Grid=UIModule.instance.getRectangle(),e.m_maskImg.alpha=0,e.addChild(e.m_maskImg)),e}return __extends(e,t),e.prototype.show=function(t){if(void 0===t&&(t=null),!this.parent){this.m_backFunc=t,this.m_effect||(this.m_effect=new EffectMovieClip,this.m_effect.onCompleteFunc=this.comPlay.bind(this),this.m_effect.onLoadCompleteFunc=this.loadCom.bind(this));var e="monsterscoming";this.m_maskImg.alpha=.3,this.m_effect.setMC(PublicCon.PATH_EFFECT_MONSTER+e),this.m_effect.scaleX=2,this.m_effect.scaleY=2,this.addChild(this.m_effect),this.m_effect.play(10,1),UIModule.instance.downUILayer3.addChild(this),Dispatch.register(StageManager.EVENT_STAGE_RESIZE,this.stageResize,this,!0)}},e.prototype.loadCom=function(){TweenLite.to(this.m_maskImg,.2,{delay:.12,alpha:.8}),TweenLite.to(this.m_maskImg,.2,{delay:.3,alpha:.3}),TweenLite.to(this.m_maskImg,.2,{delay:1,alpha:.8}),TweenLite.to(this.m_maskImg,.2,{delay:1.2,alpha:.3}),TweenLite.to(this.m_maskImg,.2,{delay:1.5,alpha:.8}),TweenLite.to(this.m_maskImg,.2,{delay:1.7,alpha:.3})},e.prototype.stageResize=function(){var t=StageManager.instance.p_stageWidth,e=StageManager.instance.p_stageHeight;this.m_maskImg&&null!=this.m_maskImg.parent&&(this.m_maskImg.width=t,this.m_maskImg.height=e),this.m_effect&&(this.m_effect.x=.5*t,this.m_effect.y=.5*e)},e.prototype.comPlay=function(){null!=this.m_backFunc&&this.m_backFunc(),this.hide()},e.prototype.hide=function(){this.m_effect&&(this.m_effect.destory(),this.m_effect=null),TweenMax.killTweensOf(this.m_maskImg),this.m_backFunc=null,DisplayObjectUtils.removeFormParent(this)},e}(egret.DisplayObjectContainer);__reflect(MonsterComing.prototype,"MonsterComing");var MonsterPreCome=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e.touchChildren=!1,e}return __extends(e,t),e.prototype.show=function(t){this.parent||(this.m_effect||(this.m_effect=new EffectMovieClip,this.m_effect.scaleX=this.m_effect.scaleY=1.2,this.m_effect.onCompleteFunc=this.comPlay.bind(this)),this.m_effect.setMC(PublicCon.PATH_EFFECT_MONSTER+"yuchaoTishi"),this.addChild(this.m_effect),this.m_effect.gotoAndPlay(12),UIModule.instance.downUILayer3.addChild(this),this.m_endTime=t,Dispatch.register(StageManager.EVENT_STAGE_RESIZE,this.stageResize,this,!0))},e.prototype.stageResize=function(){this.x=StageManager.instance.p_stageWidth/2},e.prototype.comPlay=function(){this.m_numberTime||(this.m_numberTime=new NumberView("num_max_time_",0,-10),this.m_numberTime.p_isAnchorOffsetX=!0,this.m_numberTime.x=0,this.m_numberTime.y=60),this.addChild(this.m_numberTime),TimeManager.instance.doLoop(this.refreshTime,this,1e3)},e.prototype.refreshTime=function(){var t=this.m_endTime-ServerTimeManager.instance.timer;return 0>t?void this.hide():(this.m_numberTime.numValue=t,this.m_numberTime.alpha=1,this.m_numberTime.scaleX=this.m_numberTime.scaleY=1.2,TweenLite.killTweensOf(this.m_numberTime),void TweenLite.to(this.m_numberTime,1,{scaleX:.6,scaleY:.6,alpha:0,ease:Back.easeIn}))},e.prototype.hide=function(){this.m_effect&&(this.m_effect.destory(),this.m_effect=null),TimeManager.instance.clearTimer(this.refreshTime,this),DisplayObjectUtils.removeFormParent(this)},e}(egret.DisplayObjectContainer);__reflect(MonsterPreCome.prototype,"MonsterPreCome");var BaozhaEffect=function(){function t(){this.m_imgUrl=PublicCon.PATH_EFFECT_MONSTER+"baozha/baozha_guang.png",this.m_initPoint=new egret.Point,this.m_isToBag=!1}return t.prototype.show=function(t,e){void 0===e&&(e=!1),this.m_isToBag=e,this.m_initPoint.x=t.x+t.pointCentered[0],this.m_initPoint.y=t.y+t.pointCentered[1],this.m_attAvatar=t,this.m_imgGuang||(this.m_imgGuang=new eui.Image(this.m_imgUrl),this.m_imgGuang.width=1569,this.m_imgGuang.height=1028,this.m_imgGuang.anchorOffsetX=this.m_imgGuang.width/2,this.m_imgGuang.anchorOffsetY=this.m_imgGuang.height/2,this.m_imgGuang.touchEnabled=!1,this.m_imgGuang.blendMode=egret.BlendMode.ADD),this.m_iconUrl1=TextureFrom.EFFECT+PublicCon.PATH_EFFECT_MONSTER+"baozha/baozha1",this.m_iconUrl2=TextureFrom.EFFECT+PublicCon.PATH_EFFECT_MONSTER+"baozha/baozha2",TextureLoadManager.instance.requestLoadTextureAtlas(this.m_iconUrl1,this,LoaderPriority.EFFECT,!1),TextureLoadManager.instance.requestLoadTextureAtlas(this.m_iconUrl2,this,LoaderPriority.EFFECT,!1)},t.prototype.onloadComplete=function(t){t==this.m_iconUrl1?(null==this.m_iconMC1?(this.m_iconMC1=new MovieClip(TexturePool.instance.getTextureAtlas(t)),this.m_iconMC1.scaleX=this.m_iconMC1.scaleY=1.5):this.m_iconMC1.resetTextures(TexturePool.instance.getTextureAtlas(t)),this.m_iconMC1.x=this.m_initPoint.x,this.m_iconMC1.y=this.m_initPoint.y,this.m_iconMC1.touchEnabled=!1,this.m_iconMC1.anchorOffsetX=.5*this.m_iconMC1.texture.textureWidth,this.m_iconMC1.anchorOffsetY=.5*this.m_iconMC1.texture.textureHeight,this.m_iconMC1.blendMode=egret.BlendMode.ADD,this.m_iconMC1.addEventListener(egret.Event.COMPLETE,this.playComplete1,this)):(null==this.m_iconMC2?(this.m_iconMC2=new MovieClip(TexturePool.instance.getTextureAtlas(t)),this.m_iconMC2.scaleX=this.m_iconMC2.scaleY=2):this.m_iconMC2.resetTextures(TexturePool.instance.getTextureAtlas(t)),this.m_iconMC2.touchEnabled=!1,this.m_iconMC2.x=this.m_initPoint.x-40,this.m_iconMC2.y=this.m_initPoint.y,this.m_iconMC2.anchorOffsetX=.5*this.m_iconMC2.texture.textureWidth,this.m_iconMC2.anchorOffsetY=.5*this.m_iconMC2.texture.textureHeight,this.m_iconMC2.addEventListener(egret.Event.COMPLETE,this.playComplete2,this),this.m_iconMC2.addFrameScript(2,this.showImgGuang.bind(this))),this.m_iconMC1&&this.m_iconMC2&&(TweenLite.to(this.m_attAvatar,.3,{alpha:0,onComplete:this.hideMonster.bind(this)}),this.startPlay())},t.prototype.hideMonster=function(){SceneItemModule.instance.deleteMonster(this.m_attAvatar.dataMonster.scene_monster_id),this.m_attAvatar.destory(),this.m_attAvatar=null},t.prototype.showImgGuang=function(){this.m_imgGuang.alpha=1,TweenLite.to(this.m_imgGuang,.5,{alpha:0})},t.prototype.startPlay=function(){this.m_imgGuang.alpha=0,this.m_imgGuang.x=this.m_initPoint.x,this.m_imgGuang.y=this.m_initPoint.y,SceneLayerModule.instance.upEffectLayer.addChild(this.m_iconMC1),SceneLayerModule.instance.upEffectLayer.addChild(this.m_imgGuang),SceneLayerModule.instance.upEffectLayer.addChild(this.m_iconMC2),this.m_iconMC1.play(),this.m_iconMC2.play(),ShockManager.instance.shockHandler(StageManager.instance.scenelayer,40,40,40,200)},t.prototype.playComplete1=function(){TextureLoadManager.instance.closeLoad(this.m_iconUrl1,this),null!=this.m_iconMC1&&(this.m_iconMC1.removeEventListener(egret.Event.COMPLETE,this.playComplete1,this),DisplayObjectUtils.removeFormParent(this.m_iconMC1),this.m_iconMC1.removeEventListeners(),this.m_iconMC1.removeFromParent(),this.m_iconMC1.dispose(),this.m_iconMC1.stop(),this.m_iconMC1=null),this.setClose()},t.prototype.playComplete2=function(){TextureLoadManager.instance.closeLoad(this.m_iconUrl2,this),null!=this.m_iconMC2&&(this.m_iconMC2.removeEventListener(egret.Event.COMPLETE,this.playComplete2,this),DisplayObjectUtils.removeFormParent(this.m_iconMC2),this.m_iconMC2.removeEventListeners(),this.m_iconMC2.removeFromParent(),this.m_iconMC2.dispose(),this.m_iconMC2.stop(),this.m_iconMC2=null),this.setClose()},t.prototype.setClose=function(){this.m_iconMC1||this.m_iconMC1||(this.m_isToBag&&FightManager.instance.s_get_award(12),this.m_isToBag=!1,DisplayObjectUtils.removeFormParent(this.m_imgGuang),this.m_imgGuang=null,RES.destroyRes(this.m_imgUrl),-1==FightUIModule.instance.p_baoZhaList.indexOf(this)&&FightUIModule.instance.p_baoZhaList.push(this))},t}();__reflect(BaozhaEffect.prototype,"BaozhaEffect",["ITextureLoadEvent"]);var LotteryEffect=function(){function t(){}return t.prototype.show=function(t,e){var i=1==e?"lotteryPool/lotteryFirst":"lotteryPool/lotterySecond";this.m_effect||(this.m_effect=new EffectMovieClip,this.m_effect.onCompleteFunc=this.playComplete.bind(this)),this.m_effect.scaleX=this.m_effect.scaleY=2,this.m_effect.setMC(PublicCon.PATH_EFFECT_MONSTER+i+"_2");var s=t.xyFoot;this.m_effect.x=s[0]+10,this.m_effect.y=s[1]-20,this.m_effect.play(12,1),SceneLayerModule.instance.upEffectLayer.addChild(this.m_effect),this.m_effect2||(this.m_effect2=new EffectMovieClip),this.m_effect2.scaleX=this.m_effect2.scaleY=2,this.m_effect2.setMC(PublicCon.PATH_EFFECT_MONSTER+i+"_1");var n=t.pointCentered;this.m_effect2.x=t.x+n[0]-10,this.m_effect2.y=t.y+n[1]+50,this.m_effect2.play(12,1),SceneLayerModule.instance.upEffectLayer.addChild(this.m_effect2)},t.prototype.playComplete=function(){this.m_effect&&(this.m_effect.destory(),this.m_effect=null),this.m_effect2&&(this.m_effect2.destory(),this.m_effect2=null),FightUIModule.instance.p_lotteryList.push(this)},t}();__reflect(LotteryEffect.prototype,"LotteryEffect");var ShowEffect=function(){function t(){}return t.prototype.show=function(t,e,i){this.m_eff||(this.m_eff=new EffectMovieClip,this.m_eff.onCompleteFunc=this.removeEffect.bind(this)),this.m_eff.setMC(t),this.m_eff.x=e[0],this.m_eff.y=e[1],i.addChild(this.m_eff),this.m_eff.play(12,1)},t.prototype.removeEffect=function(){this.m_eff&&(this.m_eff.destory(),this.m_eff=null),FightUIModule.instance.p_showList.indexOf(this)&&FightUIModule.instance.p_showList.push(this)},t}();__reflect(ShowEffect.prototype,"ShowEffect");var ShunYiEffect=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.show=function(t,e,i){var s=t.xyCentered;this.m_eff1||(this.m_eff1=new EffectMovieClip,this.m_eff1.setMC(PublicCon.PATH_EFFECT_MONSTER+"shunyi/shanxian1")),this.m_eff1.x=s[0],this.m_eff1.y=s[1],SceneLayerModule.instance.upEffectLayer.addChild(this.m_eff1),this.m_eff1.play(7,1),this.m_eff2||(this.m_eff2=new EffectMovieClip,this.m_eff2.setMC(PublicCon.PATH_EFFECT_MONSTER+"shunyi/shanxian2")),this.m_eff2.x=s[0],this.m_eff2.y=s[1],SceneLayerModule.instance.liveThingsLayer.addChildAt(this.m_eff2,0),this.m_eff2.play(12,1),TweenLite.to(t,.1,{alpha:0,onComplete:this.nextShow.bind(this),onCompleteParams:[t,e,i]}),TweenLite.to(t,.2,{delay:.11,alpha:1}),DelayCallUtils.delayedCall(2,this.timeOver,this)},e.prototype.nextShow=function(t,e,i){t.setPos(e,i);var s=t.xyCentered;this.m_mc1||(this.m_mc1=new EffectMovieClip,this.m_mc1.setMC(PublicCon.PATH_EFFECT_MONSTER+"shunyi/teleport1")),this.m_mc1.x=s[0],this.m_mc1.y=s[1],SceneLayerModule.instance.upEffectLayer.addChild(this.m_mc1),this.m_mc1.play(7,1),this.m_mc2||(this.m_mc2=new EffectMovieClip,this.m_mc2.setMC(PublicCon.PATH_EFFECT_MONSTER+"shunyi/teleport2")),this.m_mc2.x=s[0],this.m_mc2.y=s[1],SceneLayerModule.instance.liveThingsLayer.addChildAt(this.m_mc2,0),this.m_mc2.play(12,1)},e.prototype.timeOver=function(){DelayCallUtils.killDelayedCallsTo(this.timeOver,this),this.m_eff1&&(this.m_eff1.destory(),this.m_eff1=null),this.m_eff2&&(this.m_eff2.destory(),this.m_eff2=null),this.m_mc1&&(this.m_mc1.destory(),this.m_mc1=null),this.m_mc2&&(this.m_mc2.destory(),this.m_mc2=null),-1==FightUIModule.instance.p_shunYiList.indexOf(this)&&FightUIModule.instance.p_shunYiList.push(this)},e}(egret.HashObject);__reflect(ShunYiEffect.prototype,"ShunYiEffect");var ManaDouble=function(t){function e(){var e=t.call(this)||this;return e.m_randomList=[],e.m_curr=0,e.touchChildren=!1,e.touchEnabled=!1,e}return __extends(e,t),e.prototype.playSoundEffect=function(){SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_4003)},e.prototype.playSoundEffectNa=function(){SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_3501)},e.prototype.setNumList=function(t,e){this.m_randomList=[];for(var i=0,s=Math.floor(e/t),n=0;t>n;n++)if(n!=t-1){var o=5-Math.floor(10*Math.random());s>Math.abs(o)?(i+=s+o,this.m_randomList.push(s+o)):(i+=s,this.m_randomList.push(s))}else e-i>0&&this.m_randomList.push(e-i)},e.prototype.showMc=function(){for(var t=0;t<this.m_randomList.length;t++){var e=new NumberView("num_sy_",0,-6);e.p_isAnchorOffsetX=!0,e.p_isAnchorOffsetY=!0,e.setMsgString("j"+this.m_randomList[t]),this.patentMc.addChild(e),e.alpha=0,e.scaleX=e.scaleY=1.3,e.x=this.x,e.y=this.m_roy,TweenLite.to(e,.2,{delay:.1+.1*t,scaleX:1,scaleY:1,alpha:1,y:this.m_roy-40,ease:Circ.easeIn,onStart:this.onStartPlay.bind(this),onStartParams:[t,this.m_randomList[t]],onComplete:this.onNextPlay.bind(this),onCompleteParams:[e]})}},e.prototype.onStartPlay=function(t,e){SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_4002),0!=t&&(this.m_curr+=e,this.m_manaNum.setNumValue(this.m_curr,.2))},e.prototype.onNextPlay=function(t){TweenLite.to(t,.2,{y:this.m_roy-80,scaleX:.7,scaleY:.7,ease:Linear.easeNone,onComplete:this.onNextPlay1.bind(this),onCompleteParams:[t]})},e.prototype.onNextPlay1=function(t){TweenLite.to(t,.5,{y:this.m_roy-300,ease:Linear.easeNone,onComplete:this.onNextPlay2.bind(this),onCompleteParams:[t]})},e.prototype.onNextPlay2=function(t){TweenLite.to(t,.2,{y:this.m_roy-310,alpha:0,ease:Linear.easeNone,onComplete:this.onOutPlay.bind(this),onCompleteParams:[t]})},e.prototype.onOutPlay=function(t){t.hide(),t=null},e.prototype.show=function(t,e){var i=12+Math.floor(6*Math.random());this.setNumList(i,e),this.m_curr=this.m_randomList[0],DelayCallUtils.delayedCall(.6,this.showMc,this),DelayCallUtils.delayedCall(1,this.playSoundEffectNa,this),SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_3002),this.scaleX=1,this.scaleY=1,this.alpha=1,this.m_roy=.5*StageManager.instance.p_stageHeight+100,this.x=.5*StageManager.instance.p_stageWidth,this.y=this.m_roy,this.patentMc.addChild(this),this.m_mc||(this.m_mc=new EffectMovieClip,this.m_mc.setMC(PublicCon.PATH_EFFECT_MONSTER+"shouyi/shouyiDi2")),this.addChild(this.m_mc),this.m_mc.play(12),this.m_mc.scaleX=0,TweenLite.to(this.m_mc,.4,{scaleX:1,ease:Elastic.easeOut}),this.m_manaNum||(this.m_manaNum=new NumberView("num_sy_",0,-12),this.m_manaNum.p_isDoller=!0,this.m_manaNum.p_isAnchorOffsetX=!0,this.m_manaNum.y=-20),this.addChild(this.m_manaNum),this.m_manaNum.numValue=this.m_curr,this.m_manaNum.scaleX=0,TweenLite.to(this.m_manaNum,.4,{delay:.2,scaleX:1,ease:Elastic.easeOut}),this.m_mcBaoz||(this.m_mcBaoz=new EffectMovieClip,this.m_mcBaoz.setMC(PublicCon.PATH_EFFECT_MONSTER+"shouyi/shouyiDiBao2"),this.m_mcBaoz.blendMode=egret.BlendMode.ADD),this.addChild(this.m_mcBaoz),this.m_mcBaoz.play(12,1),TweenLite.to(this,.4,{delay:2.6,scaleX:.2,scaleY:.2,alpha:0,ease:Back.easeIn,onComplete:this.onPlayComplete.bind(this)})},e.prototype.onPlayComplete=function(){this.m_mc&&(this.m_mc.destory(),this.m_mc=null),this.m_mcBaoz&&(this.m_mcBaoz.destory(),this.m_mcBaoz=null),this.m_manaNum&&(this.m_manaNum.hide(),this.m_manaNum=null),DisplayObjectUtils.removeFormParent(this),-1==FightUIModule.instance.p_doubleList.indexOf(this)&&FightUIModule.instance.p_doubleList.push(this)},Object.defineProperty(e.prototype,"patentMc",{get:function(){return StageManager.instance.sceneUILayer},enumerable:!0,configurable:!0}),e}(egret.DisplayObjectContainer);__reflect(ManaDouble.prototype,"ManaDouble");var ManaGao=function(t){function e(){var e=t.call(this)||this;return e.m_randomList=[],e.m_curr=0,e.touchChildren=!1,e.touchEnabled=!1,e}return __extends(e,t),e.prototype.playSoundEffect=function(){SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_4003)},e.prototype.playSoundEffectNa=function(){SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_3501)},e.prototype.setNumList=function(t,e){this.m_randomList=[];for(var i=0,s=Math.floor(e/t),n=0;t>n;n++)if(n!=t-1){var o=5-Math.floor(10*Math.random());s>Math.abs(o)?(i+=s+o,this.m_randomList.push(s+o)):(i+=s,this.m_randomList.push(s))}else e-i>0&&this.m_randomList.push(e-i)},e.prototype.showMc=function(){for(var t=0;t<this.m_randomList.length;t++){var e=new NumberView("num_sy_",0,-6);e.p_isAnchorOffsetX=!0,e.p_isAnchorOffsetY=!0,e.setMsgString("j"+this.m_randomList[t]),this.patentMc.addChild(e),e.alpha=0,e.scaleX=e.scaleY=1.3,e.x=this.x,e.y=this.m_roy,TweenLite.to(e,.2,{delay:.1+.1*t,scaleX:1,scaleY:1,alpha:1,y:this.m_roy-40,ease:Circ.easeIn,onStart:this.onStartPlay.bind(this),onStartParams:[t,this.m_randomList[t]],onComplete:this.onNextPlay.bind(this),onCompleteParams:[e]})}},e.prototype.onStartPlay=function(t,e){SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_4002),0!=t&&(this.m_curr+=e,this.m_manaNum.setNumValue(this.m_curr,.2))},e.prototype.onNextPlay=function(t){TweenLite.to(t,.2,{y:this.m_roy-80,scaleX:.7,scaleY:.7,ease:Linear.easeNone,onComplete:this.onNextPlay1.bind(this),onCompleteParams:[t]})},e.prototype.onNextPlay1=function(t){TweenLite.to(t,.5,{y:this.m_roy-300,ease:Linear.easeNone,onComplete:this.onNextPlay2.bind(this),onCompleteParams:[t]})},e.prototype.onNextPlay2=function(t){TweenLite.to(t,.2,{y:this.m_roy-310,alpha:0,ease:Linear.easeNone,onComplete:this.onOutPlay.bind(this),onCompleteParams:[t]})},e.prototype.onOutPlay=function(t){t.hide(),t=null},e.prototype.show=function(t,e){var i=18+Math.floor(6*Math.random());this.setNumList(i,e),this.m_curr=this.m_randomList[0],DelayCallUtils.delayedCall(.6,this.showMc,this),DelayCallUtils.delayedCall(1,this.playSoundEffectNa,this),SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_3002),this.scaleX=1,this.scaleY=1,this.alpha=1,this.m_roy=.5*StageManager.instance.p_stageHeight+100,this.x=.5*StageManager.instance.p_stageWidth,this.y=this.m_roy,this.patentMc.addChild(this),this.m_mc||(this.m_mc=new EffectMovieClip,this.m_mc.setMC(PublicCon.PATH_EFFECT_MONSTER+"shouyi/shouyiDi3")),this.addChild(this.m_mc),this.m_mc.play(12),this.m_mc.scaleY=1.3,this.m_mc.scaleX=0,TweenLite.to(this.m_mc,.4,{scaleX:1.3,ease:Elastic.easeOut}),this.m_manaNum||(this.m_manaNum=new NumberView("num_sy_",0,-12),this.m_manaNum.p_isDoller=!0,this.m_manaNum.p_isAnchorOffsetX=!0,this.m_manaNum.y=-20),this.addChild(this.m_manaNum),this.m_manaNum.numValue=this.m_curr,this.m_manaNum.scaleX=0,TweenLite.to(this.m_manaNum,.4,{delay:.2,scaleX:1,ease:Elastic.easeOut}),this.m_mcBaoz||(this.m_mcBaoz=new EffectMovieClip,this.m_mcBaoz.setMC(PublicCon.PATH_EFFECT_MONSTER+"shouyi/shouyiDiBao3"),this.m_mcBaoz.blendMode=egret.BlendMode.ADD),this.addChild(this.m_mcBaoz),this.m_mcBaoz.play(12,1),TweenLite.to(this,.4,{delay:2.8,scaleX:.2,scaleY:.2,alpha:0,ease:Back.easeIn,onComplete:this.onPlayComplete.bind(this)})},e.prototype.onPlayComplete=function(){this.m_mc&&(this.m_mc.destory(),this.m_mc=null),this.m_mcBaoz&&(this.m_mcBaoz.destory(),this.m_mcBaoz=null),this.m_manaNum&&(this.m_manaNum.hide(),this.m_manaNum=null),DisplayObjectUtils.removeFormParent(this),-1==FightUIModule.instance.p_gaoList.indexOf(this)&&FightUIModule.instance.p_gaoList.push(this)},Object.defineProperty(e.prototype,"patentMc",{get:function(){return StageManager.instance.sceneUILayer},enumerable:!0,configurable:!0}),e}(egret.DisplayObjectContainer);__reflect(ManaGao.prototype,"ManaGao");var ManaIcon=function(t){function e(){var e=t.call(this)||this;return e.touchChildren=!1,e.touchEnabled=!1,e}return __extends(e,t),e.prototype.playSoundEffect=function(){SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_4003)},e.prototype.show=function(t,e){SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_3004),this.x=t.x+t.jsonAvatar.name_off_list[0],this.y=t.y+t.jsonAvatar.name_off_list[1]+50,this.m_manaNum||(this.m_manaNum=new NumberView("num_sy_",0,-6),this.m_manaNum.p_isAnchorOffsetX=!0,this.m_manaNum.p_isDoller=!0),this.addChild(this.m_manaNum),this.m_manaNum.numValue=e,SceneLayerModule.instance.upEffectLayer.addChild(this),this.alpha=1,this.scaleX=0,this.scaleY=0,TweenLite.to(this,.4,{scaleX:1,scaleY:1,ease:Circ.easeIn}),TweenLite.to(this,.4,{delay:1.6,scaleX:.2,scaleY:.2,alpha:0,ease:Circ.easeIn,onComplete:this.onPlayComplete.bind(this)})},e.prototype.onPlayComplete=function(){this.m_manaNum&&(this.m_manaNum.hide(),this.m_manaNum=null),DisplayObjectUtils.removeFormParent(this),-1==FightUIModule.instance.p_iconList.indexOf(this)&&FightUIModule.instance.p_iconList.push(this)},e}(egret.DisplayObjectContainer);__reflect(ManaIcon.prototype,"ManaIcon");var ManaItem=function(t){function e(){var e=t.call(this)||this;return e.m_count=0,e.touchChildren=!1,e.touchEnabled=!1,e}return __extends(e,t),e.prototype.show=function(t,e,i){void 0===i&&(i=!1),this.m_count=3,this.m_isTishi=i,this.m_delayTime=e,this.m_pointList=t.xyFoot,this.m_mc||(this.m_mc=new EffectMovieClip),this.addChild(this.m_mc),2==FightSkillManager.instance.p_typeScene?this.m_mc.setMC(PublicCon.PATH_FLY_RES+"gold"):this.m_mc.setMC(PublicCon.PATH_FLY_RES+"rmb"),this.m_mc.play(),this.alpha=0,this.x=this.m_pointList[0],this.y=this.m_pointList[1],SceneLayerModule.instance.upEffectLayer.addChild(this);var s=Math.floor(60*Math.random())+10;1==Math.floor(2*Math.random())&&(s=-1*s);var n=Math.floor(50*Math.random())+10;1==Math.floor(2*Math.random())&&(n=-1*n),this.m_roy=n+this.m_pointList[1],TweenMax.to(this,.3,{delay:this.m_delayTime+.1,alpha:1,x:s+this.m_pointList[0],y:this.m_roy,onComplete:this.onNextPlay.bind(this)}),this.m_times=10,TimeManager.instance.doLoop(this.timeGoto,this)},e.prototype.onNextPlay=function(){if(this.m_count<=0){var t=void 0;t=2==FightSkillManager.instance.p_typeScene?UIModule.instance.pointGold:UIModule.instance.pointRmb;var e=this.parent.localToGlobal(this.x,this.y);DisplayObjectUtils.removeFormParent(this),this.x=e.x,this.y=e.y,FightUIModule.instance.p_pointXY.x=e.x-t[0],FightUIModule.instance.p_pointXY.y=e.y-t[1];var i=FightUIModule.instance.p_pointXY.length,s=i/800*1;UIModule.instance.downUILayer3.addChild(this),TweenMax.to(this,s,{x:t[0],y:t[1],onComplete:this.recover.bind(this)})}else this.y==this.m_roy?TweenMax.to(this,.1,{y:this.m_roy+15,onComplete:this.onNextPlay.bind(this)}):TweenMax.to(this,.2,{y:this.m_roy,onComplete:this.onNextPlay.bind(this)});this.m_count-=1},e.prototype.timeGoto=function(){return this.m_times<=0?void this.timesOver():void(this.m_times-=1)},e.prototype.timesOver=function(){TimeManager.instance.clearTimer(this.timeGoto,this),this.recover()
},e.prototype.recover=function(){TimeManager.instance.clearTimer(this.timeGoto,this),this.m_mc&&(this.m_mc.destory(),this.m_mc=null),DisplayObjectUtils.removeFormParent(this),this.m_isTishi,-1==FightUIModule.instance.p_itemList.indexOf(this)&&FightUIModule.instance.p_itemList.push(this)},e}(egret.DisplayObjectContainer);__reflect(ManaItem.prototype,"ManaItem");var ManaObtain=function(t){function e(){var e=t.call(this)||this;return e.m_randomList=[],e.m_curr=0,e.touchChildren=!1,e.touchEnabled=!1,e}return __extends(e,t),e.prototype.playSoundEffect=function(){SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_4003)},e.prototype.playSoundEffectNa=function(){SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_3501)},e.prototype.setNumList=function(t,e){this.m_randomList=[];for(var i=0,s=Math.floor(e/t),n=0;t>n;n++)if(n!=t-1){var o=5-Math.floor(10*Math.random());s>Math.abs(o)?(i+=s+o,this.m_randomList.push(s+o)):(i+=s,this.m_randomList.push(s))}else e-i>0&&this.m_randomList.push(e-i)},e.prototype.showMc=function(){for(var t=0;t<this.m_randomList.length;t++){var e=new NumberView("num_sy_",0,-6);e.p_isAnchorOffsetX=!0,e.p_isAnchorOffsetY=!0,e.setMsgString("j"+this.m_randomList[t]),this.patentMc.addChild(e),e.alpha=0,e.scaleX=e.scaleY=1.3,e.x=this.x,e.y=this.m_roy,TweenLite.to(e,.2,{delay:.1+.1*t,scaleX:1,scaleY:1,alpha:1,y:this.m_roy-40,ease:Circ.easeIn,onStart:this.onStartPlay.bind(this),onStartParams:[t,this.m_randomList[t]],onComplete:this.onNextPlay.bind(this),onCompleteParams:[e]})}},e.prototype.onStartPlay=function(t,e){SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_4002),0!=t&&(this.m_curr+=e,this.m_manaNum.setNumValue(this.m_curr,.2))},e.prototype.onNextPlay=function(t){TweenLite.to(t,.2,{y:this.m_roy-80,scaleX:.7,scaleY:.7,ease:Linear.easeNone,onComplete:this.onNextPlay1.bind(this),onCompleteParams:[t]})},e.prototype.onNextPlay1=function(t){TweenLite.to(t,.5,{y:this.m_roy-300,ease:Linear.easeNone,onComplete:this.onNextPlay2.bind(this),onCompleteParams:[t]})},e.prototype.onNextPlay2=function(t){TweenLite.to(t,.2,{y:this.m_roy-310,alpha:0,ease:Linear.easeNone,onComplete:this.onOutPlay.bind(this),onCompleteParams:[t]})},e.prototype.onOutPlay=function(t){t.hide(),t=null},e.prototype.show=function(t,e){var i=12+Math.floor(6*Math.random());this.setNumList(i,e),this.m_curr=this.m_randomList[0],DelayCallUtils.delayedCall(.6,this.showMc,this),DelayCallUtils.delayedCall(1,this.playSoundEffectNa,this),SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_3002),this.scaleX=1,this.scaleY=1,this.alpha=1,this.m_roy=.5*StageManager.instance.p_stageHeight+100,this.x=.5*StageManager.instance.p_stageWidth,this.y=this.m_roy,this.patentMc.addChild(this),this.m_mc||(this.m_mc=new EffectMovieClip,this.m_mc.setMC(PublicCon.PATH_EFFECT_MONSTER+"shouyi/shouyiDi2")),this.addChild(this.m_mc),this.m_mc.play(12),this.m_mc.scaleX=0,TweenLite.to(this.m_mc,.4,{scaleX:1,ease:Elastic.easeOut}),this.m_manaNum||(this.m_manaNum=new NumberView("num_sy_",0,-12),this.m_manaNum.p_isDoller=!0,this.m_manaNum.p_isAnchorOffsetX=!0,this.m_manaNum.y=-20),this.addChild(this.m_manaNum),this.m_manaNum.numValue=this.m_curr,this.m_manaNum.scaleX=0,TweenLite.to(this.m_manaNum,.4,{delay:.2,scaleX:1,ease:Elastic.easeOut}),this.m_mcBaoz||(this.m_mcBaoz=new EffectMovieClip,this.m_mcBaoz.setMC(PublicCon.PATH_EFFECT_MONSTER+"shouyi/shouyiDiBao2"),this.m_mcBaoz.blendMode=egret.BlendMode.ADD),this.addChild(this.m_mcBaoz),this.m_mcBaoz.play(12,1),TweenLite.to(this,.4,{delay:2.6,scaleX:.2,scaleY:.2,alpha:0,ease:Back.easeIn,onComplete:this.onPlayComplete.bind(this)})},e.prototype.onPlayComplete=function(){this.m_mc&&(this.m_mc.destory(),this.m_mc=null),this.m_mcBaoz&&(this.m_mcBaoz.destory(),this.m_mcBaoz=null),this.m_manaNum&&(this.m_manaNum.hide(),this.m_manaNum=null),DisplayObjectUtils.removeFormParent(this),-1==FightUIModule.instance.p_obtainList.indexOf(this)&&FightUIModule.instance.p_obtainList.push(this)},Object.defineProperty(e.prototype,"patentMc",{get:function(){return StageManager.instance.sceneUILayer},enumerable:!0,configurable:!0}),e}(egret.DisplayObjectContainer);__reflect(ManaObtain.prototype,"ManaObtain");var ManaSimple=function(t){function e(){var e=t.call(this)||this;return e.touchChildren=!1,e.touchEnabled=!1,e}return __extends(e,t),e.prototype.playSoundEffect=function(){SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_4003)},e.prototype.show=function(t,e){SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_3001),this.scaleX=1,this.scaleY=1,this.alpha=1,t?(this.x=t.x+t.jsonAvatar.name_off_list[0]+50,this.y=t.y+t.jsonAvatar.name_off_list[1]-40,SceneLayerModule.instance.upEffectLayer.addChild(this)):(this.x=.5*StageManager.instance.p_stageWidth,this.y=.5*StageManager.instance.p_stageHeight,UIModule.instance.upUILayer.addChild(this)),this.m_mc||(this.m_mc=new EffectMovieClip,this.m_mc.setMC(PublicCon.PATH_EFFECT_MONSTER+"shouyi/shouyiDi1")),this.addChild(this.m_mc),this.m_mc.play(12),this.m_mc.scaleX=0,TweenLite.to(this.m_mc,.5,{scaleX:1,ease:Elastic.easeOut}),this.m_manaNum||(this.m_manaNum=new NumberView("num_sy_",0,-12),this.m_manaNum.p_isDoller=!0,this.m_manaNum.p_isAnchorOffsetX=!0,this.m_manaNum.y=-25),this.addChild(this.m_manaNum),this.m_manaNum.numValue=e,this.m_manaNum.scaleX=0,TweenLite.to(this.m_manaNum,.9,{delay:.2,scaleX:1,ease:Elastic.easeOut}),TweenLite.to(this,.4,{delay:1.7,scaleX:.2,scaleY:.2,alpha:0,ease:Circ.easeIn,onComplete:this.onPlayComplete.bind(this)})},e.prototype.onPlayComplete=function(){this.m_mc&&(this.m_mc.destory(),this.m_mc=null),this.m_manaNum&&(this.m_manaNum.hide(),this.m_manaNum=null),DisplayObjectUtils.removeFormParent(this),-1==FightUIModule.instance.p_simpleList.indexOf(this)&&FightUIModule.instance.p_simpleList.push(this)},e}(egret.DisplayObjectContainer);__reflect(ManaSimple.prototype,"ManaSimple");var RageSkill=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.show=function(){this.m_imgBj||(this.m_imgBj=new eui.Image("commonUI_box"),this.m_imgBj.scale9Grid=UIModule.instance.getRectangle(),this.m_imgBj.x=0,this.m_imgBj.y=0),this.stageResize(),this.m_imgBj.alpha=0,this.addChild(this.m_imgBj),StageManager.instance.popUplayer.addChild(this),this.playSkill(),DelayCallUtils.delayedCall(FightSkillManager.p_rage_time,this.hide,this)},e.prototype.playSkill=function(){Skills.instance.playDrameSkill(FightSkillManager.p_rage_id,PlayerManager.instance.p_mainPlayer,PlayerManager.instance.p_mainPlayer.getPos())},e.prototype.stageResize=function(){var t=StageManager.instance.p_stageWidth,e=StageManager.instance.p_stageHeight;this.m_imgBj&&(this.m_imgBj.width=t,this.m_imgBj.height=e)},e.prototype.hide=function(){DisplayObjectUtils.removeFormParent(this),DelayCallUtils.killDelayedCallsTo(this.hide,this),DelayCallUtils.killDelayedCallsTo(this.playSkill,this);var t={key:"c_rage_over",value:1};GuideModule.instance.executeNextGuide(GuideConfig.guide_task,[t])},e}(egret.DisplayObjectContainer);__reflect(RageSkill.prototype,"RageSkill");var FirstRechargeUI=function(t){function e(){var e=t.call(this)||this;return e.m_disposeUrlList.push("firstRechargeUI_json"),e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/firstRechargeUI/FirstRechargeUISkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.touchEnabled=!1,this.u_txtCloseTips.textFlow=LanguageJson.getHtmlTextFlow("l_closePop_tip"),this.m_rechargeId=0;var e=0;1==URIManager.is_native_pay&&(e=GameManager.instance.isIos?2:1),this.m_viewNum||(this.m_viewNum=new NumberView("firstRechargeUI_num_",164,-4),this.m_viewNum.y=15,this.u_btnRecharge.addChild(this.m_viewNum));var i=RechargeJson.getRechargeData(ChargeGameEnum.FIRST_CHARGE,e);if(i&&i.length>0){var s=i[0];if(this.m_rechargeId=s.ID,this.m_viewNum.setMsgString("$"+s.cash),s&&s.reward_item_list)for(var n=0;n<s.reward_item_list.length;n++){var o=new ItemIcon;o.scaleX=.73,o.scaleY=.73,o.x=20,o.y=15,o.setData(s.reward_item_list[n][0],s.reward_item_list[n][1]),this["u_gpPropBg"+n].addChild(o),this["u_txtPropName"+n].text=o.itemJson.name}}},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnRecharge,this.onRecharge,this,!0)},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),ClientLogManager.instance.s_client_log_client_log(ClientLogEnum.FIRST_CHARGE_BUTTON_TIMES))},e.prototype.onRecharge=function(t){0!=this.m_rechargeId&&ChargeManager.instance.requestRecharge(this.m_rechargeId,1)},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i)},e.prototype.sureHide=function(e,i){void 0===e&&(e=null),void 0===i&&(i=null),t.prototype.sureHide.call(this,e,i)},e}(PopupBase);__reflect(FirstRechargeUI.prototype,"FirstRechargeUI");var FlyRes=function(t){function e(){var e=t.call(this)||this;return e.m_times=10,e.touchEnabled=!1,e.touchChildren=!1,e}return __extends(e,t),e.prototype.flyOtherPlayMana=function(t,e,i){void 0===i&&(i=1),2==FightSkillManager.instance.p_typeScene?this.setEffectMc(PublicCon.PATH_FLY_RES+"gold"):this.setEffectMc(PublicCon.PATH_FLY_RES+"rmb"),this.x=e.x,this.y=e.y,this.alpha=1;var s=e.getPos(),n=t.getPos(),o=[],a=egret.Point.interpolate(n,s,.85);o.push(this.getRoundRandomPoint(a.x,a.y,300,400));var r=egret.Point.interpolate(n,s,.15);o.push(this.getRoundRandomPoint(r.x,r.y,200,100)),o.push({x:n.x,y:s.y}),TweenMax.to(this,i+.6*Math.random(),{rotation:360*Math.random(),bezier:o,ease:Linear.easeNone,onComplete:this.flyGotoPlayEnd.bind(this),onCompleteParams:[t]}),this.m_times=10,TimeManager.instance.doLoop(this.timeGoto,this)},e.prototype.timeGoto=function(){return this.m_times<=0?void this.onPlayEnd():void(this.m_times-=1)},e.prototype.flyGotoPlayEnd=function(t){t&&!t.isDestory?TweenMax.to(this,.2,{x:t.getPos().x,y:t.getPos().y-100,ease:Linear.easeNone,onComplete:this.onPlayEnd.bind(this)}):this.onPlayEnd()},e.prototype.flyExp=function(t,e,i){void 0===i&&(i=1),this.setEffectMc(ItemJson.getIconId(ItemEnum.EXP)+""),this.x=e.x,this.y=e.y,this.alpha=1;var s=e.getPos(),n=t.getPos(),o=[],a=egret.Point.interpolate(n,s,.85);o.push(this.getRoundRandomPoint(a.x,a.y,300,400));var r=egret.Point.interpolate(n,s,.15);o.push(this.getRoundRandomPoint(r.x,r.y,200,100)),o.push({x:n.x,y:s.y}),TweenMax.to(this,i+.6*Math.random(),{rotation:360*Math.random(),bezier:o,ease:Linear.easeNone,onComplete:this.flyExpPlayEnd.bind(this),onCompleteParams:[t]}),this.m_times=10,TimeManager.instance.doLoop(this.timeGoto,this)},e.prototype.flyExpPlayEnd=function(t){t&&!t.isDestory?TweenMax.to(this,.2,{x:t.getPos().x,y:t.getPos().y-100,ease:Linear.easeNone,onComplete:this.onPlayEnd.bind(this)}):this.onPlayEnd()},e.prototype.playEffect=function(t,e,i,s){void 0===s&&(s=1.5),this.setEffectMc(ItemJson.getIconId(t)+""),this.x=e[0],this.y=e[1],this.alpha=1,this.flyGoto(e,i,s),this.m_times=10,TimeManager.instance.doLoop(this.timeGoto,this)},e.prototype.flyGoto=function(t,e,i){void 0===i&&(i=1.5),FlyResModule.instance.p_startPoint.x=t[0],FlyResModule.instance.p_startPoint.y=t[1],FlyResModule.instance.p_endPoint.x=e[0],FlyResModule.instance.p_endPoint.y=e[1];var s=[],n=egret.Point.interpolate(FlyResModule.instance.p_startPoint,FlyResModule.instance.p_endPoint,.85);s.push(this.getRoundRandomPoint(n.x,n.y,300,400));var o=egret.Point.interpolate(FlyResModule.instance.p_startPoint,FlyResModule.instance.p_endPoint,.15);s.push(this.getRoundRandomPoint(o.x,o.y,200,100)),s.push({x:e[0],y:e[1]}),TweenMax.to(this,i+.6*Math.random(),{rotation:360*Math.random(),bezier:s,ease:Linear.easeNone,onComplete:this.onPlayEnd.bind(this)})},e.prototype.playEffect2=function(t,e,i,s,n,o){this.setEffectMc(ItemJson.getIconId(t)+""),this.x=e[0],this.y=e[1],this.alpha=0;var a,r,_=90*Math.random(),h=30*Math.random();a=1==Math.floor(2*Math.random())?e[0]+_:e[0]-_,r=1==Math.floor(2*Math.random())?e[1]+h:e[1]-h,TweenMax.to(this,.3,{delay:s,alpha:1,x:a,y:r,ease:Quad.easeInOut}),DelayCallUtils.delayedCall(o+.4+s,this.showStay,this,[n,i]),this.m_times=10,TimeManager.instance.doLoop(this.timeGoto,this)},e.prototype.showStay=function(t,e){DelayCallUtils.killDelayedCallsTo(this.showStay,this),TweenMax.to(this,t,{x:e[0],y:e[1],ease:Quad.easeIn,onComplete:this.onPlayEnd.bind(this)})},e.prototype.playEffect3=function(t,e,i,s,n){this.setEffectMc(ItemJson.getIconId(t)+""),this.x=e[0],this.y=e[1],this.alpha=0;var o=Math.random()>.5?1:-1,a=o*(3*Math.random()+3),r=a*Math.random()*25>>0,_=.8*Math.random();TweenMax.to(this,0,{delay:s,alpha:1}),TweenMax.to(this,_,{delay:s,x:this.x+r,ease:Quad.easeOut}),TweenMax.to(this,_+.5,{delay:s,y:this.y+50+10*Math.random(),onComplete:this.flyGoto.bind(this),ease:Elastic.easeOut,onCompleteParams:[e,i,n]}),this.m_times=10,TimeManager.instance.doLoop(this.timeGoto,this)},e.prototype.playEffect4=function(t,e,i,s,n){this.setEffectMc(ItemJson.getIconId(t)+""),this.x=e[0],this.y=e[1],this.alpha=.3;var o=Math.floor(80*Math.random())+20;1==Math.floor(2*Math.random())&&(o=-1*o);var a=Math.floor(60*Math.random())+20;1==Math.floor(2*Math.random())&&(a=-1*a),TweenMax.to(this,n,{delay:s,alpha:1,x:o+e[0],y:a+e[1]});var r=Math.floor(4*Math.random())/10+.2;FightUIModule.instance.p_pointXY.x=e[0]-i[0],FightUIModule.instance.p_pointXY.y=e[1]-i[1];var _=FightUIModule.instance.p_pointXY.length,h=_/800*1;TweenMax.to(this,h,{delay:s+r,x:i[0],y:i[1],onComplete:this.onPlayEnd.bind(this)}),this.m_times=10,TimeManager.instance.doLoop(this.timeGoto,this)},e.prototype.setEffectMc=function(t){this.m_mc||(this.m_mc=new EffectMovieClip),this.m_mc.setMC(PublicCon.PATH_FLY_RES+t),this.m_mc.play(),this.addChild(this.m_mc)},e.prototype.onPlayEnd=function(){TweenMax.killTweensOf(this),TimeManager.instance.clearTimer(this.timeGoto,this),this.m_mc&&(this.m_mc.destory(),this.m_mc=null),-1==FlyResModule.instance.p_flyResList.indexOf(this)&&FlyResModule.instance.p_flyResList.push(this)},e.prototype.getRoundRandomPoint=function(t,e,i,s){var n=2*Math.PI*Math.random(),o=(Math.random()*i+20)*Math.cos(n)+t,a=(Math.random()*s+100)*Math.sin(n)+e;return{x:o,y:a}},e}(egret.DisplayObjectContainer);__reflect(FlyRes.prototype,"FlyRes");var FlyResModule=function(){function t(){this.m_flyNums=[5,15,30],this.p_flyResList=[],this.p_startPoint=new egret.Point,this.p_endPoint=new egret.Point}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.flyOtherPlayMana=function(t,e,i,s){if(void 0===i&&(i=8),void 0===s&&(s=1.6),null!=t&&!t.isDestory&&null!=e&&!e.isDestory)for(var n=0;i>n;n++){var o=this.getFlyResItem();o.flyOtherPlayMana(t,e,s),SceneLayerModule.instance.upEffectLayer.addChild(o)}},t.prototype.flyExpPlayer=function(t,e,i,s){if(void 0===i&&(i=8),void 0===s&&(s=1.6),null!=t&&!t.isDestory&&null!=e&&!e.isDestory)for(var n=0;i>n;n++){var o=this.getFlyResItem();o.flyExp(t,e,s),SceneLayerModule.instance.upEffectLayer.addChild(o)}},t.prototype.playResEffect=function(t,e,i,s,n,o){void 0===i&&(i=2),void 0===s&&(s=8),void 0===n&&(n=1),void 0===o&&(o=null),null==o&&(o=StageManager.instance.popToplayer);for(var a=0;s>a;a++){var r=this.getFlyResItem();r.playEffect(i,t,e,n),o.addChild(r)}},t.prototype.playResEffect2=function(t,e,i,s,n,o){void 0===i&&(i=2),void 0===s&&(s=1),void 0===n&&(n=.7),void 0===o&&(o=null),null==o&&(o=StageManager.instance.popToplayer);for(var a=0;s>a;a++){var r=this.getFlyResItem();o.addChild(r),r.playEffect2(i,t,e,.08*a,n,.08*s)}},t.prototype.playResEffect3=function(t,e,i,s,n,o){void 0===i&&(i=2),void 0===s&&(s=1),void 0===n&&(n=.7),void 0===o&&(o=null),null==o&&(o=StageManager.instance.popToplayer);for(var a=0;s>a;a++){var r=this.getFlyResItem();o.addChild(r),r.playEffect3(i,t,e,.2+.1*a,n)}},t.prototype.playResEffect4=function(t,e,i,s,n,o){void 0===i&&(i=2),void 0===s&&(s=1),void 0===n&&(n=.5),void 0===o&&(o=null),null==o&&(o=StageManager.instance.popToplayer);for(var a=0;s>a;a++){var r=this.getFlyResItem();o.addChild(r),r.playEffect4(i,t,e,.06*a,n)}},t.prototype.getFlyResItem=function(){return this.p_flyResList.length>0?this.p_flyResList.shift():new FlyRes},t}();__reflect(FlyResModule.prototype,"FlyResModule");var GameSetConfig=function(){function t(){}return t.k_sound_bj="k_sound_bj",t.k_sound_effect="k_sound_effect",t.k_sound_size="k_sound_size",t.k_sound_effect_size="k_sound_effect_size",t.k_guide="k_guide",t.k_last_scene="k_last_scene",t.k_first_charge="k_first_charge",t.k_guessKey="k_guessKey",t.k_course_guide="k_course_guide",t}();__reflect(GameSetConfig.prototype,"GameSetConfig");var GameSettingUI=function(t){function e(){var e=t.call(this)||this;return e.m_bgSoundState=!0,e.m_effectSoundState=!0,e.m_disposeUrlList.push("gameSettingUI_json"),e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/gameSettingUI/GameSettingUISkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.m_head||(this.m_head=new PersonalHead,this.m_head.x=432,this.m_head.y=151,this.m_head.p_showLevel=!1,this.addChildAt(this.m_head,1));var e=PlayerManager.instance.p_playerInfo;this.m_head.showView(e.player_other_data,e.player_id,e.level),this.u_titleLb.text=LanguageJson.getText("l_setting_title"),this.u_txtId.text=LanguageJson.getText("l_game_set_id")+"   :  "+PlayerManager.instance.playerId,this.u_txtName.text=LanguageJson.getText("l_game_set_name")+": "+PlayerManager.instance.p_playerInfo.nickname,this.u_btnEdit.left=this.u_txtName.x+this.u_txtName.textWidth+15,this.u_txtPlayerEff.text=LanguageJson.getText("l_game_set_playerEff"),this.u_txtPlayer.text=LanguageJson.getText("l_game_set_player"),this.u_btnName.text=LanguageJson.getText("l_setting_exit"),this.m_hsliderBgView||(this.m_hsliderBgView=new HsliderView,this.m_hsliderBgView.x=45,this.m_hsliderBgView.y=15,this.m_hsliderBgView.p_funcEnd=this.setSoundValue.bind(this),this.m_hsliderBgView.p_funcSetGray=this.setSoundGray.bind(this),this.u_mc_soundBg.addChild(this.m_hsliderBgView)),this.m_hsliderEffectView||(this.m_hsliderEffectView=new HsliderView,this.m_hsliderEffectView.x=45,this.m_hsliderEffectView.y=15,this.m_hsliderEffectView.p_funcEnd=this.setEffextValue.bind(this),this.m_hsliderEffectView.p_funcSetGray=this.setEffextGray.bind(this),this.u_mc_soundeEffect.addChild(this.m_hsliderEffectView));var i=parseFloat(PlayerManager.instance.getSetingMsg(GameSetConfig.k_sound_size)),s=parseFloat(PlayerManager.instance.getSetingMsg(GameSetConfig.k_sound_effect_size));this.setValue(this.u_soundValue,isNaN(i)?1:i),this.setValue(this.u_effectValue,isNaN(s)?1:s),i?this.m_hsliderBgView.initView(i):this.m_hsliderBgView.initView(),s?this.m_hsliderEffectView.initView(s):this.m_hsliderEffectView.initView();var n=PlayerManager.instance.getSetingMsg(GameSetConfig.k_sound_bj);this.m_bgSoundState=this.getBtnState(n),this.m_hsliderBgView.setHsliderGray(!this.m_bgSoundState);var o=PlayerManager.instance.getSetingMsg(GameSetConfig.k_sound_effect);this.m_effectSoundState=this.getBtnState(o),this.m_hsliderEffectView.setHsliderGray(!this.m_effectSoundState),this.u_btnPlayerEffect.source=this.getBtnUrl(PlayerManager.instance.p_playerEffectIsShow),this.u_btnPlayer.source=this.getBtnUrl(PlayerManager.instance.p_playerIsShow)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnClose,this.close,this),this.registerEventClick(this.u_btnEdit,this.editName,this),this.registerEventClick(this.u_btnPlayerEffect,this.onPlayerEffect,this),this.registerEventClick(this.u_btnPlayer,this.onPlayerShow,this),this.registerEventClick(this.u_btnAccount,this.onQuitGame,this,!0),this.registerEventClick(this.u_btnPerson,this.onPersonal,this,!0)},e.prototype.editName=function(){},e.prototype.onQuitGame=function(t){LoginManager.instance.loginOutBack(!0)},e.prototype.onPlayerEffect=function(t){PlayerManager.instance.p_playerEffectIsShow=!PlayerManager.instance.p_playerEffectIsShow,SceneModule.instance.showHidePlayerEffect(),this.u_btnPlayerEffect.source=this.getBtnUrl(PlayerManager.instance.p_playerEffectIsShow)},e.prototype.onPlayerShow=function(t){PlayerManager.instance.p_playerIsShow=!PlayerManager.instance.p_playerIsShow,SceneModule.instance.showHideOtherPlayer(),this.u_btnPlayer.source=this.getBtnUrl(PlayerManager.instance.p_playerIsShow)},e.prototype.onPersonal=function(){PopupModule.instance.showPop(PopupConfig.ID_PERSONALIZATION,null,!1)},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&t.prototype.showView.call(this,e)},e.prototype.setSoundValue=function(t){this.setValue(this.u_soundValue,t),SoundMoude.instance.setSoundVolume(t),this.setEgretItem(GameSetConfig.k_sound_size,t+"")},e.prototype.setValue=function(t,e){t.text=(100*e).toFixed()+"%"},e.prototype.setSoundGray=function(t){this.m_hsliderBgView.setHsliderGray(!this.m_bgSoundState)},e.prototype.setEffextValue=function(t){this.setValue(this.u_effectValue,t),SoundMoude.instance.setSoundEffectVolume(t),this.setEgretItem(GameSetConfig.k_sound_effect_size,t+"")},e.prototype.setEffextGray=function(t){this.m_hsliderEffectView.setHsliderGray(!this.m_effectSoundState)},e.prototype.getBtnState=function(t){return t?"true"==t?!0:!1:!0},e.prototype.setEgretItem=function(t,e){PlayerManager.instance.setingMsg(t,e+"")},e.prototype.getBtnUrl=function(t){return t?"gameSettingUI_json.gameSettingUI_btn_on":"gameSettingUI_json.gameSettingUI_btn_off"},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i)},e.prototype.sureHide=function(e,i){void 0===e&&(e=null),void 0===i&&(i=null),t.prototype.sureHide.call(this,e,i)},Object.defineProperty(e.prototype,"isClickBMask",{get:function(){return!1},enumerable:!0,configurable:!0}),e}(PopupBase);__reflect(GameSettingUI.prototype,"GameSettingUI");var GodDragonBtn=function(t){function e(){var e=t.call(this)||this;return e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/godDragonUI/GodDragonBtnSkin.exml",e}return __extends(e,t),e.prototype.setXY=function(){this.x=StageManager.instance.p_stageWidth-this.width+40,this.y=82},e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.anchorOffsetX=50,this.anchorOffsetY=50,this.setXY()},e.prototype.initEvent=function(){this.registerEventClick(this.u_btnOpen,this.onEventClick,this)},e.prototype.showView=function(){this.checkComplete(this.showView)&&(Dispatch.register(BagManager.EVENT_BAG_UPGRADE,this.setProgress,this),Dispatch.register(GodDragonManager.EVENT_GODDRAGON_BLESS,this.hide,this),this.m_residueTime=GodDragonManager.instance.m_pStateMsg.close_time-ServerTimeManager.instance.timer,TimeManager.instance.doLoop(this.timeGo,this),TweenLite.to(this,3,{alpha:1,rotation:1440,ease:Power0.easeIn}))},e.prototype.timeGo=function(){return this.m_residueTime<=0?(TimeManager.instance.clearTimer(this.timeGo,this),PopupModule.instance.hidePop(PopupConfig.ID_GODDRAGON_LOTTERY),void FightUIModule.instance.hideGodDragonBuf()):(this.m_residueTime-=1,void(this.u_textTime.text=TimeUtil.getSpliceTime2(this.m_residueTime)+""))},e.prototype.setProgress=function(){this.u_imgProgress.width=0,this.u_txtProgress.text="0";var t=StaticDataJson.parseStrToList("monster_function_shenlongzhufu_cost_list");this.u_txtProgress.text=BagManager.instance.getNum(ItemEnum.BLESS_COIN)+"/"+t[1],this.u_imgProgress.width=BagManager.instance.getNum(ItemEnum.BLESS_COIN)>Number(t[1])?Number(t[1]):BagManager.instance.getNum(ItemEnum.BLESS_COIN)},e.prototype.onEventClick=function(){PopupModule.instance.showPop(PopupConfig.ID_GODDRAGON_LOTTERY)},e.prototype.hide=function(){TweenLite.killTweensOf(this),TweenLite.to(this,3,{rotation:-1440,alpha:0,ease:Power0.easeInOut,onComplete:this.sureHide.bind(this)})},e.prototype.sureHide=function(){DisplayObjectUtils.removeFormParent(this),Dispatch.remove(BagManager.EVENT_BAG_UPGRADE,this.setProgress,this),Dispatch.remove(GodDragonManager.EVENT_GODDRAGON_BLESS,this.hide,this)},e}(ComponentBase);__reflect(GodDragonBtn.prototype,"GodDragonBtn");var GodDragonFlyEffect=function(t){function e(){var e=t.call(this)||this;return e.touchChildren=!1,e.touchEnabled=!1,e}return __extends(e,t),e.prototype.show=function(){this.parent||(TweenLite.killTweensOf(this),UIModule.instance.downUILayer3.addChild(this),this.showEffect())},e.prototype.showEffect=function(){var t=StageManager.instance.p_stageWidth,e=StageManager.instance.p_stageHeight;this.m_effect||(this.m_effect=new EffectMovieClip),this.m_effect.setMC(PublicCon.PATH_EFFECT_BINGDONG+"bingDong"),this.addChild(this.m_effect),this.m_effect.alpha=0,this.m_effect.scaleX=.7,this.m_effect.scaleY=.7,this.m_effect.x=t-200,this.m_effect.y=e+30,this.m_effect.play(),TweenLite.to(this.m_effect,2.3,{delay:.3,alpha:1,scaleX:1,scaleY:1,x:50,y:50})},e.prototype.showEffect1=function(){this.m_effect||(this.m_effect=new EffectMovieClip),this.m_effect.x=0,this.m_effect.y=0,this.m_effect.scaleX=1,this.m_effect.scaleY=1,this.m_effect.alpha=1,this.addChild(this.m_effect),this.m_effect.play()},e.prototype.loadCom=function(){this.m_effect.mc.addEventListener(egret.Event.COMPLETE,this.playCom,this)},e.prototype.playCom=function(){},e.prototype.hideClose=function(){DisplayObjectUtils.removeFormParent(this)},e}(egret.DisplayObjectContainer);__reflect(GodDragonFlyEffect.prototype,"GodDragonFlyEffect");var GodDragonPopup=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/godDragonUI/popup/GodDragonPopupSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_btnLottery.touchEnabled=!0;var e=StaticDataJson.parseStrToList("monster_function_shenlongzhufu_cost_list");this.u_textTip.text=LanguageJson.getHtmlText("l_goddragon_cost_tip",[e[1]])},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnLottery,this.onLotteryEvent,this)},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),Dispatch.register(GodDragonManager.EVENT_GODDRAGON_AWARD,this.onDrawEvent,this),this.createEgg())},e.prototype.onLotteryEvent=function(){this.u_btnLottery.touchEnabled=!1,GodDragonManager.instance.s_shen_long_draw()},e.prototype.onDrawEvent=function(){this.showEggAction()},e.prototype.showDragonEffect=function(){StageManager.instance.p_stageWidth,StageManager.instance.p_stageHeight;this.m_effect||(this.m_effect=new EffectMovieClip,this.m_effect.setMC(PublicCon.PATH_EFFECT_BINGDONG+"bingDong"),this.m_effect.onLoadCompleteFunc=this.loadCom.bind(this)),this.m_effect.x=50,this.m_effect.y=50,this.m_effect.scaleX=1,this.m_effect.scaleY=1,this.m_effect.alpha=1,this.u_grpCentre.addChild(this.m_effect),this.m_effect.play()},e.prototype.createEgg=function(){if(!this.m_eggEffect){StageManager.instance.p_stageWidth,StageManager.instance.p_stageHeight;this.m_eggEffect=new EffectMovieClip,this.m_eggEffect.setMC(PublicCon.PATH_EFFECT_BINGDONG+"bingDong",2),this.m_eggEffect.onCompleteFunc=this.loadCom.bind(this),this.m_eggEffect.scaleX=1,this.m_eggEffect.scaleY=1,this.m_eggEffect.alpha=1,this.u_grpCentre.addChild(this.m_eggEffect)}},e.prototype.showEggAction=function(){this.m_eggEffect.play()},e.prototype.showPrizeText=function(){var t=0;GodDragonManager.instance.m_pStateMsg&&GodDragonManager.instance.m_pStateMsg.player_id&&(t=GodDragonManager.instance.m_pStateMsg.player_id),this.u_textTitle.visible=!0,this.u_textTitle.text=LanguageJson.getHtmlText("l_goddragon_title_tip",[t])},e.prototype.loadCom=function(){this.m_itemIcon||(this.m_itemIcon=new ItemIcon,this.u_grpCentre.addChild(this.m_itemIcon));var t=GodDragonManager.instance.m_pDrawData,e=MonsterFunctionShenlongzhufuJson.getData(t.type,t.id);1!=e.id&&(this.m_itemIcon.setData(e.reward_item_list[0],e.reward_item_list[1]),this.m_itemIcon.visible=!0),GodDragonManager.instance.m_pStateMsg&&GodDragonManager.instance.m_pStateMsg.player_id?this.showPrizeText():(this.u_textTitle.visible=!0,this.u_textTitle.text=e.desc),TweenLite.to(this.m_itemIcon,1.3,{delay:2,alpha:1,onComplete:this.flyIcon.bind(this)})},e.prototype.flyIcon=function(){this.localToGlobal(this.m_itemIcon.x+20,this.m_itemIcon.y+20);this.m_itemIcon.visible=!1,this.u_textTitle.visible=!1,this.u_btnLottery.touchEnabled=!0,GodDragonManager.instance.m_pStateMsg&&GodDragonManager.instance.m_pStateMsg.player_id&&(Dispatch.dispatch(GodDragonManager.EVENT_GODDRAGON_BLESS),this.close())},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i),Dispatch.remove(GodDragonManager.EVENT_GODDRAGON_AWARD,this.onDrawEvent,this),this.m_eggEffect&&(this.m_eggEffect.destory(),this.m_eggEffect=null),this.m_effect&&(this.m_effect.destory(),this.m_effect=null)},e.prototype.sureHide=function(e,i){void 0===e&&(e=null),void 0===i&&(i=null),t.prototype.sureHide.call(this,e,i),this.u_btnLottery.touchEnabled=!0},e}(PopupBase);__reflect(GodDragonPopup.prototype,"GodDragonPopup");var GuessBossUI=function(t){function e(){var e=t.call(this)||this;return e.m_bossList=[],e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/guessBossUI/GuessBossUISkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this);for(var e=GuessBossManager.instance.guessBossList,i=0;i<e.length;i++){var s=new GuessBossAvatar(i,e[i]);this.addChildAt(s,2),this.m_bossList.push(s)}this.u_txtDesc.textFlow=LanguageJson.getHtmlTextFlow("l_guess_boss_rule")},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnChallenge,this.onChallenge,this,!0,SoundEnum.EFFECT_SOUND_1014)},e.prototype.onChallenge=function(t){MissionManager.instance.s_mission_challenge_mission(MissionTypeEnum.GUESS_BOSS,1)},e.prototype.showView=function(e){if(void 0===e&&(e=null),this.checkComplete(this.showView,e)){t.prototype.showView.call(this,e);for(var i=0;i<this.m_bossList.length;i++)this.m_bossList[i].show()}},e.prototype.hide=function(e,i){for(var s=0;s<this.m_bossList.length;s++)this.m_bossList[s].hide();t.prototype.hide.call(this,e,i)},e}(UIBase);__reflect(GuessBossUI.prototype,"GuessBossUI");var GuessEffectPopup=function(t){function e(){var e=t.call(this)||this;return e.m_isClick=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/guessBossUI/popup/GuessEffectPopupSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this)},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),this.m_isClick=!1,this.m_effect1||(this.m_effect1=new EffectMovieClip,this.m_effect1.x=320,this.m_effect1.y=600,this.m_effect1.setMC(PublicCon.PATH_EFFECT_MONSTER+"luckGold"),this.m_effect1.scaleX=this.m_effect1.scaleY=2),this.addChild(this.m_effect1),this.m_effect2||(this.m_effect2=new EffectMovieClip,this.m_effect2.x=320,this.m_effect2.y=580),this.addChild(this.m_effect2),this.m_effect3||(this.m_effect3=new EffectMovieClip,this.m_effect3.x=320,this.m_effect3.y=600,this.m_effect3.setMC(PublicCon.PATH_EFFECT_MONSTER+"luckBoom")),this.addChild(this.m_effect3),this.m_effect1.play(12,1),this.m_effect3.play(12,1),e&&e.bossId&&(this.u_imgBg.alpha=0,this.m_monsterId=Number(e.bossId),DelayCallUtils.delayedCall(.2,this.showMonster,this),TweenLite.to(this.u_imgBg,.4,{delay:.2,alpha:1,onComplete:this.onStageClick.bind(this)})),this.startTimeDo(),SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_1016))},e.prototype.showMonster=function(){this.m_effect2.setMC(MonsterJson.getAvatarPath(this.m_monsterId)),this.m_effect2.play()},e.prototype.onStageClick=function(){this.m_isClick=!0
},e.prototype.startTimeDo=function(){this.m_time=2,TimeManager.instance.doLoop(this.refreshTime,this,1e3)},e.prototype.refreshTime=function(){return this.m_time<=0?void this.close():void this.m_time--},e.prototype.hide=function(e,i){TweenLite.killTweensOf(this.u_imgBg),DelayCallUtils.killDelayedCallsTo(this.showMonster,this),t.prototype.hide.call(this,e,i)},e.prototype.sureHide=function(e,i){void 0===e&&(e=null),void 0===i&&(i=null),this.m_effect1&&(this.m_effect1.destory(),this.m_effect1=null),this.m_effect2&&(this.m_effect2.destory(),this.m_effect2=null),this.m_effect3&&(this.m_effect3.destory(),this.m_effect3=null),t.prototype.sureHide.call(this,e,i)},Object.defineProperty(e.prototype,"isClickBMask",{get:function(){return this.m_isClick},enumerable:!0,configurable:!0}),e}(PopupBase);__reflect(GuessEffectPopup.prototype,"GuessEffectPopup");var GuessFightPopup=function(t){function e(){var e=t.call(this)||this;return e.m_monsterlist=[],e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/guessBossUI/popup/GuessFightPopupSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_imgBg.x=(this.width-this.u_imgBg.width)/2,this.u_imgBg.y=(StageManager.instance.p_stageHeight-StageManager.MAX_STAGE_HEIGHT)/2},e.prototype.showView=function(i){if(void 0===i&&(i=null),this.checkComplete(this.showView,i)){t.prototype.showView.call(this,i),e.p_myCost=i;var s=GuessBossManager.instance.p_posList;this.m_monsterlist=[],e.p_monsterList={};for(var n=0;n<s.length;n++){var o=new GuessMonster(n);4==n?this.addChildAt(o,2):5==n?this.addChildAt(o,1):this.addChild(o),this.m_monsterlist.push(o),o.show(s[n])}DelayCallUtils.delayedCall(2,this.startFight,this)}},e.prototype.startFight=function(){var t=0;GuessBossManager.instance.p_fightData[0]&&(t=GuessBossManager.instance.p_fightData[0].attack_id,Dispatch.dispatch(GuessMonster.EVENT_GUESS_BOSS_FIGHT+t))},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i);for(var s=0;s<this.m_monsterlist.length;s++)this.m_monsterlist[s].hide(),this.m_monsterlist[s]=null;this.m_monsterlist=[]},Object.defineProperty(e.prototype,"height",{get:function(){return StageManager.instance.p_stageHeight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isClickBMask",{get:function(){return!1},enumerable:!0,configurable:!0}),e.p_monsterList={},e.p_myCost={},e}(PopupBase);__reflect(GuessFightPopup.prototype,"GuessFightPopup");var GuessRecordPopup=function(t){function e(){var e=t.call(this)||this;return e.m_layout=new eui.TileLayout,e.m_typeList=new eui.ArrayCollection,e.m_headList=[],e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/guessBossUI/popup/GuessRecordPopupSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this);for(var e=0;6>e;e++){var i=new GuessBossHead(e);this.addChild(i),this.m_headList.push(i)}this.u_scrollerItem.horizontalScrollBar=null,this.u_scrollerItem.verticalScrollBar=null,this.u_scrollerItem.bounces=!1,this.m_layout.requestedColumnCount=1,this.u_listItem.itemRenderer=GuessRecordRender,this.u_listItem.layout=this.m_layout,this.u_listItem.dataProvider=this.m_typeList},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.setCloseBtn(this.u_btnClose)},e.prototype.showView=function(e){if(void 0===e&&(e=null),this.checkComplete(this.showView,e)){t.prototype.showView.call(this,e);for(var i=0;i<this.m_headList.length;i++)this.m_headList[i].show();this.u_scrollerItem.viewport.scrollV=0,this.m_typeList.source=GuessBossManager.instance.p_guessRecord}},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i),this.u_scrollerItem.stopAnimation()},e}(PopupBase);__reflect(GuessRecordPopup.prototype,"GuessRecordPopup");var GuessResultPopup=function(t){function e(){var e=t.call(this)||this;return e.m_time=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/guessBossUI/popup/GuessResultPopupSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.m_numberView||(this.m_numberView=new NumberView("guessInsideUI_json.guessInsideUI_cost_",0,0),this.m_numberView.verticalCenter=0,this.m_numberView.p_isDoller=!0,this.m_numberView.x=50,this.u_grpCost.addChild(this.m_numberView)),this.u_txtMyCost.text=LanguageJson.getText("l_guess_boss_cost"),this.u_txtTotalCost.textFlow=LanguageJson.getHtmlTextFlow("l_missiom_game_cost"),this.u_imgIcon1.source=BagManager.instance.getIconPath(2),this.u_imgIcon2.source=BagManager.instance.getIconPath(2)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.setCloseBtn(this.u_btnClose),this.registerEventClick(this.u_btnOK,this.close,this,!0)},e.prototype.showView=function(e){if(void 0===e&&(e=null),this.checkComplete(this.showView,e)){if(t.prototype.showView.call(this,e),e){var i=e.bossId,s=e.prop,n=e.totalCost,o=0,a=GuessBossManager.instance.getBossIdx(i);for(var r in s)o+=s[r].num;var _=o>0?1:2;if(a>-1&&(this.u_iconNum.source="guessInsideUI_json.guessInsideUI_srl_"+(a+1)),this.u_imgIcon.source=MonsterJson.getMonsterHeadPath(i),1==_){var h=Number(StaticDataJson.getData("guess_rate").data),l=o/(h/1e4);this.u_grpBoss.y=306,this.u_txtMsg.y=164,this.u_grpContent.visible=!0,this.u_imgBg.source="missionJieSuanUI_json.missionJieSuanUI_bg",this.u_txtMsg.textFlow=LanguageJson.getHtmlTextFlow("l_guess_boss_msg_1"),this.u_imgIcon1.x=this.u_txtMyCost.x+this.u_txtMyCost.width-10,this.u_txtCount1.x=this.u_imgIcon1.x+this.u_imgIcon1.width,this.u_txtCount1.text=NumberUtil.numberDecimalism(l),this.m_numberView.numValue=o,SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_1003)}else this.u_grpBoss.y=366,this.u_txtMsg.y=250,this.u_grpContent.visible=!1,this.u_txtMsg.textFlow=LanguageJson.getHtmlTextFlow("l_guess_boss_msg_2"),this.u_imgBg.source="guessInsideUI_json.guessInsideUI_bg_1",SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_1004);this.u_imgIcon2.x=this.u_txtTotalCost.x+this.u_txtTotalCost.width-10,this.u_txtCount2.x=this.u_imgIcon2.x+this.u_imgIcon2.width,this.u_txtCount2.text=NumberUtil.numberDecimalism(n)}this.startTimeDo()}},e.prototype.startTimeDo=function(){this.m_time=10,TimeManager.instance.doLoop(this.refreshTime,this,1e3)},e.prototype.refreshTime=function(){return this.u_txtOK.text=LanguageJson.getText("l_btn_ok")+"("+this.m_time+")",this.m_time<=0?(TimeManager.instance.clearTimer(this.refreshTime,this),void this.close()):void this.m_time--},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i),TimeManager.instance.clearTimer(this.refreshTime,this)},Object.defineProperty(e.prototype,"isClickBMask",{get:function(){return!1},enumerable:!0,configurable:!0}),e}(PopupBase);__reflect(GuessResultPopup.prototype,"GuessResultPopup");var GuessTishiPopup=function(t){function e(){var e=t.call(this)||this;return e.m_isGou=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/guessBossUI/popup/GuessTishiPopupSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_txtTishiMsg.text=LanguageJson.getHtmlText("l_guess_boss_tishi")},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnClose,this.close,this,!0),this.registerEventClick(this.u_mcTishi,this.onTishi,this)},e.prototype.onTishi=function(t){this.m_isGou=!this.m_isGou,this.u_imgGou.visible=this.m_isGou},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),this.m_isGou="1"==PlayerManager.instance.getSetingMsg(GameSetConfig.k_guessKey)?!0:!1,this.u_imgGou.visible=this.m_isGou,this.startTimeDo())},e.prototype.startTimeDo=function(){this.m_time=8,TimeManager.instance.doLoop(this.refreshTime,this,1e3)},e.prototype.refreshTime=function(){return this.m_time<=0?(TimeManager.instance.clearTimer(this.refreshTime,this),void this.close()):void this.m_time--},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i),TimeManager.instance.clearTimer(this.refreshTime,this),this.m_isGou&&"1"!=PlayerManager.instance.getSetingMsg(GameSetConfig.k_guessKey)&&PlayerManager.instance.setingMsg(GameSetConfig.k_guessKey,"1")},Object.defineProperty(e.prototype,"isClickBMask",{get:function(){return!1},enumerable:!0,configurable:!0}),e}(PopupBase);__reflect(GuessTishiPopup.prototype,"GuessTishiPopup");var GuessMyCostRender=function(t){function e(){return t.call(this,"resource/eui_skins/guessBossUI/render/GuessMyCostRenderSkin.exml")||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnClick,this.onAttack,this)},e.prototype.onAttack=function(t){var e=this.getRid();0!=e&&FightAutoAI.instance.attack(e)},e.prototype.getRid=function(){for(var t in SceneItemModule.instance.monsterDict){var e=SceneItemModule.instance.monsterDict[t];if(e.dataMonster.monster_id==this.m_monsterId)return e.dataMonster.scene_monster_id}return 0},e.prototype.dataChanged=function(){if(this.checkComplete(this.dataChanged)){t.prototype.dataChanged.call(this),this.m_monsterId=this.data;var e=MonsterJson.getData(this.m_monsterId);this.u_imgIcon.source=PublicCon.PATH_BOSS_HEAD+e.icon_id+".png",this.u_iconNum.source="guessInsideUI_json.guessInsideUI_srl_"+(this.itemIndex+1),Dispatch.register(GuessBossManager.EVENT_GUESS_BOSS_MYCOST_CHANGE+this.m_monsterId,this.upMyCost,this,!0)}},e.prototype.upMyCost=function(){this.u_txtCost.text=GuessBossManager.instance.getMyCostByBossId(this.m_monsterId)+""},e}(ItemRendererBase);__reflect(GuessMyCostRender.prototype,"GuessMyCostRender");var GuessRecordRender=function(t){function e(){return t.call(this,"resource/eui_skins/guessBossUI/render/GuessRecordRenderSkin.exml")||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this)},e.prototype.dataChanged=function(){if(this.checkComplete(this.dataChanged)){t.prototype.dataChanged.call(this),this.m_data=this.data,this.u_txtId.text=GuessBossManager.instance.p_guessRecord.length-this.itemIndex+"";var e=GuessBossManager.instance.getBossIdx(this.m_data.boss_id);0>e?this.u_ingIcon.visible=!1:(this.u_ingIcon.visible=!0,this.u_ingIcon.x=39+88.7*e)}},e}(ItemRendererBase);__reflect(GuessRecordRender.prototype,"GuessRecordRender");var GuessBossAvatar=function(t){function e(e,i){var s=t.call(this)||this;return s.m_posXY=[[262,266],[458,376],[458,603],[262,747],[75,603],[75,376]],s.m_effList=[[0,0,.5],[0,0,.48],[0,0,.48],[0,-20,.55],[0,-30,.5],[0,0,.58]],s.touchEnabled=!1,s.m_idx=e,s.m_bossId=i,s.x=s.m_posXY[s.m_idx][0],s.y=s.m_posXY[s.m_idx][1],s.once(egret.Event.COMPLETE,s.onCompleted,s),s.skinName="resource/eui_skins/guessBossUI/view/GuessBossAvatarSkin.exml",s}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){},e.prototype.show=function(t){void 0===t&&(t=null),this.checkComplete(this.show,t)&&(this.m_effect||(this.m_effect=new EffectMovieClip,this.m_effect.x=this.width/2+this.m_effList[this.m_idx][0],this.m_effect.y=-60+this.m_effList[this.m_idx][1],this.m_effect.scaleX=this.m_effect.scaleY=this.m_effList[this.m_idx][2]),this.addChild(this.m_effect),this.u_imgBossId.source="guessInsideUI_json.guessInsideUI_boss_"+(this.m_idx+1),this.m_effect.setMC(MonsterJson.getAvatarPath(this.m_bossId)),this.m_effect.play())},e.prototype.hide=function(){this.m_effect&&(this.m_effect.destory(),this.m_effect=null)},Object.defineProperty(e.prototype,"width",{get:function(){return 130},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 56},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(GuessBossAvatar.prototype,"GuessBossAvatar");var GuessBossHead=function(t){function e(e){var i=t.call(this)||this;return i.m_idx=e,i.x=74+(i.width-5)*e,i.y=286,i.once(egret.Event.COMPLETE,i.onCompleted,i),i.skinName="resource/eui_skins/guessBossUI/view/GuessBossHeadSkin.exml",i}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){var t=GuessBossManager.instance.guessBossList;this.m_monsterId=t[this.m_idx],this.u_iconNum.source="guessInsideUI_json.guessInsideUI_srl_"+(this.m_idx+1),this.u_imgIcon.source=MonsterJson.getMonsterHeadPath(this.m_monsterId)},e.prototype.show=function(t){if(void 0===t&&(t=null),this.checkComplete(this.show,t)){var e=GuessBossManager.instance.getselectNum(this.m_monsterId);this.u_txtNum.text=e+""}},Object.defineProperty(e.prototype,"width",{get:function(){return 94},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 124},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(GuessBossHead.prototype,"GuessBossHead");var GuessMonster=function(t){function e(e){var i=t.call(this)||this;return i.m_bossId=0,i.m_dirList=[4,4,6,5,3,3],i.m_posId=e,i.x=i.getPosXY(e)[0],i.y=i.getPosXY(e)[1],i.touchEnabled=!1,i.touchChildren=!1,i}return __extends(e,t),e.prototype.show=function(t){Dispatch.remove(e.EVENT_GUESS_BOSS_FIGHT+this.m_bossId,this.startFight,this),Dispatch.remove(e.EVENT_GUESS_BOSS_HP+this.m_bossId,this.changeHP,this),Dispatch.remove(e.EVENT_GUESS_BOSS_SELECT,this.showSelectEffect,this),this.m_bossId=t,Dispatch.register(e.EVENT_GUESS_BOSS_FIGHT+this.m_bossId,this.startFight,this),Dispatch.register(e.EVENT_GUESS_BOSS_HP+this.m_bossId,this.changeHP,this),Dispatch.register(e.EVENT_GUESS_BOSS_SELECT,this.showSelectEffect,this),this.m_monster||(this.m_monster=new AvatarMonster);var i=new proto.SceneMonster,s=this.m_dirList[this.m_posId];this.m_monster.scaleX=1,5==s&&(s=6,this.m_monster.scaleX=-1),i.scene_monster_id=this.m_posId+1,i.monster_id=this.m_bossId,i.max_hp=100,i.hp=100,this.m_monster.setData(i),this.m_monster.x=this.width/2-this.m_monster.pointCentered[0],this.m_monster.y=this.height/2-this.m_monster.pointCentered[1],this.m_monster.alpha=0,this.m_monster.shiftToAction(AvatarConfig.ACTION_stand,s),this.addChild(this.m_monster),this.m_monster.liveName="",this.m_monster.hotTouchable=!1,GuessFightPopup.p_monsterList[this.m_bossId]=this.m_monster,this.m_monsterHp||(this.m_monsterHp=new GuessMonsterHp),this.addChild(this.m_monsterHp),this.m_monsterHp.show(this.m_bossId),this.m_monsterHp.x=this.m_monster.x-this.m_monsterHp.width/2,this.m_monsterHp.y=-200,this.m_monsterHp.alpha=0,this.setShowEffect(),this.m_selectEffect||(this.m_selectEffect=new EffectMovieClip,this.m_selectEffect.setMC(PublicCon.PATH_EFFECT_MONSTER+"luckSelect"),this.m_selectEffect.x=this.width/2,this.m_selectEffect.y=this.height/2),this.addChildAt(this.m_selectEffect,0),this.m_selectEffect.play(),this.m_selectEffect.visible=!1},e.prototype.setShowEffect=function(){this.m_showEffect||(this.m_showEffect=new EffectMovieClip,this.m_showEffect.setMC(PublicCon.PATH_EFFECT_MONSTER+"show"),this.m_showEffect.onCompleteFunc=this.removeEffect.bind(this),this.m_showEffect.regiestFrameFunc(4,this.stareShowCome.bind(this),!1)),this.m_showEffect.x=this.width/2,this.m_showEffect.y=this.height/2,this.m_showEffect.scaleX=2,this.m_showEffect.scaleY=2,this.addChild(this.m_showEffect),this.m_showEffect.play()},e.prototype.stareShowCome=function(){TweenLite.to(this.m_monster,.2,{alpha:1}),TweenLite.to(this.m_monsterHp,.2,{alpha:1})},e.prototype.startFight=function(){if(TimeManager.instance.clearTimer(this.sendMsg,this),GuessBossManager.instance.p_fightData.length>0){e.m_curFightData=GuessBossManager.instance.p_fightData.shift();var t=GuessBossManager.instance.p_posList.indexOf(e.m_curFightData.attack_id),i=Math.floor(2*Math.random());e.m_curTimes=-1,e.m_stopTimes=6*(i+2)+t+this.disNum,this.startSelectEffect()}else this.fightFinish()},e.prototype.startFightAction=function(){if(e.m_curFightData&&this.m_bossId==e.m_curFightData.attack_id){this.m_monster.shiftToAction(AvatarConfig.ACTION_attack01);for(var t in GuessFightPopup.p_monsterList){var i=GuessFightPopup.p_monsterList[t];i.jsonMonster&&i.jsonMonster.id!=e.m_curFightData.attack_id&&DelayCallUtils.delayedCall(.3,this.showGuangBo.bind(this,[i]),this)}DelayCallUtils.delayedCall(.8,this.clearMonster,this)}},e.prototype.startSelectEffect=function(){TimeManager.instance.doLoop(this.sendMsg,this,70)},Object.defineProperty(e.prototype,"disNum",{get:function(){var t=6-e.m_startPosId;return t>5&&(t=0),t},enumerable:!0,configurable:!0}),e.prototype.sendMsg=function(){e.m_startPosId>5&&(e.m_startPosId=0);var t=GuessBossManager.instance.p_posList[e.m_startPosId];GuessFightPopup.p_monsterList[t]?Dispatch.dispatch(e.EVENT_GUESS_BOSS_SELECT,e.m_startPosId):(e.m_startPosId++,e.m_curTimes++,this.sendMsg())},e.prototype.showSelectEffect=function(t){t==this.m_posId?(e.m_startPosId++,e.m_curTimes++,this.m_selectEffect.visible=!0):this.m_selectEffect.visible=!1,e.m_curTimes==e.m_stopTimes&&t==this.m_posId&&(TimeManager.instance.clearTimer(this.sendMsg,this),DelayCallUtils.delayedCall(.5,this.startFightAction,this))},e.prototype.showGuangBo=function(t){var e=t[0];FightUIModule.instance.showGuangBo(this.m_monster,e,PlayerManager.instance.p_mainPlayer.playerData.hero_arms_id,this.parent),DelayCallUtils.delayedCall(.2,this.showShouJi.bind(this,[e]),this)},e.prototype.showShouJi=function(t){var i=t[0],s=e.m_curFightData.die_id_list.indexOf(i.jsonMonster.id)>-1;FightUIModule.instance.showShouJi(i,PlayerManager.instance.p_mainPlayer),Dispatch.dispatch(e.EVENT_GUESS_BOSS_HP+i.jsonMonster.id,s)},e.prototype.clearMonster=function(){var t;if(e.m_curFightData.die_id_list)for(var i in e.m_curFightData.die_id_list){var s=e.m_curFightData.die_id_list[i];t=GuessFightPopup.p_monsterList[s],t&&(t.shiftToAction(AvatarConfig.ACTION_die),delete GuessFightPopup.p_monsterList[s])}if(0==GuessBossManager.instance.p_fightData.length)for(var i in GuessFightPopup.p_monsterList)t=GuessFightPopup.p_monsterList[i],t&&t.jsonMonster.id!=GuessBossManager.instance.p_winBoss&&(t.shiftToAction(AvatarConfig.ACTION_die),delete GuessFightPopup.p_monsterList[s]);DelayCallUtils.delayedCall(1.5,this.startFightNext,this)},e.prototype.changeHP=function(t){t?(this.m_monster.dataMonster.hp=0,this.m_monsterHp.refreshHP(0)):(this.m_monster.dataMonster.hp=this.m_monster.dataMonster.hp-.3*this.m_monster.dataMonster.hp,this.m_monsterHp.refreshHP(this.m_monster.dataMonster.hp/this.m_monster.dataMonster.max_hp))},e.prototype.startFightNext=function(){this.fightNextStart()},e.prototype.fightNextStart=function(){if(GuessBossManager.instance.p_fightData[0]){var t=GuessBossManager.instance.p_fightData[0].attack_id;GuessFightPopup.p_monsterList[t]?Dispatch.dispatch(e.EVENT_GUESS_BOSS_FIGHT+t):this.fightFinish()}else this.fightFinish()},e.prototype.fightFinish=function(){PopupModule.instance.havPopupStage(PopupConfig.ID_GUESS_BOSS_FIGHT)&&(e.m_startPosId=0,PopupModule.instance.hidePop(PopupConfig.ID_GUESS_BOSS_FIGHT))},e.prototype.removeEffect=function(){this.m_showEffect&&(this.m_showEffect.destory(),this.m_showEffect=null)},e.prototype.removeEffect2=function(){this.m_selectEffect&&(this.m_selectEffect.destory(),this.m_selectEffect=null)},e.prototype.removeMonster=function(){this.m_monster&&(this.m_monster.destory(),this.m_monster=null)},e.prototype.removeMonsterHP=function(){this.m_monsterHp&&(this.m_monsterHp.hide(),this.m_monsterHp=null)},e.prototype.getPosXY=function(t){var e=0,i=0;return 0==t?(e=640*(2/3)-this.width+45,i=.25*StageManager.instance.p_stageHeight-this.height):1==t?(e=512-this.width,i=.5*StageManager.instance.p_stageHeight-this.height+30):2==t?(e=640*(2/3)-this.width+45,i=.75*StageManager.instance.p_stageHeight-this.height+80):3==t?(e=640*(1/3)-this.width-25,i=.75*StageManager.instance.p_stageHeight-this.height+80):4==t?(e=128-this.width+30,i=.5*StageManager.instance.p_stageHeight-this.height+30):5==t&&(e=640*(1/3)-this.width-25,i=.25*StageManager.instance.p_stageHeight-this.height),[e,i]},e.prototype.hide=function(){this.removeMonster(),this.removeEffect(),this.removeEffect2(),this.removeMonsterHP(),DisplayObjectUtils.removeFormParent(this),TimeManager.instance.clearTimer(this.sendMsg,this),Dispatch.remove(e.EVENT_GUESS_BOSS_FIGHT+this.m_bossId,this.startFight,this),Dispatch.remove(e.EVENT_GUESS_BOSS_HP+this.m_bossId,this.changeHP,this),Dispatch.remove(e.EVENT_GUESS_BOSS_SELECT,this.showSelectEffect,this)},Object.defineProperty(e.prototype,"width",{get:function(){return 40},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 40},enumerable:!0,configurable:!0}),e.EVENT_GUESS_BOSS_FIGHT="EVENT_GUESS_BOSS_FIGHT",e.EVENT_GUESS_BOSS_HP="EVENT_GUESS_BOSS_HP",e.EVENT_GUESS_BOSS_SELECT="EVENT_GUESS_BOSS_SELECT",e.m_stopTimes=0,e.m_curTimes=0,e.m_startPosId=0,e}(egret.DisplayObjectContainer);__reflect(GuessMonster.prototype,"GuessMonster");var GuessMonsterHp=function(t){function e(){var e=t.call(this)||this;return e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/guessBossUI/view/GuessBossHPSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){t.prototype.onCompleted.call(this)},e.prototype.show=function(t){if(this.checkComplete(this.show,t)){var e=GuessBossManager.instance.getBossIdx(t);this.u_hpimg.width=this.u_hpLineimg.width=174,this.u_imgBossId.source="guessInsideUI_json.guessInsideUI_boss_"+(e+1),this.m_numberView||(this.m_numberView=new NumberView("guessInsideUI_json.guessInsideUI_cost_",0,-2),this.m_numberView.verticalCenter=0,this.m_numberView.p_isDoller=!0,this.m_numberView.x=70),this.u_grpTotal.addChild(this.m_numberView);var i=this.getMyCostByBossId(t);this.m_numberView.numValue=i}},e.prototype.getMyCostByBossId=function(t){var e=GuessFightPopup.p_myCost[t];return e?Number(e.num):0},e.prototype.refreshHP=function(t){this.u_hpimg.width=174*t,this.u_hpimg.width=this.u_hpimg.width>174?174:this.u_hpimg.width,TweenLite.to(this.u_hpLineimg,1,{width:this.u_hpimg.width,onComplete:this.hideHP.bind(this),onCompleteParams:[t]})},e.prototype.hideHP=function(t){0==t&&this.hide()},e.prototype.hide=function(){DisplayObjectUtils.removeFormParent(this)},Object.defineProperty(e.prototype,"width",{get:function(){return 206},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 100},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(GuessMonsterHp.prototype,"GuessMonsterHp");var GuessMyCost=function(t){function e(){var e=t.call(this)||this;return e.m_layout=new eui.TileLayout,e.m_typeList=new eui.ArrayCollection,e.m_showTypeX=1,e.m_isClick=!1,e.m_time=10,e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/guessBossUI/view/GuessMyCostSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.touchEnabled=!1,this.u_scrollerItem.horizontalScrollBar=null,this.u_scrollerItem.verticalScrollBar=null,this.m_layout.requestedColumnCount=3,this.m_layout.horizontalGap=14,this.m_layout.verticalGap=-8,this.u_listItem.itemRenderer=GuessMyCostRender,this.u_listItem.layout=this.m_layout,this.u_listItem.dataProvider=this.m_typeList},e.prototype.initEvent=function(){this.u_btnShow.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChange,this)},e.prototype.onChange=function(t){void 0===t&&(t=null),this.m_isClick||(this.m_isClick=!0,1==this.m_showTypeX?(this.m_showTypeX=2,TweenLite.to(this.u_grpCost,.4,{scaleX:0}),TweenLite.to(this.u_btnShow,.5,{scaleX:-1,onComplete:this.changeState.bind(this)})):(this.m_showTypeX=1,this.u_grpCost.visible=!0,TweenLite.to(this.u_grpCost,.4,{scaleX:1}),TweenLite.to(this.u_btnShow,.5,{scaleX:1,onComplete:this.changeState.bind(this)})),SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_1007))},e.prototype.changeState=function(){this.m_isClick=!1,2==this.m_showTypeX&&(this.u_grpCost.visible=!1)},e.prototype.show=function(t){void 0===t&&(t=null),this.checkComplete(this.show,t)&&(this.m_showTypeX=1,this.u_btnShow.scaleX=1,this.u_grpCost.scaleX=1,this.u_grpCost.visible=!0,Dispatch.register(GuessBossManager.EVENT_GUESS_BOSS_RESULT,this.showList,this,!0),this.startTimeDo())},e.prototype.showList=function(){this.m_typeList.source=GuessBossManager.instance.guessBossList},e.prototype.startTimeDo=function(){this.m_time=10,TimeManager.instance.doLoop(this.refreshTime,this,1e3)},e.prototype.refreshTime=function(){return this.m_time<=0?(TimeManager.instance.clearTimer(this.refreshTime,this),void(1==this.m_showTypeX&&this.onChange())):void this.m_time--},e.prototype.hide=function(){TweenLite.killTweensOf(this.u_grpCost),TweenLite.killTweensOf(this.u_btnShow),TimeManager.instance.clearTimer(this.refreshTime,this),Dispatch.remove(GuessBossManager.EVENT_GUESS_BOSS_RESULT,this.showList,this),DisplayObjectUtils.removeFormParent(this)},Object.defineProperty(e.prototype,"width",{get:function(){return 390},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 341},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(GuessMyCost.prototype,"GuessMyCost");var GuessRecordBtn=function(t){function e(){var e=t.call(this)||this;return e.initView(),e.initEvent(),e}return __extends(e,t),e.prototype.initView=function(){this.m_btnRecord||(this.m_btnRecord=new eui.Group,this.m_btnRecord.width=75,this.m_btnRecord.height=87),this.addChild(this.m_btnRecord),this.m_imgRecord||(this.m_imgRecord=new eui.Image("guessInsideUI_json.guessInsideUI_btn_record")),this.m_btnRecord.addChild(this.m_imgRecord)},e.prototype.initEvent=function(){this.registerEventClick(this.m_btnRecord,this.onGetRecord,this,!0)},e.prototype.onGetRecord=function(t){GuessBossManager.instance.s_mission_guess_get_record()},e.prototype.hide=function(){DisplayObjectUtils.removeFormParent(this)},Object.defineProperty(e.prototype,"width",{get:function(){return 75},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 87},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(GuessRecordBtn.prototype,"GuessRecordBtn");var GuessTotal=function(t){function e(){var e=t.call(this)||this;return e.m_lift=e,e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/guessBossUI/view/GuessTotalSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.m_numberView||(this.m_numberView=new NumberView("guessInsideUI_json.guessInsideUI_cost_",0,-2),this.m_numberView.verticalCenter=0,this.m_numberView.p_isDoller=!0,this.m_numberView.x=70,this.u_grpTotal.addChild(this.m_numberView))},e.prototype.show=function(t,e){if(this.checkComplete(this.show,t)){var i=GuessBossManager.instance.getBossIdx(e);-1!=i&&(this.m_numberView.numValue=t,this.u_imgBossId.source="guessInsideUI_json.guessInsideUI_boss_"+(i+1))}},e.prototype.hide=function(){this.m_numberView&&(this.m_numberView.hide(),this.m_numberView=null),DisplayObjectUtils.removeFormParent(this),this.m_lift=null},Object.defineProperty(e.prototype,"width",{get:function(){return 260},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 60},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(GuessTotal.prototype,"GuessTotal");var GuessUI=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/guessUI/GuessUISkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this)},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this),this.m_residueTime=GuessManager.instance.p_guessStep.time-ServerTimeManager.instance.timer,TimeManager.instance.doLoop(this.countDowDTime,this),SceneModule.instance.p_bossInfo.mission_type==MissionTypeEnum.MISSION_SCENE_BOSS_LOCATION&&(GuessManager.instance.p_guessType=0,this.m_guessPosView||(this.m_guessPosView=new GuessPosView,this.addChild(this.m_guessPosView)),this.m_guessPosView.showView()),SceneModule.instance.p_bossInfo.mission_type==MissionTypeEnum.MISSION_SCENE_BOSS_TIME_AND_COUNT&&(GuessManager.instance.p_guessType=1,this.m_guessAtkView||(this.m_guessAtkView=new GuessAtkView,this.addChild(this.m_guessAtkView)),this.m_guessAtkView.showView()),Dispatch.register(GuessManager.EVENT_GUESS_BOSS_STATE_CHANGE,this.changeState,this,!0))},e.prototype.countDowDTime=function(){return this.m_residueTime<=0?void TimeManager.instance.clearTimer(this.countDowDTime,this):(this.m_residueTime-=1,void(this.u_textTime.text=LanguageJson.getText("l_boss_guess_time_tip1")+TimeUtil.getSpliceTime2(this.m_residueTime)))},e.prototype.changeState=function(){2==GuessManager.instance.p_guessStep.step?this.u_grpUp.visible=!1:this.u_grpUp.visible=!0},e.prototype.hide=function(e,i){void 0===i&&(i=null),t.prototype.hide.call(this,e,i),Dispatch.remove(GuessManager.EVENT_GUESS_BOSS_STATE_CHANGE,this.changeState,this),TimeManager.instance.clearTimer(this.countDowDTime,this),this.m_guessPosView&&(this.m_guessPosView.hide(),this.m_guessPosView.visible=!1),this.m_guessAtkView&&(this.m_guessAtkView.hide(),this.m_guessAtkView.visible=!1)},e}(UIBase);__reflect(GuessUI.prototype,"GuessUI");var GuessLoserPopup=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/guessUI/popup/GuessLoserPopupSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_textTip.text=LanguageJson.getText("l_closePop_tip"),this.u_textTitle.text=LanguageJson.getText("l_boss_guess_result_loser_tip")},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnOK,this.close,this)},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&t.prototype.showView.call(this,e)},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i),UIModule.instance.setEventBubble(!1),SceneModule.instance.p_bossInfo.state=0},e}(PopupBase);__reflect(GuessLoserPopup.prototype,"GuessLoserPopup");var GuessWinPopup=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/guessUI/popup/GuessWinPopupSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_textTip1.text=LanguageJson.getText("l_boss_guess_result_tip2"),this.m_atkGoldNum=this.createAwardView(this.u_grpAtkTable,this.m_atkGoldNum),this.m_singleViewNum=this.createAwardView(this.u_grpType1,this.m_singleViewNum),this.m_rangeViewNum=this.createAwardView(this.u_grpType2,this.m_rangeViewNum),this.m_numGoldView=this.createAwardView(this.u_grpType3,this.m_numGoldView),this.m_numberView||(this.m_numberView=new NumberView("guessWinUI_img_num_",0,0),this.u_grpType3.addChild(this.m_numberView),this.m_numberView.x=24,this.m_numberView.y=20),this.m_awardViewNum||(this.m_awardViewNum=new NumberView("guessWinUI_img_gold_",0,0),this.addChild(this.m_awardViewNum),this.m_awardViewNum.p_isAnchorOffsetX=!0,this.m_awardViewNum.p_backFunc=this.setAwardNumXY.bind(this),this.m_awardViewNum.x=568,this.m_awardViewNum.y=260.502,this.m_awardViewNum.scaleX=this.m_awardViewNum.scaleY=.8),this.m_atkViewNum||(this.m_atkViewNum=new NumberView("guessWinUI_img_num_",0,0),this.u_grpAtkTable.addChild(this.m_atkViewNum),this.m_atkViewNum.p_isAnchorOffsetX=!0,this.m_atkViewNum.x=44,this.m_atkViewNum.y=28,this.m_atkViewNum.scaleX=this.m_atkViewNum.scaleY=.8)
},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnOK,this.close,this)},e.prototype.showView=function(e){if(void 0===e&&(e=null),this.checkComplete(this.showView,e)){t.prototype.showView.call(this,e),this.m_residueTime=10,TimeManager.instance.doLoop(this.countDowDTime,this);var i=GuessManager.instance.p_resultData.win_name;if(""==i)this.u_textTitle.text=LanguageJson.getText("l_boss_guess_result_title2");else{var s=TextUtil.setText(i,65407);this.u_textTitle.textFlow=HtmlUtil.setTextFlow(LanguageJson.getHtmlText("l_boss_guess_result_title1",[s]))}var n=NumberUtil.numberToString(GuessManager.instance.p_resultData.win_award_value);this.m_awardViewNum.setMsgString(n);var o=GuessManager.instance.p_resultData.scene_boss_bet_award;this.u_grpPos.visible=!1,this.u_grpAtkTable.visible=!1,this.u_imgSingle.visible=!1,this.u_imgDouble.visible=!1,this.u_imgMax.visible=!1,this.u_imgMin.visible=!1,this.setMsgText(this.m_numGoldView,1),this.m_numberView.setMsgString("1"),this.setMsgText(this.m_singleViewNum,0),this.setMsgText(this.m_singleViewNum,0),this.setMsgText(this.m_rangeViewNum,0),this.setMsgText(this.m_numGoldView,0);for(var a=0;a<o.length;a++){var r=StaticDataJson.parseStrToList("scene_boss_location_list"),_=StaticDataJson.parseStrToList("scene_boss_count_list");if(0==GuessManager.instance.p_guessType)this.u_grpPos.visible=!0,o[a].id==r[6][0]?(this.setMsgText(this.m_singleViewNum,o[a].num),this.u_imgSingle.visible=!0):o[a].id==r[7][0]?(this.setMsgText(this.m_singleViewNum,o[a].num),this.u_imgDouble.visible=!0):o[a].id==r[8][0]?(this.setMsgText(this.m_rangeViewNum,o[a].num),this.u_imgMax.visible=!0):o[a].id==r[9][0]?(this.setMsgText(this.m_rangeViewNum,o[a].num),this.u_imgMin.visible=!0):o[a].num>=0&&(this.setMsgText(this.m_numGoldView,o[a].num),this.m_numberView.setMsgString(o[a].id+""));else if(1==GuessManager.instance.p_guessType){this.u_grpAtkTable.visible=!0,this.setMsgText(this.m_atkGoldNum,o[a].num);var h=_[o[a].id][1][0];h=h+"~"+("0"==_[o[a].id][1][1]?"y":_[o[a].id][1][1]),this.m_atkViewNum.setMsgString(h)}}}},e.prototype.createAwardView=function(t,e){return e||(e=new NumberView("guessWinUI_img_gold_",0,0),t.addChild(e),e.x=118,e.y=18,e.scaleX=e.scaleY=.5),e},e.prototype.setMsgText=function(t,e){var i=NumberUtil.numberToString(e).replace(".","d");t.setMsgString(i)},e.prototype.countDowDTime=function(){this.m_residueTime<=1&&TimeManager.instance.clearTimer(this.countDowDTime,this),this.m_residueTime-=1,this.u_textTip2.textFlow=LanguageJson.getHtmlTextFlow("l_boss_guess_result_tip1",[this.m_residueTime])},e.prototype.setAwardNumXY=function(){this.u_imgGold.x=this.m_awardViewNum.x-this.m_awardViewNum.width-15},e.prototype.showFlyEffect=function(){var t=UIModule.instance.pointGold,e=UIModule.instance.pointRmb,i=GuessManager.instance.p_resultData.win_award_value<=0?0:10;FlyResModule.instance.playResEffect4([444,262],t,ItemEnum.GOLD,i);for(var s=GuessManager.instance.p_resultData.scene_boss_bet_award,n=0;n<s.length;n++){var o=StaticDataJson.parseStrToList("scene_boss_location_list"),a=(StaticDataJson.parseStrToList("scene_boss_count_list"),s[n].num<=0?0:10);0==GuessManager.instance.p_guessType?s[n].id==o[6][0]||s[n].id==o[7][0]?FlyResModule.instance.playResEffect4([280,370],e,ItemEnum.RMB,a):s[n].id==o[8][0]||s[n].id==o[9][0]?FlyResModule.instance.playResEffect4([540,370],e,ItemEnum.RMB,a):s[n].num>=0&&FlyResModule.instance.playResEffect4([790,370],e,ItemEnum.RMB,a):1==GuessManager.instance.p_guessType&&FlyResModule.instance.playResEffect4([540,370],e,ItemEnum.RMB,a)}},Object.defineProperty(e.prototype,"isClickBMask",{get:function(){return!1},enumerable:!0,configurable:!0}),e.prototype.hide=function(e,i){this.showFlyEffect(),t.prototype.hide.call(this,e,i),TimeManager.instance.clearTimer(this.countDowDTime,this),UIModule.instance.setEventBubble(!1),SceneModule.instance.p_bossInfo.state=0},e}(PopupBase);__reflect(GuessWinPopup.prototype,"GuessWinPopup");var GuessAtkRender=function(t){function e(){return t.call(this,"resource/eui_skins/guessUI/render/GuessAtkRenderSkin.exml")||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this),this.m_goldMy||(this.m_goldMy=new NumberView("guessUI_img_gold_",0,0),this.m_goldMy.x=55,this.m_goldMy.y=8,this.u_grpMy.addChild(this.m_goldMy)),this.m_goldAll||(this.m_goldAll=new NumberView("guessUI_img_gold_",0,0),this.m_goldAll.x=55,this.m_goldAll.y=8,this.u_grpAll.addChild(this.m_goldAll))},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickEvent,this)},e.prototype.dataChanged=function(){if(this.checkComplete(this.dataChanged)){if(t.prototype.dataChanged.call(this),Dispatch.register(GuessManager.EVENT_GUESS_BOSS_NUMBER,this.onNotice,this),Dispatch.register(GuessManager.EVENT_GUESS_BOSS_BTN_CHANGE,this.changeBtn,this,!0),Dispatch.register(GuessManager.EVENT_GUESS_BOSS_UPDATE,this.upData,this,!0),this.m_atkJson=this.data,!this.m_wagerNum){this.m_wagerNum=new NumberView("guessUI_img_num_",0,0),this.addChild(this.m_wagerNum),this.m_wagerNum.p_isAnchorOffsetX=!0,this.m_wagerNum.x=108,this.m_wagerNum.y=50,this.m_wagerNum.scaleX=this.m_wagerNum.scaleY=.8;var e=this.m_atkJson[1][0];e=e+"~"+("0"==this.m_atkJson[1][1]?"y":this.m_atkJson[1][1]),this.m_wagerNum.setMsgString(e)}this.u_textRate.text="x"+Number(this.data[2]/1e4)}},e.prototype.upData=function(){var t;if(0==GuessManager.instance.p_guessData.scene_boss_bet_list.length&&(this.u_grpMy.visible=!1,this.u_grpAll.visible=!1,this.u_textTouch.visible=!0),1==GuessManager.instance.p_guessData.scene_boss_bet_list.length)t=GuessManager.instance.p_guessData.scene_boss_bet_list[0];else for(var e=0;e<GuessManager.instance.p_guessData.scene_boss_bet_list.length;e++)if(this.data&&this.data[0]==GuessManager.instance.p_guessData.scene_boss_bet_list[e].id){t=GuessManager.instance.p_guessData.scene_boss_bet_list[e];break}if(t&&this.data[0]==t.id){if(t.my_num>0){this.u_grpMy.visible=!0;var i=NumberUtil.numberToString(t.my_num).replace("K","i");i=i.replace(".","d"),this.m_goldMy.setMsgString(i),this.u_textTouch.visible=!1}else this.u_grpMy.visible=!1,this.u_grpAll.visible=!1,this.u_textTouch.visible=!0;if(t.total_num>0){this.u_grpAll.visible=!0;var i=NumberUtil.numberToString(t.total_num).replace("K","i");i=i.replace(".","d"),this.m_goldAll.setMsgString(i),this.u_textTouch.visible=!1}else this.u_grpMy.visible=!1,this.u_grpAll.visible=!1,this.u_textTouch.visible=!0}},e.prototype.onNotice=function(){this.data&&GuessManager.instance.p_selectedNum==this.data[0]?this.u_imgSelected.visible=!0:this.u_imgSelected.visible=!1},e.prototype.changeBtn=function(){GuessManager.instance.p_guessStep.step>=2?(this.u_imgSelected.visible=!1,this.touchEnabled=!1):this.touchEnabled=!0},e.prototype.onClickEvent=function(t){GuessManager.instance.p_guessStep.step>=2||GuessManager.instance.p_selectedNum!=this.data[0]&&(GuessManager.instance.p_selectedNum=this.data[0],Dispatch.dispatch(GuessManager.EVENT_GUESS_BOSS_NUMBER))},e.prototype.hide=function(){this.checkComplete(this.hide)&&(Dispatch.remove(GuessManager.EVENT_GUESS_BOSS_NUMBER,this.onNotice,this),Dispatch.remove(GuessManager.EVENT_GUESS_BOSS_UPDATE,this.upData,this),Dispatch.remove(GuessManager.EVENT_GUESS_BOSS_BTN_CHANGE,this.changeBtn,this))},e}(ItemRendererBase);__reflect(GuessAtkRender.prototype,"GuessAtkRender");var GuessChipRender=function(t){function e(){var e=t.call(this)||this;return e.m_index=0,e.m_nameArr=[],e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/guessUI/render/GuessChipRenderSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){},e.prototype.initEvent=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickEvent,this)},e.prototype.showView=function(t,e){this.checkComplete(this.showView)&&(Dispatch.register(GuessManager.EVENT_GUESS_BOSS_CHIP,this.onChipEvent,this),this.m_jsonData=t,this.m_index=e,this.m_imgBg||(this.m_imgBg=new eui.Image("guessUI_img_cm"+e),this.m_imgBg.y=1,this.u_grpChip.addChild(this.m_imgBg),this.m_imgBg.touchEnabled=!1))},e.prototype.onChipEvent=function(){this.m_jsonData&&GuessManager.instance.p_selecteChip==this.m_index?this.u_imgChip_Light.visible=!0:this.u_imgChip_Light.visible=!1},e.prototype.onClickEvent=function(t){GuessManager.instance.p_selecteChip=this.m_index,Dispatch.dispatch(GuessManager.EVENT_GUESS_BOSS_CHIP),this.m_jsonData&&!BagManager.instance.isEnoughProp([this.m_jsonData[0],this.m_jsonData[1]],!1)&&FloatTipModule.instance.popTipLanguage("l_game_tips_20"),GuessManager.instance.p_selectedNum>=0&&GuessManager.instance.s_mission_scene_boss_bet(GuessManager.instance.p_guessType,GuessManager.instance.p_selectedNum,this.m_jsonData[1])},e.prototype.hide=function(){this.checkComplete(this.hide)&&(DisplayObjectUtils.removeFormParent(this),Dispatch.remove(GuessManager.EVENT_GUESS_BOSS_CHIP,this.onChipEvent,this))},e}(ComponentBase);__reflect(GuessChipRender.prototype,"GuessChipRender");var GuessPosBigRender=function(t){function e(){return t.call(this,"resource/eui_skins/guessUI/render/GuessPosBigRenderSkin.exml")||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this),this.m_nameArr=[],this.m_goldMy||(this.m_goldMy=new NumberView("guessUI_img_gold_",0,0),this.m_goldMy.x=55,this.m_goldMy.y=0,this.u_grpMy.addChild(this.m_goldMy)),this.m_goldAll||(this.m_goldAll=new NumberView("guessUI_img_gold_",0,0),this.m_goldAll.x=55,this.m_goldAll.y=8,this.u_grpAll.addChild(this.m_goldAll))},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickEvent,this)},e.prototype.onNotice=function(){this.data&&GuessManager.instance.p_selectedNum==this.data[0]?this.u_imgSelected.visible=!0:this.u_imgSelected.visible=!1},e.prototype.dataChanged=function(){if(this.checkComplete(this.dataChanged)&&(t.prototype.dataChanged.call(this),Dispatch.register(GuessManager.EVENT_GUESS_BOSS_NUMBER,this.onNotice,this),Dispatch.register(GuessManager.EVENT_GUESS_BOSS_UPDATE,this.upData,this,!0),Dispatch.register(GuessManager.EVENT_GUESS_BOSS_BTN_CHANGE,this.changeBtn,this,!0),this.m_nameArr[7]="guessUI_img_odd",this.m_nameArr[8]="guessUI_img_double",this.m_nameArr[9]="guessUI_img_big",this.m_nameArr[10]="guessUI_img_small",!this.m_imgSmall)){var e=this.data[0],i=this.m_nameArr[e];this.m_imgSmall=new eui.Image("guessUI_json."+i),this.addChild(this.m_imgSmall),this.m_imgSmall.x=69,this.m_imgSmall.y=17}},e.prototype.upData=function(){var t;if(0==GuessManager.instance.p_guessData.scene_boss_bet_list.length&&(this.u_grpMy.visible=!1,this.u_grpAll.visible=!1,this.u_textTouch.visible=!0),1==GuessManager.instance.p_guessData.scene_boss_bet_list.length)t=GuessManager.instance.p_guessData.scene_boss_bet_list[0];else for(var e=0;e<GuessManager.instance.p_guessData.scene_boss_bet_list.length;e++)if(this.data&&this.data[0]==GuessManager.instance.p_guessData.scene_boss_bet_list[e].id){t=GuessManager.instance.p_guessData.scene_boss_bet_list[e];break}if(t&&this.data[0]==t.id){if(t.my_num>0){this.u_grpMy.visible=!0;var i=NumberUtil.numberToString(t.my_num).replace("K","i");i=i.replace(".","d"),this.m_goldMy.setMsgString(i),this.u_textTouch.visible=!1}else this.u_grpMy.visible=!1,this.u_grpAll.visible=!1,this.u_textTouch.visible=!0;if(t.total_num>0){this.u_grpAll.visible=!0;var i=NumberUtil.numberToString(t.total_num).replace("K","i");i=i.replace(".","d"),this.m_goldAll.setMsgString(i),this.u_textTouch.visible=!1}else this.u_grpMy.visible=!1,this.u_grpAll.visible=!1,this.u_textTouch.visible=!0}},e.prototype.changeBtn=function(){GuessManager.instance.p_guessStep.step>=2?(this.u_imgSelected.visible=!1,this.touchEnabled=!1):this.touchEnabled=!0},e.prototype.onClickEvent=function(t){GuessManager.instance.p_guessStep.step>=2||GuessManager.instance.p_selectedNum!=this.data[0]&&(GuessManager.instance.p_selectedNum=this.data[0],Dispatch.dispatch(GuessManager.EVENT_GUESS_BOSS_NUMBER))},e.prototype.hide=function(){this.checkComplete(this.hide)&&(Dispatch.remove(GuessManager.EVENT_GUESS_BOSS_NUMBER,this.onNotice,this),Dispatch.remove(GuessManager.EVENT_GUESS_BOSS_UPDATE,this.upData,this),Dispatch.remove(GuessManager.EVENT_GUESS_BOSS_BTN_CHANGE,this.changeBtn,this))},e}(ItemRendererBase);__reflect(GuessPosBigRender.prototype,"GuessPosBigRender");var GuessPosSmallRender=function(t){function e(){return t.call(this,"resource/eui_skins/guessUI/render/GuessPosSmallRenderSkin.exml")||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this),this.m_goldMy||(this.m_goldMy=new NumberView("guessUI_img_gold_",0,0),this.m_goldMy.x=55,this.m_goldMy.y=8,this.u_grpMy.addChild(this.m_goldMy)),this.m_goldAll||(this.m_goldAll=new NumberView("guessUI_img_gold_",0,0),this.m_goldAll.x=55,this.m_goldAll.y=10,this.u_grpAll.addChild(this.m_goldAll))},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickEvent,this)},e.prototype.dataChanged=function(){this.checkComplete(this.dataChanged)&&(t.prototype.dataChanged.call(this),Dispatch.register(GuessManager.EVENT_GUESS_BOSS_NUMBER,this.onNotice,this),Dispatch.register(GuessManager.EVENT_GUESS_BOSS_UPDATE,this.upData,this,!0),Dispatch.register(GuessManager.EVENT_GUESS_BOSS_BTN_CHANGE,this.changeBtn,this,!0),this.m_numberView||(this.m_numberView=new NumberView("guessUI_img_num_",0,0),this.m_numberView.x=32.995,this.m_numberView.y=20,this.addChild(this.m_numberView)),this.m_numberView.numValue=this.data[0])},e.prototype.upData=function(){var t;if(1==GuessManager.instance.p_guessData.scene_boss_bet_list.length)t=GuessManager.instance.p_guessData.scene_boss_bet_list[0];else for(var e=0;e<GuessManager.instance.p_guessData.scene_boss_bet_list.length;e++)if(this.data&&this.data[0]==GuessManager.instance.p_guessData.scene_boss_bet_list[e].id){t=GuessManager.instance.p_guessData.scene_boss_bet_list[e];break}if(t&&this.data[0]==t.id){if(t.my_num>0){this.u_grpMy.visible=!0;var i=NumberUtil.numberToString(t.my_num).replace("K","i");i=i.replace(".","d"),this.m_goldMy.setMsgString(i),this.u_textTouch.visible=!1}else this.u_grpMy.visible=!1,this.u_grpAll.visible=!1,this.u_textTouch.visible=!0;if(t.total_num>0){this.u_grpAll.visible=!0;var i=NumberUtil.numberToString(t.total_num).replace("K","i");i=i.replace(".","d"),this.m_goldAll.setMsgString(i),this.u_textTouch.visible=!1}else this.u_grpMy.visible=!1,this.u_grpAll.visible=!1,this.u_textTouch.visible=!0}},e.prototype.onNotice=function(){this.data&&GuessManager.instance.p_selectedNum==this.data[0]?this.u_imgSelected.visible=!0:this.u_imgSelected.visible=!1},e.prototype.changeBtn=function(){GuessManager.instance.p_guessStep.step>=2?(this.u_imgSelected.visible=!1,this.touchEnabled=!1):this.touchEnabled=!0},e.prototype.onClickEvent=function(t){GuessManager.instance.p_guessStep.step>=2||GuessManager.instance.p_selectedNum!=this.data[0]&&(GuessManager.instance.p_selectedNum=this.data[0],Dispatch.dispatch(GuessManager.EVENT_GUESS_BOSS_NUMBER))},e.prototype.hide=function(){this.checkComplete(this.hide)&&(Dispatch.remove(GuessManager.EVENT_GUESS_BOSS_NUMBER,this.onNotice,this),Dispatch.remove(GuessManager.EVENT_GUESS_BOSS_UPDATE,this.upData,this),Dispatch.remove(GuessManager.EVENT_GUESS_BOSS_BTN_CHANGE,this.changeBtn,this))},e}(ItemRendererBase);__reflect(GuessPosSmallRender.prototype,"GuessPosSmallRender");var GuessAtkView=function(t){function e(){var e=t.call(this)||this;return e.m_chipArr=[],e.m_layout=new eui.TileLayout,e.m_typeList=new eui.ArrayCollection,e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/guessUI/view/GuessAtkViewSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.m_layout.requestedColumnCount=4,this.u_listItem.itemRenderer=GuessAtkRender,this.u_listItem.layout=this.m_layout,this.u_listItem.dataProvider=this.m_typeList;for(var t=StaticDataJson.parseStrToList("scene_boss_guess_cost_list"),e=0;e<t.length;e++){var i=new GuessChipRender;this.u_grpChip.addChild(i),i.x=120*e,this.m_chipArr.push(i)}},e.prototype.initEvent=function(){this.registerEventClick(this.u_btnClean,this.onCleanEvent,this)},e.prototype.showView=function(t){if(void 0===t&&(t=null),this.checkComplete(this.showView,t)){Dispatch.register(GuessManager.EVENT_GUESS_BOSS_STATE_CHANGE,this.changeState,this,!0),this.m_typeList.source=StaticDataJson.parseStrToList("scene_boss_count_list");var e=TextUtil.setText(LanguageJson.getText("l_boss_guess_atk_title"),16711680);this.u_textTitle.textFlow=HtmlUtil.setTextFlow(LanguageJson.getHtmlText("l_boss_guess_atk_tip",[e]));for(var i=0;i<this.m_chipArr.length;i++){var s=StaticDataJson.parseStrToList("scene_boss_guess_cost_list");this.m_chipArr[i].showView(s[i],i+1)}this.visible=!0}},e.prototype.changeState=function(){2==GuessManager.instance.p_guessStep.step?(this.u_grpChip.visible=!1,this.u_btnClean.visible=!1):(this.u_grpChip.visible=!0,this.u_btnClean.visible=!0)},e.prototype.onCleanEvent=function(){GuessManager.instance.s_mission_scene_boss_bet_reset(GuessManager.instance.p_guessType)},e.prototype.hide=function(){this.checkComplete(this.hide)&&Dispatch.remove(GuessManager.EVENT_GUESS_BOSS_STATE_CHANGE,this.changeState,this)},e}(ComponentBase);__reflect(GuessAtkView.prototype,"GuessAtkView");var STATUS;!function(t){t[t.EVENT_STATE_NULL=0]="EVENT_STATE_NULL",t[t.EVENT_STATE_WAIT=1]="EVENT_STATE_WAIT",t[t.EVENT_STATE_FIGHT=2]="EVENT_STATE_FIGHT"}(STATUS||(STATUS={}));var GuessInfoView=function(t){function e(){var e=t.call(this)||this;return e.m_fightTime=0,e.m_residueTime=0,e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/guessUI/view/GuessInfoViewSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.y=170,this.u_textAtk_Title.text=LanguageJson.getText("l_boss_guess_info_atk_title"),this.u_textFight_Title.text=LanguageJson.getText("l_boss_guess_info_fight_title")},e.prototype.initEvent=function(){this.registerEventClick(this.u_btnEnter,this.onEnterClick,this)},e.prototype.showView=function(t){if(void 0===t&&(t=null),this.checkComplete(this.showView,t)){if(Dispatch.register(GuessManager.EVENT_GUESS_BOSS_DAO_NUM,this.changeDaoNum,this),this.m_fightNumView||(this.m_fightNumView=new NumberView("guessUI_img_gold_",0,0),this.m_fightNumView.x=86,this.m_fightNumView.y=10,this.u_grpFight.addChild(this.m_fightNumView)),GuessManager.instance.p_guessStep.step==STATUS.EVENT_STATE_WAIT)this.u_grpFight.visible=!1,this.u_grpAtkNum.visible=!1,this.m_residueTime=GuessManager.instance.p_guessStep.time-ServerTimeManager.instance.timer,TimeManager.instance.doLoop(this.countDowDTime,this),UIModule.instance.showUI(UIConfig.ID_BOSS_GUESS);else if(GuessManager.instance.p_guessStep.step==STATUS.EVENT_STATE_FIGHT){this.u_textTime.text=LanguageJson.getText("l_boss_guess_time_end_tip"),this.u_grpFight.visible=!0;var e=GuessManager.instance.p_guessStep.time;this.m_fightTime=e-ServerTimeManager.instance.timer,TimeManager.instance.doLoop(this.fightTimeDoGo,this),SceneModule.instance.p_bossInfo.mission_type==MissionTypeEnum.MISSION_SCENE_BOSS_TIME_AND_COUNT&&(this.u_grpAtkNum.visible=!0,GuessManager.instance.p_guessType=1)}SceneModule.instance.p_bossInfo.mission_type==MissionTypeEnum.MISSION_SCENE_BOSS_LOCATION&&(this.u_grpAtkNum.visible=!1,GuessManager.instance.p_guessType=0),this.m_afkCount||(this.m_afkCount=new NumberView("guessUI_img_gold_",0,0),this.m_afkCount.x=86,this.m_afkCount.y=10,this.u_grpAtkNum.addChild(this.m_afkCount));var i=NumberUtil.numberDecimalism(0);i=i.replace(/,/g,"d"),this.m_afkCount.setMsgString(i+"k"),this.setPosition()}},e.prototype.setPosition=function(){var t=20;this.u_grpFight.visible&&(t=this.u_grpFight.y+this.u_grpFight.height+20),this.u_grpAtkNum.visible&&(t=this.u_grpAtkNum.y+this.u_grpAtkNum.height+20),this.u_grpIcon.y=t},e.prototype.fightTimeDoGo=function(){if(this.m_fightTime<=0)return void TimeManager.instance.clearTimer(this.fightTimeDoGo,this);this.m_fightTime-=1;var t=TimeUtil.getSpliceTime2(this.m_fightTime)+"";t=t.replace(/:/g,"e"),this.m_fightNumView.setMsgString(t)},e.prototype.countDowDTime=function(){return this.m_residueTime<=0?(TimeManager.instance.clearTimer(this.countDowDTime,this),this.u_textTime.text=LanguageJson.getText("l_boss_guess_time_end_tip"),void UIModule.instance.hideUI(UIConfig.ID_BOSS_GUESS)):(this.m_residueTime-=1,void(this.u_textTime.text=LanguageJson.getText("l_boss_guess_time_tip2")+TimeUtil.getSpliceTime2(this.m_residueTime)))},e.prototype.changeDaoNum=function(){var t=NumberUtil.numberDecimalism(GuessManager.instance.p_guessDao.value);t=t.replace(/,/g,"d"),this.m_afkCount.setMsgString(t+"k")},e.prototype.onEnterClick=function(t){UIModule.instance.showUI(UIConfig.ID_BOSS_GUESS)},e.prototype.hide=function(){DisplayObjectUtils.removeFormParent(this),TimeManager.instance.clearTimer(this.fightTimeDoGo,this),TimeManager.instance.clearTimer(this.countDowDTime,this),Dispatch.remove(GuessManager.EVENT_GUESS_BOSS_DAO_NUM,this.changeDaoNum,this)},e}(ComponentBase);__reflect(GuessInfoView.prototype,"GuessInfoView");var GuessPosView=function(t){function e(){var e=t.call(this)||this;return e.m_chipArr=[],e.m_layout=new eui.TileLayout,e.m_typeList=new eui.ArrayCollection,e.m_layout1=new eui.TileLayout,e.m_typeList1=new eui.ArrayCollection,e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/guessUI/view/GuessPosViewSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.m_layout.requestedColumnCount=6,this.u_listItem.itemRenderer=GuessPosSmallRender,this.u_listItem.layout=this.m_layout,this.u_listItem.dataProvider=this.m_typeList,this.m_layout1.horizontalGap=50,this.m_layout1.requestedColumnCount=4,this.u_listItem1.itemRenderer=GuessPosBigRender,this.u_listItem1.layout=this.m_layout1,this.u_listItem1.dataProvider=this.m_typeList1;for(var t=StaticDataJson.parseStrToList("scene_boss_guess_cost_list"),e=0;e<t.length;e++){var i=new GuessChipRender;this.u_grpChip.addChild(i),i.x=120*e,this.m_chipArr.push(i)}},e.prototype.initEvent=function(){this.registerEventClick(this.u_btnClean,this.onCleanEvent,this,!0)},e.prototype.showView=function(t){if(void 0===t&&(t=null),this.checkComplete(this.showView,t)){Dispatch.register(GuessManager.EVENT_GUESS_BOSS_STATE_CHANGE,this.changeState,this,!0);var e=StaticDataJson.parseStrToList("scene_boss_guess_cost_list");GuessManager.instance.p_selecteChip=e[0][0];for(var i=StaticDataJson.parseStrToList("scene_boss_location_list"),s=[],n=[],o=0;o<i.length;o++)6>o?s.push(i[o]):n.push(i[o]);this.m_typeList.source=s,this.m_typeList1.source=n;var a=StaticDataJson.parseStrToList("scene_boss_location_list");this.u_textRateName0.text=LanguageJson.getText("l_boss_guess_rate"),this.u_textRateName1.text=LanguageJson.getText("l_boss_guess_rate"),this.u_textRate_0.text=LanguageJson.getText("l_boss_guess_rate")+" x"+Number(a[0][2]/1e4),this.u_textRate_1.text="x"+Number(a[7][2]/1e4),this.u_textRate_2.text="x"+Number(a[9][2]/1e4);var r=TextUtil.setText(LanguageJson.getText("l_boss_guess_pos_title"),16711680);this.u_textTitle.textFlow=HtmlUtil.setTextFlow(LanguageJson.getHtmlText("l_boss_guess_pos_tip",[r]));for(var o=0;o<this.m_chipArr.length;o++){var _=StaticDataJson.parseStrToList("scene_boss_guess_cost_list");this.m_chipArr[o].showView(_[o],o+1)}this.visible=!0}},e.prototype.changeState=function(){2==GuessManager.instance.p_guessStep.step?(this.u_grpChip.visible=!1,this.u_btnClean.visible=!1):(this.u_grpChip.visible=!0,this.u_btnClean.visible=!0)},e.prototype.onCleanEvent=function(){GuessManager.instance.s_mission_scene_boss_bet_reset(GuessManager.instance.p_guessType)},e.prototype.hide=function(){this.checkComplete(this.hide)&&Dispatch.remove(GuessManager.EVENT_GUESS_BOSS_STATE_CHANGE,this.changeState,this)},e}(ComponentBase);__reflect(GuessPosView.prototype,"GuessPosView");var GuideConfig=function(){function t(){}return t.guide_ui_close="guide_ui_close",t.guide_popup_close="guide_popup_close",t.guide_render_click="guide_render_click",t.guide_scene_npc_city="guide_scene_npc_city",t.guide_scene_monster="guide_scene_monster",t.guide_function_icon="guide_function_icon",t.guide_task="guide_task",t.guide_popup_msg="guide_popup_msg",t.guide_page_entrance="guide_page_entrance",t.guide_attack_key="guide_attack_key",t.guide_2_1="guide_2_1",t.guide_3_1="guide_3_1",t.guide_4_2="guide_4_2",t.guide_41_1="guide_41_1",t.guide_7_1="guide_7_1",t.guide_7_4="guide_7_4",t.guide_8_1="guide_8_1",t.guide_8_2="guide_8_2",t.guide_8_3="guide_8_3",t.guide_11_1="guide_11_1",t.guide_11_2="guide_11_2",t}();__reflect(GuideConfig.prototype,"GuideConfig");var GuideMask=function(t){function e(e){var i=t.call(this)||this;if(i.m_monsterRid=0,i.m_isMove=!1,i.m_mask_alpha=.2,i.m_initPoint=new egret.Point(0,0),i.m_goPoint=new egret.Point,i.m_delayTime=0,i.m_clickTime=0,i.m_clickBool=!1,i.touchEnabled=!1,i.alpha=0,i.m_backFunc=e,i.m_bgmMenk||(i.m_bgmMenk=new eui.Image("commonUI_box"),i.m_bgmMenk.alpha=0,i.m_bgmMenk.scale9Grid=UIModule.instance.getRectangle(),i.addChild(i.m_bgmMenk)),!i.m_iconList){i.m_iconList=[];for(var s=0;5>s;s++){var n;0==s?(n=new eui.Image("resource/assets/icon/guide/guide.png"),n.addEventListener(egret.TouchEvent.TOUCH_TAP,i.onClickContent,i),n.addEventListener(egret.TouchEvent.TOUCH_BEGIN,i.onSetAuto1,i),n.addEventListener(egret.TouchEvent.TOUCH_END,i.onSetAutoEnd,i)):(n=new eui.Image("resource/assets/icon/guide/guide_zhe.png"),n.scale9Grid=new egret.Rectangle(2,2,7,7),n.addEventListener(egret.TouchEvent.TOUCH_TAP,i.onClick,i),n.smoothing=!0,n.visible=!1),i.addChild(n),i.m_iconList.push(n)}}return i.m_arrowImg||(i.m_arrowImg=new eui.Image("commonsUI_jiantou"),i.m_arrowImg.anchorOffsetX=28,i.m_arrowImg.anchorOffsetY=38.5),i.m_gudieView||(i.m_gudieView=new GuideView),i.m_effects||(i.m_effects=new EffectMovieClip,i.m_effects.touchEnabled=!1,i.m_effects.touchChildren=!1,i.m_effects.setMC("resource/assets/uiEffect/guide/guideClick")),i}return __extends(e,t),e.prototype.onSetAuto1=function(t){t.stopImmediatePropagation(),t.stopPropagation(),this.isAttackAuto&&DelayCallUtils.delayedCall(.3,this.autoAttackMonster,this)},e.prototype.onSetAutoEnd=function(t){t.stopImmediatePropagation(),t.stopPropagation(),DelayCallUtils.killDelayedCallsTo(this.autoAttackMonster,this)},e.prototype.autoAttackMonster=function(){this.isAttackAuto&&SceneItemModule.instance.getMonster(this.m_monsterRid)&&(FightAutoAI.instance.attack(this.m_monsterRid),DelayCallUtils.killDelayedCallsTo(this.autoAttackMonster,this),DelayCallUtils.delayedCall(.001*FightSkillManager.instance.p_attackSpeed,this.autoAttackMonster,this))},Object.defineProperty(e.prototype,"isAttackAuto",{get:function(){return this.m_json.method_key==GuideConfig.guide_scene_monster&&this.m_json.param_obj&&this.m_json.param_obj.c_continued_attack?!0:!1},enumerable:!0,configurable:!0}),e.prototype.onClickContent=function(t){return this.m_json.method_key==GuideConfig.guide_scene_monster&&SceneItemModule.instance.getMonster(this.m_monsterRid)?void FightAutoAI.instance.attack(this.m_monsterRid):this.m_json.method_key==GuideConfig.guide_attack_key?void FightAutoAI.instance.attackArrow():void(this.clickDelayBool&&this.clickGuide())},e.prototype.onClick=function(t){return 0!=this.m_json.guide_type?this.m_json.method_key==GuideConfig.guide_scene_monster&&SceneItemModule.instance.getMonster(this.m_monsterRid)?void FightAutoAI.instance.attack(this.m_monsterRid):this.m_json.method_key==GuideConfig.guide_attack_key?void FightAutoAI.instance.attackArrow():void(this.clickDelayBool&&this.clickGuide()):void 0},Object.defineProperty(e.prototype,"clickDelayBool",{get:function(){return!this.m_clickBool||ServerTimeManager.instance.timerValue<this.m_clickTime?!1:!0},enumerable:!0,configurable:!0}),e.prototype.clickGuide=function(){this.m_clickBool=!1,DelayCallUtils.killDelayedCallsTo(this.clickGuide,this),Dispatch.remove(AvatarMonster.EVENT_MONSTER_DIE,this.monsterDieGuide,this),this.m_json.sound_effect_id>0&&SoundMoude.instance.playSoundEffect(this.m_json.sound_effect_id);var t=GuideJson.getData(this.m_json.id,this.m_json.next_step);t&&0==t.is_client?this.m_backFunc.call(this,this.m_json):TweenLite.to(this,.2,{alpha:0,onComplete:this.sureGotoNext.bind(this)})},e.prototype.sureGotoNext=function(){this.m_backFunc.call(this,this.m_json)},e.prototype.showGudie=function(t,e){if(void 0===e&&(e=!1),TweenLite.killTweensOf(this),DelayCallUtils.killDelayedCallsTo(this.autoAttackMonster,this),e?this.alpha=1:TweenLite.to(this,.3,{alpha:1}),this.m_json=t,this.m_isMove=e,null==this.parent&&Dispatch.register(StageManager.EVENT_STAGE_RESIZE,this.stageResize,this,!0),this.m_json.position_list&&this.m_json.position_list.length>0?this.setPositionBox():this.setImgDispose(),this.m_json.tishi_off_list&&this.m_json.tishi_off_list.length>0?(this.m_gudieView.showView(this.m_json,e,this.m_delayTime),this.addChild(this.m_gudieView)):this.m_gudieView.hide(),this.m_clickBool=!0,this.m_clickTime=ServerTimeManager.instance.timerValue+1e3*(this.m_delayTime+this.m_json.stay_time),DelayCallUtils.killDelayedCallsTo(this.clickGuide,this),this.m_json.execute_time>0&&DelayCallUtils.delayedCall(this.m_json.execute_time,this.clickGuide,this),this.m_json.method_key==GuideConfig.guide_scene_monster){var i=0;i=this.m_json.param_obj&&this.m_json.param_obj.c_monster_id?this.m_json.param_obj.c_monster_id:ChatMoude.instance.p_moId;var s=[],n=[];for(var o in SceneItemModule.instance.monsterDict){var a=SceneItemModule.instance.monsterDict[o];a&&a.jsonMonster&&(a.jsonMonster.id==i?n.push({rid:a.dataMonster.scene_monster_id,idx:egret.Point.distance(a.getPos(),PlayerManager.instance.p_mainPlayer.getPos())}):s.push({rid:a.dataMonster.scene_monster_id,idx:egret.Point.distance(a.getPos(),PlayerManager.instance.p_mainPlayer.getPos())}))}ArrayUtils.setSortArr(n,["idx"],[0]),n[0]?this.m_monsterRid=n[0].rid:s[0]&&(ArrayUtils.setSortArr(s,["idx"],[0]),this.m_monsterRid=s[0].rid);var r=SceneItemModule.instance.getMonster(this.m_monsterRid);r&&(Dispatch.register(AvatarMonster.EVENT_MONSTER_DIE,this.monsterDieGuide,this),r.guideAttack(this.m_json))}},e.prototype.setPositionBox=function(){var t=[];1==this.m_json.float_type_x?t[0]=Math.floor(this.m_json.position_list[0]):2==this.m_json.float_type_x?t[0]=Math.floor(this.m_json.position_list[0]+StageManager.instance.p_stageWidth-StageManager.MIN_STAGE_WIDTH):t[0]=Math.floor(this.m_json.position_list[0]+.5*(StageManager.instance.p_stageWidth-StageManager.MIN_STAGE_WIDTH)),1==this.m_json.float_type_y?t[1]=Math.floor(this.m_json.position_list[1]+StageManager.instance.p_stageHeight-StageManager.MIN_STAGE_HEIGHT):2==this.m_json.float_type_y?t[1]=Math.floor(this.m_json.position_list[1]):t[1]=Math.floor(this.m_json.position_list[1]+.5*(StageManager.instance.p_stageHeight-StageManager.MIN_STAGE_HEIGHT)),t[2]=Math.floor(this.m_json.position_list[2]),t[3]=Math.floor(this.m_json.position_list[3]),this.iconBgm.visible=!0,0==this.m_json.show_type?this.iconBgm.alpha=this.m_mask_alpha+this.m_json.mask_alpha:this.iconBgm.alpha=0,this.m_isMove?(this.m_goPoint.x=t[0],this.m_goPoint.y=t[1],this.m_delayTime=egret.Point.distance(this.m_initPoint,this.m_goPoint)/1e3*.5,this.iconBgm.x=.5*(StageManager.instance.p_stageWidth-StageManager.instance.p_stageHeight),this.iconBgm.y=0,this.iconBgm.width=StageManager.instance.p_stageHeight,this.iconBgm.height=StageManager.instance.p_stageHeight,TweenLite.to(this.iconBgm,this.m_delayTime,{x:t[0],y:t[1],width:t[2],height:t[3],ease:Expo.easeOut,onUpdate:this.guideMoveTo.bind(this)})):(this.iconBgm.x=t[0],this.iconBgm.y=t[1],this.iconBgm.width=t[2],this.iconBgm.height=t[3],this.onUpdateBack(t)),null==this.m_effects.parent&&(this.m_effects.play(),this.addChild(this.m_effects)),this.m_effects.x=t[0]+t[2]/2,this.m_effects.y=t[1]+t[3]/2,this.m_isMove?(this.m_effects.alpha=0,TweenLite.to(this.m_effects,.2,{delay:this.m_delayTime,alpha:1})):this.m_effects.alpha=1,TweenLite.killTweensOf(this.m_arrowImg);
var e=this.setArrowDire(t);e&&e.length>0?(this.addChild(this.m_arrowImg),this.m_arrowImg.rotation=e[0],this.m_arrowImg.x=e[1],this.m_arrowImg.y=e[2],this.m_isMove?(this.m_arrowImg.alpha=0,TweenLite.to(this.m_arrowImg,.2,{delay:this.m_delayTime,alpha:1,onComplete:this.moveArrwoShow.bind(this),onCompleteParams:[[e[1],e[2]],[e[3],e[4]]]})):(this.m_arrowImg.alpha=1,this.moveArrwoShow([e[1],e[2]],[e[3],e[4]]))):TweenLite.to(this.m_arrowImg,.2,{alpha:0,onComplete:this.hideArrowImg.bind(this)})},e.prototype.guideMoveTo=function(){var t=[Math.floor(this.iconBgm.x),Math.floor(this.iconBgm.y),Math.floor(this.iconBgm.width),Math.floor(this.iconBgm.height)];this.onUpdateBack(t)},e.prototype.hideArrowImg=function(){this.m_arrowImg&&(TweenLite.killTweensOf(this.m_arrowImg),DisplayObjectUtils.removeFormParent(this.m_arrowImg))},e.prototype.setArrowDire=function(t){var e=[];return 1==this.m_json.arrow_dire?e=[0,t[0]+.5*t[2],t[1]-80,t[0]+.5*t[2],t[1]-80+15]:2==this.m_json.arrow_dire?e=[90,t[0]+t[2]+80,t[1]+.5*t[3],t[0]+t[2]+80-15,t[1]+.5*t[3]]:3==this.m_json.arrow_dire?e=[180,t[0]+.5*t[2],t[1]+t[3]+80,t[0]+.5*t[2],t[1]+t[3]+80-15]:4==this.m_json.arrow_dire&&(e=[270,t[0]-80,t[1]+.5*t[3],t[0]-80+15,t[1]+.5*t[3]]),e},e.prototype.moveArrwoShow=function(t,e){this.m_arrowImg.x==t[0]&&this.m_arrowImg.y==t[1]?TweenLite.to(this.m_arrowImg,.4,{x:e[0],y:e[1],onComplete:this.moveArrwoShow.bind(this),onCompleteParams:[t,e]}):TweenLite.to(this.m_arrowImg,.6,{x:t[0],y:t[1],onComplete:this.moveArrwoShow.bind(this),onCompleteParams:[t,e]})},e.prototype.monsterDieGuide=function(t){if(this.m_monsterRid==t){this.m_monsterRid=0;var e=GuideJson.getData(this.m_json.id,this.m_json.step_id);e.param_obj&&1==e.param_obj.c_is_next&&GuideModule.instance.executeNextGuide(e.method_key)}},e.prototype.hideGuide=function(t){void 0===t&&(t=!0),this.m_monsterRid=0,DelayCallUtils.killDelayedCallsTo(this.clickGuide,this),Dispatch.remove(StageManager.EVENT_STAGE_RESIZE,this.stageResize,this),Dispatch.remove(AvatarMonster.EVENT_MONSTER_DIE,this.monsterDieGuide,this),t?TweenLite.to(this,.2,{alpha:0,onComplete:this.hideSure.bind(this),onCompleteParams:[t]}):this.hideSure(t)},e.prototype.hideSure=function(t){void 0===t&&(t=!0),this.setImgDispose(),TweenLite.killTweensOf(this),TweenLite.killTweensOf(this.iconBgm),t&&DisplayObjectUtils.removeFormParent(this)},e.prototype.setImgDispose=function(){for(var t=0;t<this.m_iconList.length;t++)this.m_iconList[t].visible=!1;this.m_effects&&(this.m_effects.stop(),TweenLite.killTweensOf(this.m_effects),DisplayObjectUtils.removeFormParent(this.m_effects)),this.m_arrowImg&&(TweenLite.killTweensOf(this.m_arrowImg),DisplayObjectUtils.removeFormParent(this.m_arrowImg)),this.m_gudieView&&this.m_gudieView.hide()},Object.defineProperty(e.prototype,"iconBgm",{get:function(){return this.m_iconList[0]},enumerable:!0,configurable:!0}),e.prototype.onUpdateBack=function(t){t[1]<=0?this.m_iconList[1].visible=!1:this.setIconData(1,0,0,StageManager.instance.p_stageWidth,t[1]),t[0]<=0?this.m_iconList[2].visible=!1:this.setIconData(2,0,t[1],t[0],t[3]),t[2]>=StageManager.instance.p_stageWidth?this.m_iconList[3].visible=!1:this.setIconData(3,t[0]+t[2],t[1],StageManager.instance.p_stageWidth-(t[0]+t[2]),t[3]),t[3]>=StageManager.instance.p_stageHeight?this.m_iconList[4].visible=!1:this.setIconData(4,0,t[1]+t[3],StageManager.instance.p_stageWidth,StageManager.instance.p_stageHeight-(t[1]+t[3]))},e.prototype.setIconData=function(t,e,i,s,n){this.m_iconList[t].visible=!0,this.m_iconList[t].x=e,this.m_iconList[t].y=i,this.m_iconList[t].width=s,this.m_iconList[t].height=n,this.m_iconList[t].alpha=this.m_mask_alpha+this.m_json.mask_alpha},e.prototype.stageResize=function(){this.m_bgmMenk.width=StageManager.instance.p_stageWidth,this.m_bgmMenk.height=StageManager.instance.p_stageHeight},e}(eui.Component);__reflect(GuideMask.prototype,"GuideMask");var GuideModule=function(t){function e(){var e=t.call(this)||this;return e.m_guideId=0,e.m_step=0,e.p_stopGudie=!1,e.m_initBool=!0,e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.m_instance||(this.m_instance=new e),this.m_instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){},e.prototype.sceneChange=function(){var t=[{key:"c_npc_id",value:1},{key:"c_is_next",value:1}];e.instance.executeNextGuide(GuideConfig.guide_task,t);var i=[{key:"c_is_next",value:1}];if(e.instance.executeNextGuide(GuideConfig.guide_scene_monster,i),this.m_initBool){this.m_initBool=!1;var s=PlayerManager.instance.getSetingMsg(GameSetConfig.k_guide);if(s&&!PopupModule.instance.havPopupStage(PopupConfig.ID_WELCOME)){var n=s.split("_"),o=GuideJson.getData(Number(n[0]),Number(n[1]));if("1031_1"==s&&SceneModule.instance.isMainScene)o=GuideJson.getData(1031,3);else if("1031_4"!=s||SceneModule.instance.isMainScene){var a=TaskManager.instance.p_task_data;if(a){var r=TaskJson.getData(a.task_id);if(r&&0==a.status&&""!=r.task_guide_do&&s!=r.task_guide_do){var _=r.task_guide_do.split("_");o=GuideJson.getData(Number(_[0]),Number(_[1]))}else if(r&&1==a.status&&""!=r.task_guide_complete&&s!=r.task_guide_complete){var h=r.task_guide_complete.split("_");o=GuideJson.getData(Number(h[0]),Number(h[1]))}else r&&0==a.status&&"1001_1"==s&&1==a.num?o=GuideJson.getData(1001,2):r&&0==a.status&&"1001_2"==s&&2==a.num?o=GuideJson.getData(1001,3):r&&0==a.status&&"1001_3"==s&&3==a.num&&(o=GuideJson.getData(1001,4))}}else o=GuideJson.getData(1031,5);o&&this.startGuide(o.id,null,o.step_id)}}},e.prototype.registerGuide=function(t,e){var i=GuideJson.getData(t,e);if(i){var s=PlayerManager.instance.getSetingMsg(GameSetConfig.k_guide),n=i.id+"_"+i.start_step_id;n!=s&&PlayerManager.instance.setingMsg(GameSetConfig.k_guide,n)}},e.prototype.startGuide=function(t,e,i){if(void 0===e&&(e=null),void 0===i&&(i=1),!URIManager.isdebug||URIManager.is_platform||!this.p_stopGudie){var s=GuideJson.getData(t,i);if(s)if(this.m_guideId=t,this.m_backFunc=e,this.m_step=i,s.function_config_id>0&&FunctionManager.instance.executeFunction(s.function_config_id),s.position_list&&s.position_list.length>0||s.tishi_off_list&&s.tishi_off_list.length>0)this.createGuideMask(s,!0);else{GuideJson.getNextGuide(this.m_guideId,this.m_step);0==s.is_client&&this.nextCurrStep()}}},e.prototype.nextCurrStep=function(){var t=GuideJson.getNextGuide(this.m_guideId,this.m_step);if(t)if(this.m_step=t.step_id,t.function_config_id>0&&FunctionManager.instance.executeFunction(t.function_config_id),t.position_list&&t.position_list.length>0||t.tishi_off_list&&t.tishi_off_list.length>0)this.createGuideMask(t,!0);else if(0==t.next_step)this.stopGuide(!1);else{var t=GuideJson.getNextGuide(this.m_guideId,this.m_step);t&&0==t.is_client&&this.nextCurrStep()}else this.stopGuide(!1)},e.prototype.createGuideMask=function(t,e){void 0===e&&(e=!1),this.m_guideMask||(this.m_guideMask=new GuideMask(this.dispatchGuideFunc.bind(this)));var i=PlayerManager.instance.getSetingMsg(GameSetConfig.k_guide),s=t.id+"_"+t.start_step_id;s!=i&&PlayerManager.instance.setingMsg(GameSetConfig.k_guide,s),this.m_guideMask.showGudie(t,e),null==this.m_guideMask.parent&&StageManager.instance.guidelayer.addChild(this.m_guideMask)},e.prototype.dispatchGuideFunc=function(t){if(t&&t.id==this.m_guideId&&t.step_id==this.m_step){Dispatch.dispatch(t.method_key,t.param_obj);var e=GuideJson.getNextGuide(t.id,t.step_id);if(null==e)return void this.stopGuide(!1);0==e.is_client?this.nextCurrStep():this.m_guideMask&&this.m_guideMask.hideGuide(!1)}},e.prototype.executeNextGuide=function(t,e){void 0===e&&(e=null);var i=GuideJson.getNextGuide(this.m_guideId,this.m_step);if(i&&0!=i.is_client&&i.method_key==t)if(e&&i.param_obj){var s=!1;for(var n in e)if(i.param_obj[e[n].key]==e[n].value){s=!0;break}s&&this.nextCurrStep()}else this.nextCurrStep()},e.prototype.stopGuide=function(t){void 0===t&&(t=!0),this.m_step=0,this.m_guideId=0,this.m_guideMask&&this.m_guideMask.hideGuide(),PlayerManager.instance.deleteSetingMsg(GameSetConfig.k_guide),t||null==this.m_backFunc||this.m_backFunc.call(this),this.m_backFunc=null,Dispatch.dispatch(e.EVENT_GUIDE_STOP)},e.prototype.setPataGuide=function(t,e){this.m_guideId==t&&(this.m_step=e)},e.prototype.getIsGuiding=function(t){return void 0===t&&(t=0),t>0&&this.m_guideId==t?!0:this.m_guideId>0?!0:!1},e.EVENT_GUIDE_STOP="EVENT_GUIDE_STOP",e}(egret.HashObject);__reflect(GuideModule.prototype,"GuideModule");var GuideDIalogUI=function(t){function e(){var e=t.call(this)||this;return e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/guideUI/GuideDIalogUISkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.touchChildren=!1,this.touchEnabled=!1,t.prototype.onCompleted.call(this)},e.prototype.showView=function(t,e){void 0===e&&(e=!0),!this.checkComplete(this.showView,t)},e}(ComponentBase);__reflect(GuideDIalogUI.prototype,"GuideDIalogUI");var GuideView=function(t){function e(){var e=t.call(this)||this;return e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/guideUI/GuideViewSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.touchChildren=!1,this.touchEnabled=!1,t.prototype.onCompleted.call(this)},e.prototype.showView=function(t,e,i){if(void 0===e&&(e=!0),void 0===i&&(i=0),this.checkComplete(this.showView,t)){this.u_imgBj.width=t.tishi_off_list[2],this.u_txtMsg.width=t.tishi_off_list[2]-20,this.u_txtMsg.textFlow=HtmlUtil.setTextFlow(t.tishi_msg),this.u_imgBj.height=this.u_txtMsg.y+this.u_txtMsg.textHeight+12;var s=[];1==t.float_type_x?s[0]=Math.floor(t.tishi_off_list[0]):2==t.float_type_x?s[0]=Math.floor(t.tishi_off_list[0]+(StageManager.instance.p_stageWidth-StageManager.MIN_STAGE_WIDTH)):s[0]=Math.floor(t.tishi_off_list[0]+.5*(StageManager.instance.p_stageWidth-StageManager.MIN_STAGE_WIDTH)),1==t.float_type_y?s[1]=Math.floor(t.tishi_off_list[1]+StageManager.instance.p_stageHeight-StageManager.MIN_STAGE_HEIGHT):2==t.float_type_y?s[1]=Math.floor(t.tishi_off_list[1]):s[1]=Math.floor(t.tishi_off_list[1]+.5*(StageManager.instance.p_stageHeight-StageManager.MIN_STAGE_HEIGHT)),this.x=s[0],this.y=s[1],e?(this.alpha=0,TweenLite.to(this,.2,{delay:i,alpha:1})):this.alpha=1}},e.prototype.hide=function(){TweenLite.killTweensOf(this),DisplayObjectUtils.removeFormParent(this)},e}(ComponentBase);__reflect(GuideView.prototype,"GuideView");var InvRebateUI=function(t){function e(){var e=t.call(this)||this;return e.m_layout=new eui.TileLayout,e.m_list=new eui.ArrayCollection,e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/invRebateUI/InvRebateUISkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_txtBuy.text=LanguageJson.getText("l_btn_buy"),this.u_scrollerItem.horizontalScrollBar=null,this.u_scrollerItem.verticalScrollBar=null,this.m_layout.requestedColumnCount=1,this.u_listItem.itemRenderer=InvRebateRender,this.u_listItem.layout=this.m_layout,this.u_listItem.dataProvider=this.m_list,this.m_dataList=TouZiJiHuaJson.getRewardList(),ArrayUtils.setSortArr(this.m_dataList,["id"],[0])},e.prototype.initEvent=function(){this.registerEventClick(this.u_btnBuy,this.onBuy,this)},e.prototype.onBuy=function(t){if(1==InvestManager.instance.invest_state)return void FloatTipModule.instance.popTipLanguage("l_vip_tips_5");var e=RechargeJson.getRechargeData(ChargeGameEnum.TOU_ZI_JI_HUA);ChargeManager.instance.requestRecharge(e[0].ID,1)},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),this.m_list.source=this.m_dataList)},e.prototype.hide=function(e){void 0===e&&(e=null),t.prototype.hide.call(this,e)},e}(PageBase);__reflect(InvRebateUI.prototype,"InvRebateUI");var InvRebateRender=function(t){function e(){return t.call(this,"resource/eui_skins/invRebateUI/render/InvRebateRenderSkin.exml")||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this),this.m_rewardGroup||(this.m_rewardGroup=new RewardGroupUI,this.m_rewardGroup.scaleX=this.m_rewardGroup.scaleY=.9,this.m_rewardGroup.x=20,this.m_rewardGroup.y=20,this.m_rewardGroup.visualWidth=185,this.addChild(this.m_rewardGroup)),this.u_txtRecive.text=LanguageJson.getText("l_btn_receive")},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.u_btnRecive.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onReceive,this)},e.prototype.onReceive=function(){this.m_investData&&1==this.m_investData.state&&InvestManager.instance.s_invest_get_invest_award(this.m_data.id)},e.prototype.dataChanged=function(){this.checkComplete(this.dataChanged)&&(t.prototype.dataChanged.call(this),this.m_data&&this.m_data.id&&Dispatch.remove(InvestManager.INVEST_DATA_UPDATE+this.m_data.id,this.setFuncVis,this),this.m_data=this.data,this.u_txtLoginDay.textFlow=LanguageJson.getHtmlTextFlow("l_invest_loginday",[this.m_data.condition_list[1]]),this.m_rewardGroup.setDataByList(this.m_data.reward_list,3),Dispatch.register(InvestManager.INVEST_DATA_UPDATE+this.m_data.id,this.setFuncVis,this,!0))},e.prototype.setFuncVis=function(){switch(this.m_investData=InvestManager.instance.getInvestData(this.m_data.id),this.m_investData.state){case 0:this.u_btnRecive.visible=!0,this.u_btnReciveRed.visible=!1,ObjectUtils.setGrey(this.u_btnRecive);break;case 1:this.u_btnRecive.visible=!0,this.u_btnReciveRed.visible=!0,ObjectUtils.setGrey(this.u_btnRecive,!1);break;case 2:this.u_btnRecive.visible=!0,this.u_btnReciveRed.visible=!1,ObjectUtils.setGrey(this.u_btnRecive)}},e}(ItemRendererBase);__reflect(InvRebateRender.prototype,"InvRebateRender");var LoadingMissionUI=function(t){function e(){var e=t.call(this)||this;return e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/loadingUI/LoadingMissionUISkin.exml",e.touchEnabled=!1,e.touchChildren=!1,e}return __extends(e,t),e.prototype.onCompleted=function(){t.prototype.onCompleted.call(this)},e.prototype.show=function(){this.checkComplete(this.show)&&(this.hand1.alpha=1,this.hand1.x=106,this.hand1.y=284,this.hand2.alpha=1,this.hand2.x=297,this.hand2.y=521,this.ray1.alpha=0,this.ray2.alpha=0,this.star.alpha=0,this.alpha=1,this.play(),Dispatch.register(StageManager.EVENT_STAGE_RESIZE,this.onStageResize,this,!0))},e.prototype.play=function(){var t=.5,e=.4,i=.2;TweenLite.to(this.hand1,t,{x:30,y:236}),TweenMax.to(this.star,.2,{delay:t-.3,alpha:1}),TweenMax.to(this.star,e,{delay:t+.01,ease:Quad.easeIn,alpha:0}),TweenMax.to(this.hand1,i,{delay:t+e,ease:Quad.easeIn,x:-29,y:194}),TweenMax.to(this.hand1,.05,{delay:t+e+.15,alpha:0}),TweenMax.to(this.hand2,.05,{delay:t+e+.15,alpha:0}),TweenMax.to(this.ray1,.01,{delay:t+e+i,alpha:1}),TweenMax.to(this.ray2,.01,{delay:t+e+i+.1,alpha:1}),TweenMax.to(this.ray1,.11,{delay:t+e+i+.1,alpha:0}),TweenMax.to(this.ray2,.11,{delay:t+e+i+.1+.05,alpha:0}),TweenMax.to(this,i,{delay:t+e+i+.1+.05,alpha:0,onComplete:this.hide.bind(this)})},e.prototype.hide=function(){DisplayObjectUtils.removeFormParent(this),Dispatch.remove(StageManager.EVENT_STAGE_RESIZE,this.onStageResize,this)},e.prototype.onStageResize=function(){this.bg.x=.5*(640-StageManager.instance.p_stageWidth),this.bg.width=StageManager.instance.p_stageWidth,this.bg.height=StageManager.instance.p_stageHeight,this.x=.5*(StageManager.instance.p_stageWidth-640)},e}(ComponentBase);__reflect(LoadingMissionUI.prototype,"LoadingMissionUI");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.m_current=1,e.m_total=1,e.m_progressText="100%",e.m_nowTimeStr="",e.m_timer=new egret.Timer(1e3,180),e.m_maskRect=new egret.Rectangle(0,0,0,40),e.initUI(),e.m_timer.addEventListener(egret.TimerEvent.TIMER,e.timerFunc,e),e.m_timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,e.timerComFunc,e),e}return __extends(e,t),e.prototype.initUI=function(){var t="index_bg_jpg",e=new eui.Image(t);e.y=-125,e.x=-80,this.addChildAt(e,0),this.height=1136,this.width=640;var i=new eui.Image;this.p_progressBg=i,i.source="index_res/index_loading_line_bg.png",i.x=46,i.y=1046,this.addChild(i),i=new eui.Image,this.p_progress=i,i.source="index_res/index_loading_line.png",i.x=47,i.y=1051,this.addChild(i),i=new eui.Label,this.p_progressText=i,i.bold=!0,i.size=20,i.stroke=2,i.textAlign="center",i.width=357,i.horizontalCenter=0,i.y=1076,this.addChild(i),("wxgame"==window.platform_name||"qqgame"==window.platform_name)&&(i=new eui.Label,this.p_cacheText=i,this.p_cacheText.touchEnabled=!0,i.bold=!0,i.size=22,i.stroke=2,i.textFlow=HtmlUtil.setTextFlow("若无法进入游戏，请点|u|c117【清除缓存】，重新打开游戏$c$u"),i.textAlign="center",i.width=640,i.horizontalCenter=0,i.y=1108,this.addChild(i),this.p_cacheText.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clearStorage,this)),this.onCompleted()},e.prototype.clearStorage=function(t){void 0===t&&(t=null)},e.prototype.startTimer=function(){this.stopTimer(),this.m_timer.reset(),this.m_timer.addEventListener(egret.TimerEvent.TIMER,this.timerFunc,this),this.m_timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.timerComFunc,this),this.m_timer.start(),this.timerFunc()},e.prototype.timerFunc=function(t){void 0===t&&(t=null);for(var e="",i=this.m_timer.currentCount%4,s=0;i>s;s++)e+=".";this.m_nowTimeStr=""+e+" ",this.p_progressText},e.prototype.timerComFunc=function(t){this.stopTimer()},e.prototype.stopTimer=function(){this.m_timer.removeEventListener(egret.TimerEvent.TIMER,this.timerFunc,this),this.m_timer.removeEventListener(egret.TimerEvent.TIMER_COMPLETE,this.timerComFunc,this),this.m_timer.stop()},e.prototype.onCompleted=function(){t.prototype.onCompleted.call(this),this.refreshProgress()},e.prototype.refreshProgress=function(){this.m_isComplete&&(this.m_progressText=Number(this.m_current/this.m_total*100).toFixed(0)+"%",this.p_progress.width=546*(this.m_current/this.m_total))},e.prototype.show=function(t){this.setloadCount(0,1),this.startTimer()},e.prototype.hide=function(t){this.stopTimer()},e.prototype.setloadCount=function(t,e){this.m_current=t,this.m_total=e,this.refreshProgress()},e}(ComponentBase);__reflect(LoadingUI.prototype,"LoadingUI");var LoadingUIModule=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(t){this.m_root=t,this.m_loadingView=new LoadingUI,Dispatch.register(StageManager.EVENT_STAGE_RESIZE,this.stageResize,this)},t.prototype.stageResize=function(){this.m_loadingView&&this.m_loadingView.parent&&(this.m_loadingView.x=Math.floor(.5*(StageManager.instance.p_stageWidth-640)),this.m_loadingView.y=Math.floor(.5*(StageManager.instance.p_stageHeight-1136)))},t.prototype.show=function(t){this.m_root.addChild(this.m_loadingView),this.m_loadingView.show(null),this.stageResize()},t.prototype.hide=function(t){this.m_loadingView.parent&&this.m_loadingView.parent.removeChild(this.m_loadingView),this.m_loadingView.hide(null)},t.prototype.reset=function(){},t.prototype.setLoadInfoText=function(t){},t.prototype.showMissionLoading=function(){this.m_loadingMissionUI||(this.m_loadingMissionUI=new LoadingMissionUI),this.m_loadingMissionUI.show(),this.m_root.addChild(this.m_loadingMissionUI)},t.prototype.hideMissionLoading=function(){this.m_loadingMissionUI&&this.m_loadingMissionUI.hide()},t.prototype.showViewLoading=function(t,e,i){void 0===t&&(t=!0),void 0===e&&(e=null),void 0===i&&(i=0),this.m_loadingViewUI||(this.m_loadingViewUI=new LoadingViewUI),this.m_loadingViewUI.show(t,e,i),this.m_root.addChild(this.m_loadingViewUI)},t.prototype.hideViewLoading=function(){this.m_loadingViewUI&&this.m_loadingViewUI.hide()},t.prototype.setloadCount=function(t,e){this.m_loadingView.setloadCount(t,e)},t.prototype.setProgress=function(t){},Object.defineProperty(t.prototype,"loadingViewMiss",{get:function(){return this.m_loadingMissionUI},enumerable:!0,configurable:!0}),t.EVENT_LOADING_ISSHOW="EVENT_LOADING_ISSHOW",t}();__reflect(LoadingUIModule.prototype,"LoadingUIModule",["ILoaderView"]);var LoadingViewUI=function(t){function e(){var e=t.call(this)||this;return e.m_value=0,e}return __extends(e,t),e.prototype.show=function(t,e,i){void 0===t&&(t=!0),void 0===e&&(e=null),void 0===i&&(i=0),DelayCallUtils.killDelayedCallsTo(this.hide,this),DelayCallUtils.killDelayedCallsTo(this.timeOver,this),TimeManager.instance.clearTimer(this.doTimeZhuan,this),this.m_backFunc=e,this.m_backTime=i,t?(this.m_bj||(this.m_bj=new eui.Image("commonUI_box"),this.m_bj.scale9Grid=UIModule.instance.getRectangle(),this.m_bj.x=0,this.m_bj.y=0,this.m_bj.alpha=.1),this.addChild(this.m_bj)):DisplayObjectUtils.removeFormParent(this.m_bj),this.m_zhuan||(this.m_zhuan=new eui.Image("commonUI_jiazai"),this.m_zhuan.anchorOffsetX=21,this.m_zhuan.anchorOffsetY=21),this.addChild(this.m_zhuan),this.startMove(),this.m_backTime>0&&DelayCallUtils.delayedCall(this.m_backTime,this.timeOver,this),DelayCallUtils.delayedCall(20,this.hide,this),Dispatch.register(StageManager.EVENT_STAGE_RESIZE,this.onStageResize,this,!0)},e.prototype.startMove=function(){this.m_value=0,this.m_zhuan.rotation=this.m_value,TimeManager.instance.doLoop(this.doTimeZhuan,this,30)},e.prototype.doTimeZhuan=function(){this.m_value>=360&&(this.m_value=0),this.m_zhuan.rotation=this.m_value,this.m_value+=10},e.prototype.onStageResize=function(){this.m_bj.width=StageManager.instance.p_stageWidth,this.m_bj.height=StageManager.instance.p_stageHeight,this.m_zhuan.x=StageManager.instance.p_stageWidth/2,this.m_zhuan.y=StageManager.instance.p_stageHeight/2},e.prototype.timeOver=function(){null!=this.m_backFunc&&this.m_backFunc(),this.hide()},e.prototype.hide=function(){DelayCallUtils.killDelayedCallsTo(this.hide,this),DelayCallUtils.killDelayedCallsTo(this.timeOver,this),TimeManager.instance.clearTimer(this.doTimeZhuan,this),Dispatch.remove(StageManager.EVENT_STAGE_RESIZE,this.onStageResize,this),this.m_backFunc=null,DisplayObjectUtils.removeFormParent(this.m_bj),DisplayObjectUtils.removeFormParent(this)},e}(ComponentBase);__reflect(LoadingViewUI.prototype,"LoadingViewUI");var LoginAnnounce=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/loginUI/LoginAnnounceSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_txtTitle.text=LanguageJson.getText("l_login_gonggao_title")},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),this.msgText?this.u_txtMsg.textFlow=HtmlUtil.setTextFlow(this.msgText):this.u_txtMsg.textFlow=LanguageJson.getHtmlTextFlow("l_login_gonggao"))},Object.defineProperty(e.prototype,"width",{get:function(){return 970},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 640},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"msgText",{get:function(){return egret.localStorage.getItem(ServerListManager.instance.p_noticCacheType)},enumerable:!0,configurable:!0}),e}(PopupBase);__reflect(LoginAnnounce.prototype,"LoginAnnounce");var LoginUI=function(t){function e(){var i=t.call(this)||this;return i.m_btnImgList=[],e.loginUISelfs=i,i.addEventListener(egret.Event.COMPLETE,i.onCompleted,i),i.skinName="resource/eui_skins/loginUI/LoginUISkin.exml",i}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initEvent=function(){Dispatch.register(ServerListManager.EVENT_SERVER_LIST,this.updateServerList,this),Dispatch.register(ServerListManager.EVENT_SERVER_SELECT,this.setDataInfo,this),Dispatch.register(ServerListManager.EVENT_LOGIN_SET_INFO,this.setTishiMsg,this),Dispatch.register(ServerListManager.EVENT_LOGIN_KEFU,this.showKefu,this),this.u_image_serverList.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openServerList,this),this.u_txtXieyi.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onXieyi,this),this.u_txtYinshi.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onYinsi,this),this.registerEventClick(this.u_btnLoginGame,this.onLoginGmae,this,!0),this.registerEventClick(this.u_btnKefu,this.onKefu,this,!0)},e.prototype.initView=function(){TextUtil.setLink(this.u_txtYinshi),TextUtil.setLink(this.u_txtXieyi),this.u_btnKefu.visible=!1;for(var t=[URIManager.p_fb,URIManager.p_youke,URIManager.p_google],e=.5*(this.width-(100*t.length+10*(t.length-1))),i=0;i<t.length;i++){var s=new eui.Image("loginUI_btn_"+t[i]);s.width=100,s.height=78,s.x=e+(s.width+10)*i,s.y=450,s.name=t[i],this.addChild(s),this.m_btnImgList.push(s),this.registerEventClick(s,this.onStartLogin,this,!0)}this.u_txtTiMs.text=LanguageJson.getText("l_login_yuedu"),this.u_txtAnd.text=LanguageJson.getText("l_login_and"),this.u_txtYinshi.text=LanguageJson.getText("l_login_yinsi"),this.u_txtXieyi.text=LanguageJson.getText("l_login_yonghu"),this.u_txtTishi.textFlow=LanguageJson.getHtmlTextFlow("l_login_tishi");var n=.5*(StageManager.instance.p_stageWidth-StageManager.MIN_STAGE_WIDTH);this.u_btnKefu.x+=n,this.u_txt_resVersion.x-=n,this.u_txt_version.x-=n,this.u_txt_version.text="v"+GameManager.instance.p_version+"."+GameManager.instance.p_version_v,this.u_txt_resVersion.text="res "+URIManager.versions;var o=egret.localStorage.getItem(LoginManager.cookie_acc_id);this.u_txt_account.text=""!=o&&"undefined"!=o?o:"",this.u_txt_password.text="",this.u_group_server_list.visible=!1,this.u_group_login.visible=URIManager.is_platform||URIManager.p_h5Game?!1:!0,URIManager.platformId==PlatformEnum.TEST&&(this.u_group_login.visible=!0),this.u_mcTest.visible=URIManager.is_platform?!1:!0;var a=egret.localStorage.getItem(LoginManager.login_para_key);if(null==a){var r=egret.localStorage.getItem("debug_storage");r&&(a=r)}this.u_txt_test.text=a?a:"",this.u_btnLoginGame.visible=!1,this.u_mcTishi.visible=!1,this.setSevenState(),GamePreLoadManager.instance.preloadGame(!1),GameManager.instance.callToNative("toAppLoginShow")},e.prototype.showKefu=function(){this.u_btnKefu.visible=!0},e.prototype.onKefu=function(t){GameManager.instance.callToNative("toAppLoginKefu")},e.prototype.onXieyi=function(t){PopupModule.instance.showPop(PopupConfig.ID_USER_XIEYI,1)},e.prototype.onYinsi=function(t){PopupModule.instance.showPop(PopupConfig.ID_USER_XIEYI,2)},e.prototype.onStartLogin=function(t){var e=t.target.name;this.onGameLogin(e)},e.prototype.onGameLogin=function(t){if(this.checkLogin())if(URIManager.p_h5Game){var e=H5Manager.instance.loginGame(t);console.log("H5登录返回："+e),""!=e&&null!=e&&void 0!=e&&LoginManager.instance.loginGameCallBack(e)}else if(URIManager.is_platform)GameManager.instance.callToNative("toAppLogin",t);else{if(""==LoginManager.instance.p_acc_id)return void FloatTipModule.instance.popTipLanguage("l_login_kong");ServerListManager.instance.requestRecentListData()}},e.prototype.onLoginGmae=function(t){0==LoginManager.instance.p_is_connect_socket&&(LoginManager.instance.p_is_connect_socket=!0,URIManager.is_platform||this.setDebugParam(),GameSocket.instance.init())},e.prototype.updateServerList=function(){this.setSevenState(),this.u_group_server_list.visible=!0,this.u_group_login.visible=!1,this.setDataInfo()},e.prototype.setSevenState=function(){ServerListManager.instance.p_recentServerLists.length>0?(this.u_btnLoginGame.visible=!0,this.u_mcTishi.visible=!0,this.u_image_state.source=null,1==LoginManager.instance.p_state?this.u_image_state.source="loginUI_server_weihu":3==LoginManager.instance.p_state&&(this.u_image_state.source="loginUI_hot")):(this.u_btnLoginGame.visible=!1,this.u_mcTishi.visible=!1);for(var t in this.m_btnImgList)this.m_btnImgList[t].visible=!this.u_btnLoginGame.visible},e.prototype.checkLogin=function(){return 0==LoginManager.instance.p_is_inner&&1==LoginManager.instance.p_state?(FloatTipModule.instance.popTipLanguage("l_login_weihu"),!1):LoginManager.instance.p_isLogin?!1:((0==URIManager.is_platform||URIManager.platformId==PlatformEnum.TEST)&&(LoginManager.instance.p_acc_id=this.u_txt_account.text),!0)},e.prototype.setDebugParam=function(){var t=egret.localStorage.getItem("debug_storage");t&&this.u_txt_test.text==t||egret.localStorage.setItem("debug_storage",this.u_txt_test.text),""!=this.u_txt_test.text&&(this.u_txt_test.text.indexOf("debug")>-1&&(ChatMoude.instance.p_isDebug=!0),this.u_txt_test.text.indexOf("stopGuide")>-1&&(GuideModule.instance.p_stopGudie=!0),this.u_txt_test.text.indexOf("texture")>-1&&TexturePool.instance.showTextureUse(),this.u_txt_test.text.indexOf("test")>-1&&(ChatMoude.instance.p_isTest=!0),this.u_txt_test.text.indexOf("miei")>-1&&(URIManager.p_imeiKey=this.u_txt_test.text))},e.prototype.openServerList=function(t){SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_1007),PopupModule.instance.showPop(PopupConfig.ID_SERVER_LIST),ServerListManager.instance.p_allServerList&&ServerListManager.instance.p_allServerList.length>0?Dispatch.dispatch(ServerListManager.EVENT_SERVER_LIST_ALL):ServerListManager.instance.requestAllListData()},e.prototype.setDataInfo=function(){this.u_txt_serverName.text=LoginManager.instance.p_server_id,this.u_image_state.source=null,1==LoginManager.instance.p_state?this.u_image_state.source="loginUI_server_weihu":3==LoginManager.instance.p_state&&(this.u_image_state.source="loginUI_hot")},e.prototype.setTishiMsg=function(t){},e.prototype.destroy=function(){if(Dispatch.remove(ServerListManager.EVENT_SERVER_LIST,this.updateServerList,this),Dispatch.remove(ServerListManager.EVENT_SERVER_SELECT,this.setDataInfo,this),Dispatch.remove(ServerListManager.EVENT_LOGIN_SET_INFO,this.setTishiMsg,this),Dispatch.remove(ServerListManager.EVENT_LOGIN_KEFU,this.showKefu,this),this.u_image_serverList.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.openServerList,this),this.u_txtXieyi.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onXieyi,this),this.u_txtYinshi.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onYinsi,this),this.removeEventClick(this.u_btnLoginGame),e.loginUISelfs=null,RES.destroyRes("preloadLogin"),LoginXieyi.loadUrlList)for(var t=0;t<LoginXieyi.loadUrlList.length;t++)RES.destroyRes(LoginXieyi.loadUrlList[t]);LoginXieyi.loadUrlList=null},e.prototype.setXY=function(){this.x=Math.floor(.5*(StageManager.instance.p_stageWidth-this.width)),this.y=Math.floor(.5*(StageManager.instance.p_stageHeight-this.height))},Object.defineProperty(e.prototype,"width",{get:function(){return StageManager.MIN_STAGE_WIDTH},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return StageManager.MIN_STAGE_HEIGHT},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(LoginUI.prototype,"LoginUI");var ServerListBean=function(){function t(){}return t}();__reflect(ServerListBean.prototype,"ServerListBean");var ServerListBtnItem=function(t){function e(){var e=t.call(this)||this;return e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/loginUI/ServerListBtnItemSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.dataChanged()},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.u_txt_type&&null!=this.data&&(this.u_txt_type.text=this.data.type)},e}(eui.ItemRenderer);__reflect(ServerListBtnItem.prototype,"ServerListBtnItem");var ServerListItem=function(t){function e(){var e=t.call(this)||this;return e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/loginUI/ServerListItemSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.dataChanged()},e.prototype.dataChanged=function(){this.u_txtName&&null!=this.data&&(this.u_txtName.text=this.data.desc,ObjectUtils.setGrey(this,!1),1==this.data.state?(this.u_imgName.source="loginUI_xin",this.u_imgState.source="loginUI_xin_img",ObjectUtils.setGrey(this)):3==this.data.state?(this.u_imgName.source="loginUI_huo",this.u_imgState.source="loginUI_huo_img"):(this.u_imgName.source="loginUI_xin",this.u_imgState.source="loginUI_xin_img"))},e}(eui.ItemRenderer);__reflect(ServerListItem.prototype,"ServerListItem");var ServerListUI=function(t){function e(){var e=t.call(this)||this;
return e.m_serverListTypePro=new eui.ArrayCollection,e.m_serverListItemPro=new eui.ArrayCollection,e.m_scrollIdx=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/loginUI/ServerListUISkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){this.u_list_type.itemRenderer=ServerListBtnItem,this.u_list_type.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.selectType,this),this.u_list_type.dataProvider=this.m_serverListTypePro;var t=new eui.TileLayout;t.requestedColumnCount=1,this.u_list_type.layout=t,this.u_list_item.itemRenderer=ServerListItem,this.u_list_item.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.selectItem,this),this.u_list_item.dataProvider=this.m_serverListItemPro;var e=new eui.TileLayout;e.requestedColumnCount=2,e.horizontalGap=7,this.u_list_item.layout=e},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),Dispatch.register(ServerListManager.EVENT_SERVER_LIST_ALL,this.updateData,this,!0))},e.prototype.updateData=function(){function t(t,e){var i=Number(t.id),s=Number(e.id);return s-i}var e=[];if(ServerListManager.instance.p_recentServerLists&&ServerListManager.instance.p_recentServerLists.length>0){var i=LanguageJson.getText("l_serverList_current");e.push({type:i,list:ServerListManager.instance.p_recentServerLists})}for(var s=Math.ceil(ServerListManager.instance.p_allServerList.length/ServerListManager.instance.p_server_list_group_num),n=0,o=0,a=[],r=0;s>r;r++){for(var _=[],h=r*ServerListManager.instance.p_server_list_group_num;h<(r+1)*ServerListManager.instance.p_server_list_group_num;h++)ServerListManager.instance.p_allServerList[h]&&_.push(ServerListManager.instance.p_allServerList[h]);n=0==r?1:r*ServerListManager.instance.p_server_list_group_num,o=(r+1)*ServerListManager.instance.p_server_list_group_num,a.push({type:n+"-"+o,list:_})}for(a.reverse(),e=e.concat(a),r=1;r<e.length;r++)e[r].list.sort(t);this.m_serverListTypePro.source=e,this.m_serverListItemPro.source=e[0].list},e.prototype.selectType=function(t){t.item&&(this.scrollPosition(0),this.m_serverListItemPro.source=t.item.list)},e.prototype.scrollPosition=function(t){this.m_scrollIdx=t;var e=120*this.m_scrollIdx-this.u_scroller_item.height+120;e=0>e?0:e,TweenLite.to(this.u_scroller_item.viewport,.3,{scrollV:e})},e.prototype.selectItem=function(t){t.item&&(this.m_currentServer=t.item,this.setDefaultServer(),this.close())},e.prototype.setDefaultServer=function(){this.m_currentServer&&(LoginManager.instance.p_desc=this.m_currentServer.desc,LoginManager.instance.p_server_id=this.m_currentServer.id,URIManager.analyze("null",{game_host:this.m_currentServer.ip,game_port:Number(this.m_currentServer.port)}),LoginManager.instance.p_state=this.m_currentServer.state,Dispatch.dispatch(ServerListManager.EVENT_SERVER_SELECT))},e.prototype.hide=function(e,i){void 0===i&&(i=null),t.prototype.hide.call(this,e,i),Dispatch.remove(ServerListManager.EVENT_SERVER_LIST_ALL,this.updateData,this)},Object.defineProperty(e.prototype,"width",{get:function(){return 1136},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 640},enumerable:!0,configurable:!0}),e}(PopupBase);__reflect(ServerListUI.prototype,"ServerListUI");var LoginXieyi=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){this.u_txtTishi.textFlow=LanguageJson.getHtmlTextFlow("l_closePop_tip")},Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/loginUI/popup/LoginXieyiSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.showView=function(e){if(void 0===e&&(e=null),this.checkComplete(this.showView,e))if(t.prototype.showView.call(this,e),this.u_txtLoading.visible=!0,this.u_scrollerItem.viewport.scrollV=0,this.m_type=e,this.u_txtMsg.text="",1==this.m_type)if(this.u_txtTitle.text=LanguageJson.getText("l_login_yonghu"),this.m_xieyi)this.u_txtLoading.visible=!1,this.u_txtMsg.textFlow=HtmlUtil.setTextFlow(this.m_xieyi);else{var i="http://www.goldennmaster.com:7080/game/resource/user_agreement.html";URIManager.is_platform&&(i="http://www.bountymasters.com:7080/game/"+URIManager.platformId+"/resource/user_agreement.html"),this.setDataList(i)}else if(this.u_txtTitle.text=LanguageJson.getText("l_login_yinsi"),this.m_yinsi)this.u_txtLoading.visible=!1,this.u_txtMsg.textFlow=HtmlUtil.setTextFlow(this.m_yinsi);else{var s="http://www.goldennmaster.com:7080/game/resource/privacy_statement.html";URIManager.is_platform&&(s="http://www.bountymasters.com:7080/game/"+URIManager.platformId+"/resource/privacy_statement.html"),this.setDataList(s)}},e.prototype.setDataList=function(t){this.m_request||(this.m_request=new egret.HttpRequest),this.m_request.responseType=egret.HttpResponseType.TEXT,this.m_request.open(t+"?v="+Math.random(),egret.HttpMethod.GET),this.m_request.addEventListener(egret.Event.COMPLETE,this.onAllGetComplete,this),this.m_request.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onAllGetIOError,this),this.m_request.addEventListener(egret.ProgressEvent.PROGRESS,this.onAllGetProgress,this),this.m_request.send()},e.prototype.onAllGetComplete=function(t){this.m_request.removeEventListener(egret.Event.COMPLETE,this.onAllGetComplete,this),this.m_request.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onAllGetIOError,this),this.m_request.removeEventListener(egret.ProgressEvent.PROGRESS,this.onAllGetProgress,this);var e=t.currentTarget.response;this.u_txtLoading.visible=!1,1==this.m_type?this.m_xieyi=e:this.m_yinsi=e,this.u_txtMsg.textFlow=HtmlUtil.setTextFlow(e)},e.prototype.onAllGetIOError=function(t){},e.prototype.onAllGetProgress=function(t){},e.prototype.hide=function(e,i){this.u_scrollerItem.stopAnimation(),t.prototype.hide.call(this,e,i)},Object.defineProperty(e.prototype,"width",{get:function(){return 970},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 560},enumerable:!0,configurable:!0}),e.loadUrlList=[],e}(PopupBase);__reflect(LoginXieyi.prototype,"LoginXieyi");var LuckBossUI=function(t){function e(){var e=t.call(this)||this;return e.m_costBtnList=[],e.m_bossViewList=[],e.m_betViewList=[],e.m_disposeUrlList.push("luckBossUI_json"),e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/luckBossUI/LuckBossUISkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this);var i=StaticDataJson.parseStrToList("guess_cost_list");e.p_cost=i[0][1];for(var s=0;s<i.length;s++){var n=new LuckBossCost(s,i[s][1]);this.m_costBtnList.push(n),this.u_grpCost.addChild(n)}for(var o=StaticDataJson.parseStrToList("guess_rate_list"),s=0;s<o.length;s++){var a=o[s][0];if(6>=a){var r=new LuckBossView(a);this.u_mcMid.addChild(r),this.m_bossViewList.push(r),e.p_flyList[a]=r}else if(8>=a){var _=new LuckBetView(a-7,o[s]);this.u_mcRight.addChild(_),this.m_betViewList.push(_),e.p_flyList[a]=_}else if(10>=a){var h=new LuckBetView(a-9,o[s]);this.u_mcLeft.addChild(h),this.m_betViewList.push(h),e.p_flyList[a]=h}}this.u_txtRate1.text=LanguageJson.getHtmlText("l_luck_boss_rate",[o[0][2]/1e4]),this.u_txtRate2.text=LanguageJson.getHtmlText("l_luck_boss_rate",[o[6][2]/1e4]),this.u_txtRate3.text=LanguageJson.getHtmlText("l_luck_boss_rate",[o[8][2]/1e4]),this.u_imgRateBg1.width=this.u_txtRate1.width+58,this.u_imgRateBg2.width=this.u_txtRate2.width+58,this.u_imgRateBg3.width=this.u_txtRate3.width+58,this.u_txtBlank.text=LanguageJson.getText("l_luck_boss_cant_done"),e.p_goldList=StaticDataJson.parseStrToList("guess_count_icon_list");var l=.5*(StageManager.MIN_STAGE_WIDTH-StageManager.instance.p_stageWidth);this.u_btnClose.x+=l},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnChart,this.onChart,this,!0),this.registerEventClick(this.u_btnClear,this.onClear,this,!0),this.registerEventClick(this.u_btnClose,this.close,this,!0),this.registerEventClick(this.u_btnGuanZhan,this.onGuanZhan,this,!0)},e.prototype.onChart=function(t){void 0===t&&(t=null),GuessManager.instance.s_mission_luck_boss_get_record()},e.prototype.onClear=function(t){void 0===t&&(t=null),GuessManager.instance.s_mission_lucky_boss_bet_reset()},e.prototype.onGuanZhan=function(t){void 0===t&&(t=null),MissionManager.instance.s_mission_challenge_mission(MissionTypeEnum.GUESS_BOSS,1)},e.prototype.showView=function(e){if(void 0===e&&(e=null),this.checkComplete(this.showView,e)){t.prototype.showView.call(this,e);for(var i=0;i<this.m_costBtnList.length;i++)this.m_costBtnList[i].show();GuessManager.instance.isFirstEnterTips(),Dispatch.register(GuessManager.EVENT_GUESS_BOSS_TIME_CHANGE,this.setTimeDown,this,!0),Dispatch.register(GuessManager.EVENT_GUESS_BOSS_PEOPLE_CHANGE,this.setPeople,this,!0)}},e.prototype.setTimeDown=function(){GuessManager.instance.p_luckBossEndTime>ServerTimeManager.instance.timer?TimeManager.instance.doLoop(this.setTimeMissionItem,this,1e3):TimeManager.instance.clearTimer(this.setTimeMissionItem,this),this.setData()},e.prototype.setData=function(){1==GuessManager.instance.p_bossState&&SceneManager.instance.p_sceneType!=SceneTypeEnum.MISSION?(this.u_grpCanDo.visible=!0,this.u_grpCant.visible=!1,this.u_mcBet.touchChildren=!0):(this.u_grpCanDo.visible=!1,this.u_grpCant.visible=!0,this.u_mcBet.touchChildren=!1,2==GuessManager.instance.p_bossState&&SceneManager.instance.p_sceneType!=SceneTypeEnum.MISSION?(this.u_grpCantTips.visible=!1,this.u_btnGuanZhan.visible=!0):(this.u_grpCantTips.visible=!0,this.u_btnGuanZhan.visible=!1));for(var t=0;t<this.m_bossViewList.length;t++)this.m_bossViewList[t].show();for(var t=0;t<this.m_betViewList.length;t++)this.m_betViewList[t].show()},e.prototype.setTimeMissionItem=function(){var t=GuessManager.instance.p_luckBossEndTime-ServerTimeManager.instance.timer;return 0>t?(t=0,void TimeManager.instance.clearTimer(this.setTimeMissionItem,this)):void(1==GuessManager.instance.p_bossState?this.u_txtTime.textFlow=LanguageJson.getHtmlTextFlow("l_luck_boss_time",[TimeUtil.getSpliceTime2(t)]):2==GuessManager.instance.p_bossState?this.u_txtTime.textFlow=LanguageJson.getHtmlTextFlow("l_luck_boss_fight_time",[TimeUtil.getSpliceTime2(t)]):this.u_txtTime.textFlow=LanguageJson.getHtmlTextFlow("l_luck_boss_next_time",[TimeUtil.getSpliceTime2(t)]))},e.prototype.setPeople=function(){this.u_txtPeople.text=GuessManager.instance.p_players+""},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i);for(var s=0;s<this.m_costBtnList.length;s++)this.m_costBtnList[s].hide();for(var s=0;s<this.m_bossViewList.length;s++)this.m_bossViewList[s].hide();for(var s=0;s<this.m_betViewList.length;s++)this.m_betViewList[s].hide();TimeManager.instance.clearTimer(this.setTimeMissionItem,this),Dispatch.remove(GuessManager.EVENT_GUESS_BOSS_TIME_CHANGE,this.setTimeDown,this),Dispatch.remove(GuessManager.EVENT_GUESS_BOSS_PEOPLE_CHANGE,this.setPeople,this)},e.prototype.sureHide=function(e,i){void 0===i&&(i=null),t.prototype.sureHide.call(this,e,i),GuessManager.instance.s_mission_lucky_boss_status(0)},e.EVENT_LUCKBOSS_CLEAR="EVENT_LUCKBOSS_CLEAR",e.EVENT_LUCKBOSS_JINGCAI="EVENT_LUCKBOSS_JINGCAI",e.p_flyList={},e}(PopupBase);__reflect(LuckBossUI.prototype,"LuckBossUI");var LuckBossUniqueSkill=function(){function t(){this.m_imgUrl=PublicCon.PATH_EFFECT_MONSTER+"baozha/baozha_guang.png",this.m_initPoint=new egret.Point}return t.prototype.show=function(t){this.m_initPoint.x=t.x+t.pointCentered[0],this.m_initPoint.y=t.y+t.pointCentered[1],this.m_imgGuang||(this.m_imgGuang=new eui.Image(this.m_imgUrl),this.m_imgGuang.width=1569,this.m_imgGuang.height=1028,this.m_imgGuang.anchorOffsetX=this.m_imgGuang.width/2,this.m_imgGuang.anchorOffsetY=this.m_imgGuang.height/2,this.m_imgGuang.touchEnabled=!1,this.m_imgGuang.blendMode=egret.BlendMode.ADD),this.m_iconUrl1=TextureFrom.EFFECT+PublicCon.PATH_EFFECT_MONSTER+"baozha/baozha1",this.m_iconUrl2=TextureFrom.EFFECT+PublicCon.PATH_EFFECT_MONSTER+"baozha/baozha2",TextureLoadManager.instance.requestLoadTextureAtlas(this.m_iconUrl1,this,LoaderPriority.EFFECT,!1),TextureLoadManager.instance.requestLoadTextureAtlas(this.m_iconUrl2,this,LoaderPriority.EFFECT,!1)},t.prototype.onloadComplete=function(t){t==this.m_iconUrl1?(null==this.m_iconMC1?(this.m_iconMC1=new MovieClip(TexturePool.instance.getTextureAtlas(t)),this.m_iconMC1.scaleX=this.m_iconMC1.scaleY=1.5):this.m_iconMC1.resetTextures(TexturePool.instance.getTextureAtlas(t)),this.m_iconMC1.x=this.m_initPoint.x,this.m_iconMC1.y=this.m_initPoint.y,this.m_iconMC1.touchEnabled=!1,this.m_iconMC1.anchorOffsetX=.5*this.m_iconMC1.texture.textureWidth,this.m_iconMC1.anchorOffsetY=.5*this.m_iconMC1.texture.textureHeight,this.m_iconMC1.blendMode=egret.BlendMode.ADD,this.m_iconMC1.addEventListener(egret.Event.COMPLETE,this.playComplete1,this)):(null==this.m_iconMC2?(this.m_iconMC2=new MovieClip(TexturePool.instance.getTextureAtlas(t)),this.m_iconMC2.scaleX=this.m_iconMC2.scaleY=2):this.m_iconMC2.resetTextures(TexturePool.instance.getTextureAtlas(t)),this.m_iconMC2.touchEnabled=!1,this.m_iconMC2.x=this.m_initPoint.x-40,this.m_iconMC2.y=this.m_initPoint.y,this.m_iconMC2.anchorOffsetX=.5*this.m_iconMC2.texture.textureWidth,this.m_iconMC2.anchorOffsetY=.5*this.m_iconMC2.texture.textureHeight,this.m_iconMC2.addEventListener(egret.Event.COMPLETE,this.playComplete2,this),this.m_iconMC2.addFrameScript(2,this.showImgGuang.bind(this))),this.m_iconMC1&&this.m_iconMC2&&this.startPlay()},t.prototype.showImgGuang=function(){this.m_imgGuang.alpha=1,TweenLite.to(this.m_imgGuang,.5,{alpha:0})},t.prototype.startPlay=function(){this.m_imgGuang.alpha=0,this.m_imgGuang.x=this.m_initPoint.x,this.m_imgGuang.y=this.m_initPoint.y,SceneLayerModule.instance.upEffectLayer.addChild(this.m_iconMC1),SceneLayerModule.instance.upEffectLayer.addChild(this.m_imgGuang),SceneLayerModule.instance.upEffectLayer.addChild(this.m_iconMC2),this.m_iconMC1.play(),this.m_iconMC2.play()},t.prototype.playComplete1=function(){TextureLoadManager.instance.closeLoad(this.m_iconUrl1,this),null!=this.m_iconMC1&&(this.m_iconMC1.removeEventListener(egret.Event.COMPLETE,this.playComplete1,this),DisplayObjectUtils.removeFormParent(this.m_iconMC1),this.m_iconMC1.removeEventListeners(),this.m_iconMC1.removeFromParent(),this.m_iconMC1.dispose(),this.m_iconMC1.stop(),this.m_iconMC1=null),this.setClose()},t.prototype.playComplete2=function(){TextureLoadManager.instance.closeLoad(this.m_iconUrl2,this),null!=this.m_iconMC2&&(this.m_iconMC2.removeEventListener(egret.Event.COMPLETE,this.playComplete2,this),DisplayObjectUtils.removeFormParent(this.m_iconMC2),this.m_iconMC2.removeEventListeners(),this.m_iconMC2.removeFromParent(),this.m_iconMC2.dispose(),this.m_iconMC2.stop(),this.m_iconMC2=null),this.setClose()},t.prototype.setClose=function(){this.m_iconMC1||this.m_iconMC1||(DisplayObjectUtils.removeFormParent(this.m_imgGuang),this.m_imgGuang=null,RES.destroyRes(this.m_imgUrl),-1==GuessManager.instance.p_uniqueSkillList.indexOf(this)&&GuessManager.instance.p_uniqueSkillList.push(this))},t}();__reflect(LuckBossUniqueSkill.prototype,"LuckBossUniqueSkill",["ITextureLoadEvent"]);var LuckBossChartPopup=function(t){function e(){var e=t.call(this)||this;return e.m_layout=new eui.TileLayout,e.m_typeList=new eui.ArrayCollection,e.m_headList=[],e.touchEnabled=!1,e.m_disposeUrlList.push("luckBossChartUI_json"),e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/luckBossUI/popup/LuckBossChartPopupSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this);for(var e=GuessManager.instance.guessBossList,i=0;i<e.length;i++){var s=new LuckBossChartHead(i,e[i]);this.addChild(s),this.m_headList.push(s)}this.u_scrollerItem.horizontalScrollBar=null,this.u_scrollerItem.verticalScrollBar=null,this.u_scrollerItem.bounces=!1,this.m_layout.requestedRowCount=1,this.m_layout.horizontalGap=0,this.u_listItem.itemRenderer=LuckBossChartRender,this.u_listItem.layout=this.m_layout,this.u_listItem.dataProvider=this.m_typeList,this.u_txtDesc.textFlow=LanguageJson.getHtmlTextFlow("l_luck_boss_chart")},e.prototype.initEvent=function(){t.prototype.initEvent.call(this)},e.prototype.showView=function(e){if(void 0===e&&(e=null),this.checkComplete(this.showView,e)){t.prototype.showView.call(this,e);for(var i=0;i<this.m_headList.length;i++)this.m_headList[i].show();var s=GuessManager.instance.p_guessRecord;this.u_scrollerItem.viewport.scrollH=0,this.m_typeList.source=s}},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i),this.u_scrollerItem.stopAnimation()},e}(PopupBase);__reflect(LuckBossChartPopup.prototype,"LuckBossChartPopup");var LuckBossFTPopup=function(t){function e(){var e=t.call(this)||this;return e.m_disposeUrlList.push("luckBossFTUI_json"),e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/luckBossUI/popup/LuckBossFTPopupSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this);var e=LanguageJson.getText("l_guess_boss_rule");this.u_txtMsg.textFlow=HtmlUtil.setTextFlow(e)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnClose,this.close,this,!0)},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),this.startTimeDo())},e.prototype.startTimeDo=function(){this.m_time=8,TimeManager.instance.doLoop(this.refreshTime,this,1e3)},e.prototype.refreshTime=function(){return this.m_time<=0?(TimeManager.instance.clearTimer(this.refreshTime,this),void this.close()):void this.m_time--},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i),TimeManager.instance.clearTimer(this.refreshTime,this)},Object.defineProperty(e.prototype,"isClickBMask",{get:function(){return!1},enumerable:!0,configurable:!0}),e}(PopupBase);__reflect(LuckBossFTPopup.prototype,"LuckBossFTPopup");var LuckBossResultPopup=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e.m_disposeUrlList.push("luckBossResultUI_json"),e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/luckBossUI/popup/LuckBossResultPopupSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_txtMsg2.textFlow=LanguageJson.getHtmlTextFlow("l_luck_boss_win_more_tips"),this.u_txtNone2.textFlow=LanguageJson.getHtmlTextFlow("l_luck_boss_loser"),this.u_txtNone3.textFlow=LanguageJson.getHtmlTextFlow("l_luck_boss_loser")},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnClose,this.close,this,!0)},e.prototype.showView=function(e){if(void 0===e&&(e=null),this.checkComplete(this.showView,e)){t.prototype.showView.call(this,e);var i=e.win_boss,s=e.prop,n=s[0].num,o=s[1].num,a=s[2].num;n>0?(this.u_grpNum1.visible=!0,this.m_numberView1||(this.m_numberView1=new NumberView("luckBossResultUI_json.luckBossResultUI_num_",0,-11),this.m_numberView1.x=36,this.m_numberView1.y=0),this.u_grpNum1.addChild(this.m_numberView1),this.m_numberView1.setMsgString(NumberUtil.numberToString(n)),this.u_txtMsg1.y=220,this.u_txtMsg1.textFlow=LanguageJson.getHtmlTextFlow("l_luck_boss_win_tips"),this.u_imgBg.source="luckBossResultUI_json.luckBossResultUI_bg1",this.u_btnClose.source="luckBossResultUI_json.luckBossResultUI_btn_sure1"):(this.u_grpNum1.visible=!1,this.u_txtMsg1.y=245,this.u_txtMsg1.textFlow=LanguageJson.getHtmlTextFlow("l_luck_boss_loser_tips"),this.u_imgBg.source="luckBossResultUI_json.luckBossResultUI_bg2",this.u_btnClose.source="luckBossResultUI_json.luckBossResultUI_btn_sure2",this.m_numberView1&&(this.m_numberView1.hide(),this.m_numberView1=null)),o>0?(this.u_grpDX.visible=!0,this.u_grpDX.x=a>0?604:451,this.u_dxImgBg.source="luckBossResultUI_json.luckBossResultUI_bg5",this.u_txtNone2.visible=!1,this.u_grpNum2.visible=!0,this.m_numberView2||(this.m_numberView2=new NumberView("luckBossResultUI_json.luckBossResultUI_num_",0,-11),this.m_numberView2.x=36,this.m_numberView2.y=0),this.u_grpNum2.addChild(this.m_numberView2),this.m_numberView2.setMsgString(NumberUtil.numberToString(o))):(this.u_grpDX.visible=a>0?!1:!0,this.u_grpDX.visible&&(this.u_txtNone2.visible=!0,this.u_grpNum2.visible=!1,this.u_grpDX.x=604,this.u_dxImgBg.source="luckBossResultUI_json.luckBossResultUI_bg6"),this.m_numberView2&&(this.m_numberView2.hide(),this.m_numberView2=null)),a>0?(this.u_grpDS.visible=!0,this.u_grpDS.x=o>0?340:451,this.u_dsImgBg.source="luckBossResultUI_json.luckBossResultUI_bg3",this.u_txtNone3.visible=!1,this.u_grpNum3.visible=!0,this.m_numberView3||(this.m_numberView3=new NumberView("luckBossResultUI_json.luckBossResultUI_num_",0,-11),this.m_numberView3.x=36,this.m_numberView3.y=0),this.u_grpNum3.addChild(this.m_numberView3),this.m_numberView3.setMsgString(NumberUtil.numberToString(a))):(this.u_grpDS.visible=o>0?!1:!0,this.u_grpDS.visible&&(this.u_txtNone3.visible=!0,this.u_grpNum3.visible=!1,this.u_grpDS.x=340,this.u_dsImgBg.source="luckBossResultUI_json.luckBossResultUI_bg4"),this.m_numberView3&&(this.m_numberView3.hide(),this.m_numberView3=null));var r=GuessManager.instance.getBossIdx(i)+1;this.u_imgHead.source="luckBossFightUI_json.luckBossFightUI_head"+r,this.u_txtTag.text=r+"",this.startTimeDo()}},e.prototype.startTimeDo=function(){this.m_time=6,TimeManager.instance.doLoop(this.refreshTime,this,1e3)},e.prototype.refreshTime=function(){return this.m_time<0?(TimeManager.instance.clearTimer(this.refreshTime,this),void this.close()):(this.u_txtBlank.textFlow=LanguageJson.getHtmlTextFlow("l_boss_guess_result_tip1",[this.m_time]),void this.m_time--)},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i),TimeManager.instance.clearTimer(this.refreshTime,this),MissionManager.instance.s_mission_exit_mission_tos(),this.m_numberView1&&(this.m_numberView1.hide(),this.m_numberView1=null),this.m_numberView2&&(this.m_numberView2.hide(),this.m_numberView2=null),this.m_numberView3&&(this.m_numberView3.hide(),this.m_numberView3=null)},e}(PopupBase);__reflect(LuckBossResultPopup.prototype,"LuckBossResultPopup");var LuckBossChartRender=function(t){function e(){return t.call(this,"resource/eui_skins/luckBossUI/render/LuckBossChartRenderSkin.exml")||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this)},e.prototype.dataChanged=function(){if(this.checkComplete(this.dataChanged)){t.prototype.dataChanged.call(this),this.m_data=this.data;var e=GuessManager.instance.p_guessRecord.length-this.itemIndex,i=GuessManager.instance.getBossIdx(this.m_data.boss_id);this.u_txtId.text=e>=0?String(e)+"":String(0),this.u_imgBg.visible=this.itemIndex%2==1?!0:!1,0>i?this.u_imgIcon.visible=!1:(this.u_imgIcon.visible=!0,this.u_imgIcon.y=48+60*i)}},e}(ItemRendererBase);__reflect(LuckBossChartRender.prototype,"LuckBossChartRender");var LuckBossFightHeadRender=function(t){function e(){return t.call(this,"resource/eui_skins/luckBossUI/render/LuckBossFightHeadRenderSkin.exml")||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this)},e.prototype.dataChanged=function(){if(this.checkComplete(this.dataChanged)){t.prototype.dataChanged.call(this),this.m_monsterId=this.data;var e=GuessManager.instance.getBossIdx(this.m_monsterId);this.u_imgHead.source="luckBossFightUI_json.luckBossFightUI_head"+(e+1),this.u_txtTag.text=String(e+1),Dispatch.register(GuessManager.EVENT_GUESS_BOSS_DIE+this.m_monsterId,this.setDie,this),this.checkDie()}},e.prototype.checkDie=function(){var t=!0;for(var e in SceneItemModule.instance.monsterDict){var i=SceneItemModule.instance.monsterDict[e];if(i.dataMonster.monster_id==this.m_monsterId&&i.p_hp>0){t=!1;break}}this.setDie(t)},e.prototype.setDie=function(t){void 0===t&&(t=!0),t?ObjectUtils.setGrey(this.u_mcHead):ObjectUtils.setGrey(this.u_mcHead,!1),this.u_imgDie.visible=t},e}(ItemRendererBase);__reflect(LuckBossFightHeadRender.prototype,"LuckBossFightHeadRender");var LuckBetView=function(t){function e(e,i){var s=t.call(this)||this;return s.m_myCost=0,s.m_totalCost=0,s.m_posId=i[0],s.m_bossList=i[1],s.x=35,s.y=60+(s.height+4)*Math.floor(e/1),s.once(egret.Event.COMPLETE,s.onCompleted,s),s.skinName="resource/eui_skins/luckBossUI/view/LuckBetViewSkin.exml",s}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.m_numberView||(this.m_numberView=new NumberView("luckBossUI_json.luckBossUI_num_xz_",0,-4),this.m_numberView.right=9,this.m_numberView.y=102,this.addChildAt(this.m_numberView,5)),this.m_tagView||(this.m_tagView=new NumberView("luckBossUI_json.luckBossUI_num_",0,-9),this.m_tagView.horizontalCenter=0,this.m_tagView.y=60,this.m_tagView.scaleX=this.m_tagView.scaleY=.75,this.addChildAt(this.m_tagView,5));for(var t="",e=0;e<this.m_bossList.length;e++){var i=GuessManager.instance.getBossIdx(this.m_bossList[e]);t+=String(i+1),e<this.m_bossList.length-1&&(t+="d")}this.m_tagView.setMsgString(t),this.u_imgIcon.source="luckBossUI_json.luckBossUI_icon"+this.m_posId,this.u_txtMsg.text=LanguageJson.getText("l_luck_boss_xiazhuqu")},e.prototype.initEvent=function(){this.registerEventClick(this,this.onClick,this)},e.prototype.onClick=function(t){void 0===t&&(t=null);var e=GuessManager.instance.getLuckMaxCost();return this.m_myCost>=e?void FloatTipModule.instance.popTipLanguage("l_luck_boss_max_tips"):void GuessManager.instance.s_mission_lucky_boss_bet(this.m_posId,LuckBossUI.p_cost)},e.prototype.show=function(t){void 0===t&&(t=null),this.checkComplete(this.show,t)&&(Dispatch.register(GuessManager.EVENT_GUESS_BOSS_MYCOST_CHANGE+this.m_posId,this.showMyCost,this,!0),Dispatch.register(GuessManager.EVENT_GUESS_BOSS_TOTALCOST_CHANGE+this.m_posId,this.showTotalCost,this),Dispatch.register(GuessManager.EVENT_GUESS_BOSS_TOTALCOST_CHANGE,this.flyIcon,this))},e.prototype.showMyCost=function(){this.m_myCost=GuessManager.instance.getMyLuckBet(this.m_posId),this.u_txtMyCost.textFlow=LanguageJson.getHtmlTextFlow("l_game_unit_dollar2",[this.m_myCost]),0==this.m_myCost?this.u_grpMyCost.visible=!1:this.u_grpMyCost.visible=!0,this.showTotalCost()},e.prototype.showTotalCost=function(){this.m_totalCost=GuessManager.instance.getTotalLuckBet(this.m_posId)+this.m_myCost,this.m_totalCost<this.m_myCost&&(this.m_totalCost=this.m_myCost),this.m_numberView.setMsgString("m"+NumberUtil.numberToString(this.m_totalCost));for(var t=0,e=0;e<LuckBossUI.p_goldList.length;e++){var i=LuckBossUI.p_goldList[e];if(0!=i[1]){if(this.m_totalCost>=i[0]&&this.m_totalCost<=i[1]){t=e;break}}else if(this.m_totalCost>=i[0]){t=e;break}}this.u_imgGold.source="luckBossUI_json.luckBossUI_num_icon_jb"+(t+1)},e.prototype.flyIcon=function(t){if(t==this.m_posId){var e=this.parent.parent.localToGlobal(1069,578),i=this.localToGlobal(this.width/2,this.height/2);FlyResModule.instance.playResEffect4([e.x,e.y],[i.x,i.y],ItemEnum.RMB,10,.3)}},e.prototype.hide=function(){Dispatch.remove(GuessManager.EVENT_GUESS_BOSS_MYCOST_CHANGE+this.m_posId,this.showMyCost,this),Dispatch.remove(GuessManager.EVENT_GUESS_BOSS_TOTALCOST_CHANGE+this.m_posId,this.showTotalCost,this),Dispatch.remove(GuessManager.EVENT_GUESS_BOSS_TOTALCOST_CHANGE,this.flyIcon,this)},Object.defineProperty(e.prototype,"width",{get:function(){return 163},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 163},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(LuckBetView.prototype,"LuckBetView");var LuckBossChartHead=function(t){function e(e,i){var s=t.call(this)||this;return s.m_idx=e,s.m_monsterId=i,s.x=133,s.y=171+(s.height+12)*e,s.once(egret.Event.COMPLETE,s.onCompleted,s),s.skinName="resource/eui_skins/luckBossUI/view/LuckBossChartHeadSkin.exml",s}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.m_numberView||(this.m_numberView=new NumberView("luckBossChartUI_json.luckBossChartUI_num_",0,-10),this.u_grpNum.addChild(this.m_numberView)),this.u_imgHead.source="luckBossFightUI_json.luckBossFightUI_head"+(this.m_idx+1)},e.prototype.show=function(t){if(void 0===t&&(t=null),this.checkComplete(this.show,t)){var e=GuessManager.instance.getSelectNum(this.m_monsterId);this.m_numberView.numValue=e}},Object.defineProperty(e.prototype,"width",{get:function(){return 99},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 48},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(LuckBossChartHead.prototype,"LuckBossChartHead");var LuckBossCost=function(t){function e(e,i){var s=t.call(this)||this;return s.m_idx=e,s.m_cost=i,s.x=(s.width+4)*e,s.once(egret.Event.COMPLETE,s.onCompleted,s),s.skinName="resource/eui_skins/luckBossUI/view/LuckBossCostSkin.exml",s}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.u_imgCost.source="luckBossUI_json.luckBossUI_icon_cm"+(this.m_idx+1)},e.prototype.initEvent=function(){this.registerEventClick(this,this.onClick,this)},e.prototype.onClick=function(t){void 0===t&&(t=null),this.m_cost!=LuckBossUI.p_cost&&(LuckBossUI.p_cost=this.m_cost,Dispatch.dispatch(e.EVENT_LUCKBOSS_COST_SELECT))},e.prototype.show=function(t){void 0===t&&(t=null),this.checkComplete(this.show,t)&&(Dispatch.register(e.EVENT_LUCKBOSS_COST_SELECT,this.setSelect,this,!0),Dispatch.register(GuessManager.EVENT_GUESS_BOSS_MYCOST_CHANGE,this.flyIcon,this))},e.prototype.setSelect=function(){this.m_cost==LuckBossUI.p_cost?this.u_imgSelect.visible=!0:this.u_imgSelect.visible=!1},e.prototype.flyIcon=function(t){if(this.m_cost==LuckBossUI.p_cost){var e=LuckBossUI.p_flyList[t],i=this.localToGlobal(this.width/2,this.height/2),s=e.parent.localToGlobal(e.x+e.width/2,e.y+e.height/2);FlyResModule.instance.playResEffect4([i.x,i.y],[s.x,s.y],ItemEnum.RMB,10,.5)}},e.prototype.hide=function(){Dispatch.remove(e.EVENT_LUCKBOSS_COST_SELECT,this.setSelect,this),Dispatch.remove(GuessManager.EVENT_GUESS_BOSS_MYCOST_CHANGE,this.flyIcon,this)},Object.defineProperty(e.prototype,"width",{get:function(){return 105},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 111},enumerable:!0,configurable:!0}),e.EVENT_LUCKBOSS_COST_SELECT="EVENT_LUCKBOSS_COST_SELECT",e}(ComponentBase);__reflect(LuckBossCost.prototype,"LuckBossCost");var LuckBossFightTop=function(t){function e(){var e=t.call(this)||this;return e.m_layout=new eui.TileLayout,e.m_typeList=new eui.ArrayCollection,e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/luckBossUI/view/LuckBossFightTopSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.m_layout.requestedRowCount=1,this.m_layout.horizontalGap=16,this.u_listItem.itemRenderer=LuckBossFightHeadRender,this.u_listItem.layout=this.m_layout,this.u_listItem.dataProvider=this.m_typeList},e.prototype.initEvent=function(){this.registerEventClick(this.u_btnDetail,this.onDetail,this),this.registerEventClick(this.u_btnChart,this.onChart,this)},e.prototype.onDetail=function(){GuessManager.instance.s_mission_lucky_boss_status(1)},e.prototype.onChart=function(){GuessManager.instance.s_mission_luck_boss_get_record()},e.prototype.showView=function(t){void 0===t&&(t=null),this.checkComplete(this.showView,t)&&(this.m_typeList.source=GuessManager.instance.guessBossList)},Object.defineProperty(e.prototype,"width",{get:function(){return 847},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 102
},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(LuckBossFightTop.prototype,"LuckBossFightTop");var LuckBossStart=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.show=function(){this.m_imgBg||(this.m_imgBg=new eui.Image("commonUI_json.commonUI_box_1"),this.m_imgBg.scale9Grid=new egret.Rectangle(17,17,16,16),this.m_imgBg.width=StageManager.instance.p_stageWidth,this.m_imgBg.height=100),this.addChild(this.m_imgBg),this.m_txtMsg||(this.m_txtMsg=new eui.Label,this.m_txtMsg.size=60,this.m_txtMsg.bold=!0,this.m_txtMsg.textColor=16777215,this.m_txtMsg.text="比赛开始",this.m_txtMsg.anchorOffsetX=this.m_txtMsg.width/2,this.m_txtMsg.anchorOffsetY=this.m_txtMsg.height/2,this.m_txtMsg.x=StageManager.instance.p_stageWidth/2,this.m_txtMsg.y=this.m_imgBg.height/2),this.addChild(this.m_txtMsg),this.startAnimation()},e.prototype.startAnimation=function(){this.x=StageManager.instance.p_stageWidth+300,this.y=(StageManager.instance.p_stageHeight-this.m_imgBg.height)/2,TweenLite.to(this,.4,{x:0,ease:Circ.easeInOut}),TweenLite.to(this,.3,{delay:1.5,x:-StageManager.instance.p_stageWidth-300,ease:Back.easeIn,onComplete:this.moveEnd.bind(this)})},e.prototype.moveEnd=function(){this.m_imgBg&&DisplayObjectUtils.removeFormParent(this.m_txtMsg),this.m_txtMsg&&DisplayObjectUtils.removeFormParent(this.m_txtMsg),DisplayObjectUtils.removeFormParent(this)},e}(egret.DisplayObjectContainer);__reflect(LuckBossStart.prototype,"LuckBossStart");var LuckBossView=function(t){function e(e){var i=t.call(this)||this;return i.m_myCost=0,i.m_totalCost=0,i.m_posId=e,i.x=35+(i.width+7)*Math.floor((e-1)%3),i.y=60+(i.height+7)*Math.floor((e-1)/3),i.once(egret.Event.COMPLETE,i.onCompleted,i),i.skinName="resource/eui_skins/luckBossUI/view/LuckBossViewSkin.exml",i}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.m_numberView||(this.m_numberView=new NumberView("luckBossUI_json.luckBossUI_num_xz_",0,-4),this.m_numberView.right=9,this.m_numberView.y=102,this.addChildAt(this.m_numberView,5)),this.u_bossIdx.source="luckBossUI_json.luckBossUI_num_"+this.m_posId,this.u_bossIcon.source="luckBossUI_json.luckBossUI_icon_boss"+this.m_posId,this.u_txtMsg.text=LanguageJson.getText("l_luck_boss_xiazhuqu")},e.prototype.initEvent=function(){this.registerEventClick(this,this.onClick,this)},e.prototype.onClick=function(t){void 0===t&&(t=null);var e=GuessManager.instance.getLuckMaxCost();return this.m_myCost>=e?void FloatTipModule.instance.popTipLanguage("l_luck_boss_max_tips"):void GuessManager.instance.s_mission_lucky_boss_bet(this.m_posId,LuckBossUI.p_cost)},e.prototype.show=function(t){void 0===t&&(t=null),this.checkComplete(this.show,t)&&(Dispatch.register(GuessManager.EVENT_GUESS_BOSS_MYCOST_CHANGE+this.m_posId,this.showMyCost,this,!0),Dispatch.register(GuessManager.EVENT_GUESS_BOSS_TOTALCOST_CHANGE+this.m_posId,this.showTotalCost,this),Dispatch.register(GuessManager.EVENT_GUESS_BOSS_TOTALCOST_CHANGE,this.flyIcon,this))},e.prototype.showMyCost=function(){this.m_myCost=GuessManager.instance.getMyLuckBet(this.m_posId),this.u_txtMyCost.textFlow=LanguageJson.getHtmlTextFlow("l_game_unit_dollar2",[this.m_myCost]),0==this.m_myCost?this.u_grpMyCost.visible=!1:this.u_grpMyCost.visible=!0,this.showTotalCost()},e.prototype.showTotalCost=function(){this.m_totalCost=GuessManager.instance.getTotalLuckBet(this.m_posId)+this.m_myCost,this.m_totalCost<this.m_myCost&&(this.m_totalCost=this.m_myCost),this.m_numberView.setMsgString("m"+NumberUtil.numberToString(this.m_totalCost));for(var t=0,e=0;e<LuckBossUI.p_goldList.length;e++){var i=LuckBossUI.p_goldList[e];if(0!=i[1]){if(this.m_totalCost>=i[0]&&this.m_totalCost<=i[1]){t=e;break}}else if(this.m_totalCost>=i[0]){t=e;break}}this.u_imgGold.source="luckBossUI_json.luckBossUI_num_icon_jb"+(t+1)},e.prototype.flyIcon=function(t){if(t==this.m_posId){var e=this.parent.parent.localToGlobal(1069,578),i=this.localToGlobal(this.width/2,this.height/2);FlyResModule.instance.playResEffect4([e.x,e.y],[i.x,i.y],ItemEnum.RMB,10,.3)}},e.prototype.hide=function(){Dispatch.remove(GuessManager.EVENT_GUESS_BOSS_MYCOST_CHANGE+this.m_posId,this.showMyCost,this),Dispatch.remove(GuessManager.EVENT_GUESS_BOSS_TOTALCOST_CHANGE+this.m_posId,this.showTotalCost,this),Dispatch.remove(GuessManager.EVENT_GUESS_BOSS_TOTALCOST_CHANGE,this.flyIcon,this)},Object.defineProperty(e.prototype,"width",{get:function(){return 178},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 160},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(LuckBossView.prototype,"LuckBossView");var LuckMonsterHp=function(t){function e(){var e=t.call(this)||this;return e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/luckBossUI/view/LuckMonsterHpSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){t.prototype.onCompleted.call(this)},e.prototype.show=function(t){if(this.checkComplete(this.show,t)){var e=GuessManager.instance.getBossIdx(t.monster_id);this.u_txtTag.text=String(e+1),this.u_hpimg.width=this.u_hpLineimg.width=165*(t.hp/t.max_hp),this.u_txtHp.text=t.hp+"/"+t.max_hp}},e.prototype.refreshHP=function(t,e){var i=t/e;this.u_hpimg.width=165*i,this.u_hpimg.width=this.u_hpimg.width>165?165:this.u_hpimg.width,this.u_txtHp.text=t+"/"+e,TweenLite.to(this.u_hpLineimg,.5,{width:this.u_hpimg.width,onComplete:this.hideHP.bind(this),onCompleteParams:[t,e]})},e.prototype.hideHP=function(t,e){0==t&&this.hide()},e.prototype.hide=function(){DisplayObjectUtils.removeFormParent(this)},Object.defineProperty(e.prototype,"width",{get:function(){return 165},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 19},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(LuckMonsterHp.prototype,"LuckMonsterHp");var LuckyDrawUI=function(t){function e(){var e=t.call(this)||this;return e.m_treasureArr=[],e.m_num=0,e.m_state=0,e.ct=30,e.m_radList=[],e.m_awdNum=0,e.m_isContinue=!1,e.m_awdList=[],e.m_awdArr=new eui.ArrayCollection,e.m_achievementList=[],e.m_extraList=[],e.m_extraArr=new eui.ArrayCollection,e.m_typeId=1,e.m_isDraw=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/luckyDrawUI/LuckyDrawUISkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_luckyTip.text=LanguageJson.getText("l_lucky_draw_value_tip"),this.u_extraTitle.text=LanguageJson.getText("l_lucky_draw_extra_award"),this.m_typeId=LuckyDrawManager.instance.p_typeId;var e=TreasureHuntTypeJson.getData(this.m_typeId);this.m_achievementList=e.achievement_list,this.m_ruleDesc=e.desc;for(var i=0;14>i;i++){var s=TreasureHuntJson.getData(this.m_typeId,i+1),n=s.award_list[0];this.m_treasureArr.push({prop_id:n[0],num:n[1]});var o=new ItemIcon;o.scaleX=.7,o.scaleY=.7,o.x=this["u_iconBg_"+i].x+23,o.y=this["u_iconBg_"+i].y+12,o.p_isShowQuality=!1,o.setData(n[0],0),this.u_iconGrp.addChild(o);var a=new eui.Image("luckyDrawUI_json.luckyDrawUI_pop");a.scale9Grid=new egret.Rectangle(20,10,4,4),this.u_iconGrp.addChild(a);var r=new eui.Label;r.size=16,r.textColor=15787184,r.textFlow=TextUtil.setTextFlow(String(NumberUtil.numberToString(n[1]))),this.u_iconGrp.addChild(r),r.x=this["u_iconBg_"+i].x+61+(61-r.textWidth)/2,r.y=this["u_iconBg_"+i].y+15;var _=r.textWidth>15?10:20;if(a.width=r.textWidth+_,a.x=r.x-_/2,a.y=r.y-5,s.label){var h=new eui.Image("luckyDrawUI_json.luckyDrawUI_tab");h.x=this["u_iconBg_"+i].x,h.y=this["u_iconBg_"+i].y,h.touchEnabled=!1,this.u_iconGrp.addChild(h)}}this.setValue(),this.initAwd(),this.initExtra(),this.m_timer=new egret.Timer(300,0),this.m_timer.addEventListener(egret.TimerEvent.TIMER,this.timeCallback,this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btn_0,this.startOneTap,this,!0),this.registerEventClick(this.u_btn_1,this.startFiveTap,this,!0),this.registerEventClick(this.u_storeBtn,this.toStore,this,!0),this.registerEventClick(this.u_tipBtn,this.showRule,this,!0)},e.prototype.initAwd=function(){this.u_awdScroller.horizontalScrollBar=null,this.u_awdScroller.verticalScrollBar=null;var t=new eui.TileLayout;t.requestedRowCount=1,t.orientation=eui.TileOrientation.COLUMNS,t.horizontalGap=15,this.u_awdList.itemRenderer=LuckyDrawAwdRender,this.u_awdList.layout=t,this.u_awdList.dataProvider=this.m_awdArr,this.m_awdArr.source=this.m_awdList},e.prototype.initExtra=function(){this.u_extraScroller.horizontalScrollBar=null,this.u_extraScroller.verticalScrollBar=null,this.u_extraScroller.scrollPolicyH=eui.ScrollPolicy.OFF,this.u_extraScroller.scrollPolicyV=eui.ScrollPolicy.AUTO;var t=new eui.TileLayout;t.orientation=eui.TileOrientation.ROWS,t.verticalGap=10;for(var e=0;e<this.m_achievementList.length;e++)this.m_extraList.push({status:Number(LuckyDrawManager.instance.p_statusArr[e]),list:this.m_achievementList[e]});this.u_extraList.itemRenderer=LuckyDrawExtraRender,this.u_extraList.layout=t,this.u_extraList.dataProvider=this.m_extraArr,this.m_extraArr.source=this.m_extraList},e.prototype.updateEtrAwd=function(t){this.m_extraList=[];for(var e=0;e<this.m_achievementList.length;e++)this.m_extraList.push({status:Number(t[e]),list:this.m_achievementList[e]});this.updateEtr()},e.prototype.updateEtr=function(){this.m_extraArr.source=this.m_extraList,this.m_extraArr.refresh()},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),Dispatch.register(LuckyDrawManager.EVENT_EXTRA_AWARD_STATUS,this.updateEtrAwd,this),Dispatch.register(LuckyDrawManager.EVENT_TREASURE_SEIZE,this.startLucky,this),this.u_selectBg.visible=!1)},e.prototype.setValue=function(){var t=LuckyDrawManager.instance,e=t.p_luckyValue;this.u_luckyLb.text=LanguageJson.getText("l_lucky_draw_value"),this.u_valueLb.text=String(e),this.u_countLb.textFlow=LanguageJson.getHtmlTextFlow("l_lucky_draw_count",[t.p_times]),this.updateEtr()},e.prototype.toStore=function(){PopupModule.instance.showPop(PopupConfig.ID_EXCHANGE_SHOP,null,!1)},e.prototype.showRule=function(t){return this.m_ruleView&&this.m_ruleView.parent?void this.m_ruleView.hide():(this.m_ruleView||(this.m_ruleView=new LuckyDrawRule,this.m_ruleView.x=412,this.m_ruleView.y=58),this.addChild(this.m_ruleView),this.m_ruleView.show(this.m_ruleDesc),t.stopPropagation(),void t.stopImmediatePropagation())},e.prototype.startOneTap=function(t){LuckyDrawManager.instance.s_seize_treasure_get_treasure(0)},e.prototype.startFiveTap=function(t){LuckyDrawManager.instance.s_seize_treasure_get_treasure(1)},e.prototype.startLucky=function(t,e,i){var s=this;this.m_isDraw=!0,this.touchChildren=!1,Dispatch.dispatch(LuckyDrawManager.EVENT_SEIZING_STATUS,!0);var n=function(t,e){var i=-1,s=Object.keys(e)[0],n=Object.keys(e)[1];return t.every(function(t,o){return t[s]==e[s]&&t[n]==e[n]?(i=o,!1):!0}),i},o=[];t.forEach(function(t){var e=n(s.m_treasureArr,t);-1!=e&&o.push(e)}),this.m_radList=o,this.m_isContinue=this.m_radList.length>1,this.m_rad=this.m_radList[0],this.u_selectBg.visible=!0,this.m_state=0,this.m_timer.start()},e.prototype.timeCallback=function(t){switch(this.m_num++,this.m_num>=14&&(this.m_num=0),this.u_selectBg.x=this["u_iconBg_"+this.m_num].x,this.u_selectBg.y=this["u_iconBg_"+this.m_num].y,this.m_state){case 0:this.m_timer.delay>30?this.m_timer.delay-=30:this.m_state=1;break;case 1:this.ct--,this.ct<=0&&(this.ct=30,this.m_state=2,this.m_timer.delay=20,this.u_valueGrp.visible=!1,this.u_awardGrp.visible=!0,this.u_awdScroller.width=this.m_isContinue?360:60);break;case 2:this.m_num==this.m_rad&&(this.m_timer.stop(),this.doFlashEffect(),this.updateAwdList(),this.m_isContinue?DelayCallUtils.delayedCall(.8,this.move,this):DelayCallUtils.delayedCall(1.2,this.showRewardPop,this))}},e.prototype.move=function(){this.u_selectBg.alpha=1,this.m_awdNum++,this.m_rad=this.m_radList[this.m_awdNum],this.m_awdNum<this.m_radList.length?(TweenLite.killTweensOf(this.u_selectBg),this.m_timer.start()):DelayCallUtils.delayedCall(1.2,this.showRewardPop,this)},e.prototype.showRewardPop=function(){LuckyDrawManager.instance.s_seize_treasure_get_extra_award_status(),PopupModule.instance.showPop(PopupConfig.ID_LUCKYDRAW_REWARD,{dataList:this.m_awdList,isContinue:this.m_isContinue},!1),this.reset()},e.prototype.updateAwdList=function(){this.m_awdList.push(this.m_treasureArr[this.m_rad]),this.m_awdArr.source=this.m_awdList,this.m_awdArr.refresh()},e.prototype.reset=function(){this.m_isDraw=!1,this.touchChildren=!0,Dispatch.dispatch(LuckyDrawManager.EVENT_SEIZING_STATUS,!1),this.m_state=0,this.m_awdNum=0,this.m_timer.delay=300,this.m_num=0,this.m_radList=[],this.m_awdList=[],this.m_awdArr.source=this.m_awdList,this.m_awdArr.refresh(),TweenLite.killTweensOf(this.u_selectBg),this.u_selectBg.visible=!1,this.u_selectBg.x=this["u_iconBg_"+this.m_num].x,this.u_selectBg.y=this["u_iconBg_"+this.m_num].y,this.u_awardGrp.visible=!1,this.u_valueGrp.visible=!0,this.setValue()},e.prototype.doFlashEffect=function(){this.parent&&this.u_selectBg&&(0==this.u_selectBg.alpha?TweenLite.to(this.u_selectBg,.2,{alpha:1,onComplete:this.doFlashEffect.bind(this)}):TweenLite.to(this.u_selectBg,.2,{alpha:0,onComplete:this.doFlashEffect.bind(this)}))},e.prototype.isCloseUI=function(){return this.m_isDraw?(FloatTipModule.instance.popTip(LanguageJson.getText("l_treasure_close_tip")),!1):!0},e.prototype.hide=function(e){void 0===e&&(e=null),t.prototype.hide.call(this,e),Dispatch.register(LuckyDrawManager.EVENT_EXTRA_AWARD_STATUS,this.updateEtrAwd,this),Dispatch.register(LuckyDrawManager.EVENT_TREASURE_SEIZE,this.startLucky,this),TweenLite.killTweensOf(this.u_selectBg),DelayCallUtils.killDelayedCallsTo(this.move,this),DelayCallUtils.killDelayedCallsTo(this.showRewardPop,this)},e}(PageBase);__reflect(LuckyDrawUI.prototype,"LuckyDrawUI");var LuckyDrawExtraRewardPop=function(t){function e(){var e=t.call(this)||this;return e.m_itemIndex=0,e.m_count=0,e.m_dataList=[],e.m_status=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/luckyDrawUI/pop/LuckyDrawExtraRewardPopSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_titleLb.text=LanguageJson.getText("l_lucky_draw_extra_award"),this.m_rewardGroup||(this.m_rewardGroup=new RewardGroupUI,this.m_rewardGroup.spaceX=15,this.m_rewardGroup.y=290,this.m_rewardGroup.scaleX=.8,this.m_rewardGroup.scaleY=.8,this.m_rewardGroup.horizontalCenter=0,this.addChild(this.m_rewardGroup))},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_buyBtn,this.onBuy,this,!0),this.registerEventClick(this.u_complBtn,this.close,this,!0),this.registerEventClick(this.u_receivBtn,this.onReceive,this,!0),this.registerEventClick(this.u_sureBtn,this.close,this,!0)},e.prototype.showView=function(e){if(void 0===e&&(e=null),this.checkComplete(this.showView,e)){t.prototype.showView.call(this,e),this.m_itemIndex=e.itemIndex,this.m_count=e.count,this.m_status=e.status,this.setView();var i=e.dataList;if(this.m_rewardGroup.scroller.viewport.scrollH=0,i&&i.length>0){if(i.length>=5)this.m_rewardGroup.visualWidth=560,this.m_rewardGroup.x=(this.width-560)/2;else{this.m_rewardGroup.visualWidth=0;var s=100*i.length+15*(i.length-1);this.m_rewardGroup.x=(this.width-s)/2}this.m_rewardGroup.visible=!0,this.m_rewardGroup.setDataByList(i,i.length)}else this.m_rewardGroup.visible=!1}},e.prototype.setView=function(){var t=LuckyDrawManager.instance.p_times;if(t>=this.m_count)1==this.m_status?(this.u_desLb.textFlow=LanguageJson.getHtmlTextFlow("l_lucky_draw_extra_tip1",[t]),this.u_btnGrp.visible=!1,this.u_receivBtn.visible=!1,this.u_sureBtn.visible=!0):(this.u_desLb.textFlow=LanguageJson.getHtmlTextFlow("l_lucky_draw_extra_tip3",[t]),this.u_btnGrp.visible=!1,this.u_receivBtn.visible=!0,this.u_sureBtn.visible=!1);else{var e=this.m_count-t;this.u_desLb.textFlow=LanguageJson.getHtmlTextFlow("l_lucky_draw_extra_tip2",[t,e]),this.u_btnGrp.visible=!0,this.u_receivBtn.visible=!1,this.u_sureBtn.visible=!1}},e.prototype.onBuy=function(){this.close(),LuckyDrawManager.instance.s_seize_treasure_get_treasure(0)},e.prototype.onReceive=function(){this.close(),LuckyDrawManager.instance.s_seize_treasure_get_extra_award(this.m_itemIndex)},e.prototype.sureHide=function(e,i){void 0===i&&(i=null),t.prototype.sureHide.call(this,e,i)},Object.defineProperty(e.prototype,"isClickBMask",{get:function(){return!1},enumerable:!0,configurable:!0}),e}(PopupBase);__reflect(LuckyDrawExtraRewardPop.prototype,"LuckyDrawExtraRewardPop");var LuckyDrawRewardPop=function(t){function e(){var e=t.call(this)||this;return e.m_itemList=[],e.m_isContinue=!1,e.m_itemW=120,e.m_flgW=20,e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/luckyDrawUI/pop/LuckyDrawRewardPopSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.m_effectOpenType=1,this.m_effectCloseType=2,this.touchEnabled=!1,this.u_closeTxt.text=LanguageJson.getText("l_closePop_tip")},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_buyBtn,this.onBuy,this,!0),this.registerEventClick(this.u_sureBtn,this.close,this,!0)},e.prototype.showView=function(e){if(void 0===e&&(e=null),this.checkComplete(this.showView,e)){t.prototype.showView.call(this,e);for(var i in this.m_itemList)this.m_itemList[i].hide();var s=e.dataList,n=Math.ceil(s.length/6),o=s.length>6?6:s.length;this.u_bg.height=n*this.m_itemW+(n-1)*this.m_flgW+300,this.u_rewardGrp.width=o*this.m_itemW+(o-1)*this.m_flgW,this.setItemList(s),this.m_isContinue=e.isContinue,this.u_buyBtn.source=this.m_isContinue?"luckyDrawUI_json.luckyDrawUI_buyFive":"luckyDrawUI_json.luckyDrawUI_buyOne"}},e.prototype.onBuy=function(){this.close();var t=this.m_isContinue?1:0;LuckyDrawManager.instance.s_seize_treasure_get_treasure(t)},e.prototype.setItemList=function(t){for(var e=0;e<t.length;e++){var i;this.m_itemList[e]?i=this.m_itemList[e]:(i=new ItemFloat,this.m_itemList[e]=i),i.setItem([t[e].prop_id,t[e].num],.12+.11*e,3),this.u_rewardGrp.addChild(i),i.x=Math.floor(e%5)*(this.m_itemW+this.m_flgW),i.y=Math.floor(e/5)*(this.m_itemW+this.m_flgW)}},e.prototype.hide=function(e,i){ItemFloatModule.instance.floatItemListByItemFloat(this.m_itemList,!0),t.prototype.hide.call(this,e,i)},e.prototype.sureHide=function(e,i){void 0===i&&(i=null),t.prototype.sureHide.call(this,e,i)},Object.defineProperty(e.prototype,"isClickBMask",{get:function(){return!0},enumerable:!0,configurable:!0}),e}(PopupBase);__reflect(LuckyDrawRewardPop.prototype,"LuckyDrawRewardPop");var LuckyDrawAwdRender=function(t){function e(){return t.call(this,"resource/eui_skins/luckyDrawUI/render/LuckyDrawAwdRenderSkin.exml")||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this),this.m_itemIcon||(this.m_itemIcon=new ItemIcon,this.m_itemIcon.x=0,this.m_itemIcon.y=0,this.m_itemIcon.scaleX=.5,this.m_itemIcon.scaleY=.5,this.addChild(this.m_itemIcon))},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.m_itemIcon.setData(this.data.prop_id,this.data.num)},e}(ItemRendererBase);__reflect(LuckyDrawAwdRender.prototype,"LuckyDrawAwdRender");var LuckyDrawExtraRender=function(t){function e(){var e=t.call(this,"resource/eui_skins/luckyDrawUI/render/LuckyDrawExtraRenderSkin.exml")||this;return e.m_dataList=[],e.m_count=0,e.m_status=0,e}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this),this.registerEventClick(this,this.onClick,this)},e.prototype.onClick=function(t){PopupModule.instance.showPop(PopupConfig.ID_LUCKYDRAW_REWARD_EXTRA,{itemIndex:this.itemIndex,count:this.m_count,dataList:this.m_dataList,status:this.m_status},!1)},e.prototype.dataChanged=function(){if(this.checkComplete(this.dataChanged)){t.prototype.dataChanged.call(this);var e=this.data.list;this.m_status=this.data.status,this.m_count=e[0],this.m_dataList=e[1],this.u_countLb.textFlow=LanguageJson.getHtmlTextFlow("l_lucky_draw_count_tip",[this.m_count]),LuckyDrawManager.instance.p_times>=this.m_count?1==this.m_status?(ObjectUtils.setGrey(this.u_boxIcon,!0,!0),this.u_receivedGrp.visible=!0):(ObjectUtils.setGrey(this.u_boxIcon,!1,!0),this.u_receivedGrp.visible=!1):(ObjectUtils.setGrey(this.u_boxIcon,!0,!0),this.u_receivedGrp.visible=!1)}},e}(ItemRendererBase);__reflect(LuckyDrawExtraRender.prototype,"LuckyDrawExtraRender");var LuckyDrawRule=function(t){function e(){var e=t.call(this)||this;return e.m_layout=new eui.TileLayout,e.m_typeList=new eui.ArrayCollection,e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/luckyDrawUI/view/LuckyDrawRuleSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){t.prototype.onCompleted.call(this)},e.prototype.show=function(t){void 0===t&&(t=null),this.checkComplete(this.show,t)&&(this.recoverAllTexture(this,!0),this.u_txtTitle.text=LanguageJson.getText("l_game_tips_27"),this.u_txtMsg.textFlow=HtmlUtil.setTextFlow(t),Dispatch.register(StageManager.EVENT_STAGE_CLICK,this.onStageClick,this))},e.prototype.onStageClick=function(t){var e=this.localToGlobal(0,0);t.stageX>=e.x&&t.stageX<=e.x+this.width&&t.stageY>=e.y&&t.stageY<=e.y+this.height||this.hide()},e.prototype.hide=function(){DisplayObjectUtils.removeFormParent(this),Dispatch.remove(StageManager.EVENT_STAGE_CLICK,this.onStageClick,this)},Object.defineProperty(e.prototype,"width",{get:function(){return 374},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 243},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(LuckyDrawRule.prototype,"LuckyDrawRule");var MailPopup=function(t){function e(){var e=t.call(this)||this;return e.m_layout=new eui.TileLayout,e.m_typeList=new eui.ArrayCollection,e.m_listArr=[],e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/mailUI/popup/MailPopupSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_scrollItem.horizontalScrollBar=null,this.u_scrollItem.verticalScrollBar=null,this.m_layout.requestedColumnCount=1,this.m_layout.verticalGap=0,this.u_listItem.itemRenderer=MailRender,this.u_listItem.layout=this.m_layout,this.u_listItem.dataProvider=this.m_typeList,this.m_rewardGroup||(this.m_rewardGroup=new RewardGroupUI,this.m_rewardGroup.spaceX=26,this.m_rewardGroup.y=235,this.u_gapDescBg.addChild(this.m_rewardGroup)),this.u_textNoMail.text=LanguageJson.getText("l_mail_nomail_tip"),this.u_textReadclick.text=LanguageJson.getText("l_mail_click_read_tip"),this.u_textAllRecerive.text=LanguageJson.getText("l_mail_receive_all"),this.u_textAllDel.text=LanguageJson.getText("l_mail_delete_all")},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_grpAllRecerive,this.onAllRecerive,this,!0),this.registerEventClick(this.u_grpAllDel,this.onAllDelete,this,!0),this.registerEventClick(this.u_btnClose,this.close,this),this.registerEventClick(this.u_grpRecerive,this.onReceive,this,!0)},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),MailManager.instance.p_isInitMailSimple?this.setData():MailManager.instance.requestMailList(),Dispatch.register(MailManager.MAIL_LIST_INIT,this.setData,this),Dispatch.register(MailManager.MAIL_OPEN_DETAIL,this.openDetail,this))},e.prototype.setData=function(t){void 0===t&&(t=!1),this.m_listArr=MailManager.instance.getMailSimpleList(),this.m_listArr.length>0?(this.u_grpNoMail.visible=!1,this.u_imgCentreLine.visible=!0,this.u_grpTip.visible=!this.u_gapDescBg.visible,t&&(this.u_grpTip.visible=!0,this.u_gapDescBg.visible=!1),this.u_grpAllRecerive.visible=!0,this.u_grpAllDel.visible=!0):(this.u_grpTip.visible=!1,this.u_imgCentreLine.visible=!1,this.u_grpNoMail.visible=!0,this.u_gapDescBg.visible=!1,this.u_grpAllDel.visible=!1,this.u_grpAllRecerive.visible=!1),this.m_typeList.source=this.m_listArr},e.prototype.onAllRecerive=function(){this.m_listArr&&this.m_listArr.length>0?MailManager.instance.requestItemMail():PopupModule.instance.showTishi(LanguageJson.getText("l_mail_delete_tips_5"))},e.prototype.onAllDelete=function(){this.m_listArr&&this.m_listArr.length>0?PopupModule.instance.showTishi(LanguageJson.getText("l_mail_delete_tips_2"),this.sureAllDelete.bind(this)):PopupModule.instance.showTishi(LanguageJson.getText("l_mail_popTips_5"))},e.prototype.sureAllDelete=function(){MailManager.instance.requestDeleteMail()},e.prototype.openDetail=function(t,e){if(void 0===t&&(t=null),this.m_vo=t,Dispatch.register(MailManager.MAIL_ITEM_REVEICE,this.checkMailInfo,this),!e)return this.u_gapDescBg.visible=!1,void(this.u_grpTip.visible=!0);if(this.u_gapDescBg.visible=!0,this.u_grpTip.visible=!1,this.setTitle(),this.setMsg(),this.setBtn(),this.m_rewardGroup.scroller.viewport.scrollH=0,this.m_rewardGroup.scaleX=this.m_rewardGroup.scaleY=.54,this.m_vo.prop_list.length>5)this.m_rewardGroup.visualWidth=704,this.m_rewardGroup.x=57;else{this.m_rewardGroup.visualWidth=0;var i=59.2*this.m_vo.prop_list.length+20*(this.m_vo.prop_list.length-1);this.m_rewardGroup.x=(this.u_gapDescBg.width-i)/2}this.m_rewardGroup.setData(this.m_vo.prop_list,this.m_vo.prop_list.length),Dispatch.dispatch(MailManager.MAIL_SELECT_STATE)},e.prototype.onReceive=function(t){1==this.m_typeBtn?PopupModule.instance.showTishi(LanguageJson.getText("l_mail_delete_tips_1"),this.sureDelete.bind(this)):MailManager.instance.requestItemMail(this.m_vo.mail_real_id)},e.prototype.sureDelete=function(){MailManager.instance.requestDeleteMail(this.m_vo.mail_real_id)},e.prototype.checkMailInfo=function(t){RewardModule.instance.receiveByProp(this.m_vo.prop_list,6,2),this.setBtn()},e.prototype.setTitle=function(){var t,e=MailJson.getData(this.m_vo.mail_id);t=2==e.type?this.m_vo.title_name:e.name,this.u_textTitle.textFlow=TextUtil.setTextFlow(t)},e.prototype.setMsg=function(){var t,e=MailJson.getData(this.m_vo.mail_id);t=2==e.type?HtmlUtil.setTextFlow(this.m_vo.content):HtmlUtil.setTextFlow(e.content,this.m_vo.param_list),this.u_textDesc.textFlow=t},e.prototype.setBtn=function(){this.m_typeBtn=1;var t=MailManager.instance.getMailSimple(this.m_vo.mail_real_id);if(t&&1==t.is_attach){if(this.u_imgAttach_Line.visible=!0,2!=t.state)return this.m_typeBtn=2,this.u_textRecerive.text=LanguageJson.getText("l_btn_receive"),void ObjectUtils.setGrey(this.m_rewardGroup,!1);this.u_textRecerive.text=LanguageJson.getText("l_btn_delete"),ObjectUtils.setGrey(this.m_rewardGroup,!0)}else this.u_imgAttach_Line.visible=!1;this.u_textRecerive.text=LanguageJson.getText("l_btn_delete")},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i),this.m_typeList.source=[],this.u_scrollItem.viewport.scrollV=0,MailManager.instance.p_selectID=0,this.u_gapDescBg.visible=!1,Dispatch.remove(MailManager.MAIL_LIST_INIT,this.setData,this),Dispatch.remove(MailManager.MAIL_OPEN_DETAIL,this.openDetail,this),Dispatch.remove(MailManager.MAIL_ITEM_REVEICE,this.checkMailInfo,this)},e}(PopupBase);__reflect(MailPopup.prototype,"MailPopup");var MailRender=function(t){function e(){var e=t.call(this,"resource/eui_skins/mailUI/render/MailRenderSkin.exml")||this;return e.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onClickEvent,e),e}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),Dispatch.register(MailManager.MAIL_SELECT_STATE,this.onSelect,this)},e.prototype.dataChanged=function(){this.checkComplete(this.dataChanged)&&(t.prototype.dataChanged.call(this),this.m_mailVo=this.data,this.onSelect(),this.setVisis())},e.prototype.onClickEvent=function(t){MailManager.instance.requestReadMail(this.m_mailVo.mail_real_id)},e.prototype.onSelect=function(){this.m_mailVo.mail_real_id==MailManager.instance.p_selectID?this.u_imgSelect.visible=!0:this.u_imgSelect.visible=!1},e.prototype.setVisis=function(){0==this.m_mailVo.state?(this.u_textTitle.textColor=15787184,this.u_textTime.textColor=12499627):(this.u_textTitle.textColor=8946817,this.u_textTime.textColor=6709855);var t,e=MailJson.getData(this.m_mailVo.mail_id);t=2==e.type?this.m_mailVo.title_name:e.name,this.u_textTitle.textFlow=TextUtil.setTextFlow(t),this.u_textTime.text=this.m_mailVo.create_time?TimeUtil.getTampTimeByUnix(this.m_mailVo.create_time):"",this.setTagState()},e.prototype.setTagState=function(){return this.u_imgIcon.visible=!0,this.u_imgNew.visible=!1,1!=this.m_mailVo.is_attach&&(this.u_imgIcon.visible=!1),0==this.m_mailVo.state?(this.u_imgNew.visible=!0,void ObjectUtils.setGrey(this.u_imgIcon,!1)):void(2==this.m_mailVo.state&&1==this.m_mailVo.is_attach&&ObjectUtils.setGrey(this.u_imgIcon))},e.prototype.hide=function(){this.checkComplete(this.hide)&&Dispatch.remove(MailManager.MAIL_SELECT_STATE,this.onSelect,this)},e}(ItemRendererBase);__reflect(MailRender.prototype,"MailRender");var MainFightView=function(t){function e(){var e=t.call(this)||this;return e.m_skillList=[],e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/userMainUI/MainFightViewSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.touchEnabled=!1;for(var t=["auto_cost","freeze_cost"],e=0;e<t.length;e++){var i=new SkillMainIcon(e,t[e]);this.m_skillList.push(i),this.addChild(i)}this.m_rangeView||(this.m_rangeView=new RangeView,this.addChild(this.m_rangeView)),this.m_dashView||(this.m_dashView=new DashIconView,this.addChild(this.m_dashView)),this.m_beilvNum||(this.m_beilvNum=new NumberView("num_weapon_",0,-2),this.addChild(this.m_beilvNum),this.m_beilvNum.p_isAnchorOffsetX=!0,this.m_beilvNum.x=this.u_btnAttack.x+.5*this.u_btnAttack.width,this.m_beilvNum.y=this.u_btnAttack.y+this.u_btnAttack.height+10),SceneModule.instance.isSceneWorld&&!this.m_sceneTip&&(this.m_sceneTip=new SceneTip,this.addChild(this.m_sceneTip)),this.addChild(this.u_btnAdd),this.addChild(this.u_btnJian),this.setManaValue()},e.prototype.initEvent=function(){this.registerEventClick(this.u_btnJian,this.onJian,this,!0,SoundEnum.EFFECT_SOUND_1007,this.setAutoBack),this.registerEventClick(this.u_btnAdd,this.onAdd,this,!0,SoundEnum.EFFECT_SOUND_1007,this.setAutoBack),this.registerEventClick(this.u_btnAttack,this.onAttack,this,!0),this.registerEventClick(this.u_btnTask,this.onTask,this,!0),this.registerEventClick(this.u_btnNotice,this.oNotice,this,!0),Dispatch.register(FightSkillManager.EVENT_FIGHT_SET_MANA,this.setManaValue,this),Dispatch.register(GuideConfig.guide_2_1,this.onAdd,this),RedNoticeManager.instance.registerRed(this.u_btnTask,[RedNoticeConfig.RED_CARD_ZHUXIAN,RedNoticeConfig.RED_CARD_YAOZU],[30,-2])},e.prototype.onTask=function(t){UIModule.instance.showUI(UIConfig.ID_TUJIAN)},e.prototype.oNotice=function(t){this.m_bobbleView||(this.m_bobbleView=new BobbleView),this.m_bobbleView.show()},e.prototype.onAttack=function(t){FightAutoAI.instance.attackArrow()},e.prototype.onMonsterInfo=function(t){UIModule.instance.showUI(UIConfig.ID_MONSTER_INFO)},e.prototype.setAutoBack=function(t,e){1==e?this.onSetAuto(t):this.onSetAutoEnd(null)},e.prototype.onJian=function(t){SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_1006),FightSkillManager.instance.currIdx>0&&FightSkillManager.instance.setManaValue(-1)},e.prototype.onAdd=function(t){void 0===t&&(t=null),SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_1006),FightSkillManager.instance.currIdx<FightSkillManager.instance.p_manaList.length-1&&FightSkillManager.instance.setManaValue(1)},e.prototype.onSetAuto=function(t){var e=-1;t.currentTarget==this.u_btnAdd&&(e=1),DelayCallUtils.delayedCall(.3,this.autoAddMana,this,[e])},e.prototype.onSetAutoEnd=function(t){DelayCallUtils.killDelayedCallsTo(this.autoAddMana,this)
},e.prototype.autoAddMana=function(t){1==t&&FightSkillManager.instance.currIdx<FightSkillManager.instance.p_manaList.length-1||-1==t&&FightSkillManager.instance.currIdx>0?(SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_1006),FightSkillManager.instance.setManaValue(t),DelayCallUtils.delayedCall(.2,this.autoAddMana,this,[t])):DelayCallUtils.killDelayedCallsTo(this.autoAddMana,this)},e.prototype.setManaValue=function(){FightSkillManager.instance.p_manaValue>0?this.m_beilvNum.numValue=FightSkillManager.instance.attValueMana:this.m_beilvNum.numValue=0},e.prototype.setManaValueTo=function(){this.m_beilvNum.setNumValue(FightSkillManager.instance.attValueMana,.3)},e.prototype.show=function(){this.checkComplete(this.show)&&(UIModule.instance.downUILayer1.addChild(this),this.m_rangeView&&this.m_rangeView.show(),this.m_dashView&&this.m_dashView.show(),SceneModule.instance.isSceneWorld&&this.m_sceneTip&&this.m_sceneTip.show(),Dispatch.register(StageManager.EVENT_STAGE_RESIZE,this.stageResize,this,!0))},e.prototype.stageResize=function(){this.x=StageManager.instance.p_stageWidth-this.width,this.y=StageManager.instance.p_stageHeight-this.height},e.prototype.hide=function(){this.checkComplete(this.hide)&&(Dispatch.remove(StageManager.EVENT_STAGE_RESIZE,this.stageResize,this),this.m_rangeView&&this.m_rangeView.hide(),this.m_dashView&&this.m_dashView.hide(),this.m_sceneTip&&this.m_sceneTip.hide(),DisplayObjectUtils.removeFormParent(this))},e.prototype.getCdTime=function(t){for(var e in this.m_skillList)if(this.m_skillList[e].skillId==t)return this.m_skillList[e].cdTime;return 0},e.prototype.stopAuto=function(t){for(var e in this.m_skillList)this.m_skillList[e].skillId==t&&this.m_skillList[e].stopAuto()},e.prototype.getPointByFuncId=function(t,e){return void 0===e&&(e=!1),[StageManager.instance.p_stageWidth-20,25]},Object.defineProperty(e.prototype,"width",{get:function(){return StageManager.MIN_STAGE_WIDTH},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return StageManager.MIN_STAGE_HEIGHT},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(MainFightView.prototype,"MainFightView");var MainSceneView=function(t){function e(){var e=t.call(this)||this;return e.m_btnEffect={},e.m_entranceFid=[FunctionEnum.ROLE_ENT,FunctionEnum.BAG_SYS,FunctionEnum.SHOP_SYS,FunctionEnum.SHARE_SYS,FunctionEnum.MAIL_SYS,FunctionEnum.KEFU],e.m_weightKuan=0,e.m_mContentX=0,e.m_disposeUrlList.push("sceneMainUI_json"),e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/userMainUI/MainSceneViewSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvents(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.m_head||(this.m_head=new PersonalHead,this.m_head.x=3,this.m_head.y=8,this.u_grpAvatar.addChildAt(this.m_head,0)),this.m_mContentX=this.u_mcRightInfo.x,this.m_expWeight=this.u_imgExp.width,this.m_selectID=0,this.m_vipView||(this.m_vipView=new NumberView("num_vip_"),this.m_vipView.touchChildren=!1,this.m_vipView.touchEnabled=!1,this.addChild(this.m_vipView),this.m_vipView.x=128,this.m_vipView.y=28),this.addChild(this.u_btnVip),this.stageResize()},e.prototype.initEvents=function(){for(var t=0;t<this.m_entranceFid.length;t++)this.registerEventClick(this["u_btnEntrance"+(t+1)],this.onEntranceClick,this,!0);this.registerEventClick(this.u_btnSet,this.onSetGame,this,!0),this.registerEventClick(this.u_btnScene,this.onSelectScene,this,!0),this.registerEventClick(this.u_btnChooseSix,this.onChooseSix,this,!0),this.registerEventClick(this.u_btnMultiplayer,this.onMultiplayer,this,!0),this.registerEventClick(this.u_btnQuickOpen,this.onQuickOpen,this,!0),this.registerEventClick(this.u_btnVip,this.onOpenVip,this),RedNoticeManager.instance.registerRed(this.u_btnEntrance1,[RedNoticeConfig.RED_HERO],[45,0]),RedNoticeManager.instance.registerRed(this.u_btnEntrance4,[RedNoticeConfig.RED_PROMOTE,RedNoticeConfig.RED_SHARE],[45,0]),RedNoticeManager.instance.registerRed(this.u_grpIcon5,[RedNoticeConfig.RED_MAIL_INFO],[45,0])},e.prototype.stageResize=function(){if(this.m_weightKuan!=StageManager.instance.p_stageWidth){this.m_weightKuan=StageManager.instance.p_stageWidth,this.x=0,this.y=.5*(StageManager.instance.p_stageHeight-this.height),this.u_imgBg.x=.5*-(StageManager.MAX_STAGE_HEIGHT-StageManager.instance.p_stageWidth),this.u_mcRightInfo.x=this.m_mContentX+StageManager.instance.p_stageWidth-StageManager.MIN_STAGE_WIDTH,this.u_imgBottom.width=StageManager.instance.p_stageWidth,this.u_grpBottom.width=StageManager.instance.p_stageWidth;for(var t=0;t<this.m_entranceFid.length;t++){var e=this["u_btnEntrance"+(t+1)];e.x=t*(StageManager.instance.p_stageWidth/this.m_entranceFid.length),e.width=StageManager.instance.p_stageWidth/this.m_entranceFid.length;var i=this["u_grpIcon"+(t+1)];i.x=e.width/2-i.width/2;var s=this["u_imgLine"+(t+1)];s&&(s.x=e.x+e.width),this.u_imgLight.width=e.width,this.removeEventClick(this["u_btnEntrance"+(t+1)]),this.registerEventClick(this["u_btnEntrance"+(t+1)],this.onEntranceClick,this,!0)}this["u_btnEntrance"+this.m_selectID]&&this.setBtnSelect(this["u_btnEntrance"+this.m_selectID]),this.m_dragon&&(this.m_dragon.x=450+.5*(StageManager.instance.p_stageWidth-StageManager.MIN_STAGE_WIDTH))}},e.prototype.onSetGame=function(t){PopupModule.instance.showPop(PopupConfig.ID_SETTING)},e.prototype.onEntranceClick=function(t){var e=Number(String(t.currentTarget.name).slice(13)),i=this.m_entranceFid[e-1];if(this.m_selectID=e,this.setBtnSelect(t.currentTarget),FunctionManager.instance.getOpenFuncId(i,!0))switch(i){case FunctionEnum.ROLE_ENT:UIModule.instance.showUI(UIConfig.ID_ROLE);break;case FunctionEnum.BAG_SYS:UIModule.instance.showUI(UIConfig.ID_BAG);break;case FunctionEnum.SHOP_SYS:UIModule.instance.showUI(UIConfig.ID_CHARGE,{c_type:ShopHallEnum.TYPE_BUYPROP});break;case FunctionEnum.SHARE_SYS:UIModule.instance.showUI(UIConfig.ID_SHARE);break;case FunctionEnum.MAIL_SYS:PopupModule.instance.showPop(PopupConfig.ID_MAIL);break;case FunctionEnum.KEFU:PlayerManager.instance.gotoKefu()}},e.prototype.onSelectScene=function(t){UIModule.instance.showUI(UIConfig.ID_SCENE_SELECT)},e.prototype.onChooseSix=function(t){GuessManager.instance.s_mission_lucky_boss_status(1)},e.prototype.onMultiplayer=function(t){},e.prototype.onQuickOpen=function(t){var e=SceneModule.instance.getRecommendScene(!1);SceneManager.instance.s_scene_enter_scene_tos(e.id)},e.prototype.onOpenVip=function(t){UIModule.instance.showUI(UIConfig.ID_VIP)},e.prototype.initPlayerInfo=function(){var t=PlayerManager.instance.p_playerInfo;null!=t&&(this.u_imgSex.source="commonUI_json.commonUI_sex_"+t.sex,this.m_head.showView(t.player_other_data,t.player_id,t.level),this.setExp(),this.setVip(),this.setName())},e.prototype.setBtnSelect=function(t){this.u_imgLight.visible=!0,this.u_imgLight.x=t.x,this.u_imgLight.y=t.y},e.prototype.setExp=function(){var t=PlayerManager.instance.p_playerInfo,e=RoleExperienceJson.getData(t.level).experience;t.exp>e?this.u_imgExp.width=this.m_expWeight:this.u_imgExp.width=t.exp/e*this.m_expWeight},e.prototype.setVip=function(){PlayerManager.instance.p_playerInfo},e.prototype.setName=function(){var t=PlayerManager.instance.p_playerInfo;this.u_txtName.text=t.nickname},e.prototype.getPointByFuncId=function(t,e){if(void 0===e&&(e=!1),this.parent&&this.m_entranceFid&&this.m_entranceFid.indexOf(t)>-1){var i=this.m_entranceFid.indexOf(t),s=this["u_btnEntrance"+(i+1)];if(s&&s.parent){if(e){var n=s.parent.localToGlobal(s.x+.5*s.width,s.y+.5*s.height);return[n.x,n.y]}var o=s.parent.localToGlobal(s.x,s.y);return[o.x,o.y]}}return[StageManager.instance.p_stageWidth-20,25]},e.prototype.show=function(){this.checkComplete(this.show)&&(UIModule.instance.downUILayer1.addChild(this),this.recoverAllTexture(this),this.u_imgBg.source=null,this.u_imgBg.source=SceneMainModule.p_mainBjUrl,this.m_dragon||(this.m_dragon=new DragonMovieClip,this.addChildAt(this.m_dragon,1),this.m_dragon.y=630,this.m_dragon.setMC(PublicCon.PATH_SCENE_MAIN+"scene_main","scene_main")),this.m_dragon.play(),this.m_dragon.x=450+.5*(StageManager.instance.p_stageWidth-StageManager.MIN_STAGE_WIDTH),Dispatch.register(StageManager.EVENT_STAGE_RESIZE,this.stageResize,this,!0),Dispatch.register(ChatManager.EVENT_CHAT_UPDATE,this.setMainScrollView,this,!0),Dispatch.register(ChatManager.EVENT_CHAT_FAKE_UPDATE,this.setMainScrollView,this),Dispatch.register(PlayerManager.EVENT_PLAYER_INIT,this.initPlayerInfo,this,!0),Dispatch.register(PlayerManager.EVENT_PLAYER_INFO+proto.Attr.exp,this.setExp,this),Dispatch.register(PlayerManager.EVENT_PLAYER_INFO+proto.Attr.vip_level,this.setVip,this),Dispatch.register(PlayerManager.EVENT_PLAYER_INFO+proto.Attr.name,this.setName,this))},e.prototype.setMainScrollView=function(){var t=ChatManager.instance.getMainScrollData();return!t||t&&0==t.length||GameManager.instance.isShield?(this.u_imgScrollBg.visible=!1,void(this.m_scrollObtainBox&&(this.m_scrollObtainBox.stopMove(),DisplayObjectUtils.removeFormParent(this.m_scrollObtainBox)))):(this.u_imgScrollBg.visible=!0,this.m_scrollObtainBox||(this.m_scrollObtainBox=new ScrollObtainBox(600,75),this.m_scrollObtainBox.x=10,this.m_scrollObtainBox.y=490),this.addChild(this.m_scrollObtainBox),void this.setScrollViewInfo())},e.prototype.setScrollViewInfo=function(){var t=ChatManager.instance.getMainScrollData(),e=ChatManager.instance.p_scrollNum;if(t.length<e)for(var i=t.length;e>i;i++)t.push(null);this.m_scrollObtainBox.setDataList(t,this.getMsgText.bind(this))},e.prototype.getMsgText=function(t){if(void 0===t&&(t=null),t){var e=NoticeJson.getData(t.template_id),i=HtmlUtil.setText(e.main_content,t.arsg_list);return i}return" "},e.prototype.hide=function(){this.checkComplete(this.hide)&&(this.m_dragon&&(this.m_dragon.destory(),this.m_dragon=null),this.m_selectID=0,this.u_imgLight.visible=!1,this.m_scrollObtainBox&&(this.m_scrollObtainBox.stopMove(),DisplayObjectUtils.removeFormParent(this.m_scrollObtainBox)),this.disposeAllTexture(),DisplayObjectUtils.removeFormParent(this),Dispatch.remove(StageManager.EVENT_STAGE_RESIZE,this.stageResize,this),Dispatch.remove(ChatManager.EVENT_CHAT_UPDATE,this.setMainScrollView,this),Dispatch.remove(ChatManager.EVENT_CHAT_FAKE_UPDATE,this.setMainScrollView,this),Dispatch.remove(PlayerManager.EVENT_PLAYER_INIT,this.initPlayerInfo,this),Dispatch.remove(PlayerManager.EVENT_PLAYER_INFO+proto.Attr.exp,this.setExp,this),Dispatch.remove(PlayerManager.EVENT_PLAYER_INFO+proto.Attr.vip_level,this.setVip,this),Dispatch.remove(PlayerManager.EVENT_PLAYER_INFO+proto.Attr.name,this.setName,this))},Object.defineProperty(e.prototype,"width",{get:function(){return StageManager.MIN_STAGE_WIDTH},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return StageManager.MIN_STAGE_HEIGHT},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(MainSceneView.prototype,"MainSceneView");var BobbleItemRender=function(t){function e(){return t.call(this,"resource/eui_skins/userMainUI/render/BubbleItemRenderSkin.exml")||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSendMsg,this),this.touchChildren=!1,this.touchEnabled=!0},e.prototype.dataChanged=function(){if(this.checkComplete(this.dataChanged)){t.prototype.dataChanged.call(this);var e=this.data;this.u_txtContext.text=e.text+""}},e.prototype.onSendMsg=function(){var t=this.data;SceneManager.instance.s_scene_send_msg_tos(0,t.id),Dispatch.dispatch(e.EVENT_SEND_MSG)},e.EVENT_SEND_MSG="EVENT_SEND_MSG",e}(ItemRendererBase);__reflect(BobbleItemRender.prototype,"BobbleItemRender");var BobbleView=function(t){function e(){var e=t.call(this)||this;return e.m_faceLayout=new eui.TileLayout,e.m_faceTypeList=new eui.ArrayCollection,e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/userMainUI/view/BubbleViewSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvents(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.u_txtTitle.text=LanguageJson.getText("l_fight_msg_title"),this.alpha=0,this.x=StageManager.instance.p_stageWidth,this.y=0,this.u_imgChatStatus.visible=!0,this.u_imgFaceStatus.visible=!1,this.u_faceScrollerItem.horizontalScrollBar=null,this.u_faceScrollerItem.verticalScrollBar=null,this.m_faceLayout.requestedColumnCount=3,this.m_faceLayout.paddingTop=12.5,this.m_faceLayout.paddingLeft=12.5,this.m_faceLayout.paddingBottom=12.5,this.m_faceLayout.paddingRight=12.5,this.m_faceLayout.horizontalGap=5,this.m_faceLayout.verticalGap=5,this.u_faceScrollerItem.visible=!1,this.u_faceListItem.itemRenderer=StickerItemRender,this.u_faceListItem.layout=this.m_faceLayout,this.u_faceListItem.dataProvider=this.m_faceTypeList,this.u_chatListItem.itemRenderer=BobbleItemRender;var t=BubbleJson.jsonData,e=[];for(var i in t)e.push(t[i]);ListUtils.refreshList(this.u_chatListItem,e)},e.prototype.initEvents=function(){this.registerEventClick(this.u_btnClose,this.hide,this,!0),this.registerEventClick(this.u_btnChat,this.onChat,this,!0),this.registerEventClick(this.u_btnFace,this.onFace,this,!0)},e.prototype.show=function(){var t=ItemJson.getListByType(ItemTypeEnum.STICKER);if(t){var e=[],i=[];for(var s in t){var n=t[s];BagManager.instance.getNum(n.id)>0?e.push(n):i.push(n)}ArrayUtils.setSortArr(e,["order","id"],[1,0]),ArrayUtils.setSortArr(i,["order","id"],[1,0]);var o=e.concat(i);this.m_faceTypeList.source=o}this.m_maskImg||(this.m_maskImg=new eui.Image("commonUI_box"),this.m_maskImg.scale9Grid=UIModule.instance.getRectangle(),this.m_maskImg.width=StageManager.instance.p_stageWidth,this.m_maskImg.height=StageManager.instance.p_stageHeight),this.m_maskImg.alpha=0,UIModule.instance.downUILayer3.addChild(this.m_maskImg),TweenLite.killTweensOf(this.m_maskImg),TweenLite.to(this.m_maskImg,.3,{alpha:.3}),this.alpha=0,this.x=StageManager.instance.p_stageWidth,UIModule.instance.downUILayer3.addChild(this),TweenLite.killTweensOf(this),TweenLite.to(this,.3,{x:StageManager.instance.p_stageWidth-this.width,alpha:1,onComplete:this.addEvent.bind(this)})},e.prototype.hide=function(){TweenLite.killTweensOf(this.m_maskImg),TweenLite.to(this.m_maskImg,.3,{alpha:0}),TweenLite.killTweensOf(this),TweenLite.to(this,.3,{x:StageManager.instance.p_stageWidth,alpha:0,onComplete:this.removeEvent.bind(this)})},e.prototype.onChat=function(){this.u_chatScrollerItem.visible=!0,this.u_faceScrollerItem.visible=!1,this.u_imgChatStatus.visible=!0,this.u_imgFaceStatus.visible=!1},e.prototype.onFace=function(){this.u_chatScrollerItem.visible=!1,this.u_faceScrollerItem.visible=!0,this.u_imgChatStatus.visible=!1,this.u_imgFaceStatus.visible=!0},e.prototype.removeEvent=function(){DisplayObjectUtils.removeFormParent(this.m_maskImg),DisplayObjectUtils.removeFormParent(this),Dispatch.remove(BobbleItemRender.EVENT_SEND_MSG,this.hide,this),Dispatch.remove(StageManager.EVENT_STAGE_RESIZE,this.stageResize,this),StageManager.instance.p_stage.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onStageTouch,this)},e.prototype.addEvent=function(){Dispatch.register(BobbleItemRender.EVENT_SEND_MSG,this.hide,this),Dispatch.register(StageManager.EVENT_STAGE_RESIZE,this.stageResize,this),StageManager.instance.p_stage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onStageTouch,this)},e.prototype.stageResize=function(){this.x=StageManager.instance.p_stageWidth-this.width,this.m_maskImg&&(this.m_maskImg.width=StageManager.instance.p_stageWidth)},e.prototype.onStageTouch=function(t){t.stageX>=StageManager.instance.p_stageWidth-this.width||PopupModule.instance.isHavPopupStage()||this.hide()},e}(ComponentBase);__reflect(BobbleView.prototype,"BobbleView");var StickerItemRender=function(t){function e(){return t.call(this,"resource/eui_skins/userMainUI/render/StickerItemRenderSkin.exml")||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSendMsg,this),this.touchChildren=!1,this.touchEnabled=!0},e.prototype.dataChanged=function(){if(this.checkComplete(this.dataChanged)){t.prototype.dataChanged.call(this);var e=this.data;if(e){if(BagManager.instance.getNum(e.id)>0)this.u_imgSticker.alpha=1,this.u_imgLock.visible=!1,this.u_txtOutput.visible=!1;else{this.u_imgSticker.alpha=.4,this.u_imgLock.visible=!0,this.u_txtOutput.visible=!0;var i=[];if(e.output_list)for(var s=0;s<e.output_list.length;s++){var n=FunctionConfigJson.getData(e.output_list[s]);n&&i.push(n.item_access)}this.u_txtOutput.text=i[0]}this.u_imgSticker.source=ItemJson.getIconPath(e.id)}}},e.prototype.onSendMsg=function(){var t=this.data;if(BagManager.instance.getNum(t.id)>0){var e=GeXingHuaJson.getJsonWithItemId(t.id);e&&(SceneManager.instance.s_scene_send_msg_tos(1,e.id),Dispatch.dispatch(BobbleItemRender.EVENT_SEND_MSG))}else PopupModule.instance.showTishiSingle(LanguageJson.getText("l_gexinghua_tipe1"))},e.EVENT_SEND_MSG="EVENT_SEND_MSG",e}(ItemRendererBase);__reflect(StickerItemRender.prototype,"StickerItemRender");var DashIconView=function(t){function e(){var e=t.call(this)||this;return e.m_powercd=3e3,e.m_usecd=0,e.m_maxPower=3,e.m_currPower=2,e.m_powerCdStartTime=0,e.m_useCdStartTime=0,e.m_rNum=32.5,e.m_rNumFlg=12.5,e.m_powerShape=new egret.Shape,e.m_cdShape=new egret.Shape,e.m_isCdOver=!0,e.m_downPoint=new egret.Point,e.m_movePoint=new egret.Point,e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/userMainUI/view/DashIconViewSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvents(),t.prototype.onCompleted.call(this)},e.prototype.initData=function(){this.m_powercd=Number(StaticDataJson.getData("skill_dash_charge_time").data),this.m_maxPower=Number(StaticDataJson.getData("skill_dash_times").data),this.m_usecd=Number(StaticDataJson.getData("skill_dash_charge_cd_time").data),this.m_currPower=this.m_maxPower},e.prototype.initEvents=function(){Dispatch.register(FightSkillManager.EVENT_ACTIVE_SKILL_USE+"1",this.useSkillSuccess,this)},e.prototype.initView=function(){this.x=870,this.y=300,this.addChild(this.m_powerShape),this.addChild(this.m_cdShape),this.addChild(this.u_txtCd),this.addChild(this.u_jiantou),this.u_jiantou.visible=!1},e.prototype.show=function(){this.initData(),this.refreshPower(),this.u_txtCd.visible=!1,TimeManager.instance.doLoop(this.timeDo,this,50),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this)},e.prototype.onTouchBegin=function(t){this.m_downPoint.x=t.stageX,this.m_downPoint.y=t.stageY,StageManager.instance.p_stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),StageManager.instance.p_stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this)},e.prototype.onTouchMove=function(t){var e=this.m_movePoint,i=this.m_downPoint;e.x=t.stageX,e.y=t.stageY,(this.u_jiantou.visible||egret.Point.distance(e,i)>50)&&(this.u_jiantou.visible=!0,this.u_jiantou.rotation=180*Math.atan2(e.y-i.y,e.x-i.x)/Math.PI+90,FightModule.instance.p_mainFighter.showDashJiantou(this.u_jiantou.rotation))},e.prototype.onTouchEnd=function(t){if(StageManager.instance.p_stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),StageManager.instance.p_stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this.u_jiantou.visible)this.useSkill(this.u_jiantou.rotation-90>>0),this.u_jiantou.visible=!1,FightModule.instance.p_mainFighter.hideDashJiantou();else{var e=FightModule.instance.p_mainFighter.curDirection,i=DirectionUtil.getRotationByDirection(e);this.useSkill(i)}},e.prototype.hide=function(){this.u_txtCd.visible=!1,TimeManager.instance.clearTimer(this.timeDo,this),this.m_powerShape.graphics.clear(),this.m_cdShape.graphics.clear(),this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),StageManager.instance.p_stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),StageManager.instance.p_stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this)},e.prototype.refreshPower=function(){for(var t=0;4>t;t++)this["u_power"+t].visible=t<this.m_currPower},e.prototype.useSkill=function(t){this.m_useCdStartTime>0||this.m_currPower<1||(0>=t&&(t=360+t),FightSkillManager.instance.s_skill_use_skill_tos(1,t))},e.prototype.useSkillSuccess=function(t){t.active_skill&&(this.m_currPower=t.active_skill.times,0==this.m_powerCdStartTime&&(this.m_powerCdStartTime=egret.getTimer()),this.m_usecd>0&&(this.m_useCdStartTime=egret.getTimer()),this.refreshPower())},e.prototype.timeDo=function(){if(this.m_powerCdStartTime>0){var t=(egret.getTimer()-this.m_powerCdStartTime)/this.m_powercd*360-90;this.refreshShape(this.m_powerShape,t);var e=Math.ceil(.001*(this.m_powercd-(egret.getTimer()-this.m_powerCdStartTime)));0>=e&&(e=0,this.m_currPower++,this.m_currPower>=this.m_maxPower?(this.m_powerCdStartTime=0,this.m_powerShape.graphics.clear()):this.m_powerCdStartTime=egret.getTimer(),this.refreshPower())}if(!(this.m_usecd<=0)&&this.m_useCdStartTime>0){var t=(egret.getTimer()-this.m_useCdStartTime)/this.m_usecd*360-90;this.refreshShape(this.m_cdShape,t,.7);var e=Math.ceil(.001*(this.m_usecd-(egret.getTimer()-this.m_useCdStartTime)));0>=e?(e=0,this.m_useCdStartTime=0,this.u_txtCd.visible=!1,this.m_cdShape.graphics.clear()):(this.u_txtCd.visible=!0,this.u_txtCd.text=e+"")}},e.prototype.refreshShape=function(t,e,i){void 0===i&&(i=.4),t.graphics.clear(),t.graphics.beginFill(0,i),t.graphics.moveTo(this.m_rNum+this.m_rNumFlg,this.m_rNum+this.m_rNumFlg),t.graphics.lineTo(this.m_rNum+this.m_rNumFlg,this.m_rNumFlg),t.graphics.drawArc(this.m_rNum+this.m_rNumFlg,this.m_rNum+this.m_rNumFlg,this.m_rNum,270*Math.PI/180,e*Math.PI/180,!0),t.graphics.lineTo(this.m_rNum+this.m_rNumFlg,this.m_rNum+this.m_rNumFlg),t.graphics.endFill()},e}(ComponentBase);__reflect(DashIconView.prototype,"DashIconView");var RangeView=function(t){function e(){var e=t.call(this)||this;return e.m_spBj=new eui.Group,e.m_rNum=45,e.m_rNumFlg=0,e.m_angle=0,e.m_rageMax=-1,e.m_shape=new egret.Shape,e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/userMainUI/view/RangeViewSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvents(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.x=962,this.y=323,this.addChild(this.m_spBj),this.m_spBj.addChild(this.m_shape),this.u_imgMenk.mask=this.m_spBj,this.m_rageMax=1e4},e.prototype.initEvents=function(){this.u_btnClick.addEventListener(egret.TouchEvent.TOUCH_END,this.onRage,this),Dispatch.register(GuideConfig.guide_4_2,this.onRage,this)},e.prototype.onRage=function(t){void 0===t&&(t=null),SceneModule.instance.isMissionScene||SceneModule.instance.isMainScene||PlayerManager.instance.p_anger<this.m_rageMax||FightSkillManager.instance.getIsAttackTimes(!0)&&PopupModule.instance.showTishi("怒气大招还未完成")},e.prototype.show=function(){this.checkComplete(this.show)&&Dispatch.register(PlayerManager.EVENT_ANGER_SET,this.setRageValue,this,!0)},e.prototype.hide=function(){Dispatch.remove(PlayerManager.EVENT_ANGER_SET,this.setRageValue,this)},e.prototype.setRageValue=function(){PlayerManager.instance.p_anger<=0?this.clearSp():PlayerManager.instance.p_anger>=this.m_rageMax?(this.u_imgMenk.mask=null,DisplayObjectUtils.removeFormParent(this.m_shape),this.m_rageEffect||(this.m_rageEffect=new EffectMovieClip,this.m_rageEffect.touchChildren=!1,this.m_rageEffect.touchEnabled=!1,this.m_rageEffect.blendMode=egret.BlendMode.ADD,this.m_rageEffect.setMC(PublicCon.PATH_EFFECT_PLAYER+"rage"),this.m_rageEffect.x=.5*this.width,this.m_rageEffect.y=.5*this.height),this.m_rageEffect&&null==this.m_rageEffect.parent&&(this.m_rageEffect.play(),this.addChild(this.m_rageEffect))):(this.clearSp(),this.m_angle=360*(100-PlayerManager.instance.p_anger/this.m_rageMax)+90,this.m_shape.graphics.clear(),this.m_shape.graphics.beginFill(0,.7),this.m_shape.graphics.moveTo(this.m_rNum+this.m_rNumFlg,this.m_rNum+this.m_rNumFlg),this.m_shape.graphics.lineTo(this.m_rNum+this.m_rNumFlg,this.m_rNumFlg),this.m_shape.graphics.drawArc(this.m_rNum+this.m_rNumFlg,this.m_rNum+this.m_rNumFlg,this.m_rNum,90*Math.PI/180,this.m_angle*Math.PI/180,!0),this.m_shape.graphics.lineTo(this.m_rNum+this.m_rNumFlg,this.m_rNum+this.m_rNumFlg),this.m_shape.graphics.endFill())},e.prototype.clearSp=function(){null==this.m_shape.parent&&(this.u_imgMenk.mask=this.m_spBj,this.m_spBj.addChild(this.m_shape)),this.m_rageEffect&&this.m_rageEffect.parent&&(this.m_rageEffect.stop(),DisplayObjectUtils.removeFormParent(this.m_rageEffect))},e.prototype.setValueFlg=function(){this.setRageValue()},Object.defineProperty(e.prototype,"width",{get:function(){return 90},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 90},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(RangeView.prototype,"RangeView");var SkillMainIcon=function(t){function e(e,i){var s=t.call(this)||this;s.m_shape=new egret.Shape,s.m_angle=0,s.m_rNum=31,s.m_rNumFlg=12,s.m_cdTime=-1,s.m_autoBool=!1,s.m_binClick=!1;var n=StaticDataJson.parseStrToList(i);return s.m_itemId=n[0],s.m_itemNum=n[1],0==e?(FightSkillManager.type_auto=s.m_itemId,s.x=825,s.y=487):1==e&&(FightSkillManager.type_freeze=s.m_itemId,s.x=852,s.y=380),s.once(egret.Event.COMPLETE,s.onCompleted,s),s.skinName="resource/eui_skins/userMainUI/view/SkillMainIconSkin.exml",s}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.touchEnabled=!1,this.u_txtCd.text="",this.addChild(this.m_shape),this.u_imgIcon.source="userMainUI_json.userMainUI_d_skill_"+this.skillId,this.m_autoEffect||(this.m_autoEffect=new EffectMovieClip,this.m_autoEffect.x=this.width/2,this.m_autoEffect.y=this.height/2,this.addChild(this.m_autoEffect),this.m_autoEffect.setMC("resource/assets/uiEffect/mainSkill/mainSkill"),this.m_autoEffect.blendMode=egret.BlendMode.ADD),this.addChild(this.u_btnClick),this.addChild(this.u_txtCd),this.addChild(this.u_mcCount),this.addChild(this.u_btnClick)},e.prototype.initEvent=function(){this.u_btnClick.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.u_btnClick.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onSetAuto,this),this.u_btnClick.addEventListener(egret.TouchEvent.TOUCH_END,this.onSetAutoEnd,this),Dispatch.register(FightSkillManager.EVENT_FIGHT_SKILL_USE+this.skillId,this.startSkill,this),Dispatch.register(FightSkillManager.EVENT_FIGHT_SKILL_STOP+this.skillId,this.resetSlill,this),Dispatch.register(PlayerManager.EVENT_PLAYER_INIT,this.setDataViews,this,!0),Dispatch.register(BagManager.EVENT_BAG_UPGRADE,this.setDataView,this),Dispatch.register(SceneManager.EVENT_INIT_SCENE,this.resetSlill,this),Dispatch.register(GuideConfig.guide_3_1,this.onGuidePlay,this)},e.prototype.onGuidePlay=function(t){t&&t.c_skill_item_id==this.skillId&&this.onClick(null)},e.prototype.onSetAuto=function(t){SceneModule.instance.isMainScene||MissionManager.instance.missionType!=MissionTypeEnum.GUESS_BOSS&&(this.m_binClick=!1,DelayCallUtils.delayedCall(.3,this.autoPlayNext,this))},e.prototype.onSetAutoEnd=function(t){DelayCallUtils.killDelayedCallsTo(this.autoPlayNext,this)},e.prototype.autoPlayNext=function(){if(this.m_binClick=!0,this.m_autoBool)this.stopAuto();else{if(!BagManager.instance.isEnoughProp([this.itemId,this.m_itemNum]))return;if(!FightSkillManager.instance.getIsAttackTimes(!1))return;this.m_autoBool=!0,this.m_autoEffect.play(),this.m_cdTime<=0&&FightSkillManager.instance.useSkillFight(this.skillId)}},e.prototype.onClick=function(t){return this.m_cdTime>0?(!this.m_binClick&&this.m_autoBool&&this.stopAuto(),void(this.m_lastTime>0&&this.m_itemId==FightSkillManager.type_auto&&!FightAutoAI.instance.p_isAutoFight&&FightAutoAI.instance.startAutoFight())):void(SceneModule.instance.isMainScene||MissionManager.instance.missionType!=MissionTypeEnum.GUESS_BOSS&&BagManager.instance.isEnoughProp([this.itemId,this.m_itemNum])&&FightSkillManager.instance.getIsAttackTimes(!0)&&FightSkillManager.instance.useSkillFight(this.skillId))},e.prototype.stopAuto=function(){this.m_autoBool=!1,this.m_autoEffect&&this.m_autoEffect.stop()},e.prototype.startSkill=function(){if(!(this.m_cdTime>0)){var t=0;this.skillId==FightSkillManager.type_auto?(t=Number(StaticDataJson.getData("auto_time").data)/1e3,this.m_cdTime=Number(StaticDataJson.getData("auto_time_cd").data)/1e3,FightAutoAI.instance.startAutoFight()):this.skillId==FightSkillManager.type_freeze&&(t=Number(StaticDataJson.getData("freeze_parameter").data)/1e3,this.m_cdTime=Number(StaticDataJson.getData("freeze_time_cd").data)/1e3),ObjectUtils.setGrey(this.u_imgIcon),this.m_startTime=egret.getTimer(),TimeManager.instance.doLoop(this.timeDo,this,30),DelayCallUtils.killDelayedCallsTo(this.skillOverTime,this),DelayCallUtils.delayedCall(t-.05,this.skillOverTime,this)}},e.prototype.timeDo=function(){this.m_angle=.001*(egret.getTimer()-this.m_startTime)/this.m_cdTime*360-90;var t=Math.ceil(this.m_cdTime-.001*(egret.getTimer()-this.m_startTime));if(0>t&&(t=0),this.m_shape.graphics.clear(),this.m_shape.graphics.beginFill(0,.7),this.m_shape.graphics.moveTo(this.m_rNum+this.m_rNumFlg,this.m_rNum+this.m_rNumFlg),this.m_shape.graphics.lineTo(this.m_rNum+this.m_rNumFlg,this.m_rNumFlg),this.m_shape.graphics.drawArc(this.m_rNum+this.m_rNumFlg,this.m_rNum+this.m_rNumFlg,this.m_rNum,270*Math.PI/180,this.m_angle*Math.PI/180,!0),this.m_shape.graphics.lineTo(this.m_rNum+this.m_rNumFlg,this.m_rNum+this.m_rNumFlg),this.m_shape.graphics.endFill(),this.m_lastTime!=t&&(this.m_lastTime=t,this.u_txtCd.text=this.m_lastTime+""),0==this.m_lastTime&&(this.cdTimeOut(),this.m_autoBool)){if(!BagManager.instance.isEnoughProp([this.itemId,this.m_itemNum]))return void this.stopAuto();if(!FightSkillManager.instance.getIsAttackTimes(!1))return void this.stopAuto();FightSkillManager.instance.useSkillFight(this.skillId)}},e.prototype.skillOverTime=function(){this.skillId==FightSkillManager.type_auto?this.m_autoBool||FightAutoAI.instance.stopAutoFight():this.skillId==FightSkillManager.type_freeze},e.prototype.cdTimeOut=function(){this.m_cdTime=0,this.u_txtCd.text="",ObjectUtils.setGrey(this.u_imgIcon,!1),this.m_shape.graphics.clear(),DelayCallUtils.killDelayedCallsTo(this.skillOverTime,this),DelayCallUtils.killDelayedCallsTo(this.autoPlayNext,this),TimeManager.instance.clearTimer(this.timeDo,this)},e.prototype.resetSlill=function(){this.m_cdTime>0&&this.skillOverTime(),this.cdTimeOut(),this.stopAuto(),this.setDataViews()},e.prototype.setDataViews=function(){this.u_txtCount.text=""+BagManager.instance.getNum(this.itemId),this.u_imgCount.width=this.u_txtCount.textWidth+22,this.u_imgCount.width<=33&&(this.u_imgCount.width=33)},e.prototype.setDataView=function(t){this.itemId==t&&this.setDataViews()},Object.defineProperty(e.prototype,"width",{get:function(){return 87},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 87},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"skillId",{get:function(){return this.m_itemId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemId",{get:function(){return this.m_itemId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cdTime",{get:function(){return this.m_cdTime},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(SkillMainIcon.prototype,"SkillMainIcon");var MenuView=function(t){function e(){var e=t.call(this)||this;return e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/userMainUI/view/MenuViewSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvents(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.u_txtTitle.text=LanguageJson.getText("l_fight_menu_title"),this.alpha=0,this.x=StageManager.instance.p_stageWidth,this.y=0
},e.prototype.initEvents=function(){this.registerEventClick(this.u_btnClose,this.hide,this,!0),this.registerEventClick(this.u_btnHero,this.showHero,this,!0),this.registerEventClick(this.u_btnBag,this.showBag,this,!0),this.registerEventClick(this.u_btnShop,this.showShop,this,!0),this.registerEventClick(this.u_btnShare,this.showShare,this,!0),this.registerEventClick(this.u_btnMail,this.showMail,this,!0),this.registerEventClick(this.u_btnContact,this.showKefu,this,!0),this.registerEventClick(this.u_btnExit,this.goBackMain,this,!0)},e.prototype.show=function(){this.m_maskImg||(this.m_maskImg=new eui.Image("commonUI_box"),this.m_maskImg.scale9Grid=UIModule.instance.getRectangle(),this.m_maskImg.width=StageManager.instance.p_stageWidth,this.m_maskImg.height=StageManager.instance.p_stageHeight),this.m_maskImg.alpha=0,UIModule.instance.middleUILayer.addChild(this.m_maskImg),TweenLite.killTweensOf(this.m_maskImg),TweenLite.to(this.m_maskImg,.3,{alpha:.3}),this.alpha=0,this.x=StageManager.instance.p_stageWidth,UIModule.instance.middleUILayer.addChild(this),TweenLite.killTweensOf(this),TweenLite.to(this,.3,{x:StageManager.instance.p_stageWidth-this.width,alpha:1,onComplete:this.addEvent.bind(this)})},e.prototype.hide=function(){TweenLite.killTweensOf(this.m_maskImg),TweenLite.to(this.m_maskImg,.3,{alpha:0}),TweenLite.killTweensOf(this),TweenLite.to(this,.3,{x:StageManager.instance.p_stageWidth,alpha:0,onComplete:this.removeEvent.bind(this)})},e.prototype.removeEvent=function(){DisplayObjectUtils.removeFormParent(this.m_maskImg),DisplayObjectUtils.removeFormParent(this),Dispatch.remove(StageManager.EVENT_STAGE_RESIZE,this.stageResize,this),StageManager.instance.p_stage.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onStageTouch,this)},e.prototype.addEvent=function(){Dispatch.register(StageManager.EVENT_STAGE_RESIZE,this.stageResize,this),StageManager.instance.p_stage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onStageTouch,this)},e.prototype.stageResize=function(){this.x=StageManager.instance.p_stageWidth-this.width,this.m_maskImg&&(this.m_maskImg.width=StageManager.instance.p_stageWidth)},e.prototype.onStageTouch=function(t){t.stageX>=StageManager.instance.p_stageWidth-this.width||this.hide()},e.prototype.showHero=function(){UIModule.instance.showUI(UIConfig.ID_ROLE),this.hide()},e.prototype.showBag=function(){UIModule.instance.showUI(UIConfig.ID_BAG),this.hide()},e.prototype.showShop=function(){UIModule.instance.showUI(UIConfig.ID_CHARGE,{c_type:ShopHallEnum.TYPE_BUYPROP}),this.hide()},e.prototype.showShare=function(){UIModule.instance.showUI(UIConfig.ID_SHARE),this.hide()},e.prototype.showMail=function(){PopupModule.instance.showPop(PopupConfig.ID_MAIL),this.hide()},e.prototype.showKefu=function(){PlayerManager.instance.gotoKefu(),this.hide()},e.prototype.goBackMain=function(){var t=LanguageJson.getText("l_btn_yes"),e=LanguageJson.getText("l_btn_no");if(SceneModule.instance.isMainScene)PopupModule.instance.showTishiPrompt(PopupMsgEnum.PUP_GO_LAST_SCENE,this.backMainScene.bind(this),null,null,t,e);else if(SceneModule.instance.isMissionScene){var i=LanguageJson.getText("l_btn_no"),s=LanguageJson.getText("l_btn_yes"),n=LanguageJson.getText("l_missiom_leave");PopupModule.instance.showTishi(n,this.leaveMission.bind(this),null,s,i)}else PopupModule.instance.showTishiPrompt(PopupMsgEnum.PUP_BACK_MAINSCENE,this.backMainScene.bind(this),null,null,t,e);this.hide()},e.prototype.backMainScene=function(){if(SceneManager.instance.p_sceneId==SceneModule.instance.mainSceneId){var t=Number(PlayerManager.instance.getSetingMsg(GameSetConfig.k_last_scene));if(""==SceneModule.instance.isGotoScene(t))SceneManager.instance.s_scene_enter_scene_tos(t);else{var e=SceneModule.instance.getRecommendScene();e&&SceneManager.instance.s_scene_enter_scene_tos(e.id)}}else SceneManager.instance.s_scene_enter_scene_tos(SceneModule.instance.mainSceneId)},e.prototype.leaveMission=function(t){1==t&&MissionManager.instance.s_mission_exit_mission_tos()},e}(ComponentBase);__reflect(MenuView.prototype,"MenuView");var MainAttackSkillIcon=function(t){function e(e,i){var s=t.call(this)||this;return s.m_skillId=e,s.m_refreshFunc=i,s.once(egret.Event.COMPLETE,s.onCompleted,s),s.skinName="resource/eui_skins/userMainUI/skill/MainAttackSkillIconSkin.exml",s}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.u_imgIcon.source="userMainUI_json.userMainUI_d_skill_"+this.m_skillId},e.prototype.show=function(t){this.checkComplete(this.show,t)&&(this.m_time=t,this.m_time>ServerTimeManager.instance.timer?TimeManager.instance.doLoop(this.timeDo,this):TimeManager.instance.clearTimer(this.timeDo,this))},e.prototype.timeDo=function(){var t=this.m_time-ServerTimeManager.instance.timer;return 0>t?(TimeManager.instance.clearTimer(this.timeDo,this),void this.m_refreshFunc()):void(this.u_txtCd.text=t+"")},e.prototype.hide=function(){this.checkComplete(this.hide)&&(this.u_txtCd.text="",TimeManager.instance.clearTimer(this.timeDo,this),DisplayObjectUtils.removeFormParent(this))},Object.defineProperty(e.prototype,"width",{get:function(){return 30},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 30},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(MainAttackSkillIcon.prototype,"MainAttackSkillIcon");var MainAttackSkillView=function(t){function e(){var e=t.call(this)||this;return e.m_toRight=700,e.m_skillList=[FightSkillManager.type_lightning,FightSkillManager.type_huoqiu,FightSkillManager.type_dizhen,FightSkillManager.type_shenlong],e.m_viewDic={},e.m_randomList=[],e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/userMainUI/skill/MainAttackSkillViewSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvents(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.m_skillNum||(this.m_skillNum=new NumberView("num_sy_"),this.m_skillNum.p_qianStr=["j"],this.m_skillNum.scaleX=this.m_skillNum.scaleY=.6),this.m_skillNum.x=65,this.m_skillNum.y=6,this.addChild(this.m_skillNum),this.m_skillNum.numValue=0,this.m_valueSkill=0},e.prototype.initEvents=function(){},e.prototype.setManaSkill=function(t,e){PlayerManager.instance.p_mainPlayer&&(this.m_valueSkill+=e,this.m_skillNum.setNumValue(this.m_valueSkill,1.5))},e.prototype.show=function(t,e){this.checkComplete(this.show,t,e)&&(UIModule.instance.downUILayer1.addChild(this),this.y=StageManager.instance.p_stageHeight-150,this.setSkillList(t,e),Dispatch.register(FightSkillManager.EVENT_SKILL_GOLD_ADD,this.setManaSkill,this))},e.prototype.setSkillList=function(t,e){for(var i=[],s=0;s<this.m_skillList.length;s++){var n=PlayerManager.instance.p_mainPlayer.getAttackSkillTime(this.m_skillList[s]);if(n>0){this.m_viewDic[this.m_skillList[s]]||(this.m_viewDic[this.m_skillList[s]]=new MainAttackSkillIcon(this.m_skillList[s],this.setSkillList.bind(this)));var o=this.m_viewDic[this.m_skillList[s]];o.show(n),this.addChild(o),i.push(o)}else{var o=this.m_viewDic[this.m_skillList[s]];o&&o.hide()}}if(i.length>0){for(var a=i.length*i[0].width+8*(i.length-1),r=.5*(this.width-a),s=0;s<i.length;s++)i[s].x=r+(i[s].width+8)*s,i[s].y=60;a>this.width?this.x=StageManager.instance.p_stageWidth-450-a:this.x=StageManager.instance.p_stageWidth-450-this.width}else this.x=StageManager.instance.p_stageWidth-450-this.width,this.moveRewardGold(this.m_valueSkill),this.hide()},e.prototype.hide=function(){if(this.checkComplete(this.hide)){Dispatch.remove(FightSkillManager.EVENT_SKILL_GOLD_ADD,this.setManaSkill,this),this.m_valueSkill=0,DisplayObjectUtils.removeFormParent(this);for(var t in this.m_viewDic){var e=this.m_viewDic[t];e.hide()}}},e.prototype.moveRewardGold=function(t){var e=this.localToGlobal(this.m_skillNum.x,this.m_skillNum.y);this.m_moveNum||(this.m_moveNum=new NumberView("num_sy_"),this.m_moveNum.p_qianStr=["j"],this.m_moveNum.p_isAnchorOffsetX=!0,this.m_moveNum.scaleX=this.m_moveNum.scaleY=.6),this.m_moveNum.x=e.x,this.m_moveNum.y=e.y,this.m_moveNum.alpha=1,StageManager.instance.tiplayer.addChild(this.m_moveNum),this.m_moveNum.numValue=this.m_valueSkill,TweenLite.to(this.m_moveNum,.5,{x:StageManager.instance.p_stageWidth/2,y:StageManager.instance.p_stageHeight/2+150,onComplete:this.playGold.bind(this),onCompleteParams:[t]})},e.prototype.playGold=function(t){var e=this.m_moveNum.parent.localToGlobal(this.m_moveNum.x,this.m_moveNum.y),i=8+Math.floor(4*Math.random());this.setNumList(i,t);for(var s=0;s<this.m_randomList.length;s++){var n=new NumberView("num_sy_");n.p_isAnchorOffsetX=!0,n.setMsgString("j"+this.m_randomList[s]),StageManager.instance.tiplayer.addChild(n),n.alpha=0,n.x=e.x,n.y=e.y-20,n.scaleX=n.scaleY=.9,TweenLite.to(n,.5,{delay:.2+.19*s,scaleX:.7,scaleY:.7,y:e.y-200,alpha:1,ease:Circ.easeIn,onStart:this.onStartPlay.bind(this),onStartParams:[n,s,this.m_randomList[s]],onComplete:this.onNextPlay.bind(this),onCompleteParams:[n]})}TweenLite.to(this.m_moveNum,.3,{alpha:0,delay:1,onComplete:this.onHideMoveNum.bind(this)})},e.prototype.onHideMoveNum=function(){DisplayObjectUtils.removeFormParent(this.m_moveNum)},e.prototype.setNumList=function(t,e){this.m_randomList=[];for(var i=0,s=Math.floor(e/t),n=0;t>n;n++)if(n!=t-1){var o=8-Math.floor(10*Math.random());s>Math.abs(o)?(i+=s+o,this.m_randomList.push(s+o)):(i+=s,this.m_randomList.push(s))}else e-i>0&&this.m_randomList.push(e-i)},e.prototype.onStartPlay=function(t,e,i){SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_4002)},e.prototype.onNextPlay=function(t){var e=UIModule.instance.pointGold;TweenLite.to(t,1,{x:e[0]+60,y:e[1],scaleX:.3,scaleY:.3,onComplete:this.onOutPlay.bind(this),onCompleteParams:[t]})},e.prototype.onOutPlay=function(t){t.hide(),t=null},Object.defineProperty(e.prototype,"width",{get:function(){return 375},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 150},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(MainAttackSkillView.prototype,"MainAttackSkillView");var TouchControl=function(){function t(t){this.m_playerPoint=new egret.Point,this.m_angleDistancePt=new egret.Point,this.m_radius=0,this.m_angle=0,this.m_moveBall=t,this.m_moveBall.alpha=0,this.m_radius=.5*this.m_moveBall.width,this.initView()}return t.prototype.initView=function(){},t.prototype.startTouchControl=function(t){this.m_startPoint=t,StageManager.instance.p_stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onMapTouchMove,this),StageManager.instance.p_stage.addEventListener(egret.TouchEvent.TOUCH_END,this.endTouchControl,this),StageManager.instance.p_stage.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.endTouchControl,this),TweenLite.killTweensOf(this.m_moveBall),TweenLite.to(this.m_moveBall,.2,{alpha:1}),TweenLite.delayedCall(.2,this.tick,null,this),this.tick()},t.prototype.tick=function(){var t=PlayerManager.instance.p_mainPlayer.getPos();this.m_playerPoint.x=t.x,this.m_playerPoint.y=t.y;var e=this.m_radius*Math.cos(this.m_angle),i=this.m_radius*Math.sin(this.m_angle);this.m_playerPoint.x+=e,this.m_playerPoint.y+=i,MyMapModule.instance.map.startTouchMove(this.m_playerPoint.x,this.m_playerPoint.y),TweenLite.delayedCall(.2,this.tick,null,this)},t.prototype.onMapTouchMove=function(t){this.m_movePoint.x=t.stageX,this.m_movePoint.y=t.stageY,this.moveTouchControl(this.m_movePoint)},t.prototype.moveTouchControl=function(t){if(this.m_movePoint=t,egret.Point.distance(this.m_movePoint,this.m_startPoint)>60){var e=this.getAngleDistance(this.m_movePoint,this.m_startPoint);this.m_moveBall.x=e.x,this.m_moveBall.y=e.y}else this.m_moveBall.x=this.m_movePoint.x,this.m_moveBall.y=this.m_movePoint.y},t.prototype.endTouchControl=function(t){void 0===t&&(t=null),StageManager.instance.p_stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onMapTouchMove,this),StageManager.instance.p_stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.endTouchControl,this),TweenLite.to(this.m_moveBall,.2,{alpha:0}),TweenLite.killDelayedCallsTo(this.tick)},t.prototype.getAngleDistance=function(t,e,i){void 0===i&&(i=60);var s=e.x-t.x,n=e.y-t.y,o=i/egret.Point.distance(t,e);return s=o*s,n=o*n,this.m_angleDistancePt.x=e.x-s,this.m_angleDistancePt.y=e.y-n,this.m_angleDistancePt},t}();__reflect(TouchControl.prototype,"TouchControl");var CountDownView=function(t){function e(){var e=t.call(this)||this;return e.m_endTime=0,e.m_continueTime=0,e.m_finishTime=-1,e.initView(),e}return __extends(e,t),e.prototype.initView=function(){this.touchEnabled=!1,this.touchChildren=!1,this.m_imgTitle||(this.m_imgTitle=new eui.Image,this.m_imgTitle.anchorOffsetX=118,this.m_imgTitle.y=-52,this.addChild(this.m_imgTitle)),this.m_numberTime||(this.m_numberTime=new NumberView("countDownUI_json.countDownUI_num_",0,-10),this.m_numberTime.scaleX=this.m_numberTime.scaleY=.9,this.m_numberTime.p_isAnchorOffsetX=!0,this.m_numberTime.y=-18,this.addChild(this.m_numberTime))},e.prototype.show=function(t,e,i,s){void 0===e&&(e=0),void 0===i&&(i=0),void 0===s&&(s=null),null==this.parent&&(this.m_imgTitle.source="countDownUI_json.countDownUI_title_"+t,this.m_effect||(this.m_effect=new EffectMovieClip,this.m_effect.scaleY=1.1,this.m_effect.setMC("resource/assets/uiEffect/countDown/countDown")),this.addChildAt(this.m_effect,0),UIModule.instance.downUILayer2.addChild(this),this.m_endTime=e,this.m_continueTime=i,this.m_bossBackFunc=s,this.m_effect.play(),this.m_numberTime.alpha=1,this.m_numberTime.scaleX=this.m_numberTime.scaleY=1,this.m_endTime-ServerTimeManager.instance.timerValue>0&&TimeManager.instance.doLoop(this.refreshTime,this,50),Dispatch.register(StageManager.EVENT_STAGE_RESIZE,this.stageResize,this,!0))},e.prototype.refreshTime=function(){var t=this.m_endTime-ServerTimeManager.instance.timerValue,e=Math.floor(t/1e3);if(0>=t)return TimeManager.instance.clearTimer(this.refreshTime,this),void(null!=this.m_bossBackFunc&&(this.m_bossBackFunc(),this.hide()));if(10>=e)this.showFinishTime(e);else{var i=TimeUtil.toDurTimestring(t,"mm:ss:ms");i=i.replace(/:/g,"d"),this.m_numberTime.setMsgString(i)}},e.prototype.showFinishTime=function(t){this.m_finishTime!=t&&(this.m_finishTime=t,this.m_numberTime.numValue=this.m_finishTime,this.m_numberTime.alpha=1,this.m_numberTime.scaleX=this.m_numberTime.scaleY=1,TweenLite.killTweensOf(this.m_numberTime),TweenLite.to(this.m_numberTime,1,{scaleX:.6,scaleY:.6,alpha:0,ease:Back.easeIn}))},e.prototype.stageResize=function(){this.x=StageManager.instance.p_stageWidth/2},e.prototype.hide=function(){this.m_effect&&(this.m_effect.destory(),this.m_effect=null),this.m_bossBackFunc=null,TimeManager.instance.clearTimer(this.refreshTime,this),DisplayObjectUtils.removeFormParent(this)},e}(egret.DisplayObjectContainer);__reflect(CountDownView.prototype,"CountDownView");var DebugView=function(t){function e(){var e=t.call(this)||this;return e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/userMainUI/view/DebugUISkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.y=(StageManager.instance.p_stageHeight-this.height)/2},e.prototype.initEvent=function(){this.u_btnClose.addEventListener(egret.TouchEvent.TOUCH_TAP,this.hide,this),this.u_btnSend.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSend,this),this.u_imgDraw.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onStartMove,this),this.u_imgDraw.addEventListener(egret.TouchEvent.TOUCH_END,this.stopMove,this)},e.prototype.onStartMove=function(t){this.m_dragX=t.stageX-this.x,this.m_dragY=t.stageY-this.y,this.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onMove,this),t.stopPropagation(),t.stopImmediatePropagation()},e.prototype.stopMove=function(t){this.stage&&this.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onMove,this)},e.prototype.onMove=function(t){var e=t.stageX-this.m_dragX,i=t.stageY-this.m_dragY;e<=-(StageManager.instance.p_stageWidth-this.width)?e=-(StageManager.instance.p_stageWidth-this.width):e>=StageManager.instance.p_stageWidth-this.width&&(e=StageManager.instance.p_stageWidth-this.width),0>=i&&(i=0),i>=StageManager.instance.p_stageHeight-this.height&&(i=StageManager.instance.p_stageHeight-this.height),this.x=e,this.y=i},e.prototype.onSend=function(t){var e=this.u_textInput.text;ChatMoude.instance.isSendMsgOk(e)},e.prototype.show=function(t){void 0===t&&(t=null),this.checkComplete(this.show,t)&&null==this.parent&&StageManager.instance.rootDirec.addChild(this)},e.prototype.hide=function(){DisplayObjectUtils.removeFormParent(this)},Object.defineProperty(e.prototype,"width",{get:function(){return 640},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 60},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(DebugView.prototype,"DebugView");var MainTaskView=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/userMainUI/view/MainTaskViewSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){RedNoticeManager.instance.registerRed(this,[RedNoticeConfig.RED_CARD_ZHUXIAN,RedNoticeConfig.RED_CARD_YAOZU,RedNoticeConfig.RED_CARD_SHENZU],[45,-5])},e.prototype.initEvent=function(){this.u_btnTask.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTask,this)},e.prototype.onTask=function(t){UIModule.instance.showUI(UIConfig.ID_TUJIAN)},e.prototype.show=function(t){void 0===t&&(t=null),this.checkComplete(this.show,t)&&(UIModule.instance.downUILayer1.addChild(this),Dispatch.register(TaskManager.EVENT_MAIN_TASK_UPGRADE,this.setTaskData,this,!0))},e.prototype.setTaskData=function(){var t=TaskJson.getData(TaskManager.instance.p_task_data.task_id);if(t){var e=0!=TaskManager.instance.p_task_data.status?ColorJson.green:ColorJson.red;this.u_txtTask.textFlow=TextUtil.setTextFlow(t.content_desc+TextUtil.setText(" ("+TaskManager.instance.p_task_data.num+"/"+t.content_list[t.content_list.length-1]+")",e))}this.u_imgBg.width=this.u_txtTask.width+90<162?162:this.u_txtTask.width+90},e.prototype.hide=function(){DisplayObjectUtils.removeFormParent(this),Dispatch.remove(TaskManager.EVENT_MAIN_TASK_UPGRADE,this.setTaskData,this)},Object.defineProperty(e.prototype,"width",{get:function(){return this.u_imgBg.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 68},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(MainTaskView.prototype,"MainTaskView");var WorldNoticeView=function(){function t(t,e,i){this.m_loopSpeed=50,this.m_loopWidth=370,this.m_loopNum=3,this.m_onloopNotice=!1,this.m_showBool=!1,this.u_mc=t,this.u_imgbg=e,this.u_text=i,this.u_mc.alpha=0,this.m_showBool=!1,this.m_paremtMc=t.parent,this.m_mcX=t.x,this.m_imgbgRow=this.u_imgbg.width,this.initView(this.u_mc.x)}return t.prototype.initView=function(t){this.u_text.stroke=1,this.m_scrollRect||(this.m_scrollRect=new egret.Rectangle(t,0,370,50)),this.u_text.scrollRect=this.m_scrollRect,this.m_noticeList=[],this.m_fakeList=[]},t.prototype.setStageResize=function(){if(this.m_scrollRect){var t=StageManager.instance.p_stageWidth-StageManager.MIN_STAGE_WIDTH;this.u_imgbg.width=this.m_imgbgRow+t,this.m_loopWidth=370+t,this.u_mc.x=this.m_mcX-t,this.m_scrollRect.x=this.m_mcX-t,this.m_scrollRect.width=370+t}},t.prototype.onMessageChange=function(t){t&&3==t.channel&&(t.template_id<=0?this.m_noticeList.splice(0,0,t):this.m_noticeList.push(t),this.setText(t.template_id<=0))},t.prototype.onFakeChange=function(t){t&&3==t.channel&&(t.template_id<=0?this.m_fakeList.splice(0,0,t):this.m_fakeList.push(t),this.setText(t.template_id<=0))},t.prototype.show=function(){Dispatch.register(ChatManager.EVENT_CHAT_UPDATE,this.onMessageChange,this),Dispatch.register(ChatManager.EVENT_CHAT_FAKE_UPDATE,this.onFakeChange,this),this.m_paremtMc.addChild(this.u_mc),this.setText()},t.prototype.hide=function(){Dispatch.remove(ChatManager.EVENT_CHAT_UPDATE,this.onMessageChange,this),Dispatch.remove(ChatManager.EVENT_CHAT_FAKE_UPDATE,this.onFakeChange,this),TweenLite.killTweensOf(this),TweenLite.killDelayedCallsTo(this.loopNotice.bind(this)),DisplayObjectUtils.removeFormParent(this.u_mc)},t.prototype.setText=function(t){if(void 0===t&&(t=!1),0!=t||!this.m_onloopNotice){var e;this.m_noticeList.length<=0?(this.m_onloopNotice=!1,e=this.m_fakeList.shift()):e=this.m_noticeList.shift(),e?(this.startScroll(e),this.m_showBool||(this.m_showBool=!0,TweenLite.to(this.u_mc,.4,{alpha:1}))):this.m_showBool&&(this.m_showBool=!1,TweenLite.to(this.u_mc,.4,{alpha:0}))}},t.prototype.startScroll=function(t){var e,i=TextUtil.setTextFlowColor("                                                                    ");if(t.template_id<=0)e=HtmlUtil.setTextFlow(t.msg),this.m_loopNum=t.loop_num;else{var s=NoticeJson.getData(t.template_id);e=HtmlUtil.setTextFlow(s.content,t.arsg_list),this.m_loopNum=s.count}this.m_text=e;for(var n=0;n<this.m_loopNum-1;n++)this.m_text=this.m_text.concat(i),this.m_text=this.m_text.concat(e);this.u_text.alpha=0,this.u_text.textFlow=this.m_text,this.m_onloopNotice=!0,TweenLite.delayedCall(.05,this.loopNotice.bind(this))},t.prototype.loopNotice=function(){this.m_onloopNotice=!0,this.scrollX=-this.m_loopWidth,this.m_textWidth=this.u_text.textWidth;var t=this.m_textWidth/this.m_loopSpeed;TweenLite.killTweensOf(this),TweenLite.to(this,t,{scrollX:this.m_textWidth,ease:Linear.easeNone,onComplete:this.onloopNoticeComplete.bind(this)}),this.u_text.alpha=1},t.prototype.onloopNoticeComplete=function(){this.m_onloopNotice=!1,this.setText()},Object.defineProperty(t.prototype,"scrollX",{get:function(){return this.m_scrollX},set:function(t){this.m_scrollX=t,this.m_scrollRect.x=this.m_scrollX,this.u_text.scrollRect=this.m_scrollRect},enumerable:!0,configurable:!0}),t}();__reflect(WorldNoticeView.prototype,"WorldNoticeView");var MissionEitherUI=function(t){function e(){var e=t.call(this)||this;return e.m_layout=new eui.TileLayout,e.m_typeList=new eui.ArrayCollection,e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/missionEitherUI/MissionEitherUISkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_scrollerItem.horizontalScrollBar=null,this.u_scrollerItem.verticalScrollBar=null,this.m_layout.requestedColumnCount=1,this.u_listItem.itemRenderer=MissionEitherRender,this.u_listItem.layout=this.m_layout,this.u_listItem.dataProvider=this.m_typeList;var e=MissionJson.getListByType(MissionTypeEnum.MISSION_EITHER_OR);this.m_typeList.source=e},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.u_btnGame.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPlayGame,this)},e.prototype.onPlayGame=function(t){MissionManager.instance.s_mission_challenge_mission(MissionTypeEnum.MISSION_EITHER_OR,e.p_selectId)},e.prototype.showView=function(i){void 0===i&&(i=null),this.checkComplete(this.showView,i)&&(t.prototype.showView.call(this,i),e.p_selectId=1,Dispatch.register(MissionEitherRender.EVENT_MISSION_EITHER_ROOM_SELECT,this.upData,this,!0))},e.prototype.upData=function(){var t=MissionJson.getData(MissionTypeEnum.MISSION_EITHER_OR,e.p_selectId);this.u_txtMsg.text="当前选择挑战的关卡："+t.id},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i),Dispatch.remove(MissionEitherRender.EVENT_MISSION_EITHER_ROOM_SELECT,this.upData,this)},e.p_selectId=1,e}(UIBase);__reflect(MissionEitherUI.prototype,"MissionEitherUI");var MissionEitherRender=function(t){function e(){return t.call(this,"resource/eui_skins/missionEitherUI/render/MissionEitherRenderSkin.exml")||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnSelect,this.onSelect,this)},e.prototype.onSelect=function(t){void 0===t&&(t=null),this.m_data.id!=MissionEitherUI.p_selectId&&(MissionEitherUI.p_selectId=this.m_data.id,Dispatch.dispatch(e.EVENT_MISSION_EITHER_ROOM_SELECT))},e.prototype.dataChanged=function(){this.checkComplete(this.dataChanged)&&(t.prototype.dataChanged.call(this),this.m_data=this.data,this.u_txtName.text="副本id： "+this.m_data.id)},e.EVENT_MISSION_EITHER_ROOM_SELECT="EVENT_MISSION_EITHER_ROOM_SELECT",e}(ItemRendererBase);__reflect(MissionEitherRender.prototype,"MissionEitherRender");var MissionFailPopup=function(t){function e(){var e=t.call(this)||this;return e.m_time=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/missionJieSuanUI/popup/MissionFailPopupSkinSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.setCloseBtn(this.u_btnLeave)},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),e&&e.msg&&(this.u_txtDesc.text=e.msg),this.startTimeDo(),SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_1004))},e.prototype.startTimeDo=function(){this.m_time=10,TimeManager.instance.doLoop(this.refreshTime,this,1e3)},e.prototype.refreshTime=function(){return this.u_txtLeave.text=LanguageJson.getText("l_btn_leave")+"("+this.m_time+")",this.m_time<=0?(TimeManager.instance.clearTimer(this.refreshTime,this),void this.close()):void this.m_time--},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i),TimeManager.instance.clearTimer(this.refreshTime,this),MissionManager.instance.s_mission_exit_mission_tos()},Object.defineProperty(e.prototype,"isClickBMask",{get:function(){return!1},enumerable:!0,configurable:!0}),e}(PopupBase);__reflect(MissionFailPopup.prototype,"MissionFailPopup");var MissionFirstPrizePopup=function(t){function e(){var e=t.call(this)||this;return e.m_rank=0,e.m_reward=[],e.m_time=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/missionJieSuanUI/popup/MissionFirstPrizePopupSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.m_rewardGrop||(this.m_rewardGrop=new RewardGroupUI,this.m_rewardGrop.horizontalCenter=0,this.m_rewardGrop.verticalCenter=0,this.m_rewardGrop.spaceX=20,this.m_rewardGrop.spaceY=5,this.u_grpReward.addChild(this.m_rewardGrop))},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.setCloseBtn(this.u_btnClose),this.setCloseBtn(this.u_btnOK)},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),this.m_rank=0,e&&e.rank&&(this.m_rank=e.rank),e&&e.reward&&(this.m_reward=e.reward),this.u_txtMsg.text=LanguageJson.getText("l_missiom_finish_msg_4"),this.u_txtRank.textFlow=LanguageJson.getHtmlTextFlow("l_missiom_finish_rank",[this.m_rank]),this.m_reward.length>4?(this.m_rewardGrop.visualHeight=220,this.m_rewardGrop.setDataByProp(this.m_reward,4,0,!0)):this.m_rewardGrop.setDataByProp(this.m_reward,this.m_reward.length),this.startTimeDo(),SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_1003))},e.prototype.startTimeDo=function(){this.m_time=10,TimeManager.instance.doLoop(this.refreshTime,this,1e3)},e.prototype.refreshTime=function(){return this.u_txtOK.text=LanguageJson.getText("l_btn_ok")+"("+this.m_time+")",this.m_time<=0?(TimeManager.instance.clearTimer(this.refreshTime,this),void this.close()):void this.m_time--},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i),TimeManager.instance.clearTimer(this.refreshTime,this),MissionManager.instance.s_mission_exit_mission_tos()},Object.defineProperty(e.prototype,"isClickBMask",{get:function(){return!1},enumerable:!0,configurable:!0}),e}(PopupBase);__reflect(MissionFirstPrizePopup.prototype,"MissionFirstPrizePopup");var MissionPrizePopup=function(t){function e(){var e=t.call(this)||this;return e.m_rank=0,e.m_reward=[],e.m_time=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/missionJieSuanUI/popup/MissionPrizePopupSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.m_rewardGrop||(this.m_rewardGrop=new RewardGroupUI,this.m_rewardGrop.horizontalCenter=0,this.m_rewardGrop.y=557,this.m_rewardGrop.spaceX=30,this.addChild(this.m_rewardGrop))},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.setCloseBtn(this.u_btnOK)},e.prototype.showView=function(e){if(void 0===e&&(e=null),this.checkComplete(this.showView,e)){if(t.prototype.showView.call(this,e),this.m_rank=0,this.m_reward=[],e&&e.rank&&(this.m_rank=e.rank),e&&e.reward&&(this.m_reward=e.reward),e){var i=e.nick;null==i||void 0==i?this.u_txtMsg.textFlow=LanguageJson.getHtmlTextFlow("l_missiom_finish_msg_3"):""!=i?(this.u_txtMsg.textFlow=LanguageJson.getHtmlTextFlow("l_missiom_finish_msg_2",[i]),this.u_txtMsg2.textFlow=LanguageJson.getHtmlTextFlow("l_missiom_finish_msg_1")):this.u_txtMsg.textFlow=LanguageJson.getHtmlTextFlow("l_missiom_finish_msg_3")}this.u_txtRank.textFlow=LanguageJson.getHtmlTextFlow("l_missiom_finish_rank",[this.m_rank]),this.m_reward.length>3&&(this.m_rewardGrop.visualWidth=318),this.m_reward.length<=0?this.u_grpMsg.y=538:this.u_grpMsg.y=473,this.m_rewardGrop.setDataByProp(this.m_reward,this.m_reward.length),this.startTimeDo(),SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_1003)}},e.prototype.startTimeDo=function(){this.m_time=10,TimeManager.instance.doLoop(this.refreshTime,this,1e3)},e.prototype.refreshTime=function(){return this.u_txtOK.text=LanguageJson.getText("l_btn_ok")+"("+this.m_time+")",this.m_time<=0?(TimeManager.instance.clearTimer(this.refreshTime,this),void this.close()):void this.m_time--},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i),TimeManager.instance.clearTimer(this.refreshTime,this),MissionManager.instance.s_mission_exit_mission_tos()},Object.defineProperty(e.prototype,"isClickBMask",{get:function(){return!1},enumerable:!0,configurable:!0}),e}(PopupBase);__reflect(MissionPrizePopup.prototype,"MissionPrizePopup");var MissionMultiUI=function(t){function e(){var e=t.call(this)||this;return e.m_currList.push({funcKey:FunctionEnum.MISSION_SHISHI_MULTI_LIST,pageMc:new MissionMultiMain}),e.m_currList.push({funcKey:FunctionEnum.MISSION_SHISHI_MULTI_CREATE,pageMc:new MissionMultiCreate}),e}return __extends(e,t),e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),Dispatch.register(ShiShiRoomManager.EVENT_SHISHIROOM_CREATE_ROOM,this.changePage,this))},e.prototype.changePage=function(){},e.prototype.sureHide=function(e,i){void 0===i&&(i=null),t.prototype.sureHide.call(this,e,i),Dispatch.remove(ShiShiRoomManager.EVENT_SHISHIROOM_CREATE_ROOM,this.changePage,this)},e.prototype.isCloseUI=function(){if(ShiShiRoomManager.instance.p_roomId>0){var t=LanguageJson.getText("l_multi_leave_2"),i=LanguageJson.getText("l_btn_yes"),s=LanguageJson.getText("l_btn_no");return PopupModule.instance.showTishi(t,this.sureClose.bind(this),null,i,s),!1}return Dispatch.dispatch(e.EVENT_MISSION_MULTI_CLOSE),!0},e.prototype.sureClose=function(t){1==t&&ShiShiRoomManager.instance.s_shi_shi_room_leave_room()},e.prototype.checkPageFunc=function(t){return t==FunctionEnum.MISSION_SHISHI_MULTI_CREATE&&ShiShiRoomManager.instance.p_roomId>0?!1:!0},e.EVENT_MISSION_MULTI_CLOSE="EVENT_MISSION_MULTI_CLOSE",e}(UIBase);__reflect(MissionMultiUI.prototype,"MissionMultiUI");var MissionMultiCreate=function(t){function e(){var e=t.call(this)||this;return e.m_layout=new eui.TileLayout,e.m_typeList=new eui.ArrayCollection,e.m_isGou=!1,e.m_entryLimit=0,e.m_singleLimit=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/missionMultiUI/page/MissionMultiCreateSkin.exml"
},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.m_layout.requestedColumnCount=3,this.m_layout.horizontalGap=0,this.m_layout.verticalGap=20,this.u_listItem.itemRenderer=MissionMultiBoss,this.u_listItem.layout=this.m_layout,this.u_listItem.dataProvider=this.m_typeList,this.m_idList=MissionJson.getListByType(MissionTypeEnum.MANY_PEOPLE_SHISHI),this.u_txtMana.textFlow=LanguageJson.getHtmlTextFlow("l_mission_multi_entry"),this.u_txtSingle.textFlow=LanguageJson.getHtmlTextFlow("l_mission_multi_single");var e=Number(StaticDataJson.getData("many_people_shishi_rate").data)/100;this.u_txtAward.textFlow=LanguageJson.getHtmlTextFlow("l_mission_multi_award",[e]),this.u_txtDesc.text=LanguageJson.getText("l_multi_create_desc"),this.u_txtSetPass.text=LanguageJson.getText("l_multi_create_passward"),this.u_txtOK.text=LanguageJson.getText("l_btn_ok");var i=ShiShiRoomManager.instance.getRoomMaxPeople();this.u_txtPart.textFlow=LanguageJson.getHtmlTextFlow("l_multi_create_people",[i])},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnOK,this.onCreate,this,!0),this.registerEventClick(this.u_btnGou,this.onGou,this)},e.prototype.onGou=function(t){this.m_isGou=!this.m_isGou,this.u_iconGou.visible=this.m_isGou},e.prototype.onCreate=function(t){return""==BagManager.instance.checkCondition(this.m_json.enter_conditions_list,!0)?BagManager.instance.gold<this.m_entryLimit?void BagManager.instance.noEnoughGold():BagManager.instance.gold<this.m_singleLimit?void BagManager.instance.noEnoughGold():void(1==this.m_isGou?""==this.u_txtInput.text?FloatTipModule.instance.popTipLanguage("l_multi_passward_tips"):ShiShiRoomManager.instance.s_shi_shi_room_create_room(e.p_missionId,1,this.u_txtInput.text):ShiShiRoomManager.instance.s_shi_shi_room_create_room(e.p_missionId,0,"")):void 0},e.prototype.showView=function(i){void 0===i&&(i=null),this.checkComplete(this.showView,i)&&(t.prototype.showView.call(this,i),this.m_isGou=!1,this.u_iconGou.visible=this.m_isGou,this.m_typeList.source=this.m_idList,this.u_txtInput.text="",e.p_missionId=this.m_idList[0].id,this.u_imgIcon1.x=this.u_txtMana.x+this.u_txtMana.width+4,this.u_txtEnteryCost.x=this.u_imgIcon1.x+32,this.u_imgIcon2.x=this.u_txtSingle.x+this.u_txtSingle.width+4,this.u_txtSingleCost.x=this.u_imgIcon2.x+32,Dispatch.register(MissionMultiBoss.EVENT_MISSION_MULTI_SELECT,this.showMissionInfo,this,!0))},e.prototype.showMissionInfo=function(){this.m_json=MissionJson.getData(MissionTypeEnum.MANY_PEOPLE_SHISHI,e.p_missionId),this.m_json.enter_conditions_list&&this.m_json.enter_conditions_list.length>0?"vip_level"==this.m_json.enter_conditions_list[0]?this.u_txtLimit.textFlow=LanguageJson.getHtmlTextFlow("l_multi_list_limit_vip",[this.m_json.enter_conditions_list[1]]):"level"==this.m_json.enter_conditions_list[0]&&(this.u_txtLimit.textFlow=LanguageJson.getHtmlTextFlow("l_multi_list_limit_lv",[this.m_json.enter_conditions_list[1]])):this.u_txtLimit.text="";var t=SceneJson.getData(this.m_json.scene_id);this.m_entryLimit=this.m_json.mana_enter_list[0],this.m_singleLimit=Number(this.m_json.mana_attack_list[0])*t.drop_per/1e4,this.u_txtEnteryCost.text=NumberUtil.numberToString(this.m_json.mana_enter_list[0]),this.u_txtSingleCost.text=NumberUtil.numberToString(Number(this.m_json.mana_attack_list[0])*t.drop_per/1e4)},e.prototype.hide=function(e){void 0===e&&(e=null),t.prototype.hide.call(this),Dispatch.remove(MissionMultiBoss.EVENT_MISSION_MULTI_SELECT,this.showMissionInfo,this)},e}(PageBase);__reflect(MissionMultiCreate.prototype,"MissionMultiCreate");var MissionMultiMain=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this)},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),Dispatch.register(ShiShiRoomManager.EVENT_SHISHIROOM_JOIN_ROOM,this.showData,this,!0),Dispatch.register(ShiShiRoomManager.EVENT_SHISHIROOM_SELF_LEAVE_ROOM,this.showData,this))},e.prototype.showData=function(){ShiShiRoomManager.instance.p_roomId<=0?(this.m_multiListView||(this.m_multiListView=new MissionMultiList,this.m_multiListView.x=0,this.m_multiListView.y=0),this.addChild(this.m_multiListView),this.m_multiListView.show(),this.m_multiRoomView&&this.m_multiRoomView.hide()):(this.m_multiRoomView||(this.m_multiRoomView=new MissionMultiRoom,this.m_multiRoomView.x=0,this.m_multiRoomView.y=0),this.addChild(this.m_multiRoomView),this.m_multiRoomView.show(),this.m_multiListView&&this.m_multiListView.hide())},e.prototype.hide=function(e){void 0===e&&(e=null),Dispatch.remove(ShiShiRoomManager.EVENT_SHISHIROOM_JOIN_ROOM,this.showData,this),Dispatch.remove(ShiShiRoomManager.EVENT_SHISHIROOM_SELF_LEAVE_ROOM,this.showData,this),this.m_multiListView&&this.m_multiListView.hide(),this.m_multiRoomView&&this.m_multiRoomView.hide(),t.prototype.hide.call(this)},Object.defineProperty(e.prototype,"width",{get:function(){return 640},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 1136},enumerable:!0,configurable:!0}),e}(PageBase);__reflect(MissionMultiMain.prototype,"MissionMultiMain");var MissionMultiFindPopup=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/missionMultiUI/popup/MissionMultiFindPopupSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_txtCode.text=LanguageJson.getText("l_multi_code"),this.u_txtCancel.text=LanguageJson.getText("l_btn_cancel"),this.u_txtOK.text=LanguageJson.getText("l_btn_ok")},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.setCloseBtn(this.u_btnClose),this.setCloseBtn(this.u_btnCancel),this.registerEventClick(this.u_btnOK,this.onFind,this,!0)},e.prototype.onFind=function(t){var e=this.u_txtInput.text;""==e?FloatTipModule.instance.popTipLanguage("l_multi_code_tips"):ShiShiRoomManager.instance.s_shi_shi_room_join_room(0,"",e)},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),this.u_txtInput.text="",Dispatch.register(ShiShiRoomManager.EVENT_SHISHIROOM_JOIN_ROOM,this.close,this))},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i),Dispatch.remove(ShiShiRoomManager.EVENT_SHISHIROOM_JOIN_ROOM,this.close,this)},e}(PopupBase);__reflect(MissionMultiFindPopup.prototype,"MissionMultiFindPopup");var MissionMultiJoinPopup=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/missionMultiUI/popup/MissionMultiJoinPopupSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_txtPass.text=LanguageJson.getText("l_multi_join_passward"),this.u_txtCancel.text=LanguageJson.getText("l_btn_cancel"),this.u_txtOK.text=LanguageJson.getText("l_btn_ok")},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.setCloseBtn(this.u_btnClose),this.setCloseBtn(this.u_btnCancel),this.registerEventClick(this.u_btnOK,this.onJoin,this,!0)},e.prototype.onJoin=function(t){var e=this.u_txtInput.text;""==e?FloatTipModule.instance.popTipLanguage("l_multi_passward_tips"):ShiShiRoomManager.instance.s_shi_shi_room_join_room(this.m_roomId,e,"")},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),this.m_roomId=e,this.u_txtInput.text="",this.u_txtRoomId.textFlow=LanguageJson.getHtmlTextFlow("l_multi_join_id",[this.m_roomId]),Dispatch.register(ShiShiRoomManager.EVENT_SHISHIROOM_JOIN_ROOM,this.close,this))},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i),Dispatch.remove(ShiShiRoomManager.EVENT_SHISHIROOM_JOIN_ROOM,this.close,this)},e}(PopupBase);__reflect(MissionMultiJoinPopup.prototype,"MissionMultiJoinPopup");var MissionMultiVictoryPopup=function(t){function e(){var e=t.call(this)||this;return e.m_time=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/missionMultiUI/popup/MissionMultiResultPopupSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_txtMana.text=LanguageJson.getHtmlText("l_shishi_boss_mana"),this.u_txtCost.text=LanguageJson.getHtmlText("l_missiom_game_cost"),this.u_imgIcon2.source=BagManager.instance.getIconPath(2)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnClose,this.onClosePop,this,!0),this.registerEventClick(this.u_btnOK,this.onClosePop,this,!0)},e.prototype.onClosePop=function(t){void 0===t&&(t=null),this.close(),MissionManager.instance.s_mission_exit_mission_tos()},e.prototype.showView=function(e){if(void 0===e&&(e=null),this.checkComplete(this.showView,e)){if(t.prototype.showView.call(this,e),e){var i=e.winName,s=e.prop,n=Number(e.totalCost),o=0;for(var a in s)o+=s[a].num;this.u_txtName.textFlow=LanguageJson.getHtmlTextFlow("l_shishi_boss_msg_1",[i]),this.u_txtCount1.text=NumberUtil.numberDecimalism(o),this.u_txtCount2.text=NumberUtil.numberDecimalism(n),this.u_imgIcon1.x=this.u_txtMana.x+this.u_txtMana.width-10,this.u_txtCount1.x=this.u_imgIcon1.x+this.u_imgIcon1.width,this.u_imgIcon2.x=this.u_txtCost.x+this.u_txtCost.width-10,this.u_txtCount2.x=this.u_imgIcon2.x+this.u_imgIcon2.width,this.startTimeDo()}SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_1003)}},e.prototype.startTimeDo=function(){this.m_time=10,TimeManager.instance.doLoop(this.refreshTime,this,1e3)},e.prototype.refreshTime=function(){return this.u_txtOK.text=LanguageJson.getText("l_btn_ok")+"("+this.m_time+")",this.m_time<=0?(TimeManager.instance.clearTimer(this.refreshTime,this),void this.onClosePop()):void this.m_time--},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i),TimeManager.instance.clearTimer(this.refreshTime,this)},Object.defineProperty(e.prototype,"isClickBMask",{get:function(){return!1},enumerable:!0,configurable:!0}),e}(PopupBase);__reflect(MissionMultiVictoryPopup.prototype,"MissionMultiVictoryPopup");var MissionMultiBoss=function(t){function e(){var e=t.call(this,"resource/eui_skins/missionMultiUI/render/MissionMultiBossSkin.exml")||this;return e.m_pathStr="",e.m_off_list=[],e}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this),this.touchEnabled=!1},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnClick,this.onClick,this)},e.prototype.onClick=function(t){void 0===t&&(t=null),MissionMultiCreate.p_missionId=this.m_missionJson.id,Dispatch.dispatch(e.EVENT_MISSION_MULTI_SELECT)},e.prototype.dataChanged=function(){this.checkComplete(this.dataChanged)&&(t.prototype.dataChanged.call(this),this.m_missionJson=this.data,this.m_off_list=StaticDataJson.parseStrToList("many_people_shishi_list_off_list"+this.m_missionJson.id),this.m_pathStr=MonsterJson.getAvatarPath(this.m_missionJson.boss_id),""!=this.m_pathStr&&(this.m_effect||(this.m_effect=new EffectMovieClip),this.m_effect.x=88,this.m_effect.y=90,this.addChildAt(this.m_effect,1),this.m_off_list[0]&&(this.m_effect.x+=this.m_off_list[0]),this.m_off_list[1]&&(this.m_effect.y+=this.m_off_list[1]),this.m_effect.setMC(this.m_pathStr),this.m_effect.play()),Dispatch.register(e.EVENT_MISSION_MULTI_SELECT,this.upSelect,this,!0),Dispatch.register(MissionMultiUI.EVENT_MISSION_MULTI_CLOSE,this.destoryEff,this))},e.prototype.upSelect=function(){this.m_missionJson.id==MissionMultiCreate.p_missionId?(this.u_imgSelect.source="missionMultiUI_json.missionMultiUI_boss_select_2",this.u_imgSelect.scaleX=this.u_imgSelect.scaleY=1.05,this.m_off_list[2]&&(this.m_effect.scaleX=this.m_effect.scaleY=this.m_off_list[2]+.1)):(this.u_imgSelect.source="missionMultiUI_json.missionMultiUI_boss_select_1",this.u_imgSelect.scaleX=this.u_imgSelect.scaleY=1,this.m_off_list[2]&&(this.m_effect.scaleX=this.m_effect.scaleY=this.m_off_list[2]))},e.prototype.onRemoveStage=function(i){t.prototype.onRemoveStage.call(this,i),Dispatch.remove(e.EVENT_MISSION_MULTI_SELECT,this.upSelect,this),this.m_effect&&this.m_effect.stop()},e.prototype.destoryEff=function(){this.m_effect&&(this.m_effect.destory(),this.m_effect=null),Dispatch.remove(MissionMultiUI.EVENT_MISSION_MULTI_CLOSE,this.destoryEff,this)},Object.defineProperty(e.prototype,"width",{get:function(){return 177},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 140},enumerable:!0,configurable:!0}),e.EVENT_MISSION_MULTI_SELECT="EVENT_MISSION_MULTI_SELECT",e}(ItemRendererBase);__reflect(MissionMultiBoss.prototype,"MissionMultiBoss");var MissionMultiListRender=function(t){function e(){var e=t.call(this,"resource/eui_skins/missionMultiUI/render/MissionMultiListRenderSkin.exml")||this;return e.m_pathStr="",e.m_partNum=0,e}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_txtCondition.text=LanguageJson.getHtmlText("l_mission_multi_ess"),this.u_txtJoin.text=LanguageJson.getText("l_btn_join")},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnJoin,this.onJoin,this,!0)},e.prototype.onJoin=function(t){if(void 0===t&&(t=null),""==BagManager.instance.checkCondition(this.m_missionJson.enter_conditions_list,!0)){if(BagManager.instance.gold<this.m_missionJson.mana_enter_list[0])return void BagManager.instance.noEnoughGold();var e=SceneJson.getData(this.m_missionJson.scene_id),i=Number(this.m_missionJson.mana_attack_list[0])*e.drop_per/1e4;return BagManager.instance.gold<i?void BagManager.instance.noEnoughGold():void(0==this.m_data.is_lock?ShiShiRoomManager.instance.s_shi_shi_room_join_room(this.m_data.room_id,"",""):PopupModule.instance.showPop(PopupConfig.ID_MISSION_MULTI_JOIN,this.m_data.room_id,!1))}},e.prototype.dataChanged=function(){if(this.checkComplete(this.dataChanged)){if(t.prototype.dataChanged.call(this),this.m_data=this.data,this.m_missionJson=MissionJson.getData(MissionTypeEnum.MANY_PEOPLE_SHISHI,this.m_data.mission_id),this.m_pathStr=MonsterJson.getAvatarPath(this.m_missionJson.boss_id),this.u_grpIcon.x=this.u_txtCondition.x+this.u_txtCondition.width+6,this.u_txtEnteryCost.text=NumberUtil.numberToString(this.m_missionJson.mana_enter_list[0]),this.u_txtPartic.textFlow=LanguageJson.getHtmlTextFlow("l_multi_room_people",[this.m_data.people_count,ShiShiRoomManager.instance.getRoomMaxPeople()]),""!=this.m_pathStr){this.m_effect||(this.m_effect=new EffectMovieClip),this.m_effect.x=83,this.m_effect.y=115,this.addChildAt(this.m_effect,this.getChildIndex(this.u_txtVip)+2);var e=StaticDataJson.parseStrToList("many_people_shishi_list_off_list"+this.m_missionJson.id);e[0]&&(this.m_effect.x+=e[0]),e[1]&&(this.m_effect.y+=e[1]),e[2]&&(this.m_effect.scaleX=this.m_effect.scaleY=e[2]),this.m_effect.setMC(this.m_pathStr),this.m_effect.play()}this.m_missionJson.enter_conditions_list.length>0?(this.u_txtVip.visible=!0,"vip_level"==this.m_missionJson.enter_conditions_list[0]?this.u_txtVip.textFlow=LanguageJson.getHtmlTextFlow("l_multi_list_limit_vip",[this.m_missionJson.enter_conditions_list[1]]):"level"==this.m_missionJson.enter_conditions_list[0]&&(this.u_txtVip.textFlow=LanguageJson.getHtmlTextFlow("l_multi_list_limit_lv",[this.m_missionJson.enter_conditions_list[1]]))):this.u_txtVip.visible=!1,this.u_iconLock.visible=1==this.m_data.is_lock,Dispatch.register(MissionMultiUI.EVENT_MISSION_MULTI_CLOSE,this.destoryEff,this)}},e.prototype.onRemoveStage=function(e){t.prototype.onRemoveStage.call(this,e),this.m_effect&&this.m_effect.stop()},e.prototype.destoryEff=function(){this.m_effect&&(this.m_effect.destory(),this.m_effect=null),Dispatch.remove(MissionMultiUI.EVENT_MISSION_MULTI_CLOSE,this.destoryEff,this)},e}(ItemRendererBase);__reflect(MissionMultiListRender.prototype,"MissionMultiListRender");var MissionMultiSelectRender=function(t){function e(){var e=t.call(this,"resource/eui_skins/missionMultiUI/render/MissionMultiSelectRenderSkin.exml")||this;return e.m_condition="",e}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this,this.onSelect,this)},e.prototype.onSelect=function(t){void 0===t&&(t=null),Dispatch.dispatch(e.EVENT_MISSION_MULTI_RATE_SELECT),this.m_missionId!=MissionMultiList.p_missionId&&ShiShiRoomManager.instance.s_shi_shi_room_get_room_list(this.m_missionId)},e.prototype.dataChanged=function(){if(this.checkComplete(this.dataChanged))if(t.prototype.dataChanged.call(this),this.m_missionId=this.data,this.m_missionJson=MissionJson.getData(MissionTypeEnum.MANY_PEOPLE_SHISHI,this.m_missionId),this.m_missionJson){var e=SceneJson.getData(this.m_missionJson.scene_id);this.u_grpIcon.visible=!0,this.u_txtSingle.text=LanguageJson.getText("l_mission_multi_single"),this.u_grpIcon.x=this.u_txtSingle.x+this.u_txtSingle.width+4,this.u_txtSingleCost.text=NumberUtil.numberToString(Number(this.m_missionJson.mana_attack_list[0])*e.drop_per/1e4)}else this.u_grpIcon.visible=!1,this.u_txtSingle.text=LanguageJson.getText("l_multi_list_all")},e.EVENT_MISSION_MULTI_RATE_SELECT="EVENT_MISSION_MULTI_RATE_SELECT",e}(ItemRendererBase);__reflect(MissionMultiSelectRender.prototype,"MissionMultiSelectRender");var MissionMultiHead=function(t){function e(e){var i=t.call(this)||this;return i.m_posId=e,i.x=(i.width+20)*((e-1)%3),i.y=(i.height-5)*Math.floor((e-1)/3),i.once(egret.Event.COMPLETE,i.onCompleted,i),i.skinName="resource/eui_skins/missionMultiUI/view/MissionMultiHeadSkin.exml",i}return __extends(e,t),e.prototype.onCompleted=function(){this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initEvent=function(){this.registerEventClick(this.u_btnKick,this.onKick,this,!0)},e.prototype.onKick=function(t){void 0===t&&(t=null),ShiShiRoomManager.instance.s_shi_shi_room_kick_out_player(this.m_posId)},e.prototype.show=function(t){void 0===t&&(t=null),this.checkComplete(this.show,t)&&(Dispatch.register(ShiShiRoomManager.EVENT_SHISHIROOM_OTHER_JOIN_ROOM,this.upPosData,this),Dispatch.register(ShiShiRoomManager.EVENT_SHISHIROOM_LEAVE_ROOM,this.upPosData,this),Dispatch.register(ShiShiRoomManager.EVENT_SHISHIROOM_READY+this.m_posId,this.changeReady,this),Dispatch.register(ShiShiRoomManager.EVENT_SHISHIROOM_OWNER_UPDATA,this.showPosData,this),this.showPosData())},e.prototype.showPosData=function(){this.m_data=ShiShiRoomManager.instance.getDataByPosId(this.m_posId),this.m_data?(this.u_grpHave.visible=!0,this.u_txtLv.textFlow=LanguageJson.getHtmlTextFlow("l_multi_lv",[this.m_data.model_head_figure.level]),this.u_txtName.text=this.m_data.model_head_figure.nickname,this.m_data.model_head_figure.player_id==PlayerManager.instance.playerId?this.u_txtName.textColor=5106176:this.u_txtName.textColor=16777215,1==this.m_data.is_room_owner?(this.u_imgReady.visible=!1,this.u_imgBg.source="multiRoomUI_json.multiRoomUI_head1"):(this.u_imgReady.visible=1==this.m_data.is_ready,this.u_imgBg.source="multiRoomUI_json.multiRoomUI_head2"),1==ShiShiRoomManager.instance.p_roomInfo.is_room_owner?1==this.m_data.is_room_owner?this.u_btnKick.visible=!1:this.u_btnKick.visible=!0:this.u_btnKick.visible=!1,this.u_imgHead.source=PublicCon.PATH_PERSONAL_ICON+this.m_data.model_head_figure.head_id+".png"):(this.u_grpHave.visible=!1,this.u_imgBg.source="multiRoomUI_json.multiRoomUI_head2")},e.prototype.upPosData=function(t){this.m_posId==t&&this.showPosData()},e.prototype.changeReady=function(t){this.u_imgReady.visible=0==t?!1:!0},e.prototype.hide=function(){DisplayObjectUtils.removeFormParent(this),Dispatch.remove(ShiShiRoomManager.EVENT_SHISHIROOM_OTHER_JOIN_ROOM,this.upPosData,this),Dispatch.remove(ShiShiRoomManager.EVENT_SHISHIROOM_LEAVE_ROOM,this.upPosData,this),Dispatch.remove(ShiShiRoomManager.EVENT_SHISHIROOM_READY+this.m_posId,this.changeReady,this),Dispatch.remove(ShiShiRoomManager.EVENT_SHISHIROOM_OWNER_UPDATA,this.showPosData,this)},Object.defineProperty(e.prototype,"width",{get:function(){return 167},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 159},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(MissionMultiHead.prototype,"MissionMultiHead");var MissionMultiList=function(t){function e(){var e=t.call(this)||this;return e.m_layout=new eui.TileLayout,e.m_typeList=new eui.ArrayCollection,e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/missionMultiUI/page/MissionMultiListSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.u_scrollerItem.horizontalScrollBar=null,this.u_scrollerItem.verticalScrollBar=null,this.m_layout.requestedColumnCount=1,this.u_listItem.itemRenderer=MissionMultiListRender,this.u_listItem.layout=this.m_layout,this.u_listItem.dataProvider=this.m_typeList,this.u_txtTips.text=LanguageJson.getText("l_multi_list_code"),this.u_txtRefresh.text=LanguageJson.getText("l_btn_refresh")},e.prototype.initEvent=function(){this.registerEventClick(this.u_btnSelect,this.onSelected,this),this.registerEventClick(this.u_btnInput,this.onInput,this),this.registerEventClick(this.u_btnRefresh,this.onRefresh,this,!0)},e.prototype.onSelected=function(t){void 0===t&&(t=null),e.p_isClick?this.m_selectView&&this.m_selectView.hide():(this.m_selectView||(this.m_selectView=new MissionMultiSelect,this.m_selectView.x=30,this.m_selectView.y=142),this.addChild(this.m_selectView),this.m_selectView.show(),e.p_isClick=!0),t.stopPropagation(),t.stopImmediatePropagation()},e.prototype.onInput=function(t){void 0===t&&(t=null),PopupModule.instance.showPop(PopupConfig.ID_MISSION_MULTI_FIND,null,!1)},e.prototype.onRefresh=function(t){void 0===t&&(t=null),e.p_cd<=0&&(e.p_cd=6,this.u_txtTime.visible=!0,TimeManager.instance.doLoop(this.refreshTime,this,1e3),ShiShiRoomManager.instance.s_shi_shi_room_get_room_list(e.p_missionId))},e.prototype.show=function(t){void 0===t&&(t=null),this.checkComplete(this.show,t)&&(this.recoverAllTexture(this,!0),e.p_missionId=0,e.p_isClick=!1,this.u_txtTime.visible=!1,e.p_cd>0&&(this.u_txtTime.visible=!0,TimeManager.instance.doLoop(this.refreshTime,this,1e3)),Dispatch.register(ShiShiRoomManager.EVENT_SHISHIROOM_GET_ROOMLIST,this.refreshRoomList,this),ShiShiRoomManager.instance.s_shi_shi_room_get_room_list(e.p_missionId))},e.prototype.refreshRoomList=function(t,i){if(this.u_scrollerItem.stopAnimation(),this.m_selectView&&this.m_selectView.hide(),e.p_missionId=t,this.m_typeList.source=i,this.u_imgNone.visible=i.length>0?!1:!0,this.u_scrollerItem.viewport.scrollV=0,0==t)this.u_grpCost.visible=!1,this.u_txtSelect.text=LanguageJson.getText("l_mission_multi_single_all"),this.u_iconArrow.x=this.u_txtSelect.x+this.u_txtSelect.width+10;else{var s=MissionJson.getData(MissionTypeEnum.MANY_PEOPLE_SHISHI,t),n=SceneJson.getData(s.scene_id);this.u_grpCost.visible=!0,this.u_txtSelect.text=LanguageJson.getText("l_mission_multi_single"),this.u_grpCost.x=this.u_txtSelect.width+4,this.u_txtSingleCost.text=NumberUtil.numberToString(Number(s.mana_attack_list[0])*n.drop_per/1e4),this.u_iconArrow.x=this.u_grpCost.x+this.u_txtSingleCost.x+this.u_txtSingleCost.width+7}},e.prototype.refreshTime=function(){return this.u_txtTime.textFlow=LanguageJson.getHtmlTextFlow("l_game_unit_s",[e.p_cd]),e.p_cd<=0?(this.u_txtTime.visible=!1,void TimeManager.instance.clearTimer(this.refreshTime,this)):void e.p_cd--},e.prototype.hide=function(){DisplayObjectUtils.removeFormParent(this),TimeManager.instance.clearTimer(this.refreshTime,this),Dispatch.remove(ShiShiRoomManager.EVENT_SHISHIROOM_GET_ROOMLIST,this.refreshRoomList,this)},Object.defineProperty(e.prototype,"width",{get:function(){return 640},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 1136},enumerable:!0,configurable:!0}),e.p_cd=6,e.p_isClick=!1,e.p_missionId=0,e}(ComponentBase);__reflect(MissionMultiList.prototype,"MissionMultiList");var MissionMultiPro=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.show=function(t){void 0===t&&(t=null),this.checkComplete(this.show,t)&&(Dispatch.register(StageManager.EVENT_STAGE_RESIZE,this.stageResize,this,!0),Dispatch.register(ShiShiRoomManager.EVENT_SHISHIROOM_VALUE_UPDATA,this.changeValue,this,!0))},e.prototype.changeValue=function(){this.m_numberView.numValue=ShiShiRoomManager.instance.p_totalValue},e.prototype.stageResize=function(){this.x=(StageManager.instance.p_stageWidth-this.width)/2},e.prototype.hide=function(){DisplayObjectUtils.removeFormParent(this),Dispatch.remove(StageManager.EVENT_STAGE_RESIZE,this.stageResize,this),Dispatch.remove(ShiShiRoomManager.EVENT_SHISHIROOM_VALUE_UPDATA,this.changeValue,this)},e}(MissionShishiPro);__reflect(MissionMultiPro.prototype,"MissionMultiPro");var MissionMultiRoom=function(t){function e(){var e=t.call(this)||this;return e.m_isReady=0,e.m_posList=[],e.m_pathStr="",e.m_off_list=[],e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/missionMultiUI/page/MissionMultiRoomSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.m_effect||(this.m_effect=new EffectMovieClip,this.m_effect.touchEnabled=!1,this.u_grpInfo.addChild(this.m_effect));var t=Number(StaticDataJson.getData("many_people_shishi_rate").data)/100;this.m_maxPart=ShiShiRoomManager.instance.getRoomMaxPeople(),this.u_txtcopy.text=LanguageJson.getText("l_multi_room_copy"),this.u_txtInfo.text=LanguageJson.getText("l_multi_room_info"),this.u_txtSingle.textFlow=LanguageJson.getHtmlTextFlow("l_mission_multi_single"),this.u_txtAward.textFlow=LanguageJson.getHtmlTextFlow("l_mission_multi_award",[t]),this.u_txtMana.textFlow=LanguageJson.getHtmlTextFlow("l_mission_multi_entry"),TextUtil.setLink(this.u_txtcopy);for(var e=1;e<=this.m_maxPart;e++){var i=new MissionMultiHead(e);this.u_grpHead.addChild(i),this.m_posList.push(i)}},e.prototype.initEvent=function(){this.registerEventClick(this.u_btnLeave,this.onLeave,this,!0),this.registerEventClick(this.u_btnReady,this.onReady,this,!0,SoundEnum.EFFECT_SOUND_1012),this.registerEventClick(this.u_btnStart,this.onStart,this,!0),this.registerEventClick(this.u_txtcopy,this.onCopy,this)},e.prototype.onCopy=function(t){TextUtil.setTextCopy(this.m_data.invitation_code),FloatTipModule.instance.popTipLanguage("l_multi_room_tips_3")},e.prototype.onLeave=function(t){var e=LanguageJson.getText("l_multi_leave_2"),i=LanguageJson.getText("l_btn_yes"),s=LanguageJson.getText("l_btn_no");PopupModule.instance.showTishi(e,this.sureLeave.bind(this),null,i,s)},e.prototype.sureLeave=function(t){1==t&&ShiShiRoomManager.instance.s_shi_shi_room_leave_room()},e.prototype.onReady=function(t){if(0==this.m_isReady){if(!this.checkMana())return;ShiShiRoomManager.instance.s_shi_shi_room_ready(1)}else ShiShiRoomManager.instance.s_shi_shi_room_ready(0)},e.prototype.onStart=function(t){ShiShiRoomManager.instance.s_shi_shi_room_start()},e.prototype.checkMana=function(){if(BagManager.instance.gold<this.m_json.mana_enter_list[0])return BagManager.instance.noEnoughGold(),!1;var t=SceneJson.getData(this.m_json.scene_id),e=Number(this.m_json.mana_attack_list[0])*t.drop_per/1e4;return BagManager.instance.gold<e?void BagManager.instance.noEnoughGold():!0},e.prototype.show=function(t){if(void 0===t&&(t=null),this.checkComplete(this.show,t)&&(this.recoverAllTexture(this,!0),this.m_data=ShiShiRoomManager.instance.p_roomInfo,this.m_data)){this.m_json=MissionJson.getData(MissionTypeEnum.MANY_PEOPLE_SHISHI,this.m_data.room_data.mission_id),this.m_off_list=StaticDataJson.parseStrToList("many_people_shishi_ui_off_list"+this.m_json.id),this.u_txtRoomId.textFlow=LanguageJson.getHtmlTextFlow("l_multi_room_id",[this.m_data.room_data.room_id]),this.u_txtCode.textFlow=LanguageJson.getHtmlTextFlow("l_multi_room_code",[this.m_data.invitation_code]),this.u_imgIcon1.x=this.u_txtMana.x+this.u_txtMana.width+4,this.u_txtEnteryCost.x=this.u_imgIcon1.x+32,this.u_txtEnteryCost.text=NumberUtil.numberToString(this.m_json.mana_enter_list[0]);var e=SceneJson.getData(this.m_json.scene_id);this.u_imgIcon2.x=this.u_txtSingle.x+this.u_txtSingle.width+4,this.u_txtSingleCost.x=this.u_imgIcon2.x+32,this.u_txtSingleCost.text=NumberUtil.numberToString(Number(this.m_json.mana_attack_list[0])*e.drop_per/1e4),this.m_pathStr=MonsterJson.getAvatarPath(this.m_json.boss_id),""!=this.m_pathStr&&(this.m_effect.setMC(this.m_pathStr),this.m_effect.play(),this.m_effect.x=82,this.m_effect.y=92,this.m_off_list[0]&&(this.m_effect.x+=this.m_off_list[0]),this.m_off_list[1]&&(this.m_effect.y+=this.m_off_list[1]),this.m_off_list[2]&&(this.m_effect.scaleX=this.m_effect.scaleY=this.m_off_list[2]));for(var i=0;i<this.m_posList.length;i++)this.m_posList[i].show();Dispatch.register(ShiShiRoomManager.EVENT_SHISHIROOM_OTHER_JOIN_ROOM,this.upData,this,!0),Dispatch.register(ShiShiRoomManager.EVENT_SHISHIROOM_LEAVE_ROOM,this.upData,this),Dispatch.register(ShiShiRoomManager.EVENT_SHISHIROOM_OWNER_UPDATA,this.ownerChange,this,!0),0==this.m_data.is_room_owner&&Dispatch.register(ShiShiRoomManager.EVENT_SHISHIROOM_MY_READY,this.changeReady,this,!0)}},e.prototype.ownerChange=function(){1==ShiShiRoomManager.instance.p_roomInfo.is_room_owner?(this.u_btnStart.visible=!0,this.u_btnLeave.visible=!1,this.u_btnReady.visible=!1):(this.u_btnStart.visible=!1,this.u_btnLeave.visible=!0,this.u_btnReady.visible=!0),this.u_txtOwner.textFlow=LanguageJson.getHtmlTextFlow("l_multi_room_owner",[this.m_data.owner_name,this.m_data.owner_level])},e.prototype.upData=function(){var t=ShiShiRoomManager.instance.getRoomPeople();this.u_txtPart.textFlow=LanguageJson.getHtmlTextFlow("l_multi_room_people",[t,this.m_maxPart])},e.prototype.changeReady=function(t){void 0===t&&(t=0),this.m_isReady=t,this.u_txtReady.text=1==this.m_isReady?LanguageJson.getText("l_btn_cancel"):LanguageJson.getText("l_btn_ready")},e.prototype.hide=function(){Dispatch.remove(ShiShiRoomManager.EVENT_SHISHIROOM_OTHER_JOIN_ROOM,this.upData,this),Dispatch.remove(ShiShiRoomManager.EVENT_SHISHIROOM_LEAVE_ROOM,this.upData,this),Dispatch.remove(ShiShiRoomManager.EVENT_SHISHIROOM_OWNER_UPDATA,this.ownerChange,this),Dispatch.remove(ShiShiRoomManager.EVENT_SHISHIROOM_MY_READY,this.changeReady,this),""!=this.m_pathStr&&this.m_effect.stop(),DisplayObjectUtils.removeFormParent(this)},Object.defineProperty(e.prototype,"width",{get:function(){return 640},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 1136},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(MissionMultiRoom.prototype,"MissionMultiRoom");var MissionMultiSelect=function(t){function e(){var e=t.call(this)||this;return e.m_layout=new eui.TileLayout,e.m_typeList=new eui.ArrayCollection,e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/missionMultiUI/view/MissionMultiSelectSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.u_scrollerItem.horizontalScrollBar=null,this.u_scrollerItem.verticalScrollBar=null,this.m_layout.requestedColumnCount=1,this.u_listItem.itemRenderer=MissionMultiSelectRender,this.u_listItem.layout=this.m_layout,this.u_listItem.dataProvider=this.m_typeList;var t=[0];this.m_missionIdList=t.concat(ShiShiRoomManager.instance.getMissionMultiIdList())},e.prototype.initEvent=function(){this.registerEventClick(this.u_btnClose,this.hide,this,!0)},e.prototype.show=function(t){void 0===t&&(t=null),this.checkComplete(this.show,t)&&(this.recoverAllTexture(this,!0),this.scaleY=0,TweenLite.to(this,.3,{scaleY:1}),this.m_typeList.source=this.m_missionIdList,this.u_scrollerItem.viewport.scrollV=0,Dispatch.register(StageManager.EVENT_STAGE_CLICK,this.onStageClick,this),Dispatch.register(MissionMultiSelectRender.EVENT_MISSION_MULTI_RATE_SELECT,this.hide,this))
},e.prototype.onStageClick=function(t){var e=this.localToGlobal(0,0);t.stageX>=e.x&&t.stageX<=e.x+this.width&&t.stageY>=e.y&&t.stageY<=e.y+this.height||(this.hide(),SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_1007))},e.prototype.hide=function(){MissionMultiList.p_isClick=!1,Dispatch.remove(StageManager.EVENT_STAGE_CLICK,this.onStageClick,this),Dispatch.remove(MissionMultiSelectRender.EVENT_MISSION_MULTI_RATE_SELECT,this.hide,this),TweenLite.to(this,.3,{scaleY:0,onComplete:this.sureHide.bind(this)})},e.prototype.sureHide=function(){DisplayObjectUtils.removeFormParent(this)},Object.defineProperty(e.prototype,"width",{get:function(){return 420},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 595},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(MissionMultiSelect.prototype,"MissionMultiSelect");var MissionShishiUI=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/missionShishiUI/MissionShishiUISkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.m_dataList=ActivityInfoJson.getListByType(4),this.u_txtDesc.textFlow=LanguageJson.getHtmlTextFlow("l_shishi_rule"),this.m_monsterId=MissionJson.getData(MissionTypeEnum.SHISHI_BOSS,1).boss_id},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnGame,this.onPlayGame,this,!0,SoundEnum.EFFECT_SOUND_1014)},e.prototype.onPlayGame=function(t){MissionManager.instance.s_mission_challenge_mission(MissionTypeEnum.SHISHI_BOSS,1)},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),this.m_effect||(this.m_effect=new EffectMovieClip,this.m_effect.x=310,this.m_effect.y=480,this.m_effect.scaleX=-1,this.m_effect.setMC(MonsterJson.getAvatarPath(this.m_monsterId,"stand",4))),this.addChild(this.m_effect),this.m_effect.play())},e.prototype.hide=function(e,i){this.m_effect&&(this.m_effect.destory(),this.m_effect=null),t.prototype.hide.call(this,e,i)},e}(UIBase);__reflect(MissionShishiUI.prototype,"MissionShishiUI");var MissionShishiFirst=function(t){function e(){var e=t.call(this)||this;return e.m_layout=new eui.TileLayout,e.m_typeList=new eui.ArrayCollection,e.m_time=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/missionShishiUI/popup/MissionShishiFirstSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_scrollerItem.horizontalScrollBar=null,this.u_scrollerItem.verticalScrollBar=null,this.m_layout.requestedColumnCount=1,this.m_layout.verticalGap=20,this.u_listItem.itemRenderer=MissionShishiWiner,this.u_listItem.layout=this.m_layout,this.u_listItem.dataProvider=this.m_typeList},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.setCloseBtn(this.u_btnClose),this.setCloseBtn(this.u_btnOK)},e.prototype.showView=function(e){if(void 0===e&&(e=null),this.checkComplete(this.showView,e)){if(t.prototype.showView.call(this,e),e){var i=e.winName,s=Number(e.value),n=Number(e.totalCost),o=e.secondList;this.u_txtName.textFlow=LanguageJson.getHtmlTextFlow("l_shishi_boss_msg_1",[i]),this.u_txtMana.text=LanguageJson.getHtmlText("l_shishi_boss_mana"),this.u_txtCost.text=LanguageJson.getHtmlText("l_missiom_game_cost"),this.u_txtCount.text=NumberUtil.numberDecimalism(s),this.u_txtCount2.text=NumberUtil.numberDecimalism(n),this.u_imgGold2.source=BagManager.instance.getIconPath(3),this.u_imgGold.x=this.u_txtMana.x+this.u_txtMana.width-10,this.u_txtCount.x=this.u_imgGold.x+this.u_imgGold.width,this.u_imgGold2.x=this.u_txtCost.x+this.u_txtCost.width-10,this.u_txtCount2.x=this.u_imgGold2.x+this.u_imgGold2.width,o.length>=2?this.u_scrollerItem.height=120:this.u_scrollerItem.height=60,this.m_typeList.source=o,this.startTimeDo()}SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_1003)}},e.prototype.startTimeDo=function(){this.m_time=8,TimeManager.instance.doLoop(this.refreshTime,this,1e3)},e.prototype.refreshTime=function(){return this.u_txtOK.text=LanguageJson.getText("l_btn_ok")+"("+this.m_time+")",this.m_time<=0?(TimeManager.instance.clearTimer(this.refreshTime,this),void this.close()):void this.m_time--},e.prototype.hide=function(e,i){TimeManager.instance.clearTimer(this.refreshTime,this),t.prototype.hide.call(this,e,i)},Object.defineProperty(e.prototype,"isClickBMask",{get:function(){return!1},enumerable:!0,configurable:!0}),e}(PopupBase);__reflect(MissionShishiFirst.prototype,"MissionShishiFirst");var MissionShishiSecond=function(t){function e(){var e=t.call(this)||this;return e.m_time=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/missionShishiUI/popup/MissionShishiSecondSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.setCloseBtn(this.u_btnClose),this.setCloseBtn(this.u_btnOK)},e.prototype.showView=function(e){if(void 0===e&&(e=null),this.checkComplete(this.showView,e)){if(t.prototype.showView.call(this,e),e&&e.winName&&e.value){var i=e.winName,s=Number(e.value);this.u_txtName.textFlow=LanguageJson.getHtmlTextFlow("l_shishi_boss_msg_2",[i]),this.u_txtMana.text=LanguageJson.getHtmlText("l_shishi_boss_mana"),this.u_txtCount.text=NumberUtil.numberDecimalism(s),this.u_imgGold.x=this.u_txtMana.x+this.u_txtMana.width-10,this.u_txtCount.x=this.u_imgGold.x+this.u_imgGold.width,this.startTimeDo()}SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_1003)}},e.prototype.startTimeDo=function(){this.m_time=8,TimeManager.instance.doLoop(this.refreshTime,this,1e3)},e.prototype.refreshTime=function(){return this.u_txtOK.text=LanguageJson.getText("l_btn_ok")+"("+this.m_time+")",this.m_time<=0?(TimeManager.instance.clearTimer(this.refreshTime,this),void this.close()):void this.m_time--},e.prototype.hide=function(e,i){TimeManager.instance.clearTimer(this.refreshTime,this),t.prototype.hide.call(this,e,i)},Object.defineProperty(e.prototype,"isClickBMask",{get:function(){return!1},enumerable:!0,configurable:!0}),e}(PopupBase);__reflect(MissionShishiSecond.prototype,"MissionShishiSecond");var MissionShishiWiner=function(t){function e(){return t.call(this,"resource/eui_skins/missionShishiUI/render/MissionShishiWinerSkin.exml")||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this)},e.prototype.dataChanged=function(){this.checkComplete(this.dataChanged)&&(t.prototype.dataChanged.call(this),this.m_data=this.data,this.u_txtName.textFlow=LanguageJson.getHtmlTextFlow("l_shishi_boss_msg_2",[this.m_data.lastWinName]),this.u_txtMana.text=LanguageJson.getHtmlText("l_shishi_boss_mana"),this.u_txtCount.text=NumberUtil.numberDecimalism(Number(this.m_data.lastValue)),this.u_imgGold.x=this.u_txtMana.x+this.u_txtMana.width-10,this.u_txtCount.x=this.u_imgGold.x+this.u_imgGold.width)},e}(ItemRendererBase);__reflect(MissionShishiWiner.prototype,"MissionShishiWiner");var ColorJson=function(){function t(){}return t.getData=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},t.getColorNum=function(t){return this.getData(t)?Number("0x"+this.getData(t).color_value):16777215},t.getColorStr=function(t){return this.getData(t)?"#"+this.getData(t).color_value:"#ffffff"},Object.defineProperty(t,"red",{get:function(){return this.getColorNum(ColorEnum.C_RED)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"green",{get:function(){return this.getColorNum(ColorEnum.C_GREEN)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"jsonData",{get:function(){return this.m_jsonData=JsonUtil.analyzeJsonStr(this.FileName,this.m_jsonData),this.m_jsonData},set:function(t){this.m_jsonData=t},enumerable:!0,configurable:!0}),t.FileName="color",t}();__reflect(ColorJson.prototype,"ColorJson"),window.ColorJson=ColorJson;var MissionUIModule=function(t){function e(){var e=t.call(this)||this;return e.m_hideEffectList={},e.m_missionEndTime=0,e.m_finishTime=-1,e.m_donSendType=[],e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.m_instance||(this.m_instance=new e),this.m_instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){Dispatch.register(MissionManager.EVENT_EXIT_MISSION,this.exitMission,this),Dispatch.register(StageManager.EVENT_STAGE_RESIZE,this.stageResize,this),Dispatch.register(SceneManager.EVENT_ENTER_SCENE,this.enterScene,this)},e.prototype.getPlayerEffect=function(t){return this.m_hideEffectList[t]?this.m_hideEffectList[t].showEffect:!0},e.prototype.getPlayerShield=function(t){return this.m_hideEffectList[t]?this.m_hideEffectList[t].showShield:!0},e.prototype.enterScene=function(){SceneModule.instance.isMissionScene&&(MissionManager.instance.missionType!=MissionTypeEnum.MISSION_SCENE_BOSS_LOCATION&&MissionManager.instance.missionType!=MissionTypeEnum.MISSION_SCENE_BOSS_TIME_AND_COUNT&&this.showMissionTimeTip(),(MissionManager.instance.missionType==MissionTypeEnum.MANY_PEOPLE_BOSS||MissionManager.instance.missionType==MissionTypeEnum.WORLD_BOSS||MissionManager.instance.missionType==MissionTypeEnum.SHISHI_BOSS||MissionManager.instance.missionType==MissionTypeEnum.MANY_PEOPLE_SHISHI)&&this.showRank(),MissionManager.instance.missionType==MissionTypeEnum.PAGODA&&(this.m_timeShow&&(this.m_timeShow.y=240),this.showMissionPoint()),MissionManager.instance.missionType==MissionTypeEnum.GUESS_BOSS&&(this.showLuckBossTop(),UIModule.instance.hideMainFight(),MyMapModule.instance.showHideTouchControl(!1)),MissionManager.instance.missionType==MissionTypeEnum.SHISHI_BOSS&&(this.m_timeShow.y=255,this.showShiShiPro()),MissionManager.instance.missionType==MissionTypeEnum.MANY_PEOPLE_SHISHI&&(this.m_timeShow.y=255,this.showMissionMultiPro()))},e.prototype.showMissionTimeTip=function(){this.m_timeShow||(this.m_timeShow=new MissionUITime),this.m_timeShow.y=100,this.m_timeShow.show()},e.prototype.showMissionPoint=function(){this.m_pointShow||(this.m_pointShow=new MissionUIPoint),this.m_pointShow.show()},e.prototype.exitMission=function(){this.m_rankView&&this.m_rankView.hide(),this.m_timeShow&&this.m_timeShow.hide(),this.m_pointShow&&this.m_pointShow.hide(),this.m_guessBtn&&this.m_guessBtn.hide(),this.m_guessMyCost&&this.m_guessMyCost.hide(),this.m_shishiPro&&this.m_shishiPro.hide(),this.m_missionMultiPro&&this.m_missionMultiPro.hide(),this.m_guessInfo&&this.m_guessInfo.hide(),this.hideMissionEndTime(),MyMapModule.instance.showHideTouchControl(!0)},e.prototype.showRank=function(){this.m_rankView||(this.m_rankView=new MissionRank),this.m_rankView.x=(StageManager.instance.p_stageWidth-640)/2+640-this.m_rankView.width,this.m_rankView.y=StageManager.instance.p_stageHeight-375,UIModule.instance.downUILayer1.addChild(this.m_rankView),this.m_rankView.show()},e.prototype.showGuessBtn=function(){this.m_guessBtn||(this.m_guessBtn=new GuessRecordBtn,this.m_guessBtn.x=(StageManager.instance.p_stageWidth-640)/2+540,this.m_guessBtn.y=160),UIModule.instance.downUILayer1.addChild(this.m_guessBtn)},e.prototype.showGuessMyCost=function(){this.m_guessMyCost||(this.m_guessMyCost=new GuessMyCost,this.m_guessMyCost.x=(StageManager.instance.p_stageWidth-640)/2+640-this.m_guessMyCost.width,this.m_guessMyCost.y=StageManager.instance.p_stageHeight-121-this.m_guessMyCost.height),UIModule.instance.downUILayer1.addChild(this.m_guessMyCost),this.m_guessMyCost.show()},e.prototype.showGuessInfo=function(){SceneModule.instance.isMissionScene&&(this.m_guessInfo||(this.m_guessInfo=new GuessInfoView),UIModule.instance.downUILayer1.addChild(this.m_guessInfo),this.m_guessInfo.showView())},e.prototype.showLuckBossTop=function(){SceneModule.instance.isMissionScene&&(this.m_luckBossTop||(this.m_luckBossTop=new LuckBossFightTop,this.m_luckBossTop.x=(StageManager.instance.p_stageWidth-this.m_luckBossTop.width)/2,this.m_luckBossTop.y=0),UIModule.instance.downUILayer1.addChild(this.m_luckBossTop),this.m_luckBossTop.showView())},e.prototype.showShiShiPro=function(){this.m_shishiPro||(this.m_shishiPro=new MissionShishiPro,this.m_shishiPro.y=160),UIModule.instance.downUILayer1.addChild(this.m_shishiPro),this.m_shishiPro.show()},e.prototype.showMissionMultiPro=function(){this.m_missionMultiPro||(this.m_missionMultiPro=new MissionMultiPro,this.m_missionMultiPro.y=160),UIModule.instance.downUILayer1.addChild(this.m_missionMultiPro),this.m_missionMultiPro.show()},e.prototype.finishMission=function(t){if(2==t.result);else{var e=MissionJson.getData(t.mission_type,t.mission_id);e&&MonsterDropJson.getData(e.boss_id)?TweenLite.delayedCall(2.2,this.successMissionShow.bind(this),[t]):this.successMissionShow(t)}},e.prototype.successMissionShow=function(t){t.mission_type==MissionTypeEnum.PAGODA||this.showMissionFinish(t)},e.prototype.showMissionFinish=function(t){PopupModule.instance.showPop(PopupConfig.ID_MISSION_FAIL,{msg:LanguageJson.getText("l_missiom_fail")})},e.prototype.showMissionEndTime=function(t){this.m_missionEndTimeLabel||(this.m_missionEndTimeLabel=new eui.Label,this.m_missionEndTimeLabel.size=28,this.m_missionEndTimeLabel.textColor=ColorJson.red,this.m_missionEndTimeLabel.width=300,this.m_missionEndTimeLabel.textAlign="center",this.m_missionEndTimeLabel.bold=!0,this.m_missionEndTimeLabel.stroke=1,this.m_missionEndTimeLabel.strokeColor=1973790,this.m_missionEndTimeLabel.y=230),this.m_missionEndTimeLabel.x=.5*(StageManager.instance.p_stageWidth-300),this.m_missionEndTime=t,this.m_missionEndTime<=0&&this.hideMissionEndTime(),TimeManager.instance.clearTimer(this.runMissionEndTime,this),TimeManager.instance.doLoop(this.runMissionEndTime,this,1e3),UIModule.instance.downUILayer1.addChild(this.m_missionEndTimeLabel)},e.prototype.hideMissionEndTime=function(){TimeManager.instance.clearTimer(this.runMissionEndTime,this),DisplayObjectUtils.removeFormParent(this.m_missionEndTimeLabel)},e.prototype.runMissionEndTime=function(){return this.m_missionEndTime<=0?(TimeManager.instance.clearTimer(this.runMissionEndTime,this),void(this.m_missionEndTimeLabel.text="")):(this.m_missionEndTimeLabel.text="副本剩余时间"+TimeUtil.toDurTimestring(1e3*this.m_missionEndTime,"mm:ss"),void this.m_missionEndTime--)},e.prototype.showFinishTime=function(t){this.m_finishTime!=t&&(this.m_countNum||(this.m_countNum=new NumberView("num_max_time_",0,-10),this.m_countNum.verticalCenter=0,this.m_countNum.horizontalCenter=0),UIModule.instance.downUILayer2.addChild(this.m_countNum),this.m_finishTime=t,this.m_countNum.numValue=this.m_finishTime,this.m_countNum.alpha=1,this.m_countNum.scaleX=this.m_countNum.scaleY=1,TweenLite.killTweensOf(this.m_countNum),TweenLite.to(this.m_countNum,1,{scaleX:.6,scaleY:.6,alpha:0,ease:Back.easeIn}))},e.prototype.hideFullTime=function(){this.m_countNum&&(TweenLite.killTweensOf(this.m_countNum),DisplayObjectUtils.removeFormParent(this.m_countNum))},e.prototype.stageResize=function(){null!=this.m_guessBtn&&null!=this.m_guessBtn.parent&&(this.m_guessBtn.x=(StageManager.instance.p_stageWidth-640)/2+540,this.m_guessBtn.y=160),null!=this.m_missionEndTimeLabel&&null!=this.m_missionEndTimeLabel.parent&&(this.m_missionEndTimeLabel.x=.5*(StageManager.instance.p_stageWidth-300))},Object.defineProperty(e.prototype,"isDonSend",{get:function(){return-1==this.m_donSendType.indexOf(MissionManager.instance.missionType)?!1:!0},enumerable:!0,configurable:!0}),e.prototype.setOpenUI=function(t){!GuideModule.instance.getIsGuiding()},e.prototype.setWaitTime=function(t){this.m_waitEndTime=t,TimeManager.instance.doLoop(this.waitTimeDo,this,1e3),this.m_waitEndTime>=0},e.prototype.waitTimeDo=function(){return this.m_waitEndTime<0?void TimeManager.instance.clearTimer(this.waitTimeDo,this):void this.m_waitEndTime--},e.prototype.showStartTime=function(t){this.m_startNum||(this.m_startNum=new NumberView("numberText_json.num_c_time_",0,-10),this.m_startNum.verticalCenter=0,this.m_startNum.horizontalCenter=0),UIModule.instance.downUILayer1.addChild(this.m_startNum),this.m_startNum.numValue=t,this.m_num=this.m_startNum.numValue,this.m_startNum.alpha=1,this.m_startNum.scaleX=this.m_startNum.scaleY=1,TweenLite.killTweensOf(this.m_startNum),TweenLite.to(this.m_startNum,1,{scaleX:.6,scaleY:.6,alpha:0,ease:Back.easeIn}),TimeManager.instance.doLoop(this.startTimeDo,this,1e3)},e.prototype.startTimeDo=function(){return this.m_num<=0?(TimeManager.instance.clearTimer(this.startTimeDo,this),TweenLite.killTweensOf(this.m_startNum),void DisplayObjectUtils.removeFormParent(this.m_startNum)):void this.m_num--},e}(egret.HashObject);__reflect(MissionUIModule.prototype,"MissionUIModule");var MissionRankRender=function(t){function e(){return t.call(this,"resource/eui_skins/missionJieSuanUI/render/MissionRankRenderSkin.exml")||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this),this.m_numberView||(this.m_numberView=new NumberView("num_rank_",0,0),this.u_grpRank.addChild(this.m_numberView),this.m_numberView.horizontalCenter=0,this.m_numberView.verticalCenter=0)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this)},e.prototype.dataChanged=function(){this.checkComplete(this.dataChanged)&&(t.prototype.dataChanged.call(this),this.m_data=this.data,this.m_data.ranking<=3?(this.m_numberView.visible=!1,this.u_imgRank.source="missionJieSuanUI_json.missionJieSuanUI_rank_"+this.m_data.ranking):(this.m_numberView.visible=!0,this.m_numberView.numValue=this.m_data.ranking,this.u_imgRank.source=null),this.u_txtName.text=this.m_data.player_name,this.u_txtSpend.text=this.m_data.hurt+"",(MissionManager.instance.missionType==MissionTypeEnum.WORLD_BOSS||MissionManager.instance.missionType==MissionTypeEnum.SHISHI_BOSS||MissionManager.instance.missionType==MissionTypeEnum.MANY_PEOPLE_SHISHI)&&this.rateCount())},e.prototype.rateCount=function(){var t=0;if(MissionManager.instance.missionType==MissionTypeEnum.WORLD_BOSS&&MissionRank.p_monsterId>0){var e=MonsterJson.getData(MissionRank.p_monsterId);e.new_ling_li&&(t=NumberUtil.toFixed(this.m_data.hurt/e.new_ling_li*100,2))}(MissionManager.instance.missionType==MissionTypeEnum.SHISHI_BOSS||MissionManager.instance.missionType==MissionTypeEnum.MANY_PEOPLE_SHISHI)&&MissionRank.p_totalHurt>0&&(t=NumberUtil.toFixed(this.m_data.hurt/MissionRank.p_totalHurt*100,2)),t>100&&(t=100),this.u_txtSpend.text=LanguageJson.getHtmlText("l_missiom_rank_rate",[t])},e}(ItemRendererBase);__reflect(MissionRankRender.prototype,"MissionRankRender");var MissionRank=function(t){function e(){var e=t.call(this)||this;return e.m_layout=new eui.TileLayout,e.m_typeList=new eui.ArrayCollection,e.m_showTypeX=1,e.m_showTypeY=1,e.m_isClick=!1,e.m_time=10,e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/missionJieSuanUI/MissionRankSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.u_scrollerItem.horizontalScrollBar=null,this.u_scrollerItem.verticalScrollBar=null,this.m_layout.requestedColumnCount=1,this.u_listItem.itemRenderer=MissionRankRender,this.u_listItem.layout=this.m_layout,this.u_listItem.dataProvider=this.m_typeList,this.m_numberView||(this.m_numberView=new NumberView("num_rank_",0,0),this.u_grpMyRank.addChild(this.m_numberView),this.m_numberView.verticalCenter=0,this.m_numberView.horizontalCenter=0)},e.prototype.initEvent=function(){this.u_btnShow.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChange,this),this.u_btnMore.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChange2,this)},e.prototype.onChange=function(t){void 0===t&&(t=null),this.m_isClick||(this.m_isClick=!0,1==this.m_showTypeX?(this.m_showTypeX=2,TweenLite.to(this.u_grpRank,.4,{scaleX:0}),TweenLite.to(this.u_btnShow,.5,{scaleX:-1,onComplete:this.changeState.bind(this)})):(this.m_showTypeX=1,this.u_grpRank.visible=!0,TweenLite.to(this.u_grpRank,.4,{scaleX:1}),TweenLite.to(this.u_btnShow,.5,{scaleX:1,onComplete:this.changeState.bind(this)})),SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_1007))},e.prototype.onChange2=function(t){this.m_isClick||(this.m_isClick=!0,1==this.m_showTypeY?(this.m_showTypeY=2,TweenLite.to(this.u_scrollerItem,.4,{height:350}),TweenLite.to(this.u_imgBg,.4,{height:450}),TweenLite.to(this,.4,{y:this.y-245}),TweenLite.to(this.u_btnMore,.5,{scaleY:-1,onComplete:this.changeState.bind(this)})):(this.m_showTypeY=1,TweenLite.to(this.u_scrollerItem,.4,{height:105}),TweenLite.to(this.u_imgBg,.4,{height:205}),TweenLite.to(this,.4,{y:this.y+245}),TweenLite.to(this.u_btnMore,.5,{scaleY:1,onComplete:this.changeState.bind(this)})),SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_1007))},e.prototype.changeState=function(){this.m_isClick=!1,2==this.m_showTypeX&&(this.u_grpRank.visible=!1)},e.prototype.show=function(t){if(void 0===t&&(t=null),this.checkComplete(this.show,t)){this.m_showTypeX=1,this.m_showTypeY=1,this.u_btnShow.scaleX=1,this.u_btnMore.scaleY=1,this.u_grpRank.scaleX=1,this.u_imgBg.height=205,this.u_scrollerItem.height=105,this.u_grpRank.visible=!0;var i=MissionJson.getData(MissionManager.instance.missionType,MissionManager.instance.missionId);e.p_monsterId=i.boss_id,Dispatch.register(MissionManager.MISSION_HURE_RANKING,this.upData,this),this.startTimeDo()}},e.prototype.resetRank=function(){this.m_ranking.self_rank=0,this.m_ranking.self_hurt=0,this.m_ranking.hurt_ranking_list=[],this.upData()},e.prototype.upData=function(){this.m_ranking=MissionManager.instance.getHurtRanking(MissionManager.instance.missionType),this.m_numberView.numValue=this.m_ranking.self_rank,this.u_txtMySpend.x=193,this.u_txtMySpend.text=this.m_ranking.self_hurt+"",this.u_imgRate.source="missionJieSuanUI_json.missionJieSuanUI_mana",this.u_imgMyRate.source="missionJieSuanUI_json.missionJieSuanUI_my_spend",(MissionManager.instance.missionType==MissionTypeEnum.WORLD_BOSS||MissionManager.instance.missionType==MissionTypeEnum.SHISHI_BOSS||MissionManager.instance.missionType==MissionTypeEnum.MANY_PEOPLE_SHISHI)&&this.rateCount();var t=this.m_ranking.hurt_ranking_list;ArrayUtils.setSortArr(t,["ranking"],[0]),this.m_typeList.source=t},e.prototype.rateCount=function(){this.u_txtMySpend.x=237,this.u_imgRate.source="missionJieSuanUI_json.missionJieSuanUI_ss_pro",this.u_imgMyRate.source="missionJieSuanUI_json.missionJieSuanUI_ss_myPro";var t=0;if(MissionManager.instance.missionType==MissionTypeEnum.WORLD_BOSS){var i=MonsterJson.getData(e.p_monsterId);i&&i.new_ling_li&&(t=NumberUtil.toFixed(this.m_ranking.self_hurt/i.new_ling_li*100,2))}(MissionManager.instance.missionType==MissionTypeEnum.SHISHI_BOSS||MissionManager.instance.missionType==MissionTypeEnum.MANY_PEOPLE_SHISHI)&&(e.p_totalHurt=this.getTotalHurt(),e.p_totalHurt>0&&(t=NumberUtil.toFixed(this.m_ranking.self_hurt/e.p_totalHurt*100,2))),t>100&&(t=100),this.u_txtMySpend.text=LanguageJson.getHtmlText("l_missiom_rank_rate",[t])},e.prototype.getTotalHurt=function(){var t=0,e=this.m_ranking.hurt_ranking_list;for(var i in e)e[i].hurt&&(t+=e[i].hurt);return t},e.prototype.startTimeDo=function(){this.m_time=10,TimeManager.instance.doLoop(this.refreshTime,this,1e3)},e.prototype.refreshTime=function(){return this.m_time<=0?(TimeManager.instance.clearTimer(this.refreshTime,this),void(1==this.m_showTypeX&&this.onChange())):void this.m_time--},e.prototype.hide=function(){TweenLite.killTweensOf(this.u_grpRank),TweenLite.killTweensOf(this.u_btnShow),TweenLite.killTweensOf(this.u_imgBg),TweenLite.killTweensOf(this.u_scrollerItem),TweenLite.killTweensOf(this.u_btnMore),TimeManager.instance.clearTimer(this.refreshTime,this),Dispatch.remove(MissionManager.MISSION_HURE_RANKING,this.upData,this),DisplayObjectUtils.removeFormParent(this)},Object.defineProperty(e.prototype,"width",{get:function(){return 334},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.u_imgBg.height+56},enumerable:!0,configurable:!0}),e.p_monsterId=0,e.p_totalHurt=0,e}(ComponentBase);__reflect(MissionRank.prototype,"MissionRank");var MissionUIPoint=function(t){function e(){var e=t.call(this)||this;return e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/missionJieSuanUI/MissionUIPointSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.m_numberView||(this.m_numberView=new NumberView("missionText_json.missionText_num_",0,-5),this.u_grpLv.addChild(this.m_numberView),this.m_numberView.x=85,this.m_numberView.y=1)},e.prototype.initEvent=function(){},e.prototype.show=function(t){void 0===t&&(t=null),this.checkComplete(this.show,t)&&(null==this.parent&&UIModule.instance.downUILayer1.addChild(this),Dispatch.register(StageManager.EVENT_STAGE_RESIZE,this.stageResize,this,!0))},e.prototype.stageResize=function(){this.x=(StageManager.instance.p_stageWidth-this.width)/2,this.y=165},e.prototype.hide=function(){DisplayObjectUtils.removeFormParent(this),Dispatch.remove(StageManager.EVENT_STAGE_RESIZE,this.stageResize,this)},Object.defineProperty(e.prototype,"width",{get:function(){return 364},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 78},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(MissionUIPoint.prototype,"MissionUIPoint");var MissionUITime=function(t){function e(){var e=t.call(this)||this;return e.m_state=1,e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/missionJieSuanUI/MissionUITimeSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.touchEnabled=!1,this.touchChildren=!1,this.initView(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.m_numberView||(this.m_numberView=new NumberView("numberText_json.num_c_time_",0,-5),this.u_grpTime.addChild(this.m_numberView),this.m_numberView.horizontalCenter=0,this.m_numberView.verticalCenter=-2)},e.prototype.show=function(t){void 0===t&&(t=null),this.checkComplete(this.show,t)&&(null==this.parent&&UIModule.instance.downUILayer1.addChild(this),Dispatch.register(MissionManager.EVENT_TIME_MISSION,this.setTimeDown,this,!0),Dispatch.register(StageManager.EVENT_STAGE_RESIZE,this.stageResize,this,!0))},e.prototype.setTimeDown=function(t){void 0===t&&(t=1),this.m_state=t,this.u_imgTime.source="missionJieSuanUI_json.missionJieSuanUI_time_1",this.showTimeState(),MissionManager.instance.missionTime<=0?(this.visible=!1,TimeManager.instance.clearTimer(this.setTimeMissionItem,this)):(this.visible=!0,TimeManager.instance.doLoop(this.setTimeMissionItem,this,1e3))},e.prototype.setTimeMissionItem=function(){var t=MissionManager.instance.missionTime-ServerTimeManager.instance.timer;if(0>=t)return this.visible=!1,void TimeManager.instance.clearTimer(this.setTimeMissionItem,this);var e;t>10?e=TimeUtil.toDurTimestring(1e3*t,"mm:ss"):(e=t+"",this.m_numberView.scaleX=2.5,this.m_numberView.scaleY=2.5,TweenLite.to(this.m_numberView,.4,{scaleX:1,scaleY:1})),e=e.replace(/:/g,"d"),this.m_numberView.setMsgString(e)},e.prototype.showTimeState=function(){MissionManager.instance.missionType==MissionTypeEnum.GUESS_BOSS&&(0==this.m_state?this.u_imgTime.source="missionJieSuanUI_json.missionJieSuanUI_time_2":this.u_imgTime.source="missionJieSuanUI_json.missionJieSuanUI_time_1"),MissionManager.instance.missionType==MissionTypeEnum.SHISHI_BOSS&&(0==this.m_state?this.u_imgTime.source="missionJieSuanUI_json.missionJieSuanUI_time_2":1==this.m_state?this.u_imgTime.source="missionJieSuanUI_json.missionJieSuanUI_ss_first_prize":this.u_imgTime.source="missionJieSuanUI_json.missionJieSuanUI_ss_second_prize"),this.u_grpTime.x=this.u_imgTime.x+this.u_imgTime.width},e.prototype.stageResize=function(){this.x=(StageManager.instance.p_stageWidth-this.width)/2},e.prototype.hide=function(){DisplayObjectUtils.removeFormParent(this),Dispatch.remove(MissionManager.EVENT_TIME_MISSION,this.setTimeDown,this),Dispatch.remove(StageManager.EVENT_STAGE_RESIZE,this.stageResize,this),TimeManager.instance.clearTimer(this.setTimeMissionItem,this)},Object.defineProperty(e.prototype,"width",{get:function(){return 321},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 40},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(MissionUITime.prototype,"MissionUITime");var MonsterInfoUI=function(t){function e(){var e=t.call(this)||this;return e.m_disposeUrlList.push("monsterInfoUI_json"),e.m_currList.push({funcKey:1,pageMc:new MonsterInfoPage(1)}),e.m_currList.push({funcKey:2,pageMc:new MonsterInfoPage(2)}),e.m_currList.push({funcKey:3,pageMc:new MonsterInfoPage(3)}),e.m_currList.push({funcKey:4,pageMc:new MonsterInfoPage(4)}),e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/monsterInfoUI/MonsterInfoUISkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this);var e="monsterInfoUI_json.monsterInfoUI_btn_icon",i=[{key:1,btnName:"monsterInfoUI_btn_boss",btnNameBj:e,posXY:[20,170]},{key:2,btnName:"monsterInfoUI_btn_sj",btnNameBj:e,posXY:[20,249]},{key:3,btnName:"monsterInfoUI_btn_txg",btnNameBj:e,posXY:[20,328]},{key:4,btnName:"monsterInfoUI_btn_xg",btnNameBj:e,posXY:[20,407]}];this.m_pageSelect.setDataList(i)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this)},e.prototype.showView=function(i){void 0===i&&(i=null),this.checkComplete(this.showView,i)&&(i&&i.c_sceneId?e.p_sceneId=i.c_sceneId:e.p_sceneId=SceneManager.instance.p_sceneId,t.prototype.showView.call(this,i))},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i)},e.prototype.sureHide=function(i,s){void 0===i&&(i=null),void 0===s&&(s=null),t.prototype.sureHide.call(this,i,s);for(var n in e.p_urlList)RES.destroyRes(e.p_urlList[n]);e.p_urlList=[]},e.p_urlList=[],e.p_sceneId=0,e}(UIBase);__reflect(MonsterInfoUI.prototype,"MonsterInfoUI");var MonsterInfoPage=function(t){function e(e){var i=t.call(this)||this;return i.m_type=e,i}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/monsterInfoUI/page/MonsterInfoPageSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this)},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),this.showChange())},e.prototype.showChange=function(){if(this.m_type)switch(this.m_type){case 1:this.m_bossView||(this.m_bossView=new MonsterInfoBoss,this.m_bossView.x=0,this.m_bossView.y=0),this.addChild(this.m_bossView),this.m_bossView.show(this.m_type),this.m_eventView&&this.m_eventView.hide(),this.m_specView&&this.m_specView.hide(),this.m_smallView&&this.m_smallView.hide();break;case 2:this.m_eventView||(this.m_eventView=new MonsterInfoEvent,this.m_eventView.x=0,this.m_eventView.y=0),this.addChild(this.m_eventView),this.m_eventView.show(this.m_type),this.m_bossView&&this.m_bossView.hide(),this.m_specView&&this.m_specView.hide(),this.m_smallView&&this.m_smallView.hide();break;case 3:this.m_specView||(this.m_specView=new MonsterInfoSpec,this.m_specView.x=0,this.m_specView.y=0),this.addChild(this.m_specView),this.m_specView.show(this.m_type),this.m_bossView&&this.m_bossView.hide(),this.m_eventView&&this.m_eventView.hide(),this.m_smallView&&this.m_smallView.hide();break;case 4:this.m_smallView||(this.m_smallView=new MonsterInfoSmall,this.m_smallView.x=0,this.m_smallView.y=0),this.addChild(this.m_smallView),this.m_smallView.show(this.m_type),this.m_bossView&&this.m_bossView.hide(),this.m_eventView&&this.m_eventView.hide(),this.m_specView&&this.m_specView.hide()}},e.prototype.hide=function(e){void 0===e&&(e=null),t.prototype.hide.call(this)
},e}(PageBase);__reflect(MonsterInfoPage.prototype,"MonsterInfoPage");var MonsterInfoBossRender=function(t){function e(){return t.call(this,"resource/eui_skins/monsterInfoUI/render/MonsterInfoBossRenderSkin.exml")||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this)},e.prototype.dataChanged=function(){if(this.checkComplete(this.dataChanged)){t.prototype.dataChanged.call(this),this.m_bossData=this.data;var e=PublicCon.PATH_SCENE_MONSTER+this.m_bossData.icon_id+".png";this.u_imgBg.source=null,this.u_imgBg.source=e;var i=PublicCon.PATH_SCENE_MONSTER_NAME+this.m_bossData.id+".png";this.u_imgBossName.source=null,this.u_imgBossName.source=i,this.u_txtBossDesc.textFlow=HtmlUtil.setTextFlow("    "+this.m_bossData.desc),-1==MonsterInfoUI.p_urlList.indexOf(e)&&MonsterInfoUI.p_urlList.push(e),-1==MonsterInfoUI.p_urlList.indexOf(i)&&MonsterInfoUI.p_urlList.push(i)}},e}(ItemRendererBase);__reflect(MonsterInfoBossRender.prototype,"MonsterInfoBossRender");var MonsterInfoEventRender=function(t){function e(){return t.call(this,"resource/eui_skins/monsterInfoUI/render/MonsterInfoEventRenderSkin.exml")||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this)},e.prototype.dataChanged=function(){if(this.checkComplete(this.dataChanged)){t.prototype.dataChanged.call(this),this.m_eventData=this.data;var e=PublicCon.PATH_SCENE_MONSTER+this.m_eventData.icon_id+".png";this.u_imgBg.source=null,this.u_imgBg.source=e;var i=PublicCon.PATH_SCENE_MONSTER_NAME+this.m_eventData.id+".png";this.u_imgEventName.source=null,this.u_imgEventName.source=i,this.u_txtEventDesc.textFlow=HtmlUtil.setTextFlow("     "+this.m_eventData.desc),-1==MonsterInfoUI.p_urlList.indexOf(e)&&MonsterInfoUI.p_urlList.push(e),-1==MonsterInfoUI.p_urlList.indexOf(i)&&MonsterInfoUI.p_urlList.push(i)}},e}(ItemRendererBase);__reflect(MonsterInfoEventRender.prototype,"MonsterInfoEventRender");var MonsterInfoSmallRender=function(t){function e(){return t.call(this,"resource/eui_skins/monsterInfoUI/render/MonsterInfoSmallRenderSkin.exml")||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this),this.m_bei||(this.m_bei=new NumberView("monsterInfoUI_",0,-7),this.u_grpBei.addChild(this.m_bei),this.m_bei.x=0,this.m_bei.y=0)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this)},e.prototype.dataChanged=function(){if(this.checkComplete(this.dataChanged)){t.prototype.dataChanged.call(this),this.m_data=this.data,this.u_txtName.text=this.m_data.name;var e=PublicCon.PATH_SCENE_MONSTER+this.m_data.icon_id+".png";this.u_imgMoster.source=null,this.u_imgMoster.source=e;var i=this.m_data.reward_per.replace("_","~");this.m_bei.setMsgString("$x"+i),this.m_data.quality&&(this.u_imgName.source="monsterInfoUI_json.monsterInfoUI_img_name"+this.m_data.quality),-1==MonsterInfoUI.p_urlList.indexOf(e)&&MonsterInfoUI.p_urlList.push(e)}},e}(ItemRendererBase);__reflect(MonsterInfoSmallRender.prototype,"MonsterInfoSmallRender");var MonsterInfoSpecRender=function(t){function e(){return t.call(this,"resource/eui_skins/monsterInfoUI/render/MonsterInfoSpecRenderSkin.exml")||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this),this.m_multiple||(this.m_multiple=new NumberView("monsterInfoUI_",220,-7),this.m_multiple.x=79.5,this.m_multiple.y=7)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this)},e.prototype.dataChanged=function(){if(this.checkComplete(this.dataChanged)){if(t.prototype.dataChanged.call(this),this.m_data=this.data,this.m_data){this.u_txtMosDesc.textFlow=HtmlUtil.setTextFlow("       "+this.m_data.desc);var e=PublicCon.PATH_SCENE_MONSTER+this.m_data.icon_id+".png",i=PublicCon.PATH_SCENE_MONSTER_NAME+this.m_data.id+".png";this.u_imgMonster.source=null,this.u_imgMonster.source=e,this.u_imgMosName.source=null,this.u_imgMosName.source=i,this.u_grpMultiple.addChild(this.m_multiple);var s=this.m_data.reward_per.replace("_","~");this.m_multiple.setMsgString("$x"+s)}-1==MonsterInfoUI.p_urlList.indexOf(e)&&MonsterInfoUI.p_urlList.push(e),-1==MonsterInfoUI.p_urlList.indexOf(i)&&MonsterInfoUI.p_urlList.push(i)}},e}(ItemRendererBase);__reflect(MonsterInfoSpecRender.prototype,"MonsterInfoSpecRender");var MonsterInfoBoss=function(t){function e(){var e=t.call(this)||this;return e.m_layout=new eui.TileLayout,e.m_bossList=new eui.ArrayCollection,e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/monsterInfoUI/view/MonsterInfoBossSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.u_scrollItem.horizontalScrollBar=null,this.u_scrollItem.verticalScrollBar=this.u_bossScrollBar,this.u_bossScrollBar.visible=!1,this.u_bossScrollBar.autoVisibility=!0,this.m_layout.requestedColumnCount=1,this.m_layout.verticalGap=10,this.u_bossList.itemRenderer=MonsterInfoBossRender,this.u_bossList.layout=this.m_layout,this.u_bossList.dataProvider=this.m_bossList},e.prototype.initEvent=function(){this.u_scrollItem.addEventListener(eui.UIEvent.CHANGE,this.onSilde,this),this.u_scrollItem.addEventListener(eui.UIEvent.CHANGE_END,this.onSildeEnd,this)},e.prototype.onSilde=function(t){var e=this.u_scrollItem.viewport.scrollV<=0?!1:!0,i=this.u_scrollItem.viewport.scrollV+this.u_scrollItem.height>=this.u_scrollItem.viewport.contentHeight?!1:!0;e!=this.u_imgTop.visible&&(this.u_imgTop.visible=e),i!=this.u_imgBottom.visible&&(this.u_imgBottom.visible=i);var s=this.u_scrollItem.verticalScrollBar.height-this.u_scrollItem.verticalScrollBar.thumb.height;this.u_scrollItem.verticalScrollBar.thumb.y=this.u_scrollItem.viewport.scrollV/(this.u_scrollItem.viewport.contentHeight-this.u_scrollItem.height)*s,this.u_scrollItem.verticalScrollBar.thumb.y<0&&(this.u_scrollItem.verticalScrollBar.thumb.y=0),this.u_scrollItem.verticalScrollBar.thumb.y>s&&(this.u_scrollItem.verticalScrollBar.thumb.y=s)},e.prototype.onSildeEnd=function(t){this.u_imgTop.visible=!1,this.u_imgBottom.visible=!1},e.prototype.show=function(t){if(this.checkComplete(this.show,t)){if(this.recoverAllTexture(this,!0),t){this.m_type=t;var e=MonsterInfoJson.getDataByScene(MonsterInfoUI.p_sceneId,this.m_type)}this.m_bossList.source=e,this.u_scrollItem.viewport.scrollV=0,this.u_imgTop.visible=!1,this.u_imgBottom.visible=!1}},e.prototype.hide=function(){this.u_scrollItem.stopAnimation(),DisplayObjectUtils.removeFormParent(this)},e}(ComponentBase);__reflect(MonsterInfoBoss.prototype,"MonsterInfoBoss");var MonsterInfoEvent=function(t){function e(){var e=t.call(this)||this;return e.m_layout=new eui.TileLayout,e.m_EventList=new eui.ArrayCollection,e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/monsterInfoUI/view/MonsterInfoEventSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.u_scrollItem.horizontalScrollBar=null,this.u_scrollItem.verticalScrollBar=this.u_eventScrollBar,this.u_eventScrollBar.visible=!1,this.u_eventScrollBar.autoVisibility=!0,this.m_layout.requestedColumnCount=1,this.m_layout.verticalGap=10,this.u_EventList.itemRenderer=MonsterInfoEventRender,this.u_EventList.layout=this.m_layout,this.u_EventList.dataProvider=this.m_EventList},e.prototype.initEvent=function(){this.u_scrollItem.addEventListener(eui.UIEvent.CHANGE,this.onSilde,this),this.u_scrollItem.addEventListener(eui.UIEvent.CHANGE_END,this.onSildeEnd,this)},e.prototype.onSilde=function(t){var e=this.u_scrollItem.viewport.scrollV<=0?!1:!0,i=this.u_scrollItem.viewport.scrollV+this.u_scrollItem.height>=this.u_scrollItem.viewport.contentHeight?!1:!0;e!=this.u_imgTop.visible&&(this.u_imgTop.visible=e),i!=this.u_imgBottom.visible&&(this.u_imgBottom.visible=i);var s=this.u_scrollItem.verticalScrollBar.height-this.u_scrollItem.verticalScrollBar.thumb.height;this.u_scrollItem.verticalScrollBar.thumb.y=this.u_scrollItem.viewport.scrollV/(this.u_scrollItem.viewport.contentHeight-this.u_scrollItem.height)*s,this.u_scrollItem.verticalScrollBar.thumb.y<0&&(this.u_scrollItem.verticalScrollBar.thumb.y=0),this.u_scrollItem.verticalScrollBar.thumb.y>s&&(this.u_scrollItem.verticalScrollBar.thumb.y=s)},e.prototype.onSildeEnd=function(t){this.u_imgTop.visible=!1,this.u_imgBottom.visible=!1},e.prototype.show=function(t){if(this.checkComplete(this.show,t)){if(this.recoverAllTexture(this,!0),t){this.m_type=t;var e=MonsterInfoJson.getDataByScene(MonsterInfoUI.p_sceneId,this.m_type)}this.m_EventList.source=e,this.u_scrollItem.viewport.scrollV=0,this.u_imgTop.visible=!1,this.u_imgBottom.visible=!1}},e.prototype.hide=function(){this.u_scrollItem.stopAnimation(),DisplayObjectUtils.removeFormParent(this)},e}(ComponentBase);__reflect(MonsterInfoEvent.prototype,"MonsterInfoEvent");var MonsterInfoSmall=function(t){function e(){var e=t.call(this)||this;return e.m_layout=new eui.TileLayout,e.m_smallList=new eui.ArrayCollection,e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/monsterInfoUI/view/MonsterInfoSmallSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.u_scrollerItem.horizontalScrollBar=null,this.u_scrollerItem.verticalScrollBar=this.u_smallScrollBar,this.u_smallScrollBar.visible=!1,this.u_smallScrollBar.autoVisibility=!0,this.m_layout.requestedColumnCount=4,this.m_layout.horizontalGap=10,this.m_layout.verticalGap=10,this.u_listItem.itemRenderer=MonsterInfoSmallRender,this.u_listItem.layout=this.m_layout,this.u_listItem.dataProvider=this.m_smallList},e.prototype.initEvent=function(){this.u_scrollerItem.addEventListener(eui.UIEvent.CHANGE,this.onSilde,this),this.u_scrollerItem.addEventListener(eui.UIEvent.CHANGE_END,this.onSildeEnd,this)},e.prototype.onSilde=function(t){var e=this.u_scrollerItem.viewport.scrollV<=0?!1:!0,i=this.u_scrollerItem.viewport.scrollV+this.u_scrollerItem.height>=this.u_scrollerItem.viewport.contentHeight?!1:!0;e!=this.u_imgTop.visible&&(this.u_imgTop.visible=e),i!=this.u_imgBottom.visible&&(this.u_imgBottom.visible=i);var s=this.u_scrollerItem.verticalScrollBar.height-this.u_scrollerItem.verticalScrollBar.thumb.height;this.u_scrollerItem.verticalScrollBar.thumb.y=this.u_scrollerItem.viewport.scrollV/(this.u_scrollerItem.viewport.contentHeight-this.u_scrollerItem.height)*s,this.u_scrollerItem.verticalScrollBar.thumb.y<0&&(this.u_scrollerItem.verticalScrollBar.thumb.y=0),this.u_scrollerItem.verticalScrollBar.thumb.y>s&&(this.u_scrollerItem.verticalScrollBar.thumb.y=s)},e.prototype.onSildeEnd=function(t){this.u_imgTop.visible=!1,this.u_imgBottom.visible=!1},e.prototype.show=function(t){if(this.checkComplete(this.show,t)){if(this.recoverAllTexture(this,!0),t){this.m_type=t;var e=MonsterInfoJson.getDataByScene(MonsterInfoUI.p_sceneId,this.m_type)}this.m_smallList.source=e,this.u_scrollerItem.viewport.scrollV=0,this.u_imgTop.visible=!1,this.u_imgBottom.visible=!1}},e.prototype.hide=function(){this.u_scrollerItem.stopAnimation(),DisplayObjectUtils.removeFormParent(this)},e}(ComponentBase);__reflect(MonsterInfoSmall.prototype,"MonsterInfoSmall");var MonsterInfoSpec=function(t){function e(){var e=t.call(this)||this;return e.m_layout=new eui.TileLayout,e.m_typeList=new eui.ArrayCollection,e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/monsterInfoUI/view/MonsterInfoSpecSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.u_scrollerItem.horizontalScrollBar=this.u_specScrollBar,this.u_specScrollBar.visible=!1,this.u_specScrollBar.autoVisibility=!0,this.u_scrollerItem.verticalScrollBar=null,this.m_layout.requestedRowCount=1,this.m_layout.horizontalGap=10,this.m_layout.orientation=eui.TileOrientation.COLUMNS,this.u_listItem.itemRenderer=MonsterInfoSpecRender,this.u_listItem.layout=this.m_layout,this.u_listItem.dataProvider=this.m_typeList},e.prototype.initEvent=function(){this.u_scrollerItem.addEventListener(eui.UIEvent.CHANGE,this.onSilde,this),this.u_scrollerItem.addEventListener(eui.UIEvent.CHANGE_END,this.onSildeEnd,this)},e.prototype.onSilde=function(t){var e=this.u_scrollerItem.viewport.scrollH<=0?!1:!0,i=this.u_scrollerItem.viewport.scrollH+this.u_scrollerItem.width>=this.u_scrollerItem.viewport.contentWidth?!1:!0;e!=this.u_imgLeft.visible&&(this.u_imgLeft.visible=e),i!=this.u_imgRight.visible&&(this.u_imgRight.visible=i);var s=this.u_scrollerItem.horizontalScrollBar.width-this.u_scrollerItem.horizontalScrollBar.thumb.height-this.u_imgRight.height;this.u_scrollerItem.horizontalScrollBar.thumb.x=this.u_scrollerItem.viewport.scrollH/(this.u_scrollerItem.viewport.contentWidth-this.u_scrollerItem.width)*s,this.u_scrollerItem.horizontalScrollBar.thumb.x<0&&(this.u_scrollerItem.horizontalScrollBar.thumb.x=0),this.u_scrollerItem.horizontalScrollBar.thumb.x>s&&(this.u_scrollerItem.horizontalScrollBar.thumb.x=s)},e.prototype.onSildeEnd=function(t){this.u_imgLeft.visible=!1,this.u_imgRight.visible=!1},e.prototype.show=function(t){if(this.checkComplete(this.show,t)){if(this.recoverAllTexture(this,!0),t){this.m_type=t;var e=MonsterInfoJson.getDataByScene(MonsterInfoUI.p_sceneId,this.m_type);this.m_typeList.source=e}this.u_scrollerItem.viewport.scrollH=0,this.u_imgLeft.visible=!1,this.u_imgRight.visible=!1}},e.prototype.hide=function(){this.u_scrollerItem.stopAnimation(),DisplayObjectUtils.removeFormParent(this)},e}(ComponentBase);__reflect(MonsterInfoSpec.prototype,"MonsterInfoSpec");var MonsterRollUI=function(t){function e(){var e=t.call(this)||this;return e.m_slotArr=[],e.m_type=1,e.m_time=0,e.m_diceList=[],e.m_awardList=[],e.m_disposeUrlList.push("monsterRollUI_json"),e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/monsterRollUI/MonsterRollUISkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this);for(var e=[],i=1;7>i;i++){var s="monsterRollUI_json.monsterRollUI_fruit_"+i;e.push({img:s,id:i})}for(var i=0;3>i;i++){var n=new SevenSlotView(e,60);n.width=65,n.height=60,n.x=22+100*i,n.y=30,this.u_slotGrp.addChild(n),this.m_slotArr.push(n)}this.registerEventClick(this.u_startBtn,this.onStart,this,!0)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this)},e.prototype.showView=function(e){if(void 0===e&&(e=null),this.checkComplete(this.showView,e)){t.prototype.showView.call(this,e);var i=e;this.m_type=i.special_event_type;var s=i.award_list[0],n=MonsterFunctionLabaJson.getData(this.m_type,s.id);this.m_diceList=n.result_list,this.m_awardList=s.prop_list,this.m_time=Number(StaticDataJson.getData("monster_function_laba_time").data)/1e3,DelayCallUtils.delayedCall(this.m_time,this.onStart,this)}},e.prototype.onStart=function(t){DelayCallUtils.killDelayedCallsTo(this.onStart,this),this.startRoll(),DelayCallUtils.delayedCall(2,this.endRoll,this)},e.prototype.startRoll=function(){var t=this;this.u_startBtn.touchEnabled=!1,this.m_slotArr[0].start(),DelayCallUtils.delayedCall(.03,function(){t.m_slotArr[1].start()},this),DelayCallUtils.delayedCall(.06,function(){t.m_slotArr[2].start()},this)},e.prototype.endRoll=function(){var t=this;this.m_slotArr[0].stop(this.m_diceList[0]),DelayCallUtils.delayedCall(.5,function(){t.m_slotArr[1].stop(t.m_diceList[1])},this),DelayCallUtils.delayedCall(1,function(){t.m_slotArr[2].stop(t.m_diceList[2]),DelayCallUtils.delayedCall(1,t.showRewardPop,t)},this)},e.prototype.showRewardPop=function(){this.u_startBtn.touchEnabled=!0,this.close(),FightManager.instance.showPopupAward(10,this.m_awardList)},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i),DelayCallUtils.killDelayedCallsTo(this.onStart,this),DelayCallUtils.killDelayedCallsTo(this.endRoll,this),DelayCallUtils.killDelayedCallsTo(this.showRewardPop,this);for(var s=0;3>s;s++)this.m_slotArr[s].removeTweens()},Object.defineProperty(e.prototype,"isClickBMask",{get:function(){return!1},enumerable:!0,configurable:!0}),e}(PopupBase);__reflect(MonsterRollUI.prototype,"MonsterRollUI");var MonsterRollRender=function(t){function e(){return t.call(this,"resource/eui_skins/monsterRollUI/render/MonsterRollRenderSkin.exml")||this}return __extends(e,t),e.prototype.dataChanged=function(){this.checkComplete(this.dataChanged)&&(t.prototype.dataChanged.call(this),this.data.img&&(this.u_icon.source=this.data.img))},e}(ItemRendererBase);__reflect(MonsterRollRender.prototype,"MonsterRollRender");var MultiMainUI=function(t){function e(){var e=t.call(this)||this;return e.m_currList.push({funcKey:FunctionEnum.MISSION_MANY_PEOPLE_BOSS,pageMc:new MultiListPage}),e.m_currList.push({funcKey:FunctionEnum.MISSION_MANY_PEOPLE_BOSS_ROOM,pageMc:new MultiCreatePage}),e}return __extends(e,t),e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),Dispatch.register(ManyPeopleBossManager.EVENT_MULTI_CREATE_ROOM,this.changePage,this))},e.prototype.changePage=function(){},e.prototype.sureHide=function(e,i){void 0===i&&(i=null),t.prototype.sureHide.call(this,e,i),Dispatch.remove(ManyPeopleBossManager.EVENT_MULTI_CREATE_ROOM,this.changePage,this)},e.prototype.isCloseUI=function(){if(ManyPeopleBossManager.instance.p_roomId>0){var t="";t=1==ManyPeopleBossManager.instance.p_roomInfo.is_room_owner?LanguageJson.getText("l_multi_leave_1"):LanguageJson.getText("l_multi_leave_2");var e=LanguageJson.getText("l_btn_yes"),i=LanguageJson.getText("l_btn_no");return PopupModule.instance.showTishi(t,this.sureClose.bind(this),null,e,i),!1}return!0},e.prototype.sureClose=function(t){1==t&&ManyPeopleBossManager.instance.s_many_people_boss_leave_room()},e.prototype.checkPageFunc=function(t){return t==FunctionEnum.MISSION_MANY_PEOPLE_BOSS_ROOM&&ManyPeopleBossManager.instance.p_roomId>0?!1:!0},e}(UIBase);__reflect(MultiMainUI.prototype,"MultiMainUI");var MultiCreatePage=function(t){function e(){var e=t.call(this)||this;return e.m_layout=new eui.TileLayout,e.m_typeList=new eui.ArrayCollection,e.m_isGou=!1,e.m_disposeUrlList.push("multiCreateUI_json"),e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/multiCreateUI/MultiCreateUISkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_scrollerItem.horizontalScrollBar=null,this.u_scrollerItem.verticalScrollBar=null,this.m_layout.requestedColumnCount=5,this.m_layout.horizontalGap=0,this.u_listItem.itemRenderer=MultiBossHeadRender,this.u_listItem.layout=this.m_layout,this.u_listItem.dataProvider=this.m_typeList,this.m_bossIdList=MissionManyPeopleBossJson.getMultiBossList(),this.u_txtDesc.text=LanguageJson.getText("l_multi_create_desc"),this.u_txtSetPass.text=LanguageJson.getText("l_multi_create_passward"),this.u_txtOK.text=LanguageJson.getText("l_btn_ok")},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnOK,this.onCreate,this),this.registerEventClick(this.u_btnGou,this.onGou,this)},e.prototype.onGou=function(t){this.m_isGou=!this.m_isGou,this.u_iconGou.visible=this.m_isGou},e.prototype.onCreate=function(t){1==this.m_isGou?""==this.u_txtInput.text?FloatTipModule.instance.popTipLanguage("l_multi_passward_tips"):ManyPeopleBossManager.instance.s_many_people_boss_create_room(e.p_bossId,1,this.u_txtInput.text):ManyPeopleBossManager.instance.s_many_people_boss_create_room(e.p_bossId,0,"")},e.prototype.showView=function(i){void 0===i&&(i=null),this.checkComplete(this.showView,i)&&(t.prototype.showView.call(this,i),this.m_isGou=!1,this.u_iconGou.visible=this.m_isGou,this.m_typeList.source=this.m_bossIdList,e.p_bossId=this.m_bossIdList[0],this.u_txtVip.textFlow=LanguageJson.getHtmlTextFlow("l_multi_room_cur_vip",[PlayerManager.instance.p_playerInfo.vip_level]),Dispatch.register(MultiBossHeadRender.EVENT_MULTI_CREATE_BOSS_SELECT,this.showBossInfo,this,!0))},e.prototype.showBossInfo=function(){this.m_json=MissionManyPeopleBossJson.getData(e.p_bossId);var t=MissionJson.getData(MissionTypeEnum.MANY_PEOPLE_BOSS,this.m_json.mission_id);this.u_txtPer.textFlow=LanguageJson.getHtmlTextFlow("l_multi_room_bureau",[this.m_json.owner_award_mana]),this.u_txtPart.textFlow=LanguageJson.getHtmlTextFlow("l_multi_create_people",[this.m_json.participants_limit]),this.u_txtMana.textFlow=LanguageJson.getHtmlTextFlow("l_multi_create_cost",[this.m_json.cost_mana]),t.enter_conditions_list&&t.enter_conditions_list.length>0?"vip_level"==t.enter_conditions_list[0]?this.u_txtLimit.textFlow=LanguageJson.getHtmlTextFlow("l_multi_list_limit_vip",[t.enter_conditions_list[1]]):"level"==t.enter_conditions_list[0]&&(this.u_txtLimit.textFlow=LanguageJson.getHtmlTextFlow("l_multi_list_limit_lv",[t.enter_conditions_list[1]])):this.u_txtLimit.textFlow=LanguageJson.getHtmlTextFlow("l_multi_create_limit")},e.prototype.hide=function(e){void 0===e&&(e=null),t.prototype.hide.call(this),Dispatch.remove(MultiBossHeadRender.EVENT_MULTI_CREATE_BOSS_SELECT,this.showBossInfo,this)},e}(PageBase);__reflect(MultiCreatePage.prototype,"MultiCreatePage");var MultiListPage=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this)},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),Dispatch.register(ManyPeopleBossManager.EVENT_MULTI_JOIN_ROOM,this.showData,this,!0),Dispatch.register(ManyPeopleBossManager.EVENT_MULTI_SELF_LEAVE_ROOM,this.showData,this))},e.prototype.showData=function(){ManyPeopleBossManager.instance.p_roomId<=0?(this.m_multiListView||(this.m_multiListView=new MultiListView,this.m_multiListView.x=0,this.m_multiListView.y=0),this.addChild(this.m_multiListView),this.m_multiListView.show(),this.m_multiRoomView&&this.m_multiRoomView.hide()):(this.m_multiRoomView||(this.m_multiRoomView=new MultiRoomView,this.m_multiRoomView.x=0,this.m_multiRoomView.y=0),this.addChild(this.m_multiRoomView),this.m_multiRoomView.show(),this.m_multiListView&&this.m_multiListView.hide(),1==ManyPeopleBossManager.instance.p_roomInfo.is_room_owner&&ManyPeopleBossManager.instance.p_owner_mana>-1&&(DelayCallUtils.killDelayedCallsTo(this.showOwnerMana,this),DelayCallUtils.delayedCall(.5,this.showOwnerMana,this)))},e.prototype.showOwnerMana=function(){PopupModule.instance.showPop(PopupConfig.ID_MULTI_OWNER_COMPLETE)},e.prototype.hide=function(e){void 0===e&&(e=null),Dispatch.remove(ManyPeopleBossManager.EVENT_MULTI_JOIN_ROOM,this.showData,this),Dispatch.remove(ManyPeopleBossManager.EVENT_MULTI_SELF_LEAVE_ROOM,this.showData,this),this.m_multiListView&&this.m_multiListView.hide(),this.m_multiRoomView&&this.m_multiRoomView.hide(),t.prototype.hide.call(this)},Object.defineProperty(e.prototype,"width",{get:function(){return 640},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 1136},enumerable:!0,configurable:!0}),e}(PageBase);__reflect(MultiListPage.prototype,"MultiListPage");var MultiCompletePopup=function(t){function e(){var e=t.call(this)||this;return e.m_time=5,e.m_disposeUrlList.push("missionCompleteUI_json"),e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/multiPlayerUI/popup/MultiCompletePopupSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnOK,this.close,this)},e.prototype.showView=function(e){if(void 0===e&&(e=null),this.checkComplete(this.showView,e)){t.prototype.showView.call(this,e);var i=ManyPeopleBossManager.instance.p_owner_mana;this.m_time=5,TimeManager.instance.doLoop(this.refreshTime,this,1e3),i>0?this.u_txtMsg.textFlow=LanguageJson.getHtmlTextFlow("l_multi_owner_tips_1",[i]):this.u_txtMsg.textFlow=LanguageJson.getHtmlTextFlow("l_multi_owner_tips_2")}},e.prototype.refreshTime=function(){return this.u_txtOK.text=LanguageJson.getText("l_btn_ok")+"("+this.m_time+")",this.m_time<=0?(TimeManager.instance.clearTimer(this.refreshTime,this),void this.close()):void this.m_time--},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i),TimeManager.instance.clearTimer(this.refreshTime,this)},Object.defineProperty(e.prototype,"isClickBMask",{get:function(){return!1},enumerable:!0,configurable:!0}),e}(PopupBase);__reflect(MultiCompletePopup.prototype,"MultiCompletePopup");var MultiFindRoomPopup=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/multiPlayerUI/popup/MultiFindRoomPopupSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_txtCode.text=LanguageJson.getText("l_multi_code"),this.u_txtCancel.text=LanguageJson.getText("l_btn_cancel"),this.u_txtOK.text=LanguageJson.getText("l_btn_ok")},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.setCloseBtn(this.u_btnClose),this.registerEventClick(this.u_btnCancel,this.close,this),this.registerEventClick(this.u_btnOK,this.onFind,this)},e.prototype.onFind=function(t){var e=this.u_txtInput.text;""==e?FloatTipModule.instance.popTipLanguage("l_multi_code_tips"):ManyPeopleBossManager.instance.s_many_people_boss_join_room(0,"",e)},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),Dispatch.register(ManyPeopleBossManager.EVENT_MULTI_JOIN_ROOM,this.close,this))},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i),Dispatch.remove(ManyPeopleBossManager.EVENT_MULTI_JOIN_ROOM,this.close,this)},e}(PopupBase);__reflect(MultiFindRoomPopup.prototype,"MultiFindRoomPopup");var MultiJoinRoomPopup=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/multiPlayerUI/popup/MultiJoinRoomPopupSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_txtPass.text=LanguageJson.getText("l_multi_join_passward"),this.u_txtCancel.text=LanguageJson.getText("l_btn_cancel"),this.u_txtOK.text=LanguageJson.getText("l_btn_ok")},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.setCloseBtn(this.u_btnClose),this.registerEventClick(this.u_btnCancel,this.close,this),this.registerEventClick(this.u_btnOK,this.onJoin,this)},e.prototype.onJoin=function(t){var e=this.u_txtInput.text;""==e?FloatTipModule.instance.popTipLanguage("l_multi_passward_tips"):ManyPeopleBossManager.instance.s_many_people_boss_join_room(this.m_roomId,e,"")},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),this.m_roomId=e,this.u_txtRoomId.textFlow=LanguageJson.getHtmlTextFlow("l_multi_join_id",[this.m_roomId]),Dispatch.register(ManyPeopleBossManager.EVENT_MULTI_JOIN_ROOM,this.close,this))},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i),Dispatch.remove(ManyPeopleBossManager.EVENT_MULTI_JOIN_ROOM,this.close,this)},e}(PopupBase);__reflect(MultiJoinRoomPopup.prototype,"MultiJoinRoomPopup");var MultiWaitPopup=function(t){function e(){var e=t.call(this)||this;return e.m_time=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/multiPlayerUI/popup/MultiWaitPopupSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.m_numberView||(this.m_numberView=new NumberView("num_time_",0,0),this.addChild(this.m_numberView),this.m_numberView.verticalCenter=0,this.m_numberView.horizontalCenter=0)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this)},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),this.m_time=e,TimeManager.instance.doLoop(this.refreshTime,this,1e3),Dispatch.register(ManyPeopleBossManager.EVENT_MULTI_FIGHT_COMPLETE,this.close,this))},e.prototype.refreshTime=function(){return this.m_numberView.numValue=this.m_time,this.m_time<0?void TimeManager.instance.clearTimer(this.refreshTime,this):void this.m_time--},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i),TimeManager.instance.clearTimer(this.refreshTime,this)},e.prototype.sureHide=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),Dispatch.remove(ManyPeopleBossManager.EVENT_MULTI_FIGHT_COMPLETE,this.close,this),1==ManyPeopleBossManager.instance.p_roomInfo.is_room_owner&&ManyPeopleBossManager.instance.p_owner_mana>-1&&PopupModule.instance.showPop(PopupConfig.ID_MULTI_OWNER_COMPLETE)},Object.defineProperty(e.prototype,"isClickBMask",{get:function(){return!1},enumerable:!0,configurable:!0}),e}(PopupBase);__reflect(MultiWaitPopup.prototype,"MultiWaitPopup");var MultiBossHeadRender=function(t){function e(){return t.call(this,"resource/eui_skins/multiCreateUI/render/MultiCreateBossHeadSkin.exml")||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this),this.m_numberView||(this.m_numberView=new NumberView("num_vip_",0,-32),this.u_grpLv.addChild(this.m_numberView),this.m_numberView.verticalCenter=0,this.m_numberView.horizontalCenter=2)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this,this.onClick,this)},e.prototype.onClick=function(t){return void 0===t&&(t=null),this.u_imgLock.visible?void FloatTipModule.instance.popTipLanguage("l_game_tips_3"):(MultiCreatePage.p_bossId=this.m_pointId,void Dispatch.dispatch(e.EVENT_MULTI_CREATE_BOSS_SELECT))},e.prototype.dataChanged=function(){if(this.checkComplete(this.dataChanged)){t.prototype.dataChanged.call(this),this.m_pointId=this.data;var i=MissionManyPeopleBossJson.getData(this.m_pointId),s=MissionJson.getData(MissionTypeEnum.MANY_PEOPLE_BOSS,this.m_pointId),n=MonsterJson.getData(s.boss_id);""!=BagManager.instance.checkCondition(i.create_condition_list)?(this.u_imgLock.visible=!0,this.u_txtLv.visible=!1,this.u_imgIcon.visible=!1,this.m_numberView.setMsgString("v"+i.create_condition_list[1])):(this.u_imgLock.visible=!1,this.u_txtLv.visible=!0,this.u_imgIcon.visible=!0,this.u_imgIcon.source=PublicCon.PATH_BOSS_HEAD+n.icon_id+".png",this.m_numberView.setMsgString("v"+i.create_condition_list[1])),Dispatch.register(e.EVENT_MULTI_CREATE_BOSS_SELECT,this.upSelect,this,!0)}},e.prototype.upSelect=function(){this.u_imgLock.visible?this.u_imgSelect.visible=!1:this.m_pointId==MultiCreatePage.p_bossId?this.u_imgSelect.visible=!0:this.u_imgSelect.visible=!1},e.EVENT_MULTI_CREATE_BOSS_SELECT="EVENT_MULTI_CREATE_BOSS_SELECT",e}(ItemRendererBase);__reflect(MultiBossHeadRender.prototype,"MultiBossHeadRender");var MultiMainRender=function(t){function e(){var e=t.call(this,"resource/eui_skins/multiPlayerUI/render/MultiMainRenderSkin.exml")||this;return e.m_pathStr="",e}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this),this.touchEnabled=!1,this.m_rewardGrop||(this.m_rewardGrop=new RewardGroupUI,this.m_rewardGrop.scaleX=this.m_rewardGrop.scaleY=.9,this.m_rewardGrop.x=170,this.m_rewardGrop.y=80,this.addChild(this.m_rewardGrop)),this.m_bossLv||(this.m_bossLv=new NumberView("num_role_level_",0,-25),this.u_grpLv.addChild(this.m_bossLv),this.m_bossLv.x=25,this.m_bossLv.verticalCenter=-2),this.m_effect||(this.m_effect=new EffectMovieClip,this.addChildAt(this.m_effect,this.getChildIndex(this.u_txtVip)+2)),this.u_txtJoin.text=LanguageJson.getText("l_btn_join")},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnJoin,this.onJoin,this)
},e.prototype.onJoin=function(t){return void 0===t&&(t=null),""==BagManager.instance.checkCondition(this.m_missionJson.enter_conditions_list,!0)?BagManager.instance.gold<this.m_json.cost_mana?void BagManager.instance.noEnoughGold():void(0==this.m_data.is_lock?ManyPeopleBossManager.instance.s_many_people_boss_join_room(this.m_data.room_id,"",""):PopupModule.instance.showPop(PopupConfig.ID_MULTI_JOIN_ROOM,this.m_data.room_id,!1)):void 0},e.prototype.dataChanged=function(){if(this.checkComplete(this.dataChanged)){t.prototype.dataChanged.call(this),this.m_data=this.data,this.m_json=MissionManyPeopleBossJson.getData(this.m_data.boss_id),this.m_missionJson=MissionJson.getData(MissionTypeEnum.MANY_PEOPLE_BOSS,this.m_json.mission_id);var e=MonsterJson.getData(this.m_missionJson.boss_id);this.m_pathStr=MonsterJson.getAvatarPath(e.id),this.m_bossLv.numValue=e.level,this.u_txtMana.textFlow=LanguageJson.getHtmlTextFlow("l_multi_list_required",[this.m_json.cost_mana]),this.u_txtPartic.textFlow=LanguageJson.getHtmlTextFlow("l_multi_room_people",[this.m_data.people_count,this.m_json.participants_limit]),""!=this.m_pathStr&&(this.m_effect.setMC(this.m_pathStr),this.m_effect.play(),this.m_effect.x=80,this.m_effect.y=80,this.m_json.list_off_list[0]&&(this.m_effect.x+=this.m_json.list_off_list[0]),this.m_json.list_off_list[1]&&(this.m_effect.y+=this.m_json.list_off_list[1]),this.m_json.list_off_list[2]&&(this.m_effect.scaleX=this.m_effect.scaleY=this.m_json.list_off_list[2])),this.m_missionJson.enter_conditions_list.length>0?(this.u_txtVip.visible=!0,"vip_level"==this.m_missionJson.enter_conditions_list[0]?this.u_txtVip.textFlow=LanguageJson.getHtmlTextFlow("l_multi_list_limit_vip",[this.m_missionJson.enter_conditions_list[1]]):"level"==this.m_missionJson.enter_conditions_list[0]&&(this.u_txtVip.textFlow=LanguageJson.getHtmlTextFlow("l_multi_list_limit_lv",[this.m_missionJson.enter_conditions_list[1]]))):this.u_txtVip.visible=!1,this.u_iconLock.visible=1==this.m_data.is_lock,this.m_rewardGrop.setDataByList(this.m_missionJson.drop_look_list,3)}},e.prototype.onRemoveStage=function(e){t.prototype.onRemoveStage.call(this,e),""!=this.m_pathStr&&this.m_effect.stop()},e}(ItemRendererBase);__reflect(MultiMainRender.prototype,"MultiMainRender");var MultiSelectRender=function(t){function e(){var e=t.call(this,"resource/eui_skins/multiPlayerUI/render/MultiSelectRenderSkin.exml")||this;return e.m_condition="",e}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this,this.onSelect,this)},e.prototype.onSelect=function(t){if(void 0===t&&(t=null),""!=this.m_condition){"vip_level"==this.m_missionJson.enter_conditions_list[0]?FloatTipModule.instance.popTipLanguage("l_game_tips_3"):"level"==this.m_missionJson.enter_conditions_list[0]&&FloatTipModule.instance.popTipLanguage("l_game_tips_4")}else Dispatch.dispatch(e.EVENT_BOSS_RENDER_SELECT),this.m_bossId!=MultiListView.p_bossId&&ManyPeopleBossManager.instance.s_many_people_boss_get_room_list(this.m_bossId)},e.prototype.dataChanged=function(){this.checkComplete(this.dataChanged)&&(t.prototype.dataChanged.call(this),this.m_bossId=this.data,this.m_condition="",this.m_json=MissionManyPeopleBossJson.getData(this.m_bossId),this.m_json?this.m_json&&(this.m_missionJson=MissionJson.getData(MissionTypeEnum.MANY_PEOPLE_BOSS,this.m_json.mission_id),this.m_condition=BagManager.instance.checkCondition(this.m_missionJson.enter_conditions_list),this.m_missionJson.enter_conditions_list.length>0?(this.u_txtLimit.visible=!0,"vip_level"==this.m_missionJson.enter_conditions_list[0]?this.u_txtLimit.textFlow=LanguageJson.getHtmlTextFlow("l_multi_list_limit_vip",[this.m_missionJson.enter_conditions_list[1]]):"level"==this.m_missionJson.enter_conditions_list[0]&&(this.u_txtLimit.textFlow=LanguageJson.getHtmlTextFlow("l_multi_list_limit_lv",[this.m_missionJson.enter_conditions_list[1]]))):this.u_txtLimit.visible=!1,this.u_txtBoss.textFlow=LanguageJson.getHtmlTextFlow("l_multi_list_bossId",[this.m_json.id]),this.u_txtMana.textFlow=LanguageJson.getHtmlTextFlow("l_multi_list_mana",[this.m_json.cost_mana]),""!=this.m_condition?ObjectUtils.setGrey(this):ObjectUtils.setGrey(this,!1)):(this.u_txtBoss.text=LanguageJson.getText("l_multi_list_all"),this.u_txtLimit.text="",this.u_txtMana.text=""))},e.EVENT_BOSS_RENDER_SELECT="EVENT_BOSS_RENDER_SELECT",e}(ItemRendererBase);__reflect(MultiSelectRender.prototype,"MultiSelectRender");var MultiListView=function(t){function e(){var e=t.call(this)||this;return e.m_layout=new eui.TileLayout,e.m_typeList=new eui.ArrayCollection,e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/multiPlayerUI/MultiMainUISkin.exml",e.m_disposeUrlList.push("multiPlayerUI_json"),e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.u_scrollerItem.horizontalScrollBar=null,this.u_scrollerItem.verticalScrollBar=null,this.m_layout.requestedColumnCount=1,this.u_listItem.itemRenderer=MultiMainRender,this.u_listItem.layout=this.m_layout,this.u_listItem.dataProvider=this.m_typeList,this.u_txtSelect.text=LanguageJson.getText("l_multi_list_select"),this.u_txtTips.text=LanguageJson.getText("l_multi_list_code"),this.u_txtRefresh.text=LanguageJson.getText("l_btn_refresh"),this.u_btnSelect.width=this.u_txtSelect.width+60,this.u_iconArrow.right=0},e.prototype.initEvent=function(){this.registerEventClick(this.u_btnSelect,this.onSelected,this),this.registerEventClick(this.u_btnInput,this.onInput,this),this.registerEventClick(this.u_btnRefresh,this.onRefresh,this)},e.prototype.onSelected=function(t){void 0===t&&(t=null),e.p_isClick?this.m_selectView&&this.m_selectView.hide():(this.m_selectView||(this.m_selectView=new MultiSelectView,this.m_selectView.x=30,this.m_selectView.y=142),this.addChild(this.m_selectView),this.m_selectView.show(),e.p_isClick=!0),t.stopPropagation(),t.stopImmediatePropagation()},e.prototype.onInput=function(t){void 0===t&&(t=null),PopupModule.instance.showPop(PopupConfig.ID_MULTI_FIND_ROOM,null,!1)},e.prototype.onRefresh=function(t){void 0===t&&(t=null),e.p_cd<=0&&(e.p_cd=6,this.u_txtTime.visible=!0,TimeManager.instance.doLoop(this.refreshTime,this,1e3),ManyPeopleBossManager.instance.s_many_people_boss_get_room_list(e.p_bossId))},e.prototype.show=function(t){void 0===t&&(t=null),this.checkComplete(this.show,t)&&(e.p_isClick=!1,this.u_txtTime.visible=!1,e.p_cd>0&&(this.u_txtTime.visible=!0,TimeManager.instance.doLoop(this.refreshTime,this,1e3)),Dispatch.register(ManyPeopleBossManager.EVENT_MULTI_GET_ROOM,this.refreshRoomList,this),ManyPeopleBossManager.instance.s_many_people_boss_get_room_list(e.p_bossId))},e.prototype.refreshRoomList=function(t,i){this.u_scrollerItem.stopAnimation(),this.m_selectView&&this.m_selectView.hide(),e.p_bossId=t,this.m_typeList.source=i,this.u_scrollerItem.viewport.scrollV=0},e.prototype.refreshTime=function(){return this.u_txtTime.textFlow=LanguageJson.getHtmlTextFlow("l_game_unit_s",[e.p_cd]),e.p_cd<=0?(this.u_txtTime.visible=!1,void TimeManager.instance.clearTimer(this.refreshTime,this)):void e.p_cd--},e.prototype.hide=function(){DisplayObjectUtils.removeFormParent(this),TimeManager.instance.clearTimer(this.refreshTime,this),Dispatch.remove(ManyPeopleBossManager.EVENT_MULTI_GET_ROOM,this.refreshRoomList,this)},Object.defineProperty(e.prototype,"width",{get:function(){return 640},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 1136},enumerable:!0,configurable:!0}),e.p_cd=6,e.p_isClick=!1,e.p_bossId=0,e}(ComponentBase);__reflect(MultiListView.prototype,"MultiListView");var MultiPlayerHeadView=function(t){function e(e){var i=t.call(this)||this;return i.m_posId=e,i.x=(i.width+50)*((e-1)%2),i.y=(i.height+5)*Math.floor((e-1)/2),i.once(egret.Event.COMPLETE,i.onCompleted,i),i.skinName="resource/eui_skins/multiPlayerUI/view/MultiPlayerHeadViewSkin.exml",i}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){},e.prototype.initEvent=function(){this.registerEventClick(this.u_btnKick,this.onKick,this)},e.prototype.onKick=function(t){void 0===t&&(t=null),ManyPeopleBossManager.instance.s_many_people_boss_kick_out_player(this.m_posId)},e.prototype.show=function(t){void 0===t&&(t=null),this.checkComplete(this.show,t)&&(Dispatch.register(ManyPeopleBossManager.EVENT_MULTI_OTHER_JOIN_ROOM,this.upPosData,this),Dispatch.register(ManyPeopleBossManager.EVENT_MULTI_LEAVE_ROOM,this.upPosData,this),Dispatch.register(ManyPeopleBossManager.EVENT_MULTI_READY_ROOM,this.changeReady,this),Dispatch.register(ManyPeopleBossManager.EVENT_MULTI_FIGHT_COMPLETE,this.showPosData,this),this.showPosData())},e.prototype.showPosData=function(){this.m_data=ManyPeopleBossManager.instance.getDataByPosId(this.m_posId),this.m_data?(this.u_grpHave.visible=!0,this.u_txtLv.textFlow=LanguageJson.getHtmlTextFlow("l_multi_lv",[this.m_data.model_head_figure.level]),this.u_txtName.text=this.m_data.model_head_figure.nickname,1==this.m_data.is_room_owner?(this.u_imgReady.visible=!1,this.u_imgBg.source="multiRoomUI_json.multiRoomUI_head1"):(this.u_imgReady.visible=1==this.m_data.is_ready,this.u_imgBg.source="multiRoomUI_json.multiRoomUI_head2"),1==ManyPeopleBossManager.instance.p_roomInfo.is_room_owner?1==this.m_data.is_room_owner?this.u_btnKick.visible=!1:this.u_btnKick.visible=!0:this.u_btnKick.visible=!1):(this.u_grpHave.visible=!1,this.u_imgBg.source="multiRoomUI_json.multiRoomUI_head2")},e.prototype.upPosData=function(t){this.m_posId==t&&this.showPosData()},e.prototype.changeReady=function(t,e){this.m_posId==t&&(this.u_imgReady.visible=0==e?!1:!0)},e.prototype.hide=function(){DisplayObjectUtils.removeFormParent(this),Dispatch.remove(ManyPeopleBossManager.EVENT_MULTI_OTHER_JOIN_ROOM,this.upPosData,this),Dispatch.remove(ManyPeopleBossManager.EVENT_MULTI_LEAVE_ROOM,this.upPosData,this),Dispatch.remove(ManyPeopleBossManager.EVENT_MULTI_READY_ROOM,this.changeReady,this)},Object.defineProperty(e.prototype,"width",{get:function(){return 167},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 159},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(MultiPlayerHeadView.prototype,"MultiPlayerHeadView");var MultiRoomView=function(t){function e(){var e=t.call(this)||this;return e.m_isReady=0,e.m_posList=[],e.m_pathStr="",e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/multiPlayerUI/MultiRoomUISkin.exml",e.m_disposeUrlList.push("multiRoomUI_json"),e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.m_rewardGrop||(this.m_rewardGrop=new RewardGroupUI,this.m_rewardGrop.scaleX=this.m_rewardGrop.scaleY=.9,this.m_rewardGrop.x=189,this.m_rewardGrop.y=40,this.u_grpInfo.addChild(this.m_rewardGrop)),this.m_bossLv||(this.m_bossLv=new NumberView("num_role_level_",0,-25),this.u_grpLv.addChild(this.m_bossLv),this.m_bossLv.x=25,this.m_bossLv.verticalCenter=-2),this.m_effect||(this.m_effect=new EffectMovieClip,this.m_effect.touchEnabled=!1,this.u_grpInfo.addChild(this.m_effect)),this.u_txtcopy.text=LanguageJson.getText("l_multi_room_copy"),this.u_txtInfo.text=LanguageJson.getText("l_multi_room_info"),this.u_txtAuto.text=LanguageJson.getText("l_multi_room_auto"),TextUtil.setLink(this.u_txtcopy)},e.prototype.initEvent=function(){this.u_btnLeave.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLeave,this),this.u_btnReady.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onReady,this),this.registerEventClick(this.u_txtcopy,this.onCopy,this),this.registerEventClick(this.u_btnGou,this.onGou,this)},e.prototype.onCopy=function(t){TextUtil.setTextCopy(this.m_data.invitation_code),FloatTipModule.instance.popTipLanguage("l_multi_room_tips_3")},e.prototype.onLeave=function(t){if(1==this.m_data.is_room_owner){if(ManyPeopleBossManager.instance.getOwnerPartInState())ManyPeopleBossManager.instance.s_many_people_boss_participate_in(0);else{if(!this.checkMana())return;if(ManyPeopleBossManager.instance.getRoomPeople()>=this.m_json.participants_limit)return void FloatTipModule.instance.popTipLanguage("l_multi_popTip_12");ManyPeopleBossManager.instance.s_many_people_boss_participate_in(1)}SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_1012)}else{var e=LanguageJson.getText("l_multi_leave_2"),i=LanguageJson.getText("l_btn_yes"),s=LanguageJson.getText("l_btn_no");PopupModule.instance.showTishi(e,this.sureLeave.bind(this),null,i,s),SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_1007)}},e.prototype.sureLeave=function(t){1==t&&ManyPeopleBossManager.instance.s_many_people_boss_leave_room()},e.prototype.onReady=function(t){if(1==this.m_data.is_room_owner)ManyPeopleBossManager.instance.s_many_people_boss_start();else if(0==this.m_data.is_room_owner)if(0==this.m_isReady){if(!this.checkMana())return;ManyPeopleBossManager.instance.s_many_people_boss_ready(1)}else ManyPeopleBossManager.instance.s_many_people_boss_ready(0);SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_1012)},e.prototype.checkMana=function(){return BagManager.instance.gold<this.m_json.cost_mana?(BagManager.instance.noEnoughGold(),!1):!0},e.prototype.onGou=function(t){1==ManyPeopleBossManager.instance.p_is_auto?ManyPeopleBossManager.instance.s_many_people_boss_set_is_all_ready_start(0):ManyPeopleBossManager.instance.s_many_people_boss_set_is_all_ready_start(1)},e.prototype.show=function(t){if(void 0===t&&(t=null),this.checkComplete(this.show,t)&&(this.m_isReady=0,this.m_data=ManyPeopleBossManager.instance.p_roomInfo,this.m_data)){var e=this.m_data.room_data.boss_id;this.m_json=MissionManyPeopleBossJson.getData(e),this.u_txtOwner.textFlow=LanguageJson.getHtmlTextFlow("l_multi_room_owner",[this.m_data.owner_name,this.m_data.owner_level]),this.u_txtRoomId.textFlow=LanguageJson.getHtmlTextFlow("l_multi_room_id",[this.m_data.room_data.room_id]),this.u_txtCode.textFlow=LanguageJson.getHtmlTextFlow("l_multi_room_code",[this.m_data.invitation_code]),this.u_txtMana.textFlow=LanguageJson.getHtmlTextFlow("l_multi_create_cost",[this.m_json.cost_mana]);var i=MissionJson.getData(MissionTypeEnum.MANY_PEOPLE_BOSS,this.m_json.mission_id);this.m_rewardGrop.setDataByList(i.drop_look_list,3);var s=MonsterJson.getData(i.boss_id);this.m_pathStr=MonsterJson.getAvatarPath(s.id),this.m_bossLv.numValue=s.level,""!=this.m_pathStr&&(this.m_effect.setMC(this.m_pathStr),this.m_effect.play(),this.m_effect.x=82,this.m_effect.y=78,this.m_json.ui_off_list[0]&&(this.m_effect.x+=this.m_json.ui_off_list[0]),this.m_json.ui_off_list[1]&&(this.m_effect.y+=this.m_json.ui_off_list[1]),this.m_json.ui_off_list[2]&&(this.m_effect.scaleX=this.m_effect.scaleY=this.m_json.ui_off_list[2])),1==this.m_data.is_room_owner?(this.u_grpOwner.visible=!0,this.u_txtReady.text=LanguageJson.getText("l_btn_start"),this.u_txtLeave.text=ManyPeopleBossManager.instance.getOwnerPartInState()?LanguageJson.getText("l_btn_cancel"):LanguageJson.getText("l_btn_part_in"),this.u_txtVip.textFlow=LanguageJson.getHtmlTextFlow("l_multi_room_cur_vip",[PlayerManager.instance.p_playerInfo.vip_level]),this.u_txtPer.textFlow=LanguageJson.getHtmlTextFlow("l_multi_room_bureau",[this.m_json.owner_award_mana]),this.u_grpInfo.y=569,Dispatch.register(ManyPeopleBossManager.EVENT_MULTI_FIGHT_AOTU,this.upGou,this,!0)):(this.u_grpOwner.visible=!1,this.u_txtReady.text=LanguageJson.getText("l_btn_ready"),this.u_txtLeave.text=LanguageJson.getText("l_btn_leave"),this.u_grpInfo.y=645,Dispatch.register(ManyPeopleBossManager.EVENT_MULTI_SELF_READY_ROOM,this.changeReady,this)),this.m_posList=[];for(var n=1;n<=this.m_json.participants_limit;n++){var o=new MultiPlayerHeadView(n);this.u_grpHead.addChild(o),this.m_posList.push(o),o.show()}Dispatch.register(ManyPeopleBossManager.EVENT_MULTI_OTHER_JOIN_ROOM,this.upData,this,!0),Dispatch.register(ManyPeopleBossManager.EVENT_MULTI_LEAVE_ROOM,this.upData,this),Dispatch.register(ManyPeopleBossManager.EVENT_MULTI_FIGHT_COMPLETE,this.upData,this),Dispatch.register(ManyPeopleBossManager.EVENT_MULTI_OWNER_JOIN_ROOM,this.changePart,this)}},e.prototype.upGou=function(){this.u_iconGou.visible=1==ManyPeopleBossManager.instance.p_is_auto},e.prototype.changeReady=function(t){this.m_isReady=t,this.u_txtReady.text=1==this.m_isReady?LanguageJson.getText("l_btn_cancel"):LanguageJson.getText("l_btn_ready")},e.prototype.changePart=function(){1==this.m_data.is_room_owner&&(this.u_txtLeave.text=ManyPeopleBossManager.instance.getOwnerPartInState()?LanguageJson.getText("l_btn_cancel"):LanguageJson.getText("l_btn_part_in"))},e.prototype.upData=function(){var t=ManyPeopleBossManager.instance.getRoomPeople(),e=this.m_json.participants_limit;this.u_txtPart.textFlow=LanguageJson.getHtmlTextFlow("l_multi_room_people",[t,e]),this.changePart()},e.prototype.hide=function(){for(var t=0;t<this.m_posList.length;t++)this.m_posList[t]&&this.m_posList[t].hide();""!=this.m_pathStr&&this.m_effect.stop(),DisplayObjectUtils.removeFormParent(this),Dispatch.remove(ManyPeopleBossManager.EVENT_MULTI_SELF_READY_ROOM,this.changeReady,this),Dispatch.remove(ManyPeopleBossManager.EVENT_MULTI_OWNER_JOIN_ROOM,this.changePart,this),Dispatch.remove(ManyPeopleBossManager.EVENT_MULTI_OTHER_JOIN_ROOM,this.upData,this),Dispatch.remove(ManyPeopleBossManager.EVENT_MULTI_LEAVE_ROOM,this.upData,this),Dispatch.remove(ManyPeopleBossManager.EVENT_MULTI_FIGHT_AOTU,this.upGou,this),Dispatch.remove(ManyPeopleBossManager.EVENT_MULTI_FIGHT_COMPLETE,this.upData,this)},Object.defineProperty(e.prototype,"width",{get:function(){return 640},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 1136},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(MultiRoomView.prototype,"MultiRoomView");var MultiSelectView=function(t){function e(){var e=t.call(this)||this;return e.m_layout=new eui.TileLayout,e.m_typeList=new eui.ArrayCollection,e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/multiPlayerUI/view/MultiSelectViewSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.u_scrollerItem.horizontalScrollBar=null,this.u_scrollerItem.verticalScrollBar=null,this.m_layout.requestedColumnCount=1,this.u_listItem.itemRenderer=MultiSelectRender,this.u_listItem.layout=this.m_layout,this.u_listItem.dataProvider=this.m_typeList;var t=[0];this.m_bossIdList=t.concat(MissionManyPeopleBossJson.getMultiBossList())},e.prototype.initEvent=function(){this.registerEventClick(this.u_btnClose,this.hide,this)},e.prototype.show=function(t){void 0===t&&(t=null),this.checkComplete(this.show,t)&&(this.scaleY=0,TweenLite.to(this,.3,{scaleY:1}),this.m_typeList.source=this.m_bossIdList,this.u_scrollerItem.viewport.scrollV=0,Dispatch.register(StageManager.EVENT_STAGE_CLICK,this.onStageClick,this),Dispatch.register(MultiSelectRender.EVENT_BOSS_RENDER_SELECT,this.hide,this))},e.prototype.onStageClick=function(t){var e=this.localToGlobal(0,0);t.stageX>=e.x&&t.stageX<=e.x+this.width&&t.stageY>=e.y&&t.stageY<=e.y+this.height||(this.hide(),SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_1007))},e.prototype.hide=function(){MultiListView.p_isClick=!1,Dispatch.remove(StageManager.EVENT_STAGE_CLICK,this.onStageClick,this),Dispatch.remove(MultiSelectRender.EVENT_BOSS_RENDER_SELECT,this.hide,this),TweenLite.to(this,.3,{scaleY:0,onComplete:this.sureHide.bind(this)})},e.prototype.sureHide=function(){DisplayObjectUtils.removeFormParent(this)},Object.defineProperty(e.prototype,"width",{get:function(){return 420},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 595},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(MultiSelectView.prototype,"MultiSelectView");var PassTicketUI=function(t){function e(){var e=t.call(this)||this;return e.m_jinduW=179,e.m_disposeUrlList.push("passTicketUI_json"),e.m_currList.push({funcKey:1,pageMc:new PassTicketRewardPage}),e.m_currList.push({funcKey:2,pageMc:new PassTicketTaskPage}),e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/passTicketUI/PassTicketUISkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this);var e=[{key:1,btnNameBj:"passTicketUI_btnBg_",posXY:[419,20]},{key:2,btnNameBj:"passTicketUI_btnBg_",posXY:[568,20]}];this.m_pageSelect.setDataList(e,"l_page_txz_list");var i=[{key:1,redList:[],redPosXY:[]},{key:2,redList:[],redPosXY:[]}];this.m_pageSelect.setRedList(i)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnClose,this.close,this,!0)},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),Dispatch.register(PassTicketManager.EVENT_PSAA_TICKET_EXP_UPDATA,this.changeExp,this,!0),Dispatch.register(PassTicketManager.EVENT_PSAA_TICKET_LEVEL_UPDATA,this.changeLv,this,!0),PassTicketManager.instance.p_endTime>ServerTimeManager.instance.timer?TimeManager.instance.doLoop(this.timeDo,this):(TimeManager.instance.clearTimer(this.timeDo,this),this.u_txtTime.text="活动已结束"))},e.prototype.timeDo=function(){var t=PassTicketManager.instance.p_endTime-ServerTimeManager.instance.timer;return 0>=t?void TimeManager.instance.clearTimer(this.timeDo,this):void(this.u_txtTime.textFlow=LanguageJson.getHtmlTextFlow("l_pass_ticket_end_time1",[TimeUtil.getSpliceTime4(t)]))},e.prototype.changeExp=function(){var t=TongxingzhengLevelJson.getData(PassTicketManager.instance.p_txz_id,PassTicketManager.instance.p_lv),e=PassTicketManager.instance.p_exp,i=t.need_exp;this.u_txtJindu.text=e+"/"+i,this.u_imgJindu.width=e>i?this.m_jinduW:e/i*this.m_jinduW},e.prototype.changeLv=function(){this.u_txtNextLv.text=PassTicketManager.instance.p_lv+""},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i),TimeManager.instance.clearTimer(this.timeDo,this),Dispatch.remove(PassTicketManager.EVENT_PSAA_TICKET_EXP_UPDATA,this.changeExp,this),Dispatch.remove(PassTicketManager.EVENT_PSAA_TICKET_LEVEL_UPDATA,this.changeLv,this)},Object.defineProperty(e.prototype,"itemIdList",{get:function(){return[]},enumerable:!0,configurable:!0}),e}(UIBase);__reflect(PassTicketUI.prototype,"PassTicketUI");var PassTicketRewardPage=function(t){function e(){var e=t.call(this)||this;return e.m_maxLevel=0,e.m_levelWidth=150,e.m_ballList=[],e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/passTicketUI/page/PassTicketRewardPageSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_scrollerItem.bounces=!1,this.m_dataList=TongxingzhengLevelJson.getRewardList(PassTicketManager.instance.p_txz_id),this.m_dataList.length>0&&(this.m_maxLevel=this.m_dataList[this.m_dataList.length-1].level),this.u_imgJinduBg.width=70+this.m_maxLevel*this.m_levelWidth+200},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnBuy,this.onBuyTicket,this,!0)},e.prototype.onBuyTicket=function(t){PopupModule.instance.showPop(PopupConfig.ID_PASS_TICKET_BUY,null,!1)},e.prototype.onBuyLv=function(t){PopupModule.instance.showPop(PopupConfig.ID_PASS_TICKET_LEVEL,null,!1)},e.prototype.showView=function(e){if(void 0===e&&(e=null),this.checkComplete(this.showView,e)){t.prototype.showView.call(this,e);for(var i=0;i<this.m_dataList.length;i++){var s;this.m_ballList[i]?s=this.m_ballList[i]:(s=new PassTicketLevelView,this.m_ballList[i]=s),s.x=70+this.m_levelWidth*i-s.width/2,s.y=0,s.show(this.m_dataList[i]),this.u_mcReward.addChildAt(s,2)}this.m_box||(this.m_box=new PassTicketBigBox,this.m_box.x=this.u_imgJinduBg.x+this.u_imgJinduBg.width,this.m_box.y=168),this.u_mcReward.addChild(this.m_box),this.m_box.show(),Dispatch.register(PassTicketManager.EVENT_PURCHASE_UNLOCK,this.setBuyBtn,this,!0),this.upLevel()}},e.prototype.setBuyBtn=function(){this.u_btnBuy.visible=!PassTicketManager.instance.p_is_buy},e.prototype.upLevel=function(){if(PassTicketManager.instance.p_lv>=this.m_maxLevel)this.u_btnBuyLv.visible=!1;else{var t=TongxingzhengLevelJson.getData(PassTicketManager.instance.p_txz_id,PassTicketManager.instance.p_lv);t&&t.need_exp>0?this.u_imgJindu.width=70+PassTicketManager.instance.p_lv*this.m_levelWidth+this.m_levelWidth/2:this.u_imgJindu.width=70+this.m_maxLevel*this.m_levelWidth+200,this.u_btnBuyLv.visible=!0,this.u_btnBuyLv.x=70+PassTicketManager.instance.p_lv*this.m_levelWidth+(this.m_levelWidth-this.u_btnBuyLv.width)/2,DisplayObjectUtils.removeEventClick(this.u_btnBuyLv),DisplayObjectUtils.registerEventClick(this.u_btnBuyLv,this.onBuyLv,this,!0)}},e.prototype.hide=function(e){void 0===e&&(e=null),t.prototype.hide.call(this);for(var i=0;i<this.m_ballList.length;i++)this.m_ballList[i].hide();this.m_box&&this.m_box.hide(),Dispatch.remove(PassTicketManager.EVENT_PURCHASE_UNLOCK,this.setBuyBtn,this)},e}(PageBase);__reflect(PassTicketRewardPage.prototype,"PassTicketRewardPage");var PassTicketTaskPage=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/passTicketUI/page/PassTicketTaskPageSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this)},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&t.prototype.showView.call(this,e)},e.prototype.hide=function(e){void 0===e&&(e=null),t.prototype.hide.call(this)},e}(PageBase);__reflect(PassTicketTaskPage.prototype,"PassTicketTaskPage");var PassTicketBuyPop=function(t){function e(){var e=t.call(this)||this;return e.m_type=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/passTicketUI/popup/PassTicketBuyPopSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnClose,this.close,this,!0),this.registerEventClick(this.u_btnTips,this.onTips,this,!0),this.registerEventClick(this.u_btnBuy1,this.onBuy1,this,!0),this.registerEventClick(this.u_btnBuy2,this.onBuy2,this,!0)},e.prototype.onTips=function(t){FloatTipModule.instance.popTipLanguage("l_tongxingzheng_desc")},e.prototype.onBuy1=function(t){var e=ItemJson.getName(this.m_json.buy1_list[0]);return BagManager.instance.isEnoughProp(this.m_json.buy1_list,!1)?(this.m_type=1,void this.showTishi(this.m_json.buy1_list[1]+""+e)):void FloatTipModule.instance.popTipLanguage("l_game_tips_16",[e])},e.prototype.onBuy2=function(t){var e=ItemJson.getName(this.m_json.buy2_list[0]);return BagManager.instance.isEnoughProp(this.m_json.buy2_list,!1)?(this.m_type=2,void this.showTishi(this.m_json.buy2_list[1]+""+e)):void FloatTipModule.instance.popTipLanguage("l_game_tips_16",[e])},e.prototype.showTishi=function(t){var e="是否花费"+t+"购买?";PopupModule.instance.showTishi(e,this.sureBuy.bind(this))},e.prototype.sureBuy=function(){PassTicketManager.instance.s_tongxingzheng_purchase_unlock(this.m_type)},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),this.m_type=0,this.m_json=TongxingzhengJson.getData(PassTicketManager.instance.p_txz_id),this.u_iconCost1.source=ItemJson.getIconPath(this.m_json.buy1_list[0]),this.u_txtCost1.text=this.m_json.buy1_list[1],this.u_iconCost2.source=ItemJson.getIconPath(this.m_json.buy2_list[0]),this.u_txtCost2.text=this.m_json.buy2_list[1])},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i)},e}(PopupBase);__reflect(PassTicketBuyPop.prototype,"PassTicketBuyPop");var PassTicketEndPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/passTicketUI/popup/PassTicketEndPopSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this)},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&t.prototype.showView.call(this,e)},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i)},e}(PopupBase);__reflect(PassTicketEndPop.prototype,"PassTicketEndPop");var PassTicketLevelPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/passTicketUI/popup/PassTicketLevelPopSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnClose,this.close,this,!0),this.registerEventClick(this.u_btnBuy,this.onBuy,this,!0)},e.prototype.onBuy=function(t){if(!BagManager.instance.isEnoughProp(this.m_json.buy_level_list,!1)){var e=ItemJson.getName(this.m_json.buy_level_list[0]);return void FloatTipModule.instance.popTipLanguage("l_game_tips_16",[e])}var i="是否花费"+this.m_json.buy_level_list[1]+e+"购买?";PopupModule.instance.showTishi(i,this.sureBuy.bind(this))},e.prototype.sureBuy=function(){PassTicketManager.instance.s_tongxingzheng_purchase_level()},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),this.m_json=TongxingzhengJson.getData(PassTicketManager.instance.p_txz_id),this.u_iconCost.source=ItemJson.getIconPath(this.m_json.buy_level_list[0]),this.u_txtCost.text=this.m_json.buy_level_list[1])},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i)},e}(PopupBase);__reflect(PassTicketLevelPop.prototype,"PassTicketLevelPop");var PassTicketBigBox=function(t){function e(){var e=t.call(this)||this;return e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/passTicketUI/view/PassTicketBigBoxSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.m_item||(this.m_item=new ItemIcon,this.m_item.x=0,this.m_item.y=0),this.addChild(this.m_item),this.u_txtName.textFlow=LanguageJson.getHtmlTextFlow("l_tongxingzheng_level_max_title"),this.u_txtMsg.textFlow=LanguageJson.getHtmlTextFlow("l_tongxingzheng_level_max_desc")},e.prototype.show=function(t){void 0===t&&(t=null),this.checkComplete(this.show,t)&&(Dispatch.register(PassTicketManager.EVENT_PSAA_TICKET_BIG_BOX,this.upNum,this,!0),Dispatch.register(PassTicketManager.EVENT_PSAA_TICKET_LEVEL_RECEIVE+3,this.upNum,this))},e.prototype.upNum=function(){var t=TongxingzhengJson.getData(PassTicketManager.instance.p_txz_id);this.m_item.setData(t.max_level_item_list[0],PassTicketManager.instance.p_box_num)},e.prototype.hide=function(){DisplayObjectUtils.removeFormParent(this)},Object.defineProperty(e.prototype,"width",{get:function(){return 325},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 120},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(PassTicketBigBox.prototype,"PassTicketBigBox");var PassTicketDailyTask=function(t){function e(){var e=t.call(this)||this;return e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/passTicketUI/view/PassTicketTaskViewSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){},e.prototype.initEvent=function(){},e.prototype.show=function(t){void 0===t&&(t=null),!this.checkComplete(this.show,t)
},e.prototype.hide=function(){DisplayObjectUtils.removeFormParent(this)},Object.defineProperty(e.prototype,"width",{get:function(){return 310},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 130},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(PassTicketDailyTask.prototype,"PassTicketDailyTask");var PassTicketLevelView=function(t){function e(){var e=t.call(this)||this;return e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/passTicketUI/view/PassTicketLevelViewSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){},e.prototype.show=function(t){void 0===t&&(t=null),this.checkComplete(this.show,t)&&(this.m_json=t,this.m_json.reward1_list&&this.m_json.reward1_list.length>0?(this.m_item1||(this.m_item1=new ItemIcon,this.m_item1.horizontalCenter=0,this.m_item1.y=255,this.m_item1.scaleX=this.m_item1.scaleY=.8),this.m_item1.p_isShowTip=!1,this.addChildAt(this.m_item1,this.getChildIndex(this.u_imgReceive1)-1),this.m_item1.setData(this.m_json.reward1_list[0],this.m_json.reward1_list[1]),DisplayObjectUtils.registerEventClick(this.m_item1,this.onReceive1,this)):this.removeItem1(),this.m_json.reward2_list&&this.m_json.reward2_list.length>0?(this.m_item2||(this.m_item2=new ItemIcon,this.m_item2.horizontalCenter=0,this.m_item2.y=55),this.m_item2.p_isShowTip=!1,this.addChildAt(this.m_item2,this.getChildIndex(this.u_imgReceive2)-1),this.m_item2.setData(this.m_json.reward2_list[0],this.m_json.reward2_list[1]),DisplayObjectUtils.registerEventClick(this.m_item2,this.onReceive2,this)):this.removeItem2(),this.u_txtLv.text=this.m_json.level+"",Dispatch.register(PassTicketManager.EVENT_PSAA_TICKET_LEVEL_RECEIVE+1,this.upRewardState1,this),Dispatch.register(PassTicketManager.EVENT_PSAA_TICKET_LEVEL_RECEIVE+2,this.upRewardState2,this),Dispatch.register(PassTicketManager.EVENT_PURCHASE_UNLOCK,this.setRewardState2,this),Dispatch.register(PassTicketManager.EVENT_PSAA_TICKET_LEVEL_UPDATA,this.setReward,this),this.setRewardState1(),this.setRewardState2())},e.prototype.setReward=function(t){t==this.m_json.level&&(this.setRewardState1(),this.setRewardState2())},e.prototype.upRewardState1=function(t){t==this.m_json.level&&this.setRewardState1()},e.prototype.setRewardState1=function(){this.u_imgReceive1.visible=!1;var t=PassTicketManager.instance.p_silver_rewards.indexOf(this.m_json.level);t>-1?(this.m_item1.p_isShowTip=!0,this.u_imgReceive1.visible=!0):PassTicketManager.instance.p_lv>=this.m_json.level},e.prototype.upRewardState2=function(t){t==this.m_json.level&&this.setRewardState2()},e.prototype.setRewardState2=function(){if(this.u_imgLock.visible=!1,this.u_imgReceive2.visible=!1,this.m_json.reward2_list&&this.m_json.reward2_list.length>0)if(PassTicketManager.instance.p_is_buy){var t=PassTicketManager.instance.p_diamond_rewards.indexOf(this.m_json.level);t>-1?(this.m_item2.p_isShowTip=!0,this.u_imgReceive2.visible=!0):PassTicketManager.instance.p_lv>=this.m_json.level}else this.u_imgLock.visible=!0},e.prototype.onReceive1=function(t){PassTicketManager.instance.p_lv>=this.m_json.level?PassTicketManager.instance.s_tongxingzheng_collect_level_reward(1,this.m_json.level):FloatTipModule.instance.popTipLanguage("l_tongxingzheng_need_level")},e.prototype.onReceive2=function(t){PassTicketManager.instance.p_is_buy&&PassTicketManager.instance.p_lv>=this.m_json.level?PassTicketManager.instance.s_tongxingzheng_collect_level_reward(2,this.m_json.level):FloatTipModule.instance.popTipLanguage("l_tongxingzheng_need_buy")},e.prototype.removeItem1=function(){this.m_item1&&(this.m_item1.hide(),DisplayObjectUtils.removeEventClick(this.m_item1))},e.prototype.removeItem2=function(){this.m_item2&&(this.m_item2.hide(),DisplayObjectUtils.removeEventClick(this.m_item2))},e.prototype.hide=function(){this.removeItem1(),this.removeItem2(),DisplayObjectUtils.removeFormParent(this)},Object.defineProperty(e.prototype,"width",{get:function(){return 150},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 370},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(PassTicketLevelView.prototype,"PassTicketLevelView");var PassTicketMonthTask=function(){function t(){}return t}();__reflect(PassTicketMonthTask.prototype,"PassTicketMonthTask");var PassTicketTaskView=function(){function t(){}return t}();__reflect(PassTicketTaskView.prototype,"PassTicketTaskView");var PersonalizationUI=function(t){function e(){var e=t.call(this)||this;return e.m_dataArr=[],e.m_arrCollection=new eui.ArrayCollection,e.m_disposeUrlList.push("personalizationUI_json"),e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/personalizationUI/PersonalizationUISkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_titleLb.text=LanguageJson.getText("l_setting_title"),this.u_btn0.label=LanguageJson.getText("l_setting_head"),this.u_btn1.label=LanguageJson.getText("l_setting_head_frame"),this.u_btn2.label=LanguageJson.getText("l_setting_chat_bubble"),this.u_btn0.type=ItemTypeEnum.HEAD,this.u_btn1.type=ItemTypeEnum.HEAD_FRAME,this.u_btn2.type=ItemTypeEnum.CHAT_BUBBLES,this.initScroller(this.u_scroller,this.u_list,this.m_dataArr,this.m_arrCollection)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_closeBtn,this.close,this),this.registerEventClick(this.u_btn0,this.changeType,this),this.registerEventClick(this.u_btn1,this.changeType,this),this.registerEventClick(this.u_btn2,this.changeType,this),this.registerEventClick(this.u_choseBtn,this.onUse,this)},e.prototype.initScroller=function(t,e,i,s){t.horizontalScrollBar=null,t.verticalScrollBar=null,t.scrollPolicyH=eui.ScrollPolicy.OFF,t.scrollPolicyV=eui.ScrollPolicy.AUTO;var n=new eui.TileLayout;n.requestedColumnCount=4,n.orientation=eui.TileOrientation.ROWS,n.verticalGap=20,n.horizontalGap=20,e.itemRenderer=PersonalIconRender,e.layout=n,e.dataProvider=s,s.source=i,e.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onChange,this)},e.prototype.changeType=function(t){var e=t.target;e.currentState==PersonalButton.normal&&(this.m_selectBtn.changeState(PersonalButton.normal),e.changeState(PersonalButton.selected),this.m_selectBtn=e),this.setView()},e.prototype.setView=function(){var t=this;this.m_type=this.m_selectBtn.type,this.u_titleLb1.text=this.m_selectBtn.label;var e=ItemJson.getListByType(this.m_type),i=[],s=[];e.forEach(function(t){var e=BagManager.instance.getNum(t.id);e>0?i.push(t):s.push(t)}),this.m_dataArr=i.concat(s),this.m_arrCollection.source=this.m_dataArr,this.m_arrCollection.refresh(),-1==this.m_selectBtn.selectedIndex&&(this.m_selectBtn.selectedIndex=this.selectIndex),DelayCallUtils.delayedCall(.05,function(){t.u_list.selectedIndex=t.m_selectBtn.selectedIndex,t.setDetail(t.m_dataArr[t.m_selectBtn.selectedIndex])},this)},e.prototype.refreshView=function(){this.m_arrCollection.refresh(),this.setDetail(this.m_dataArr[this.m_selectBtn.selectedIndex])},Object.defineProperty(e.prototype,"selectIndex",{get:function(){var t=PlayerManager.instance.p_playerInfo.player_other_data,e=this.m_type==ItemTypeEnum.HEAD?t.head_id:this.m_type==ItemTypeEnum.HEAD_FRAME?t.head_frame_id:t.chat_qi_pao_id,i=-1;return this.m_dataArr.every(function(t,s){return t.icon==e?(i=s,!1):!0}),i>-1?i:0},enumerable:!0,configurable:!0}),e.prototype.onChange=function(t){var e=t.target;this.m_selectBtn.selectedIndex=e.selectedIndex;var i=e.selectedItem;this.setDetail(i)},e.prototype.setDetail=function(t){this.m_selectedItem=t,this.u_icon.height=t.type==ItemTypeEnum.CHAT_BUBBLES?24:100;var e=t.type==ItemTypeEnum.CHAT_BUBBLES?35:15;this.u_detailGrp.y=this.u_icon.y+this.u_icon.height+e,this.u_icon.source=PublicCon.PATH_PERSONAL_ICON+t.icon+".png",this.u_nameLb.text=t.name,this.u_detailLb.textFlow=HtmlUtil.setTextFlow(ItemJson.getSource(t.id)),BagManager.instance.getNum(t.id)>0?(this.u_lockImg.visible=!1,this.u_choseLb.text=LanguageJson.getText("l_setting_chose"),this.u_choseLb.horizontalCenter=0,this.u_choseBtn.touchEnabled=!0):(this.u_lockImg.visible=!0,this.u_choseLb.text=LanguageJson.getText("l_setting_lock"),this.u_choseLb.horizontalCenter=15,this.u_choseBtn.touchEnabled=!1);var i=PlayerManager.instance.p_playerInfo.player_other_data,s=!1;s=t.type==ItemTypeEnum.HEAD?t.icon==i.head_id:t.type==ItemTypeEnum.HEAD_FRAME?t.icon==i.head_frame_id:t.icon==i.chat_qi_pao_id,this.u_choseBtn.visible=s?!1:!0},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),this.m_selectBtn||(this.u_btn0.changeState(PersonalButton.selected),this.m_selectBtn=this.u_btn0),this.setView(),Dispatch.register(PlayerManager.EVENT_PLAYER_INFO+proto.Attr.head_id,this.refreshView,this),Dispatch.register(PlayerManager.EVENT_PLAYER_INFO+proto.Attr.head_frame_id,this.refreshView,this),Dispatch.register(PlayerManager.EVENT_PLAYER_INFO+proto.Attr.chat_qi_pao_id,this.refreshView,this))},e.prototype.onUse=function(){var t=this.m_type==ItemTypeEnum.HEAD?1:this.m_type==ItemTypeEnum.HEAD_FRAME?2:3;PlayerManager.instance.s_set_player_data(t,this.m_selectedItem.id)},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i),Dispatch.remove(PlayerManager.EVENT_PLAYER_INFO+proto.Attr.head_id,this.setView,this),Dispatch.remove(PlayerManager.EVENT_PLAYER_INFO+proto.Attr.head_frame_id,this.setView,this),Dispatch.remove(PlayerManager.EVENT_PLAYER_INFO+proto.Attr.chat_qi_pao_id,this.setView,this)},e.prototype.sureHide=function(e,i){void 0===i&&(i=null),t.prototype.sureHide.call(this,e,i)},Object.defineProperty(e.prototype,"isClickBMask",{get:function(){return!1},enumerable:!0,configurable:!0}),e}(PopupBase);__reflect(PersonalizationUI.prototype,"PersonalizationUI");var PersonalIconRender=function(t){function e(){return t.call(this,"resource/eui_skins/personalizationUI/render/PersonalIconRenderSkin.exml")||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_using.text=LanguageJson.getText("l_setting_using")},e.prototype.initEvent=function(){t.prototype.initEvent.call(this)},e.prototype.dataChanged=function(){if(this.checkComplete(this.dataChanged)){t.prototype.dataChanged.call(this);var e=this.data;this.u_icon.height=e.type==ItemTypeEnum.CHAT_BUBBLES?this.height/250*60:this.height,this.u_icon.source=PublicCon.PATH_PERSONAL_ICON+e.icon+".png",this.u_lockImg.visible=0==BagManager.instance.getNum(e.id),this.u_using.visible=this.isUsing}},Object.defineProperty(e.prototype,"selected",{set:function(t){this.u_selectImg.visible=this.isUsing?!1:t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isUsing",{get:function(){var t=this.data;if(!t)return!1;var e=PlayerManager.instance.p_playerInfo.player_other_data,i=!1;return i=t.type==ItemTypeEnum.HEAD?t.icon==e.head_id:t.type==ItemTypeEnum.HEAD_FRAME?t.icon==e.head_frame_id:t.icon==e.chat_qi_pao_id},enumerable:!0,configurable:!0}),e}(ItemRendererBase);__reflect(PersonalIconRender.prototype,"PersonalIconRender");var PersonalButton=function(t){function e(){var e=t.call(this)||this;return e.selectedIndex=-1,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.currentState=e.normal},e.prototype.changeState=function(t){this.currentState=t},e.normal="up",e.selected="down",e}(eui.Button);__reflect(PersonalButton.prototype,"PersonalButton");var PersonalHead=function(t){function e(){var e=t.call(this)||this;return e.p_showLevel=!0,e.initView(),e.initEvent(),e}return __extends(e,t),e.prototype.initView=function(){if(this.m_iconFrame||(this.m_iconFrame=new eui.Image,this.m_iconFrame.x=0,this.m_iconFrame.y=0,this.addChild(this.m_iconFrame)),!this.m_icon){this.m_icon=new eui.Image,this.m_icon.x=0,this.m_icon.y=0,this.m_icon.width=this.width,this.m_icon.height=this.height,this.addChild(this.m_icon);var t=new egret.Shape;t.graphics.beginFill(16777215),t.graphics.drawCircle(this.width/2,this.height/2,this.width/2-10),t.graphics.endFill(),this.addChild(t),this.m_icon.mask=t}this.m_levelGrp||(this.m_levelGrp=new eui.Group,this.m_levelGrp.x=20,this.m_levelGrp.y=this.height-20,this.addChild(this.m_levelGrp),this.m_levelBg=new eui.Image("sceneMainUI_json.sceneMainUI_img_dj"),this.m_levelBg.x=0,this.m_levelBg.y=0,this.m_levelGrp.addChild(this.m_levelBg),this.m_txtLb=new eui.Label,this.m_txtLb.y=5,this.m_txtLb.size=16,this.m_txtLb.textColor=15787184,this.m_txtLb.horizontalCenter=0,this.m_levelGrp.addChild(this.m_txtLb))},e.prototype.initEvent=function(){this.addEventListener(egret.TouchEvent.REMOVED_FROM_STAGE,this.setRemoveStage,this),this.addEventListener(egret.TouchEvent.ADDED_TO_STAGE,this.setAddStage,this)},e.prototype.showView=function(t,e,i){null==t&&(t=PlayerManager.instance.p_playerInfo.player_other_data),this.setView(t),this.m_id=e,this.setAddStage(),this.m_txtLb.text=String(i),this.m_levelGrp.visible=this.p_showLevel},e.prototype.setView=function(t){this.m_iconFrame.source=PublicCon.PATH_PERSONAL_ICON+t.head_frame_id+".png",this.m_icon.source=PublicCon.PATH_PERSONAL_ICON+t.head_id+".png"},e.prototype.setAddStage=function(){this.m_id==PlayerManager.instance.p_playerInfo.player_id&&(Dispatch.register(PlayerManager.EVENT_PLAYER_INFO+proto.Attr.head_id,this.setHeadIcon,this),Dispatch.register(PlayerManager.EVENT_PLAYER_INFO+proto.Attr.head_frame_id,this.setHeadFrame,this),Dispatch.register(PlayerManager.EVENT_PLAYER_INFO+proto.Attr.level,this.setPlayerLevel,this))},e.prototype.setRemoveStage=function(){this.m_id==PlayerManager.instance.p_playerInfo.player_id&&(Dispatch.remove(PlayerManager.EVENT_PLAYER_INFO+proto.Attr.head_id,this.setHeadIcon,this),Dispatch.remove(PlayerManager.EVENT_PLAYER_INFO+proto.Attr.head_frame_id,this.setHeadFrame,this),Dispatch.remove(PlayerManager.EVENT_PLAYER_INFO+proto.Attr.level,this.setPlayerLevel,this))},e.prototype.setHeadIcon=function(){var t=PlayerManager.instance.p_playerInfo.player_other_data;this.m_icon.source=PublicCon.PATH_PERSONAL_ICON+t.head_id+".png"},e.prototype.setHeadFrame=function(){var t=PlayerManager.instance.p_playerInfo.player_other_data;this.m_iconFrame.source=PublicCon.PATH_PERSONAL_ICON+t.head_frame_id+".png"},e.prototype.setPlayerLevel=function(){var t=PlayerManager.instance.p_playerInfo.level;this.m_txtLb.text=String(t)},Object.defineProperty(e.prototype,"width",{get:function(){return 88},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 88},enumerable:!0,configurable:!0}),e}(eui.Component);__reflect(PersonalHead.prototype,"PersonalHead");var ConditionsEnumJson=function(){function t(){}return t.getData=function(e){if(null==t.jsonData2){t.jsonData2=[];for(var i in t.jsonData)t.jsonData2[t.jsonData[i].sign]=t.jsonData[i]}var s=e,n=this.jsonData2[s];return n||""==e||egret.log(this.FileName+" :不存在["+s+"]项！"),n},t.getDataById=function(t){var e=t,i=this.jsonData[e];return i||0==t||egret.log(this.FileName+" :不存在["+t+"]项！"),i},t.FileName="conditions_enum",t}();__reflect(ConditionsEnumJson.prototype,"ConditionsEnumJson"),window.ConditionsEnumJson=ConditionsEnumJson;var PopupConfig=function(){function t(){}return t.initPopup=function(){this.list_popup[this.ID_LOGIN_ANNOUNC]=LoginAnnounce,this.list_popup[this.ID_SERVER_LIST]=ServerListUI,this.list_popup[this.ID_ITEM_USE]=ItemUsePopup,this.list_popup[this.ID_RULE]=RulePopup,this.list_popup[this.ID_SETTING]=GameSettingUI,this.list_popup[this.ID_SHOP_BUY]=ShopBuyPopup,this.list_popup[this.ID_REWARD_SHOW]=RewardShowPopup,this.list_popup[this.ID_REWARDS_RECEIVE]=RewardReceivePopup,this.list_popup[this.ID_ITEM_ACCESS]=AccessPopup,this.list_popup[this.ID_MULTI_FIND_ROOM]=MultiFindRoomPopup,this.list_popup[this.ID_MULTI_JOIN_ROOM]=MultiJoinRoomPopup,this.list_popup[this.ID_MULTI_WAIT_ROOM]=MultiWaitPopup,this.list_popup[this.ID_MULTI_OWNER_COMPLETE]=MultiCompletePopup,this.list_popup[this.ID_MULTI_FIRST_PRIZE]=MissionFirstPrizePopup,this.list_popup[this.ID_MULTI_OTHER_PRIZE]=MissionPrizePopup,this.list_popup[this.ID_MISSION_FAIL]=MissionFailPopup,this.list_popup[this.ID_GUESS_BOSS_RESULT]=GuessResultPopup,this.list_popup[this.ID_GUESS_BOSS_EFFECT]=GuessEffectPopup,this.list_popup[this.ID_SHISHI_BOSS_RESULT]=MissionShishiFirst,this.list_popup[this.ID_SHISHI_BOSS_RESULT2]=MissionShishiSecond,this.list_popup[this.ID_GUESS_BOSS_FIGHT]=GuessFightPopup,this.list_popup[this.ID_POPUP_TISHI]=PopupMsgUI,this.list_popup[this.ID_WELCOME]=WelcomeUI,this.list_popup[this.ID_USER_XIEYI]=LoginXieyi,this.list_popup[this.ID_TURNTABLE_DRAW]=TurnTableUI,this.list_popup[this.ID_FIRST_CHARGE]=FirstRechargeUI,this.list_popup[this.ID_MISSION_MULTI_FIND]=MissionMultiFindPopup,this.list_popup[this.ID_MISSION_MULTI_JOIN]=MissionMultiJoinPopup,this.list_popup[this.ID_MISSION_MULTI_VICTORY]=MissionMultiVictoryPopup,this.list_popup[this.ID_MISSION_MULTI_FAIL]=MissionMultiVictoryPopup,this.list_popup[this.ID_RED_PACKET]=RedPacketPopup,this.list_popup[this.ID_BRAVE_ONE_WAIT]=SoloWaitPopup,this.list_popup[this.ID_ACCREDIT]=AccreditUI,this.list_popup[this.ID_RECYCLE]=WithdrawalPopup,this.list_popup[this.ID_RECYCLE_HISTORY]=WithdrawalRecordPop,this.list_popup[this.ID_RECYCLE_RESULT]=WithdrawalResultPop,this.list_popup[this.ID_COURSE]=CourseUI,this.list_popup[this.ID_HERO_DESC]=RoleDescPopup,this.list_popup[this.ID_HERO_SKILL_PLAY]=RoleVideoPopup,this.list_popup[this.ID_CARD_BOOK_INFO]=CardInfoPopup,this.list_popup[this.ID_CARD_BOOK_REWARD]=CardRewardPopup,this.list_popup[this.ID_BOSS_EVENT]=BossEventPopup,this.list_popup[this.ID_ROTARY_TABLE]=RotaryTableUI,this.list_popup[this.ID_MONSTER_ROLL]=MonsterRollUI,this.list_popup[this.ID_CARD_POPUP]=CardPopup,this.list_popup[this.ID_LUCK_BOSS]=LuckBossUI,this.list_popup[this.ID_LUCK_BOSS_FIRST_ENTER]=LuckBossFTPopup,this.list_popup[this.ID_LUCK_BOSS_RECORD]=LuckBossChartPopup,this.list_popup[this.ID_LUCK_BOSS_RESULT]=LuckBossResultPopup,this.list_popup[this.ID_CREATE_ROLE]=CreateRolePopup,this.list_popup[this.ID_DRAW_CARD_REWARD]=DrawCardRewardPopup,this.list_popup[this.ID_DRAW_CARD_SUMMON]=DrawCardSummonPopup,this.list_popup[this.ID_GUESS_WIN]=GuessWinPopup,this.list_popup[this.ID_GUESS_LOSER]=GuessLoserPopup,this.list_popup[this.ID_LUCKYDRAW_REWARD]=LuckyDrawRewardPop,this.list_popup[this.ID_LUCKYDRAW_REWARD_EXTRA]=LuckyDrawExtraRewardPop,this.list_popup[this.ID_GODDRAGON_LOTTERY]=GodDragonPopup,this.list_popup[this.ID_COMBAT_RANK]=RankPopup,this.list_popup[this.ID_MINMAP]=MinMapPopup,this.list_popup[this.ID_PERSONALIZATION]=PersonalizationUI,this.list_popup[this.ID_EXCHANGE_SHOP]=ExchangeShopUI,this.list_popup[this.ID_MAIL]=MailPopup,this.list_popup[this.ID_PASS_TICKET_BUY]=PassTicketBuyPop,this.list_popup[this.ID_PASS_TICKET_LEVEL]=PassTicketLevelPop,this.list_popup[this.ID_PASS_TICKET_END]=PassTicketEndPop},t.ID_SM_FIND_FAULT=1,t.ID_SM_PUZZLE=2,t.ID_SM_DONT_TOUCH_WHITE=3,t.ID_SM_WUZIQI=4,t.ID_SM_DUILIAN=5,t.ID_SM_BLOCK_HERO=6,t.ID_SM_JIGSAW=7,t.ID_SM_JUMP=8,t.ID_SM_WUYIN=9,t.ID_SM_FANPAI=10,t.ID_SM_RUNAWAY=11,t.ID_SM_HIGH_JUMP=12,t.ID_SM_PICKUP=13,t.ID_SM_FAPPYBIRD=14,t.ID_SM_BOARD=15,t.ID_SM_DART=16,t.ID_SM_DRESS_UP=17,t.ID_SM_BUY_TIME=150,t.ID_SM_BUY_STEP=151,t.ID_SM_JIGSAW_LOOK=152,t.ID_SM_DRESS_UP_PREVIEW=153,t.ID_LOGIN_ANNOUNC=200,t.ID_SERVER_LIST=201,t.ID_ITEM_ACCESS=202,t.ID_ITEM_USE=203,t.ID_POPUP_TISHI=205,t.ID_POPUP_PRIZE_TISHI=206,t.ID_REWARD_SHOW=209,t.ID_REWARDS_RECEIVE=210,t.ID_SHOP_BUY=211,t.ID_RULE=213,t.ID_SETTING=214,t.ID_MULTI_FIND_ROOM=215,t.ID_MULTI_JOIN_ROOM=216,t.ID_MULTI_WAIT_ROOM=217,t.ID_MULTI_OWNER_COMPLETE=218,t.ID_MULTI_FIRST_PRIZE=219,t.ID_MULTI_OTHER_PRIZE=220,t.ID_MISSION_FAIL=222,t.ID_WELCOME=230,t.ID_GUESS_BOSS_RESULT=231,t.ID_SHISHI_BOSS_RESULT=232,t.ID_SHISHI_BOSS_RESULT2=233,t.ID_GUESS_BOSS_EFFECT=235,t.ID_GUESS_BOSS_FIGHT=240,t.ID_USER_XIEYI=241,t.ID_TURNTABLE_DRAW=242,t.ID_FIRST_CHARGE=243,t.ID_MISSION_MULTI_FIND=245,t.ID_MISSION_MULTI_JOIN=246,t.ID_MISSION_MULTI_VICTORY=247,t.ID_MISSION_MULTI_FAIL=248,t.ID_RED_PACKET=250,t.ID_BRAVE_ONE_WAIT=252,t.ID_ACCREDIT=254,t.ID_RECYCLE=255,t.ID_RECYCLE_HISTORY=256,t.ID_RECYCLE_RESULT=257,t.ID_COURSE=258,t.ID_HERO_DESC=260,t.ID_HERO_SKILL_PLAY=261,t.ID_CARD_BOOK_INFO=262,t.ID_CARD_BOOK_REWARD=263,t.ID_BOSS_EVENT=264,t.ID_ROTARY_TABLE=270,t.ID_MONSTER_ROLL=273,t.ID_CREATE_ROLE=274,t.ID_CARD_POPUP=275,t.ID_GUESS_WIN=277,t.ID_GUESS_LOSER=278,t.ID_LUCKYDRAW_REWARD=279,t.ID_LUCKYDRAW_REWARD_EXTRA=280,t.ID_DRAW_CARD_REWARD=285,t.ID_DRAW_CARD_SUMMON=286,t.ID_LUCK_BOSS=290,t.ID_LUCK_BOSS_FIRST_ENTER=291,t.ID_LUCK_BOSS_RECORD=292,t.ID_LUCK_BOSS_RESULT=293,t.ID_GODDRAGON_LOTTERY=294,t.ID_COMBAT_RANK=295,t.ID_MINMAP=296,t.ID_PERSONALIZATION=297,t.ID_EXCHANGE_SHOP=298,t.ID_MAIL=299,t.ID_PASS_TICKET_BUY=300,t.ID_PASS_TICKET_LEVEL=301,t.ID_PASS_TICKET_END=302,t.list_popup=[],t.list_icon_haskey={},t}();__reflect(PopupConfig.prototype,"PopupConfig");var PopupModule=function(t){function e(){var e=t.call(this)||this;return e.m_popupList=[],e.m_popupCurrList=[],e.m_popupBassList=[],e.m_tishiObj={},e.m_poptIdList=[],e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.m_instance||(this.m_instance=new e),this.m_instance},enumerable:!0,configurable:!0}),e.prototype.init=function(t){this.m_root=t,PopupConfig.initPopup(),this.m_tipRoot||(this.m_tipRoot=new egret.DisplayObjectContainer,t.addChild(this.m_tipRoot)),Dispatch.register(StageManager.EVENT_STAGE_RESIZE,this.stageResize,this,!0)},e.prototype.stageResize=function(){this.m_maskImg&&(this.m_maskImg.width=StageManager.instance.p_stageWidth,this.m_maskImg.height=StageManager.instance.p_stageHeight)},e.prototype.hideTishiPrizeCheck=function(t){var e=[];this.m_tishiObj[PopupConfig.ID_POPUP_PRIZE_TISHI]?e=this.m_tishiObj[PopupConfig.ID_POPUP_PRIZE_TISHI]:this.m_tishiObj[PopupConfig.ID_POPUP_PRIZE_TISHI]=e,e.push(t),this.setBMask()},e.prototype.showTishiSingle=function(t,e,i,s,n){void 0===e&&(e=null),void 0===i&&(i=null),void 0===s&&(s="YES"),void 0===n&&(n=0),this.showTishi(t,e,i,s,"",n)},e.prototype.showTishiPrompt=function(t,e,i,s,n,o,a){void 0===e&&(e=null),void 0===i&&(i=null),void 0===s&&(s=null),void 0===n&&(n="NO"),void 0===o&&(o="YES"),void 0===a&&(a=0);var r=PopupMsgJson.getData(t);return null!=r?this.getTishiPromt(r)?void(null!=e&&e.apply(null,[1])):void this.showTishi(HtmlUtil.setText(r.content,i),e,s,n,o,a,t):void 0},e.prototype.showTishi=function(t,e,i,s,n,o,a){void 0===e&&(e=null),void 0===i&&(i=null),void 0===s&&(s="YES"),void 0===n&&(n="NO"),void 0===o&&(o=0),void 0===a&&(a=0);var r;r=this.m_tishiObj[PopupConfig.ID_POPUP_TISHI]&&this.m_tishiObj[PopupConfig.ID_POPUP_TISHI].length>0?this.m_tishiObj[PopupConfig.ID_POPUP_TISHI].shift():new PopupConfig.list_popup[PopupConfig.ID_POPUP_TISHI],r.setId(0,{c_msg:t,c_backFunc:e,c_backData:i,c_leftBtn:s,c_rightBtn:n,c_time:o,c_popupMsgId:a,c_hideFunc:this.hideTishiCheck.bind(this)}),this.m_tipRoot.addChild(r),this.setBMask()},e.prototype.hideTishiCheck=function(t){var e=[];this.m_tishiObj[PopupConfig.ID_POPUP_TISHI]?e=this.m_tishiObj[PopupConfig.ID_POPUP_TISHI]:this.m_tishiObj[PopupConfig.ID_POPUP_TISHI]=e,e.push(t),this.setBMask()},e.prototype.showPop=function(t,e,i){if(void 0===e&&(e=null),void 0===i&&(i=!0),i&&this.m_popupBassList.length>0)return this.m_popupCurrList.push({c_id:t,c_data:e}),void this.setBMask();if(!this.havPopupStage(t)){var s;this.m_popupList[t]?s=this.m_popupList[t]:(s=new PopupConfig.list_popup[t],this.m_popupList[t]=s),this.m_popupBassList.push(s),s.setId(t,e)}},e.prototype.addPopup=function(t){this.m_tipRoot.addChild(t),this.setBMask()},e.prototype.showAccess=function(t){if(ItemEnum.GOLD==t)BagManager.instance.noEnoughGold();else if(ItemEnum.RMB==t)BagManager.instance.noEnoughRmb();else{var e=ItemJson.getData(t);if(null==e)return;e.output_list&&e.output_list.length>0&&!this.havPopupStage(PopupConfig.ID_ITEM_ACCESS)?this.showPop(PopupConfig.ID_ITEM_ACCESS,{c_itemId:t},!1):FloatTipModule.instance.popTipLanguage("l_game_tips_16",[e.name])}},e.prototype.hidePopAll=function(){for(;this.m_tipRoot.numChildren>0;){var t=this.m_tipRoot.removeChildAt(0);t&&t instanceof PopupBase&&t.hide(null,{c_allClose:1})}this.m_popupCurrList=[],this.m_popupBassList=[],this.setBMask()},e.prototype.hidePop=function(t){if(this.m_popupBassList&&this.m_popupBassList.length>0){for(var e=0;e<this.m_popupBassList.length;e++)if(this.m_popupBassList[e].id==t){var i=this.m_popupBassList[e];this.m_popupBassList.splice(e,1),i.hide(this.sureHidePop.bind(this),null);break}}else this.sureHidePop(null)},e.prototype.sureHidePop=function(t,e){if(void 0===e&&(e=null),this.m_popupCurrList&&this.m_popupCurrList.length>0){var i=this.m_popupCurrList.shift();1==i.c_isCache?this.showPop(i.c_id,i.c_data,!1):this.showPop(i.c_id,i.c_data)}else this.setBMask()},e.prototype.setBMask=function(){if(this.m_maskImg)if(null!=this.m_maskImg.parent&&this.m_maskImg.parent.removeChild(this.m_maskImg),this.m_tipRoot.numChildren>0){var t=this.m_tipRoot.getChildAt(this.m_tipRoot.numChildren-1);t&&t instanceof PopupMsgUI?(this.m_tipRoot.addChildAt(this.m_maskImg,this.m_tipRoot.numChildren-1),this.m_maskImg.alpha=t.alphaBMask):t&&t instanceof PopupPrizeMsgUI?(this.m_tipRoot.addChildAt(this.m_maskImg,this.m_tipRoot.numChildren-1),this.m_maskImg.alpha=t.alphaBMask):t&&this.m_popupBassList.indexOf(t)>-1&&t.isShowBMask&&(this.m_tipRoot.addChildAt(this.m_maskImg,this.m_tipRoot.numChildren-1),this.m_maskImg.alpha=t.alphaBMask)}else TexturePool.instance.destoryAtlasFrom(TextureFrom.UI_EFFECT);else{var e=this.m_maskImg=new eui.Image("commonUI_box");e.scale9Grid=UIModule.instance.getRectangle(),e.width=StageManager.instance.p_stageWidth,e.height=StageManager.instance.p_stageHeight,this.m_maskImg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeBMask,this),this.setBMask()}},e.prototype.closeBMask=function(t){if(void 0===t&&(t=null),this.m_popupBassList.length>0){var e=this.m_tipRoot.getChildAt(this.m_tipRoot.numChildren-1);this.m_popupBassList.indexOf(e)>-1&&e.isClickBMask&&this.hidePop(e.id)}},e.prototype.havPopupStage=function(t){if(this.m_popupBassList&&this.m_popupBassList.length>0)for(var e=0;e<this.m_popupBassList.length;e++)if(this.m_popupBassList[e].id==t)return!0;return!1},e.prototype.isHavPopupStage=function(){return this.m_tipRoot&&this.m_tipRoot.numChildren>0?!0:!1},e.prototype.addCurrPopup=function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=!0),0==i?this.m_popupCurrList.push({c_id:t,c_data:e,c_isCache:1}):this.m_popupCurrList.push({c_id:t,c_data:e})},e.prototype.getTishiPromt=function(t){if(null==t)return!1;if(t.type==PopupMsgTypeEnum.PUP_MSG_TYPE_1&&this.m_poptIdList.indexOf(t.id)>-1)return!0;if(t.type==PopupMsgTypeEnum.PUP_MSG_TYPE_2){var e=egret.localStorage.getItem(this.promptKey+t.id);if(""!=e&&null!=e){if(Number(e)>ServerTimeManager.instance.timer)return!0;egret.localStorage.removeItem(this.promptKey+t.id)}}return!1},e.prototype.setTishiPrompt=function(t){var e=PopupMsgJson.getData(t);null!=e&&(e.type==PopupMsgTypeEnum.PUP_MSG_TYPE_1&&-1==this.m_poptIdList.indexOf(t)?this.m_poptIdList.push(t):e.type==PopupMsgTypeEnum.PUP_MSG_TYPE_2&&egret.localStorage.setItem(this.promptKey+e.id,ServerTimeManager.instance.getTodayTimes("235959")+1+""))},Object.defineProperty(e.prototype,"promptKey",{get:function(){return PlayerManager.instance.p_playerInfo?PlayerManager.instance.playerId+"promptKey":"promptKey"},enumerable:!0,configurable:!0}),e.prototype.pop=function(t){this.m_root&&t&&this.m_root.addChild(t)},e}(egret.HashObject);__reflect(PopupModule.prototype,"PopupModule");var PopupMsgUI=function(t){function e(){var e=t.call(this)||this;return e.m_tishiIs=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/commonsUI/PopupMsgTipSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.m_showGuideKeyList.push(GuideConfig.guide_popup_msg),this.registerEventClick(this.u_mcTishi,this.onTishi,this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClcik,this)},e.prototype.guideSure=function(t){this.closeView(1)},e.prototype.onTishi=function(t){this.m_tishiIs=!this.m_tishiIs,this.u_imgGou.visible=this.m_tishiIs},e.prototype.onClcik=function(t){LoginManager.instance.p_isOverRenZhen&&(t.stopPropagation(),t.stopImmediatePropagation())},e.prototype.onRight=function(t){this.closeView(1)},e.prototype.onLeft=function(t){this.closeView(2)},e.prototype.closeView=function(t){var e=this.m_data.c_backFunc;null!=e&&(this.m_data.c_backData?e.apply(null,[t,this.m_data.c_backData]):0==e.length?1==t&&e.apply(null,[1]):e.apply(null,[t]),e=null),this.hide(this.sureClsoe.bind(this),null)},e.prototype.sureClsoe=function(t){void 0===t&&(t=null);var e=this.m_data.c_hideFunc;e.apply(null,[this])},e.prototype.hide=function(e,i){TimeManager.instance.clearTimer(this.clsoeTime,this),Dispatch.remove(GuideConfig.guide_popup_msg,this.guideSure,this),this.removeEventClick(this.u_btnLeft),this.removeEventClick(this.u_btnRight),this.m_popupMsgId>0&&this.m_tishiIs&&PopupModule.instance.setTishiPrompt(this.m_popupMsgId),t.prototype.hide.call(this,e,i)},e.prototype.showView=function(e){if(void 0===e&&(e=null),this.checkComplete(this.showView,e)){if(t.prototype.showView.call(this,e),Dispatch.register(GuideConfig.guide_popup_msg,this.guideSure,this),this.m_data=e,this.u_mcTishi.visible=!1,this.m_popupMsgId=0,this.m_data.c_popupMsgId&&this.m_data.c_popupMsgId>0){this.m_popupMsgId=this.m_data.c_popupMsgId,this.m_tishiIs=!1,this.u_mcTishi.visible=!0,this.u_imgGou.visible=!1;var i=PopupMsgJson.getData(this.m_popupMsgId).type;this.u_txtTishiMsg.text=PopupMsgTypeJson.getData(i).name,this.u_btnRight.y=252,this.u_btnLeft.y=252}else this.u_btnRight.y=230,this.u_btnLeft.y=230;""==this.m_data.c_leftBtn?this.u_btnRight.visible=!1:(this.u_btnRight.visible=!0,this.u_txtRight.textFlow=TextUtil.setTextFlow(this.m_data.c_leftBtn),""==this.m_data.c_rightBtn?this.u_btnRight.x=259:this.u_btnRight.x=385),""==this.m_data.c_rightBtn?this.u_btnLeft.visible=!1:(this.u_btnLeft.visible=!0,this.u_txtLeft.textFlow=TextUtil.setTextFlow(this.m_data.c_rightBtn),""==this.m_data.c_leftBtn?this.u_btnLeft.x=259:this.u_btnLeft.x=133),this.registerEventClick(this.u_btnLeft,this.onLeft,this,!0),this.registerEventClick(this.u_btnRight,this.onRight,this,!0),this.u_txtMsg.textFlow=HtmlUtil.setTextFlow(e.c_msg),this.m_data.c_time>0?(this.u_txtCountdown.visible=!0,this.m_time=this.m_data.c_time,TimeManager.instance.doLoop(this.clsoeTime,this)):this.u_txtCountdown.visible=!1}},e.prototype.clsoeTime=function(){return this.m_time<=0?void this.closeView(1):(this.u_txtCountdown.textFlow=LanguageJson.getHtmlTextFlow("l_game_unit_s",[this.m_time]),void(this.m_time-=1))},e.prototype.addStageThis=function(){PopupModule.instance.addPopup(this)},Object.defineProperty(e.prototype,"isClickBMask",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return 625},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 346},enumerable:!0,configurable:!0}),e}(PopupBase);__reflect(PopupMsgUI.prototype,"PopupMsgUI");var PopupPrizeMsgUI=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/commonsUI/PopupPrizeSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){this.m_initY=this.u_scrollerItem.y,this.m_rewardGroup||(this.m_rewardGroup=new RewardGroupUI,this.m_rewardGroup.spaceX=15,this.m_rewardGroup.y=235,this.addChild(this.m_rewardGroup))},e.prototype.initEvent=function(){this.u_btnClose.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.u_btnLeft.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLeft,this),this.u_btnRight.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRight,this)},e.prototype.onLeft=function(t){this.closeView(1)},e.prototype.onRight=function(t){this.closeView(2)
},e.prototype.onClose=function(t){this.closeView(3)},e.prototype.closeView=function(t){var e=this.m_data.backFunc;null!=e&&(this.m_data.backData?e.apply(null,[t,this.m_data.backData]):0==e.length?1==t&&e.apply(null,[1]):e.apply(null,[t]),e=null),this.hide(this.sureClsoe.bind(this),null)},e.prototype.sureClsoe=function(t){void 0===t&&(t=null);var e=this.m_data.hideFunc;e.apply(null,[this])},e.prototype.showView=function(e){if(void 0===e&&(e=null),this.checkComplete(this.showView,e)){t.prototype.showView.call(this,e),this.m_data=e;var i=e.dataList;if(this.m_rewardGroup.scroller.viewport.scrollH=0,i&&i.length>0){if(i.length>=5)this.m_rewardGroup.visualWidth=480,this.m_rewardGroup.x=(this.width-480)/2;else{this.m_rewardGroup.visualWidth=0;var s=86*i.length+15*(i.length-1);this.m_rewardGroup.x=(this.width-s)/2}this.m_rewardGroup.visible=!0,this.m_rewardGroup.setData(i,i.length)}else this.m_rewardGroup.visible=!1;""==this.m_data.leftBtn?this.u_btnLeft.visible=!1:(this.u_btnLeft.visible=!0,this.u_txtLeft.textFlow=TextUtil.setTextFlow(this.m_data.leftBtn),""==this.m_data.rightBtn?this.u_btnLeft.x=231:this.u_btnLeft.x=130),""==this.m_data.rightBtn?this.u_btnRight.visible=!1:(this.u_btnRight.visible=!0,this.u_txtRight.textFlow=TextUtil.setTextFlow(this.m_data.rightBtn),""==this.m_data.leftBtn?this.u_btnRight.x=231:this.u_btnRight.x=334),this.u_txtPrize.textFlow=HtmlUtil.setTextFlow(e.titleMsg),this.u_txtMsg.textFlow=HtmlUtil.setTextFlow(e.msg),this.u_txtMsg.textHeight<90?this.u_scrollerItem.y=this.m_initY+(100-this.u_txtMsg.textHeight)/2:this.u_scrollerItem.y=this.m_initY}},e.prototype.addStageThis=function(){PopupModule.instance.addPopup(this)},Object.defineProperty(e.prototype,"isClickBMask",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return 566},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 460},enumerable:!0,configurable:!0}),e}(PopupBase);__reflect(PopupPrizeMsgUI.prototype,"PopupPrizeMsgUI");var PromotePage=function(t){function e(){var e=t.call(this)||this;return e.m_layout=new eui.TileLayout,e.m_typeList=new eui.ArrayCollection,e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/promoteUI/PromoteUISkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_btnReceive.touchChildren=!1,this.u_scrollerItem.horizontalScrollBar=null,this.u_scrollerItem.verticalScrollBar=null,this.m_layout.requestedColumnCount=1,this.m_layout.verticalGap=10,this.u_listItem.itemRenderer=PromoteRender,this.u_listItem.layout=this.m_layout,this.u_listItem.dataProvider=this.m_typeList,this.u_shareTips.text=LanguageJson.getText("l_promote_share_tips")},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnRule,this.onRule,this,!0),this.registerEventClick(this.u_btnInfo,this.onInfo,this,!0),this.registerEventClick(this.u_btnReceive,this.onReceive,this,!0)},e.prototype.onRule=function(t){this.m_recordView&&this.m_recordView.hide(),this.m_ruleView&&this.m_ruleView.parent||(this.m_ruleView||(this.m_ruleView=new PromoteRule,this.m_ruleView.x=494,this.m_ruleView.y=208),this.addChild(this.m_ruleView),this.m_ruleView.show(),t.stopPropagation(),t.stopImmediatePropagation())},e.prototype.onInfo=function(t){this.m_ruleView&&this.m_ruleView.hide(),this.m_recordView&&this.m_recordView.parent||(PromoteManager.instance.s_promote_get_promote_record(),t.stopPropagation(),t.stopImmediatePropagation())},e.prototype.onReceive=function(t){PromoteManager.instance.p_player_promote.times>0?PromoteManager.instance.isReward()?PromoteManager.instance.s_promote_get_award():FloatTipModule.instance.popTipLanguage("l_promote_share_commission"):FloatTipModule.instance.popTipLanguage("l_promote_share_commission_1")},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),Dispatch.register(PromoteManager.EVENT_GET_PROMOTE_DATA,this.upPromotrData,this,!0),Dispatch.register(PromoteManager.EVENT_TIMES_REFRESH,this.upTimes,this),Dispatch.register(PromoteManager.EVENT_PROMOTE_INFO,this.upRecordData,this))},e.prototype.upPromotrData=function(){var t=PromoteManager.instance.p_player_promote.promote_info_list;ArrayUtils.setSortArr(t,["tier_id"],[0]),this.m_typeList.source=t,this.upTimes(),this.upRed()},e.prototype.upRecordData=function(t){this.m_recordView||(this.m_recordView=new PromoteRecord,this.m_recordView.x=494,this.m_recordView.y=265),this.addChild(this.m_recordView),this.m_recordView.show(t),this.upRed()},e.prototype.upRed=function(){var t=PromoteManager.instance.p_player_promote.record_red;this.u_imgRed.visible=t>0?!0:!1},e.prototype.upTimes=function(){var t=PromoteManager.instance.p_player_promote.times,e=Number(StaticDataJson.getData("promote_award_today_times_limit").data),i=0>=t?ColorEnum.C_RED:ColorEnum.C_GREEN;this.u_txtTimes.textFlow=LanguageJson.getHtmlTextFlow("l_promote_today_times",[TextUtil.setText(t+"/"+e,ColorJson.getColorNum(i))]),this.u_timesBg.width=this.u_txtTimes.width+22,0>=t?(ObjectUtils.setGrey(this.u_btnReceive),this.u_receiveRed.visible=!1):(ObjectUtils.setGrey(this.u_btnReceive,!1),this.u_receiveRed.visible=PromoteManager.instance.isReward())},e.prototype.hide=function(e){void 0===e&&(e=null),Dispatch.remove(PromoteManager.EVENT_GET_PROMOTE_DATA,this.upPromotrData,this),Dispatch.remove(PromoteManager.EVENT_TIMES_REFRESH,this.upTimes,this),Dispatch.remove(PromoteManager.EVENT_PROMOTE_INFO,this.upRed,this),t.prototype.hide.call(this,e)},e}(PageBase);__reflect(PromotePage.prototype,"PromotePage");var PromoteInfoRender=function(t){function e(){return t.call(this,"resource/eui_skins/promoteUI/render/PromoteInfoRenderSkin.exml")||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this)},e.prototype.dataChanged=function(){if(this.checkComplete(this.dataChanged)){t.prototype.dataChanged.call(this),this.m_data=this.data;var e=ServerTimeManager.instance.getTodayTimes("000001");if(this.m_data.time>=e?this.u_txtTime.text=TimeUtil.getTampTimeByUnix(this.m_data.time,"hh:mm:ss"):this.u_txtTime.text=TimeUtil.getTampTimeByUnix(this.m_data.time,"mm-dd  hh-mm"),1==this.m_data.id)this.u_txtDesc.textFlow=LanguageJson.getHtmlTextFlow("l_promote_info_1",this.m_data.param_list);else{var i=0,s=0,n=[];this.m_data.param_list[2]&&(i=Number(this.m_data.param_list[2])),this.m_data.param_list[3]&&(s=Number(this.m_data.param_list[3])),this.m_data.param_list[0]&&this.m_data.param_list[1]&&(i>0?(n=[this.m_data.param_list[0],this.m_data.param_list[1],String(i)],this.u_txtDesc.textFlow=LanguageJson.getHtmlTextFlow("l_promote_info_2",n)):(n=[this.m_data.param_list[0],this.m_data.param_list[1],String(s)],this.u_txtDesc.textFlow=LanguageJson.getHtmlTextFlow("l_promote_info_3",n)))}}},e}(ItemRendererBase);__reflect(PromoteInfoRender.prototype,"PromoteInfoRender");var PromoteRender=function(t){function e(){return t.call(this,"resource/eui_skins/promoteUI/render/PromoteRenderSkin.exml")||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this)},e.prototype.dataChanged=function(){if(this.checkComplete(this.dataChanged)){t.prototype.dataChanged.call(this),this.m_data=this.data;var e=PromoteJson.getData(this.m_data.tier_id).rate/100;this.u_txtInfo1.textFlow=LanguageJson.getHtmlTextFlow("l_promote_desc_1",[this.m_data.tier_id,this.m_data.number]),this.u_txtInfo2.textFlow=LanguageJson.getHtmlTextFlow("l_promote_desc_2",[e]),this.u_txtInfo3.textFlow=LanguageJson.getHtmlTextFlow("l_promote_desc_3",[this.m_data.mana]),this.u_txtInfo4.textFlow=LanguageJson.getHtmlTextFlow("l_promote_desc_4",[this.m_data.vip_exp])}},e}(ItemRendererBase);__reflect(PromoteRender.prototype,"PromoteRender");var PromoteRecord=function(t){function e(){var e=t.call(this)||this;return e.m_layout=new eui.TileLayout,e.m_typeList=new eui.ArrayCollection,e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/promoteUI/view/PromoteRecordSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.u_scrollerItem.horizontalScrollBar=null,this.u_scrollerItem.verticalScrollBar=null,this.m_layout.requestedColumnCount=1,this.m_layout.verticalGap=10,this.u_listItem.itemRenderer=PromoteInfoRender,this.u_listItem.layout=this.m_layout,this.u_listItem.dataProvider=this.m_typeList,this.u_txtTitle.text=LanguageJson.getText("l_promote_record_txt"),this.u_txtNone.text=LanguageJson.getText("l_promote_noneInfo")},e.prototype.initEvent=function(){},e.prototype.show=function(t){void 0===t&&(t=[]),this.checkComplete(this.show,t)&&(this.recoverAllTexture(this,!0),this.u_txtNone.visible=0==t.length,ArrayUtils.setSortArr(t,["time"],[1]),this.m_typeList.source=t,Dispatch.register(StageManager.EVENT_STAGE_CLICK,this.onStageClick,this))},e.prototype.onStageClick=function(t){var e=this.localToGlobal(0,0);t.stageX>=e.x&&t.stageX<=e.x+this.width&&t.stageY>=e.y&&t.stageY<=e.y+this.height||this.hide()},e.prototype.hide=function(){DisplayObjectUtils.removeFormParent(this),Dispatch.remove(StageManager.EVENT_STAGE_CLICK,this.onStageClick,this)},Object.defineProperty(e.prototype,"width",{get:function(){return 458},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 247},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(PromoteRecord.prototype,"PromoteRecord");var PromoteRule=function(t){function e(){var e=t.call(this)||this;return e.m_layout=new eui.TileLayout,e.m_typeList=new eui.ArrayCollection,e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/promoteUI/view/PromoteRuleSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){var t=LanguageJson.getText("l_promotei_rule");this.u_txtMsg.textFlow=HtmlUtil.setTextFlow(t),this.u_txtTitle.text=LanguageJson.getText("l_game_tips_27")},e.prototype.initEvent=function(){},e.prototype.show=function(t){void 0===t&&(t=null),this.checkComplete(this.show,t)&&(this.recoverAllTexture(this,!0),Dispatch.register(StageManager.EVENT_STAGE_CLICK,this.onStageClick,this))},e.prototype.onStageClick=function(t){var e=this.localToGlobal(0,0);t.stageX>=e.x&&t.stageX<=e.x+this.width&&t.stageY>=e.y&&t.stageY<=e.y+this.height||this.hide()},e.prototype.hide=function(){DisplayObjectUtils.removeFormParent(this),Dispatch.remove(StageManager.EVENT_STAGE_CLICK,this.onStageClick,this)},Object.defineProperty(e.prototype,"width",{get:function(){return 458},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 247},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(PromoteRule.prototype,"PromoteRule");var PromptBase=function(t){function e(){var e=t.call(this)||this;return e.m_effectOpenType=3,e.m_effectCloseType=4,e}return __extends(e,t),e.prototype.setId=function(t,e){void 0===e&&(e=null),this.m_baseId=t,this.startShowLoad(e)},e.prototype.setDrag=function(t){null==t&&this.m_dragMc&&(this.m_dragMc.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onStartMove,this),this.m_dragMc.removeEventListener(egret.TouchEvent.TOUCH_END,this.stopMove,this),this.stage&&this.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onMove,this)),this.m_dragMc=t,this.m_dragMc&&(this.m_dragMc.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onStartMove,this),this.m_dragMc.addEventListener(egret.TouchEvent.TOUCH_END,this.stopMove,this))},e.prototype.onStartMove=function(t){this.m_dragX=t.stageX-this.x,this.m_dragY=t.stageY-this.y,this.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onMove,this),t.stopPropagation(),t.stopImmediatePropagation()},e.prototype.stopMove=function(t){this.stage&&this.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onMove,this)},e.prototype.onMove=function(t){var e=t.stageX-this.m_dragX,i=t.stageY-this.m_dragY;0>=e?e=0:e>=StageManager.instance.p_stageWidth-this.width&&(e=StageManager.instance.p_stageWidth-this.width),0>=i&&(i=0),i>=StageManager.instance.p_stageHeight-this.height&&(i=StageManager.instance.p_stageHeight-this.height),this.x=e,this.y=i},e.prototype.close=function(t){void 0===t&&(t=null),PromptModule.instance.hidePrompt(this.m_baseId)},e.prototype.addStageThis=function(){PromptModule.instance.addPrompt(this)},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),Dispatch.register(StageManager.EVENT_STAGE_RESIZE,this.stageResize,this,!0),1==this.m_effectOpenType?this.showEffect1():2==this.m_effectOpenType?this.showEffect2():3==this.m_effectOpenType?this.showEffect3():4==this.m_effectOpenType?this.showEffect4():this.showEffectOver())},e.prototype.showEffect1=function(){var t=StageManager.instance.p_stageWidth-this.width;this.x=StageManager.instance.p_stageWidth+20,this.y=StageManager.instance.p_stageHeight-this.height,TweenLite.killTweensOf(this);var e=this.tweenShowTime>0?this.tweenShowTime:.3;TweenLite.to(this,e,{x:t,ease:Quad.easeOut,onComplete:this.stageResize.bind(this)})},e.prototype.showEffect2=function(){var t=StageManager.instance.p_stageHeight-this.height;this.x=StageManager.instance.p_stageWidth-this.width,this.y=StageManager.instance.p_stageHeight+20,TweenLite.killTweensOf(this);var e=this.tweenShowTime>0?this.tweenShowTime:.3;TweenLite.to(this,e,{y:t,ease:Quad.easeOut,onComplete:this.stageResize.bind(this)})},e.prototype.showEffect3=function(){var t=StageManager.instance.p_stageWidth-this.width;this.alpha=0,this.scaleX=0,this.x=StageManager.instance.p_stageWidth,this.y=StageManager.instance.p_stageHeight-this.height,TweenLite.killTweensOf(this);var e=this.tweenShowTime>0?this.tweenShowTime:.3;TweenLite.to(this,e,{alpha:1,scaleX:1,x:t,ease:Quad.easeIn,onComplete:this.stageResize.bind(this)})},e.prototype.showEffect4=function(){var t=StageManager.instance.p_stageHeight-this.height;this.alpha=0,this.scaleY=0,this.x=StageManager.instance.p_stageWidth-this.width,this.y=StageManager.instance.p_stageHeight,TweenLite.killTweensOf(this);var e=this.tweenShowTime>0?this.tweenShowTime:.3;TweenLite.to(this,e,{alpha:1,scaleY:1,y:t,ease:Quad.easeIn,onComplete:this.stageResize.bind(this)})},e.prototype.showEffectOver=function(){this.alpha=0,this.x=StageManager.instance.p_stageWidth-this.width,this.y=StageManager.instance.p_stageHeight-this.height,TweenLite.killTweensOf(this);var t=this.tweenShowTime>0?this.tweenShowTime:.2;TweenLite.to(this,t,{alpha:1,ease:Quad.easeIn,onComplete:this.stageResize.bind(this)})},e.prototype.stageResize=function(){TweenLite.killTweensOf(this),this.scaleX=1,this.scaleY=1,this.alpha=1,this.x=StageManager.instance.p_stageWidth-this.width,this.y=StageManager.instance.p_stageHeight-this.height},e.prototype.hide=function(t,e){if(Dispatch.remove(StageManager.EVENT_STAGE_RESIZE,this.stageResize,this),e&&e.c_allClose)return void this.sureHide(null,null);TweenLite.killTweensOf(this);var i;1==this.m_effectCloseType?(i=this.tweenHideTime>0?this.tweenHideTime:.3,TweenLite.to(this,i,{x:StageManager.instance.p_stageWidth+20,ease:Quad.easeIn,onComplete:this.sureHide.bind(this),onCompleteParams:[t,e]})):2==this.m_effectCloseType?(i=this.tweenHideTime>0?this.tweenHideTime:.3,TweenLite.to(this,i,{y:StageManager.instance.p_stageHeight+20,ease:Quad.easeIn,onComplete:this.sureHide.bind(this),onCompleteParams:[t,e]})):3==this.m_effectCloseType?(i=this.tweenHideTime>0?this.tweenHideTime:.3,TweenLite.to(this,i,{x:StageManager.instance.p_stageWidth,scaleX:0,alpha:0,ease:Back.easeIn,onComplete:this.sureHide.bind(this),onCompleteParams:[t,e]})):4==this.m_effectCloseType?(i=this.tweenHideTime>0?this.tweenHideTime:.3,TweenLite.to(this,i,{y:StageManager.instance.p_stageHeight,scaleY:0,alpha:0,ease:Back.easeIn,onComplete:this.sureHide.bind(this),onCompleteParams:[t,e]})):(i=this.tweenHideTime>0?this.tweenHideTime:.3,TweenLite.to(this,i,{alpha:0,ease:Quad.easeIn,onComplete:this.sureHide.bind(this),onCompleteParams:[t,e]}))},e.prototype.sureHide=function(t,e){void 0===e&&(e=null),TweenLite.killTweensOf(this),this.scaleX=1,this.scaleY=1,this.alpha=1,DisplayObjectUtils.removeFormParent(this),null!=t&&t.apply(null,[this,e]),this.disposeAllTexture()},Object.defineProperty(e.prototype,"tweenShowTime",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tweenHideTime",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isUIDown",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.m_baseId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return 200},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 250},enumerable:!0,configurable:!0}),e}(DisplayBase);__reflect(PromptBase.prototype,"PromptBase");var PromptConfig=function(){function t(){}return t.initPrompt=function(){},t.list_prompt=[],t}();__reflect(PromptConfig.prototype,"PromptConfig");var PromptModule=function(t){function e(){var e=t.call(this)||this;return e.m_promptList=[],e.m_prompCurrList=[],e.m_prompBassList=[],e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.m_instance||(this.m_instance=new e),this.m_instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){PromptConfig.initPrompt()},e.prototype.showPrompt=function(t,e,i,s){if(void 0===e&&(e=null),void 0===i&&(i=!0),void 0===s&&(s=!1),!this.havStage(t)){if(i&&this.m_prompBassList.length>0){var n=!0;if(0==s)for(var o in this.m_prompCurrList)if(this.m_prompCurrList[o].id==t){n=!1;break}return void(n&&this.m_prompCurrList.push({id:t,data:e}))}var a;this.m_promptList[t]?a=this.m_promptList[t]:(a=new PromptConfig.list_prompt[t],this.m_promptList[t]=a),a.setId(t,e)}},e.prototype.addPrompt=function(t){t.isUIDown?UIModule.instance.downUILayer3.addChild(t):UIModule.instance.upUILayer.addChild(t),this.m_prompBassList.push(t)},e.prototype.hidePrompt=function(t){if(this.m_prompBassList&&this.m_prompBassList.length>0){for(var e=0;e<this.m_prompBassList.length;e++)if(this.m_prompBassList[e].id==t){this.m_prompBassList[e].hide(this.sureHidePrompt.bind(this),null);break}}else this.sureHidePrompt(null)},e.prototype.sureHidePrompt=function(t,e){void 0===e&&(e=null);var i=this.m_prompBassList.indexOf(t);if(t&&i>-1&&(this.m_prompBassList.splice(i,1),this.m_prompCurrList&&this.m_prompCurrList.length>0)){var s=this.m_prompCurrList.shift();this.showPrompt(s.id,s.data)}},e.prototype.hidePromptAll=function(){for(;this.m_prompBassList.length>0;){var t=this.m_prompBassList.shift();t.hide(null,{c_allClose:1})}this.m_prompCurrList=[],this.m_prompBassList=[]},e.prototype.havStage=function(t){if(this.m_prompBassList&&this.m_prompBassList.length>0)for(var e=0;e<this.m_prompBassList.length;e++)if(this.m_prompBassList[e].id==t)return!0;return!1},e}(egret.HashObject);__reflect(PromptModule.prototype,"PromptModule");var RankPopup=function(t){function e(){var e=t.call(this)||this;return e.m_datas=[1,2,3,4,5,6,7,8],e.m_listArr=new eui.ArrayCollection,e.m_disposeUrlList.push("rankUI_json"),e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/rankUI/RankPopupSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_scroller.horizontalScrollBar=null,this.u_scroller.verticalScrollBar=null,this.u_scroller.scrollPolicyH=eui.ScrollPolicy.OFF,this.u_scroller.scrollPolicyV=eui.ScrollPolicy.AUTO;var e=new eui.TileLayout;e.requestedColumnCount=2,e.orientation=eui.TileOrientation.ROWS,e.verticalGap=10,this.u_list.itemRenderer=RankRender,this.u_list.layout=e,this.u_list.dataProvider=this.m_listArr},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_closeBtn,this.close,this)},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),this.m_datas=e,this.m_listArr.source=this.m_datas)},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i)},Object.defineProperty(e.prototype,"isClickBMask",{get:function(){return!1},enumerable:!0,configurable:!0}),e}(PopupBase);__reflect(RankPopup.prototype,"RankPopup");var RankRender=function(t){function e(){return t.call(this,"resource/eui_skins/rankUI/render/RankRenderSkin.exml")||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data.ranking;4>e?this.u_rankImg.source="rankUI_json.rankUI_icon_"+e:this.u_rankImg.source="rankUI_json.rankUI_"+e,this.u_bg.source=1==e?"rankUI_json.xxBg_1":"rankUI_json.xxBg_2",this.m_head||(this.m_head=new PersonalHead,this.m_head.x=8,this.m_head.y=12,this.m_head.scaleX=this.m_head.scaleY=.7,this.u_grpHead.addChildAt(this.m_head,1)),this.u_imgFirst.visible=1==this.data.ranking;var i=this.data.model_head_figure;this.m_head.showView(i,i.player_id,i.level),this.u_nameLb.text=i.nickname,this.u_goldLb.text=NumberUtil.numberToString(this.data.gold_value),this.u_diamondLb.text=NumberUtil.numberToString(this.data.money_value)},e}(ItemRendererBase);__reflect(RankRender.prototype,"RankRender");var RechargeUI=function(t){function e(){var e=t.call(this)||this;return e.m_layout=new eui.TileLayout,e.m_typeList=new eui.ArrayCollection,e.m_maxProg=303,e.m_disposeUrlList.push("rechargeUI_json"),e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/rechargeUI/RechargeUISkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_scrollerItem.horizontalScrollBar=null,this.u_scrollerItem.verticalScrollBar=null,this.m_layout.requestedColumnCount=4,this.m_layout.horizontalGap=12,this.m_layout.verticalGap=20,this.u_listItem.itemRenderer=RechargeRender,this.u_listItem.layout=this.m_layout,this.u_listItem.dataProvider=this.m_typeList,this.u_txtTips.text=LanguageJson.getHtmlText("l_vip_rechange_msg"),this.u_txtTips.width=this.u_txtTips.textWidth+30,this.u_tipBg.width=this.u_txtTips.textWidth+100,this.m_ratio=Number(StaticDataJson.getData("recharge_ratio").data)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnView,this.onPreView,this,!0)},e.prototype.onPreView=function(t){UIModule.instance.showUI(UIConfig.ID_VIP)},e.prototype.showView=function(e){if(void 0===e&&(e=null),this.checkComplete(this.showView,e)){t.prototype.showView.call(this,e);for(var i=[],s=ChargeManager.instance.p_charge_list,n=0;n<s.length;n++){var o=RechargeJson.getData(s[n].id);o&&i.push(o)}if(ArrayUtils.setSortArr(i,["idx_ord"],[0]),1==URIManager.is_native_pay&&0==URIManager.is_reviewing){var o=new RechargeJson;o.ID=-1,i.push(o)}this.m_typeList.source=i,this.u_scrollerItem.viewport.scrollV=0,Dispatch.register(VipManager.EVENT_VIP_GET_AWARD,this.showVipProgress,this,!0),ClientLogManager.instance.s_client_log_client_log(ClientLogEnum.CHARGE_BUTTON_TIMES)}},e.prototype.showVipProgress=function(){var t=VipManager.instance.vip_data.vip_level,e=VipManager.instance.vip_data.vip_exp,i=(VipLevelJson.getData(t),VipLevelJson.getData(t+1));if(this.u_txtVip.text=LanguageJson.getText("l_vip_vip")+t,i){this.u_txtProgress.text=e+"/"+i.exp,this.u_imgJindu.width=e/i.exp*this.m_maxProg;var s=(i.exp-VipManager.instance.vip_data.vip_exp)/this.m_ratio;this.u_txtMsg.textFlow=LanguageJson.getHtmlTextFlow("l_vip_msg",[s,i.level])}else this.u_txtProgress.text=e+"/"+LanguageJson.getText("l_bag_max"),this.u_imgJindu.width=this.m_maxProg,this.u_txtMsg.textFlow=LanguageJson.getHtmlTextFlow("l_vip_max")},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i),Dispatch.remove(VipManager.EVENT_VIP_GET_AWARD,this.showVipProgress,this)},e.prototype.sureHide=function(i,s){void 0===i&&(i=null),void 0===s&&(s=null),t.prototype.sureHide.call(this,i,s);for(var n in e.p_urlList)RES.destroyRes(e.p_urlList[n]);e.p_urlList=[]},e.p_urlList=[],e}(UIBase);__reflect(RechargeUI.prototype,"RechargeUI");var RechargeRender=function(t){function e(){return t.call(this,"resource/eui_skins/rechargeUI/render/RechargeRenderSkin.exml")||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this),this.m_mana||(this.m_mana=new NumberView("rechargeUI_value_",0,-4),this.u_mcContent.addChild(this.m_mana),this.m_mana.scaleX=.6,this.m_mana.scaleY=.6,this.m_mana.p_backFunc=this.resetXY.bind(this))},e.prototype.resetXY=function(){this.m_mana.anchorOffsetX=this.m_mana.width/2,this.m_mana.anchorOffsetY=this.m_mana.height/2,this.m_mana.x=this.width/2,this.m_mana.y=115},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.doHandler,this)},e.prototype.doHandler=function(){-1==this.m_json.ID?PlayerManager.instance.gotoKefu():ChargeManager.instance.requestRecharge(this.m_json.ID,1)},e.prototype.onRemoveStage=function(e){t.prototype.onRemoveStage.call(this,e),this.u_imgIcon.source=null},e.prototype.dataChanged=function(){if(this.checkComplete(this.dataChanged))if(t.prototype.dataChanged.call(this),this.m_json=this.data,-1==this.m_json.ID)this.u_mcContent.visible=!1,this.u_imgBj.visible=!1;else{this.u_mcContent.visible=!0,this.u_imgBj.visible=!0,this.u_txtMoney.textFlow=LanguageJson.getHtmlTextFlow("l_game_unit_yuan",[this.m_json.cash]);var e="resource/assets/icon/recharge/"+this.m_json.icon_id+".png";-1==RechargeUI.p_urlList.indexOf(e)&&RechargeUI.p_urlList.push(e),this.u_imgIcon.source=null,this.u_imgIcon.source=e;var i=0!=this.m_json.ingot?this.m_json.ingot:this.m_json.diamond;this.m_mana.setMsgString(NumberUtil.numberToString(i,1)),this.u_txtExp.text=LanguageJson.getText("l_vip_exp")+" +"+NumberUtil.numberToString(this.m_json.vip_exp,1)}},e}(ItemRendererBase);__reflect(RechargeRender.prototype,"RechargeRender");var RedPacketModule=function(t){function e(){var e=t.call(this)||this;return e.m_dataFly={},e.p_redPack_tip=[],e.p_redPack=[],e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.m_instance||(this.m_instance=new e),this.m_instance},enumerable:!0,configurable:!0}),e.prototype.createRedPack=function(t){if(RedConditionJson.getData(t.id)&&999==t.id){var e;e=this.p_redPack_tip.length>0?this.p_redPack_tip.shift():new RedPacketTip,e.show(t.id),999==t.id&&(this.m_mcReceive||(this.m_mcReceive=new RedPacketReceive),this.m_mcReceive.show(),this.m_goldListRid=[]);for(var i=t.param_list,s=RedConditionJson.getData(t.id).content,n=0;n<t.red_packet_data.length;n++){var o=t.red_packet_data[n],a=Number(o.r_id);if(!this.m_dataFly[a]){999==RedPackageJson.getType(o.red_packet_id)&&this.m_goldListRid&&-1==this.m_goldListRid.indexOf(a)&&this.m_goldListRid.push(a);var r=void 0;r=this.p_redPack.length>0?this.p_redPack.shift():new RedPacketFly,r.show(o,n,i,s),this.m_dataFly[a]=r}}}},e.prototype.recycleRedPack=function(t){if(this.m_goldListRid&&this.m_goldListRid.indexOf(t)>-1&&(this.m_goldListRid.splice(this.m_goldListRid.indexOf(t),1),0==this.m_goldListRid.length&&(this.m_goldListRid=null,this.m_goldListRid=[],DelayCallUtils.delayedCall(.4,this.clsoeRe,this))),this.m_dataFly[t]){var e=this.m_dataFly[t];e.hide(),this.p_redPack.push(e),delete this.m_dataFly[t]}},e.prototype.receiveRedPack=function(t){if(e.instance.p_curr_rid==Number(t.r_id))Dispatch.dispatch(e.EVENT_REDPACKET_GET,t.prop_list);else{var i=this.m_dataFly[Number(t.r_id)];i&&t.prop_list&&t.prop_list[0]&&i.showValue([t.prop_list[0].prop_id,t.prop_list[0].num])}},e.prototype.receiveRedPackFail=function(t){this.m_goldListRid&&this.m_goldListRid.indexOf(t)>-1||FloatTipModule.instance.popTipLanguage("l_red_pack_fali"),this.recycleRedPack(t),PopupModule.instance.hidePop(PopupConfig.ID_RED_PACKET),SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_4103)},e.prototype.setGoldAdd=function(t){this.m_mcReceive&&this.m_mcReceive.setNum(t)},Object.defineProperty(e.prototype,"pointGoldAdd",{get:function(){if(this.m_mcReceive&&this.m_mcReceive.parent){var t=this.m_mcReceive.parent.localToGlobal(this.m_mcReceive.x+103,this.m_mcReceive.y+65);return[t.x,t.y]}return null},enumerable:!0,configurable:!0}),e.prototype.clsoeRe=function(){this.m_mcReceive&&this.m_mcReceive.hide()},e.EVENT_REDPACKET_GET="EVENT_REDPACKET_GET",e}(egret.HashObject);__reflect(RedPacketModule.prototype,"RedPacketModule");var RedPacketPopup=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/redPacketUI/RedPacketPopupSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){this.m_effectOpenType=1,this.m_effectCloseType=2,this.m_manaNum||(this.m_manaNum=new NumberView("num_sy_"),this.m_manaNum.p_backFunc=this.setManaNumXY.bind(this),this.m_manaNum.p_isAnchorOffsetX=!0,this.m_manaNum.p_isDoller=!0,this.m_manaNum.x=.5*this.width,this.m_manaNum.y=200,this.m_manaNum.p_qianStr=["j"])},e.prototype.setManaNumXY=function(){this.m_manaNum.showEffect(.23)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnClick,this.onClick,this,!0)},e.prototype.onClick=function(t){RedPacketManager.instance.s_red_packet_get_red_packet(this.m_rid)},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),Dispatch.register(RedPacketModule.EVENT_REDPACKET_GET,this.setReceive,this),this.m_rid=e[0],this.m_closeTime=e[1],RedPacketModule.instance.p_curr_rid=this.m_rid,this.u_txtMsg.textFlow=HtmlUtil.setTextFlow(e[2],e[3]),TimeManager.instance.doLoop(this.timeDo,this))},e.prototype.timeDo=function(){var t=this.m_closeTime-ServerTimeManager.instance.timer;return 0>=t?(TimeManager.instance.clearTimer(this.timeDo,this),void this.close()):void(this.u_txtTime.text=LanguageJson.getHtmlText("l_red_pack_delete",[t]))},e.prototype.setReceive=function(t){SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_4202),RedPacketModule.instance.recycleRedPack(this.m_rid);var e=ItemIconModule.instance.getItemIcon();e.p_isShowTip=!1,this.addChild(e),e.setData(t[0].prop_id,t[0].num),e.x=.5*(this.width-e.width),e.y=this.u_btnClick.y+.5*this.u_btnClick.height,e.alpha=0,TweenLite.to(e,.3,{alpha:1,y:e.y-150,ease:Quad.easeIn}),TweenLite.to(e,.2,{alpha:0,delay:1.1,onComplete:this.mcMoveXY.bind(this),onCompleteParams:[e]}),this.showValueNext([t[0].prop_id,t[0].num]),this.addChild(this.m_manaNum),this.m_manaNum.numValue=t[0].num},e.prototype.mcMoveXY=function(t){ItemIconModule.instance.recoverItemGrid(t),this.close()},e.prototype.showValueNext=function(t){ItemFloatModule.instance.flyItem(t,[.5*StageManager.instance.p_stageWidth-40,.5*StageManager.instance.p_stageHeight])},e.prototype.hide=function(e,i){DisplayObjectUtils.removeFormParent(this.m_manaNum),RedPacketModule.instance.p_curr_rid=0,TimeManager.instance.clearTimer(this.timeDo,this),Dispatch.remove(RedPacketModule.EVENT_REDPACKET_GET,this.setReceive,this),t.prototype.hide.call(this,e,i)},Object.defineProperty(e.prototype,"width",{get:function(){return 500},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 600},enumerable:!0,configurable:!0}),e}(PopupBase);__reflect(RedPacketPopup.prototype,"RedPacketPopup");var RedPacketFly=function(t){function e(){var e=t.call(this)||this;return e.m_juOffX=15,e.initView(),e.initEvents(),e.touchEnabled=!1,e}return __extends(e,t),e.prototype.initView=function(){this.touchEnabled=!1,this.m_iocnClick||(this.m_iocnClick=new eui.Image("commonUI_box"),this.m_iocnClick.width=this.width,this.m_iocnClick.height=this.height-20,this.m_iocnClick.alpha=0,this.m_iocnClick.scale9Grid=UIModule.instance.getRectangle()),!URIManager.is_platform&&URIManager.isdebug&&(this.txtMsg=new eui.Label,this.addChild(this.txtMsg),this.txtMsg.x=10,this.txtMsg.size=20)
},e.prototype.initEvents=function(){},e.prototype.onClick=function(t){void 0===t&&(t=null),ServerTimeManager.instance.timer>=this.m_closeTime||(999==this.m_type?RedPacketManager.instance.s_red_packet_get_red_packet(this.m_rid):PopupModule.instance.showPop(PopupConfig.ID_RED_PACKET,[this.m_rid,this.m_closeTime,this.m_msgRed,this.m_paramList]))},e.prototype.showValue=function(t){DisplayObjectUtils.removeFormParent(this.m_manaNum),this.parent&&this.parent.addChild(this);var e=ItemIconModule.instance.getItemIcon();e.p_isShowTip=!1,this.addChild(e),e.setData(t[0],t[1]),e.x=.5*(this.width-e.width),e.y=.5*(this.height-e.height),e.alpha=0,TweenLite.to(e,.3,{alpha:1,y:-100,ease:Quad.easeIn}),TweenLite.to(e,.2,{alpha:0,delay:1.1,onComplete:this.sureHide.bind(this),onCompleteParams:[e]}),this.m_rPoint=this.parent.localToGlobal(this.x+e.x,this.y+.5*(this.height-e.height)),999==this.m_type?DelayCallUtils.delayedCall(1.2,RedPacketModule.instance.setGoldAdd,RedPacketModule.instance,[t[2]]):this.m_rPoint=this.parent.localToGlobal(this.x+e.x,this.y+.5*(this.height-e.height)),this.m_manaNum||(this.m_manaNum=new NumberView("num_sy_"),this.m_manaNum.p_backFunc=this.setManaNumXY.bind(this),this.m_manaNum.p_isAnchorOffsetX=!0,this.m_manaNum.p_isDoller=!0,this.m_manaNum.x=.5*this.width,this.m_manaNum.y=-80,this.m_manaNum.p_qianStr=["j"]),this.addChild(this.m_manaNum),this.m_manaNum.numValue=t[2],this.showValueNext(t),SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_4102),this.removeDelate()},e.prototype.setManaNumXY=function(){this.m_manaNum.showEffect(.23)},e.prototype.showValueNext=function(t){999==this.m_type?ItemFloatModule.instance.flyItem(t,[this.m_rPoint.x,this.m_rPoint.y],RedPacketModule.instance.pointGoldAdd):ItemFloatModule.instance.flyItem(t,[this.m_rPoint.x,this.m_rPoint.y])},e.prototype.sureHide=function(t){ItemIconModule.instance.recoverItemGrid(t),DisplayObjectUtils.removeFormParent(this),RedPacketModule.instance.recycleRedPack(this.m_rid)},e.prototype.show=function(t,e,i,s){void 0===i&&(i=null),void 0===s&&(s=""),DisplayObjectUtils.removeFormParent(this.m_manaNum),this.m_iocnClick.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.m_rid=Number(t.r_id),this.m_closeTime=t.clear_time,this.m_msgRed=s,this.m_paramList=i;var n=t.red_packet_id;this.m_speed=2,RedPackageJson.getData(n)&&(this.m_speed=RedPackageJson.getData(n).speed,this.m_type=RedPackageJson.getType(t.red_packet_id)),this.txtMsg&&(this.txtMsg.text=this.m_rid+"_"+n),this.m_effect||(this.m_effect=new EffectMovieClip,this.m_effect.touchEnabled=!1,this.m_effect.touchChildren=!1,this.m_effect.x=this.width/2,this.m_effect.y=this.height/2),999==this.m_type?this.m_effect.setMC("resource/assets/uiEffect/redPacket/redGold"):this.m_effect.setMC("resource/assets/uiEffect/redPacket/redPacket");var o=1+.5*e;DelayCallUtils.delayedCall(o,this.sureCreateFloat,this)},e.prototype.sureCreateFloat=function(){DelayCallUtils.killDelayedCallsTo(this.sureCreateFloat,this),this.y=-this.height,this.x=this.width/2+this.m_juOffX+Math.random()*(StageManager.instance.p_stageWidth-this.width-2*this.m_juOffX-100),null==this.parent&&(StageManager.instance.tiplayer.addChild(this),this.m_effect&&(this.m_effect.play(),this.addChildAt(this.m_effect,0)),this.addChild(this.m_iocnClick)),TimeManager.instance.doLoop(this.timeMove,this,35)},e.prototype.timeMove=function(){return this.y>=StageManager.instance.p_stageHeight+this.height?void RedPacketModule.instance.recycleRedPack(this.m_rid):ServerTimeManager.instance.timer>=this.m_closeTime?void RedPacketModule.instance.recycleRedPack(this.m_rid):void(this.y+=this.m_speed)},e.prototype.hide=function(){this.removeDelate(),DisplayObjectUtils.removeFormParent(this)},e.prototype.removeDelate=function(){this.m_iocnClick.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),DelayCallUtils.killDelayedCallsTo(this.sureCreateFloat,this),TimeManager.instance.clearTimer(this.timeMove,this),TweenLite.killTweensOf(this),this.m_effect&&(this.m_effect.destory(),this.m_effect=null),this.m_effectClick&&(this.m_effectClick.destory(),this.m_effectClick=null),DisplayObjectUtils.removeFormParent(this.m_iocnClick)},Object.defineProperty(e.prototype,"width",{get:function(){return 100},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 100},enumerable:!0,configurable:!0}),e}(egret.DisplayObjectContainer);__reflect(RedPacketFly.prototype,"RedPacketFly");var RedPacketReceive=function(t){function e(){var e=t.call(this)||this;return e.m_listMax=[],e.m_showBool=!1,e.m_randomList=[],e.touchChildren=!1,e.touchEnabled=!1,e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/redPacketUI/RedPacketReceiveSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.m_maskImg||(this.m_maskImg=new eui.Image("commonUI_box"),this.m_maskImg.scale9Grid=UIModule.instance.getRectangle(),this.m_maskImg.alpha=.3),t.prototype.onCompleted.call(this)},e.prototype.show=function(){if(this.m_maskImg.width=StageManager.instance.p_stageWidth,this.m_maskImg.height=StageManager.instance.p_stageHeight,StageManager.instance.tiplayer.addChildAt(this.m_maskImg,0),this.checkComplete(this.show)){this.m_effect||(this.m_effect=new EffectMovieClip,this.m_effect.setMC("resource/assets/uiEffect/redPacket/redReceive")),this.m_effect.x=.5*this.width,this.m_effect.y=.5*this.height,this.m_effect.play(),this.addChildAt(this.m_effect,0),this.m_showBool=!0,this.m_value=0,this.x=.5*(StageManager.instance.p_stageWidth-this.width);var t=StageManager.instance.p_stageHeight-200-this.height;StageManager.instance.tiplayer.addChildAt(this,1),this.m_manaNum||(this.m_manaNum=new NumberView("num_sy_"),this.m_manaNum.scaleX=this.m_manaNum.scaleY=.8,this.m_manaNum.x=190,this.m_manaNum.y=35),this.addChild(this.m_manaNum),this.m_manaNum.numValue=0,this.alpha=0,this.y=t-20,TweenLite.to(this,.3,{y:t,alpha:1}),DelayCallUtils.delayedCall(RedConditionJson.getData(999).red_time,this.hide,this)}},e.prototype.setNumList=function(t,e){this.m_randomList=[];for(var i=0,s=Math.floor(e/t),n=0;t>n;n++)if(n!=t-1){var o=8-Math.floor(10*Math.random());s>Math.abs(o)?(i+=s+o,this.m_randomList.push(s+o)):(i+=s,this.m_randomList.push(s))}else e-i>0&&this.m_randomList.push(e-i)},e.prototype.showPlay=function(){var t=.5*(StageManager.instance.p_stageHeight-this.height)+20;TweenLite.to(this,.4,{delay:3.5,alpha:0,y:t,onComplete:this.showHide.bind(this)}),DelayCallUtils.delayedCall(1,this.playGold,this)},e.prototype.playGold=function(){var t=RedPacketModule.instance.pointGoldAdd;this.m_manaNum.setNumValue(0,2.6);var e=8+Math.floor(4*Math.random());this.setNumList(e,this.m_value);for(var i=0;i<this.m_randomList.length;i++){var s=new NumberView("num_sy_");s.p_isAnchorOffsetX=!0,s.setMsgString("j"+this.m_randomList[i]),StageManager.instance.tiplayer.addChild(s),s.alpha=0,s.x=t[0]+.5*this.width-130,s.y=t[1]-20,s.scaleX=s.scaleY=.9,TweenLite.to(s,.5,{delay:.2+.19*i,scaleX:.7,scaleY:.7,y:t[1]-200,alpha:1,ease:Circ.easeIn,onStart:this.onStartPlay.bind(this),onStartParams:[s,i,this.m_randomList[i]],onComplete:this.onNextPlay.bind(this),onCompleteParams:[s]})}},e.prototype.hide=function(){if(DelayCallUtils.killDelayedCallsTo(this.hide,this),this.m_showBool){this.m_showBool=!1;var t=RedPacketModule.instance.pointGoldAdd;if(null==t&&this.m_value<=0)return void this.showHide();var e=.5*(StageManager.instance.p_stageHeight-this.height);TweenLite.to(this,.4,{y:e,onComplete:this.showPlay.bind(this)})}},e.prototype.onStartPlay=function(t,e,i){SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_4002)},e.prototype.onNextPlay=function(t){var e=UIModule.instance.pointGold;TweenLite.to(t,1,{x:e[0],y:e[1],scaleX:.3,scaleY:.3,onComplete:this.onOutPlay.bind(this),onCompleteParams:[t]})},e.prototype.onOutPlay=function(t){t.hide(),t=null},e.prototype.showHide=function(){DisplayObjectUtils.removeFormParent(this.m_maskImg),DisplayObjectUtils.removeFormParent(this),this.m_effect&&(this.m_effect.destory(),this.m_effect=null)},e.prototype.setNum=function(t){this.checkComplete(this.setNum,t)&&null!=this.parent&&(this.m_value+=t,this.m_manaNum.setNumValue(this.m_value,.4))},Object.defineProperty(e.prototype,"width",{get:function(){return 463},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 126},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(RedPacketReceive.prototype,"RedPacketReceive");var RedPacketTip=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.show=function(t){this.m_effect2||(this.m_effect2=new EffectMovieClip,this.m_effect2.setMC("resource/assets/uiEffect/redPacket/redWel")),this.m_effect2.play(12,1),this.m_effect2.scaleX=1.3,this.m_effect2.scaleY=1.3,this.m_effect2.x=.5*StageManager.instance.p_stageWidth,this.m_effect2.y=200,StageManager.instance.tiplayer.addChild(this.m_effect2),this.m_effect||(this.m_effect=new EffectMovieClip,this.m_effect.setMC("resource/assets/uiEffect/redPacket/redExplode")),this.m_effect.scaleX=1.3,this.m_effect.scaleY=1.3,this.m_effect.x=.5*StageManager.instance.p_stageWidth,this.m_effect.y=200,StageManager.instance.tiplayer.addChild(this.m_effect),DelayCallUtils.delayedCall(.4,this.playStart,this),999==t?SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_4201):SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_4101),TweenLite.to(this,.3,{delay:2,scaleX:.2,scaleY:.2,alpha:0,ease:Back.easeIn,onComplete:this.setPlayOver.bind(this)})},e.prototype.playStart=function(){this.m_effect.play(12,1)},e.prototype.setPlayOver=function(){TweenLite.killTweensOf(this),this.m_effect&&(this.m_effect.destory(),this.m_effect=null),this.m_effect2&&(this.m_effect2.destory(),this.m_effect2=null),RedPacketModule.instance.p_redPack_tip.push(this)},e}(egret.HashObject);__reflect(RedPacketTip.prototype,"RedPacketTip");var RewardModule=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return this.m_instance||(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.receiveByList=function(t,e,i,s,n,o){void 0===e&&(e=0),void 0===i&&(i=0),void 0===s&&(s=null),void 0===n&&(n=!1),void 0===o&&(o=.7),n&&(t=this.getListOverlay(t)),PopupModule.instance.showPop(PopupConfig.ID_REWARDS_RECEIVE,{c_dataList:t,c_funcBack:s,c_time:e,c_delayTime:i,c_alphaBMask:o},!1)},t.prototype.receiveByRewardId=function(t,e,i,s,n){void 0===e&&(e=0),void 0===i&&(i=0),void 0===s&&(s=null),void 0===n&&(n=!1),this.receiveByList(RewardJson.getAnyListById(t),e,i,s,n)},t.prototype.receiveByProp=function(t,e,i,s,n){void 0===e&&(e=0),void 0===i&&(i=0),void 0===s&&(s=null),void 0===n&&(n=!1);for(var o=[],a=0;a<t.length;a++)o.push([t[a].prop_id,t[a].num]);this.receiveByList(o,e,i,s,n)},t.prototype.showByList=function(t){PopupModule.instance.showPop(PopupConfig.ID_REWARD_SHOW,{c_dataList:t},!1)},t.prototype.showByRewardId=function(t){this.showByList(RewardJson.getAnyListById(t))},t.prototype.showByProp=function(t){for(var e=[],i=0;i<t.length;i++)e.push([t[i].prop_id,t[i].num]);this.showByList(e)},t.prototype.getListOverlay=function(t){for(var e=[],i=0;i<t.length;i++)if(0==e.length)e.push([t[i][0],t[i][1],t[i][2]]);else{for(var s=!1,n=0;n<e.length;n++)if(e[n][0]==t[i][0]&&e[n][1]==t[i][1]){e[n][2]+=t[i][2],s=!0;break}s||e.push([t[i][0],t[i][1],t[i][2]])}return e},t}();__reflect(RewardModule.prototype,"RewardModule");var RewardReceivePopup=function(t){function e(){var e=t.call(this)||this;return e.m_time=0,e.m_itemList=[],e.m_itemW=120,e.m_flgW=20,e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/rewardUI/RewardReceiveSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){this.m_effectOpenType=1,this.m_effectCloseType=2,this.touchEnabled=!1,this.u_txtTitle.textFlow=LanguageJson.getHtmlTextFlow("l_game_tips_29")},e.prototype.showView=function(e){if(void 0===e&&(e=null),this.checkComplete(this.showView,e)){t.prototype.showView.call(this,e);for(var i in this.m_itemList)this.m_itemList[i].hide();for(var s=e.c_dataList,n=Math.ceil(s.length/6),o=s.length>=6?6:s.length,a=.5*(StageManager.MIN_STAGE_WIDTH-(o*this.m_itemW+(o-1)*this.m_flgW)),r=.5*(StageManager.MIN_STAGE_HEIGHT-(n*this.m_itemW+(n-1)*this.m_flgW)),_=0;_<s.length;_++){var h;this.m_itemList[_]?h=this.m_itemList[_]:(h=new ItemFloat,this.m_itemList[_]=h),h.setItem(s[_],.12+.11*_,3),this.addChild(h);var l=Math.ceil((_+1)/6);h.x=a+(_-6*(l-1))*(this.m_itemW+this.m_flgW),h.y=r+(l-1)*(this.m_itemW+this.m_flgW)}e&&e.c_time&&e.c_time>0?(this.m_time=e.c_time,TimeManager.instance.doLoop(this.factionTreasureTime,this)):this.m_time=0,this.u_txtTip.visible=!0,this.u_txtTip.text=LanguageJson.getText("l_closePop_tip"),e&&e.c_delayTime&&e.c_delayTime>0&&(this.u_txtTip.visible=!1,DelayCallUtils.delayedCall(e.c_delayTime,this.setCloseState,this))}},e.prototype.setCloseState=function(){this.u_txtTip.visible=!0},e.prototype.hide=function(e,i){DelayCallUtils.killDelayedCallsTo(this.setCloseState,this),TimeManager.instance.clearTimer(this.factionTreasureTime,this),ItemFloatModule.instance.floatItemListByItemFloat(this.m_itemList,!0),t.prototype.hide.call(this,e,i)},e.prototype.sureHide=function(e,i){void 0===i&&(i=null),t.prototype.sureHide.call(this,e,i)},e.prototype.factionTreasureTime=function(){return this.m_time<=0?void this.close():(this.u_txtTip.textFlow=LanguageJson.getHtmlTextFlow("l_closePop_tip2",[this.m_time]),void(this.m_time-=1))},Object.defineProperty(e.prototype,"isClickBMask",{get:function(){return this.u_txtTip.visible},enumerable:!0,configurable:!0}),e}(PopupBase);__reflect(RewardReceivePopup.prototype,"RewardReceivePopup");var RewardShowPopup=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/rewardUI/RewardShowSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){this.m_rewardGroup||(this.m_rewardGroup=new RewardGroupUI,this.m_rewardGroup.spaceX=18,this.m_rewardGroup.y=140,this.m_rewardGroup.visualHeight=120,this.addChild(this.m_rewardGroup))},e.prototype.initEvent=function(){this.setCloseBtn(this.u_btnClose),this.setCloseBtn(this.u_btnSure)},e.prototype.showView=function(e){if(void 0===e&&(e=null),this.checkComplete(this.showView,e)){t.prototype.showView.call(this,e);var i=e.c_dataList;if(i.length>=5)this.m_rewardGroup.visualWidth=450,this.m_rewardGroup.x=(this.width-450)/2;else{this.m_rewardGroup.visualWidth=0;var s=86*i.length+18*(i.length-1);this.m_rewardGroup.x=(this.width-s)/2}this.m_rewardGroup.setDataByList(i,i.length)}},Object.defineProperty(e.prototype,"width",{get:function(){return 543},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 416},enumerable:!0,configurable:!0}),e}(PopupBase);__reflect(RewardShowPopup.prototype,"RewardShowPopup");var RoleListUI=function(t){function e(){var e=t.call(this)||this;return e.m_allHero=0,e.m_layout1=new eui.TileLayout,e.m_typeList1=new eui.ArrayCollection,e.m_layout2=new eui.TileLayout,e.m_typeList2=new eui.ArrayCollection,e.m_disposeUrlList.push("roleListUI_json"),e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/roleListUI/RoleListUISkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.touchEnabled=!1;var e=[0,1,2,3,4];this.m_layout1.requestedColumnCount=1,this.m_layout1.verticalGap=13,this.u_sortList.itemRenderer=RoleSortRender,this.u_sortList.layout=this.m_layout1,this.u_sortList.dataProvider=this.m_typeList1,this.m_typeList1.source=e,this.u_sortListBg.height=48*e.length+13*(e.length-1)+15,this.u_scrollerItem.horizontalScrollBar=null,this.u_scrollerItem.verticalScrollBar=null,this.m_layout2.requestedColumnCount=5,this.m_layout2.verticalGap=17,this.u_listItem.itemRenderer=RoleHeroRender,this.u_listItem.layout=this.m_layout2,this.u_listItem.dataProvider=this.m_typeList2,this.m_allHero=HeroJson.getHeroIdList().length;var i=.5*(StageManager.MIN_STAGE_WIDTH-StageManager.instance.p_stageWidth);this.u_imgBg.x+=i},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnSort,this.onOpenSort,this)},e.prototype.onOpenSort=function(t){void 0===t&&(t=null),1==this.u_imgArrow.scaleY?(TweenLite.to(this.u_imgArrow,.15,{scaleY:-1}),this.u_grpSort.visible=!0):-1==this.u_imgArrow.scaleY&&(TweenLite.to(this.u_imgArrow,.15,{scaleY:1}),this.u_grpSort.visible=!1),t.stopPropagation(),t.stopImmediatePropagation()},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),this.u_grpSort.visible=!1,this.u_imgArrow.scaleY=1,Dispatch.register(HeroManager.EVENT_HERO_ADD,this.setListData,this,!0),Dispatch.register(RoleSortRender.EVENT_HERO_SORT,this.upSortData,this),Dispatch.register(StageManager.EVENT_STAGE_CLICK,this.onStageClick,this),this.setRowsY(HeroManager.instance.heroData.id))},e.prototype.onStageClick=function(t){-1==this.u_imgArrow.scaleY&&(TweenLite.to(this.u_imgArrow,.15,{scaleY:1}),this.u_grpSort.visible=!1)},e.prototype.setListData=function(t){void 0===t&&(t=null);var i=HeroManager.instance.getHeroList(1).length;this.u_txtOwned.textFlow=LanguageJson.getHtmlTextFlow("l_newRole_owned_hero",[i,this.m_allHero]),(null==t||HeroManager.instance.getHeroIndex(e.p_dataList,RoleUI.p_heroId)>=0)&&this.upSortData()},e.prototype.upSortData=function(){this.u_scrollerItem.viewport.scrollV=0,this.u_txtSortMsg.text=LanguageJson.getText("l_newRole_hero_sort_"+e.p_sortId);var t=[],i=[];switch(e.p_sortId){case 0:t=HeroManager.instance.getHeroList(1),i=HeroManager.instance.getHeroList(2);break;case 1:t=HeroManager.instance.getHeroList(1,1),i=HeroManager.instance.getHeroList(2,1);break;case 2:t=HeroManager.instance.getHeroList(1,2),i=HeroManager.instance.getHeroList(2,2);break;case 3:t=HeroManager.instance.getHeroList(1);break;case 4:t=HeroManager.instance.getHeroList(2)}e.p_dataList=t.concat(i),this.m_typeList2.source=e.p_dataList},e.prototype.setRowsY=function(t){for(var i=0,s=0,n=0;n<e.p_dataList.length;n++)if(e.p_dataList[n].heroId==t){s=n;break}s>=5&&(i=321*Math.floor(s/5),TweenLite.to(this.u_scrollerItem.viewport,.2,{scrollV:i}))},e.prototype.hide=function(e,i){Dispatch.remove(RoleSortRender.EVENT_HERO_SORT,this.upSortData,this),Dispatch.remove(HeroManager.EVENT_HERO_ADD,this.upSortData,this),Dispatch.remove(StageManager.EVENT_STAGE_CLICK,this.onStageClick,this),t.prototype.hide.call(this,e,i)},e.p_dataList=[],e.p_sortId=0,e}(UIBase);__reflect(RoleListUI.prototype,"RoleListUI");var RoleHeroRender=function(t){function e(){var e=t.call(this,"resource/eui_skins/roleListUI/render/RoleHeroRenderSkin.exml")||this;return e.m_itemId=0,e.m_jinDuW=0,e}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this),this.touchEnabled=!1},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this,this.onClick,this)},e.prototype.onClick=function(t){UIModule.instance.showUI(UIConfig.ID_ROLE_INFO,{c_heroId:this.m_json.hero_id})},e.prototype.dataChanged=function(){if(this.checkComplete(this.dataChanged)){if(t.prototype.dataChanged.call(this),this.m_json&&Dispatch.remove(BagManager.EVENT_BAG_UPGRADE+this.m_itemId,this.upItemNum,this),this.m_data=this.data,this.m_json=HeroJson.getData(this.m_data.heroId),this.m_itemId=this.m_json.unlock_item_list[0],this.m_heroData=HeroManager.instance.getHeroInfo(this.m_json.hero_id),this.u_imgQuailty.source="roleListUI_json.roleListUI_quailty"+this.m_json.quality,this.u_heroIcon.source=PublicCon.PATH_HERO+"heroHead/"+this.m_json.icon+".png",this.u_txtName.text=this.m_json.name,this.u_txtName.textColor=ColorJson.getColorNum(this.m_json.quality),this.u_itemIcon.source=ItemJson.getIconPath(this.m_itemId),this.u_imgRed.visible=!1,this.u_grpItem.visible=!0,this.u_itemIcon.visible=!0,this.m_heroData)this.u_imgLock.visible=!1,this.u_grpStar.visible=!0,this.u_txtName.visible=!0,this.upHeroStar(this.m_json.hero_id);else{this.u_imgLock.visible=!0,this.u_grpStar.visible=!1;var e=ItemJson.getData(this.m_itemId);if(e&&e.output_list[0]){var i=FunctionConfigJson.getData(e.output_list[0]);i&&i.item_access?this.u_txtPath.textFlow=HtmlUtil.setTextFlow(i.item_access):this.u_txtPath.text=""}}Dispatch.register(HeroManager.EVENT_HERO_CHANGE,this.heroShangZhen,this,!0),Dispatch.register(HeroManager.EVENT_HERO_UPSTAR,this.upHeroStar,this),Dispatch.register(BagManager.EVENT_BAG_UPGRADE+this.m_itemId,this.upItemNum,this,!0)}},e.prototype.upHeroStar=function(t){t==this.m_json.hero_id&&(this.m_heroData=HeroManager.instance.getHeroInfo(t),this.u_txtStar.text=this.m_heroData.star+"",this.upItemNum())},e.prototype.upItemNum=function(){var t=this.m_heroData?this.m_heroData.star:0,e=HeroStarJson.getData(this.m_json.hero_id,t),i=0,s=BagManager.instance.getNum(this.m_itemId);if(this.m_heroData){if(this.u_txtPath.visible=!1,0==e.star_next)return this.u_itemIcon.visible=!1,this.u_imgRed.visible=!1,this.u_grpJindu.x=0,this.u_imgJinduBg.width=195,this.u_imgJindu.width=179,this.u_txtJindu.text=LanguageJson.getText("l_newRole_hero_max"),void Dispatch.remove(BagManager.EVENT_BAG_UPGRADE+this.m_itemId,this.upItemNum,this);i=e.item_list[1],this.u_itemIcon.visible=!0,this.u_grpJindu.x=15,this.u_imgJinduBg.width=180,this.m_jinDuW=163}else i=this.m_json.unlock_item_list[1],0==s?(this.u_txtPath.visible=!0,this.u_grpItem.visible=!1,this.u_txtName.visible=!1):(this.u_txtPath.visible=!1,this.u_grpItem.visible=!0,this.u_itemIcon.visible=!0,this.u_txtName.visible=!1,this.u_grpJindu.x=15,this.u_imgJinduBg.width=180,this.m_jinDuW=163);this.u_imgRed.visible=s>=i?!0:!1,this.u_txtJindu.text=s+"/"+i,this.u_imgJindu.width=s>i?this.m_jinDuW:s/i*this.m_jinDuW},e.prototype.heroShangZhen=function(){this.m_json.hero_id==HeroManager.instance.heroData.id?this.u_imgSelect.visible=!0:this.u_imgSelect.visible=!1},e.prototype.removeEff=function(){this.m_effect&&(this.m_effect.destory(),this.m_effect=null)},e.prototype.onRemoveStage=function(e){t.prototype.onRemoveStage.call(this,e),this.removeEff(),Dispatch.remove(HeroManager.EVENT_HERO_CHANGE,this.heroShangZhen,this),Dispatch.remove(HeroManager.EVENT_HERO_UPSTAR,this.upHeroStar,this),this.m_json&&Dispatch.remove(BagManager.EVENT_BAG_UPGRADE+this.m_itemId,this.upItemNum,this)},e}(ItemRendererBase);__reflect(RoleHeroRender.prototype,"RoleHeroRender");var RoleSortRender=function(t){function e(){return t.call(this,"resource/eui_skins/roleListUI/render/RoleSortRenderSkin.exml")||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnClick,this.onSelect,this)},e.prototype.onSelect=function(t){void 0===t&&(t=null),RoleListUI.p_sortId!=this.m_id&&(RoleListUI.p_sortId=this.m_id,Dispatch.dispatch(e.EVENT_HERO_SORT))},e.prototype.dataChanged=function(){this.checkComplete(this.dataChanged)&&(t.prototype.dataChanged.call(this),this.m_id=this.data,4==this.m_id?this.u_imgLine.visible=!1:this.u_imgLine.visible=!0,this.u_txtName.text=LanguageJson.getText("l_newRole_hero_sort_"+this.m_id))},e.EVENT_HERO_SORT="EVENT_HERO_SORT",e}(ItemRendererBase);__reflect(RoleSortRender.prototype,"RoleSortRender");var RoleUI=function(t){function e(){var e=t.call(this)||this;return e.m_heroBgList=[],e.m_itemId=0,e.m_hasNum=0,e.m_needNum=0,e.m_jinDuW=160,e.m_heroAllList=[],e.m_index=0,e.m_disposeUrlList.push("roleUI_json"),e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/roleUI/RoleUISkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.m_starView||(this.m_starView=new StarView,this.m_starView.x=187,this.m_starView.y=97),this.u_mcMid.addChild(this.m_starView),this.m_starView.p_starBj1="commonUI_json.commonUI_star_2",this.m_starView.p_starBj2="commonUI_json.commonUI_star_3",this.m_starView.starWidth=23,this.m_starView.createStar(5),this.u_txtSure.text=LanguageJson.getText("l_newRole_hero_btn_select");var e=.5*(StageManager.MIN_STAGE_WIDTH-StageManager.instance.p_stageWidth);this.u_imgBg.x+=e,this.u_mcLeft.x+=e,this.u_mcRight.x-=e,this.u_imgMask.x+=e,this.u_imgMask.width=StageManager.instance.p_stageWidth},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnTips,this.onTips,this,!0),this.registerEventClick(this.u_btnSure,this.onSure,this,!0),this.registerEventClick(this.u_btnBisha,this.onBiSha,this,!0),this.registerEventClick(this.u_btnUp,this.onUpStar,this,!0),this.registerEventClick(this.u_btnWeap,this.onWeap,this,!0),this.registerEventClick(this.u_btnDesign,this.onDesign,this,!0),this.registerEventClick(this.u_itemIcon,this.onShowAccess,this,!0),this.registerEventClick(this.u_btnLeft,this.onLeftHandle,this,!0),this.registerEventClick(this.u_btnRight,this.onRightHandle,this,!0)},e.prototype.onTips=function(t){PopupModule.instance.showPop(PopupConfig.ID_HERO_DESC,null,!1)},e.prototype.onSure=function(t){HeroManager.instance.s_hero_charge_hero_parts(e.p_heroId,e.p_weapId,e.p_designId)},e.prototype.onBiSha=function(t){PopupModule.instance.showPop(PopupConfig.ID_HERO_SKILL_PLAY,null,!1)},e.prototype.onUpStar=function(t){this.m_heroData?HeroManager.instance.s_hero_hero_up_star(e.p_heroId):HeroManager.instance.s_hero_unlock_hero(e.p_heroId)},e.prototype.onWeap=function(t){this.showPartView(1),t.stopPropagation(),t.stopImmediatePropagation()},e.prototype.onDesign=function(t){this.showPartView(2),t.stopPropagation(),t.stopImmediatePropagation()},e.prototype.showPartView=function(t){this.m_rolePartView&&(0==this.m_rolePartView.grpX?this.m_rolePartView.hideAnimation():this.m_rolePartView.grpX==this.m_rolePartView.width&&this.m_rolePartView.show(t))},e.prototype.onLeftHandle=function(t){this.m_index<=0||(this.m_index-=1,e.p_heroId=RoleListUI.p_dataList[this.m_index].heroId,this.setSelectBtn(),this.heroSelect())},e.prototype.onRightHandle=function(t){this.m_index>=RoleListUI.p_dataList.length-1||(this.m_index+=1,e.p_heroId=RoleListUI.p_dataList[this.m_index].heroId,this.setSelectBtn(),this.heroSelect())},e.prototype.showView=function(i){void 0===i&&(i=null),this.checkComplete(this.showView,i)&&(t.prototype.showView.call(this,i),e.p_heroId=0,e.p_weapId=0,e.p_designId=0,i&&i.c_heroId?e.p_heroId=i.c_heroId:HeroManager.instance.heroData&&HeroManager.instance.heroData.id&&(e.p_heroId=HeroManager.instance.heroData.id),this.m_rolePartView||(this.m_rolePartView=new RoleWeapView,this.m_rolePartView.x=StageManager.instance.p_stageWidth-this.m_rolePartView.width,this.m_rolePartView.y=0),UIModule.instance.upUILayer.addChild(this.m_rolePartView),this.m_rolePartView.grpX=this.m_rolePartView.width,this.m_rolePartView.visible=!1,Dispatch.register(HeroManager.EVENT_HERO_CHANGE,this.upHeroPart,this),Dispatch.register(HeroManager.EVENT_HERO_UPSTAR,this.upHeroStar,this),Dispatch.register(RoleWeapRender.EVENT_HERO_WEAP_SELECT,this.shangZhenBtn,this),Dispatch.register(HeroManager.EVENT_HERO_ADD,this.heroAdd,this),Dispatch.register(RoleWeapRender.EVENT_HERO_WEAP_PREVIEW,this.changeModel,this),this.heroSelect())},e.prototype.partSelect=function(){this.changeModel(),this.shangZhenBtn()},e.prototype.changeModel=function(){},e.prototype.heroAdd=function(t){this.m_index=HeroManager.instance.getHeroIndex(RoleListUI.p_dataList,e.p_heroId),t==e.p_heroId&&(this.upHeroData(),this.setHeroStar())},e.prototype.heroSelect=function(){this.m_heroJson&&Dispatch.remove(BagManager.EVENT_BAG_UPGRADE+this.m_itemId,this.upItemNum,this),this.m_heroJson=HeroJson.getData(e.p_heroId),this.m_itemId=this.m_heroJson.unlock_item_list[0],this.u_itemIcon.source=ItemJson.getIconPath(this.m_itemId),this.m_index=HeroManager.instance.getHeroIndex(RoleListUI.p_dataList,e.p_heroId),this.setSelectBtn(),this.setHeroData(),this.setHeroStar(),this.shangZhenBtn(),Dispatch.register(BagManager.EVENT_BAG_UPGRADE+this.m_itemId,this.upItemNum,this)},e.prototype.setSelectBtn=function(){this.m_index<=0?this.u_btnLeft.visible=!1:this.u_btnLeft.visible=!0,this.m_index>=RoleListUI.p_dataList.length-1?this.u_btnRight.visible=!1:this.u_btnRight.visible=!0},e.prototype.upHeroPart=function(){this.m_partEff||(this.m_partEff=new EffectMovieClip,this.m_partEff.setMC("resource/assets/uiEffect/hero/zhangzhen"),this.m_partEff.x=this.width/2,this.m_partEff.y=this.height/2,this.m_partEff.onCompleteFunc=this.removePartEff.bind(this)),this.addChild(this.m_partEff),this.m_partEff.play(12,1),this.shangZhenBtn()},e.prototype.upHeroStar=function(t){t==e.p_heroId&&(this.m_partEff||(this.m_partEff=new EffectMovieClip,this.m_partEff.setMC("resource/assets/uiEffect/hero/upStar"),this.m_partEff.x=this.width/2,this.m_partEff.y=this.height/2,this.m_partEff.onCompleteFunc=this.removePartEff.bind(this)),this.m_partEff.play(12,1),this.addChild(this.m_partEff),this.setHeroStar())},e.prototype.setHeroData=function(){this.upHeroData();var t=PublicCon.PATH_HERO+"heroBg/"+e.p_heroId+".jpg",i=PublicCon.PATH_HERO+"bisha/"+e.p_heroId+".png";this.u_txtHeroName.text=this.m_heroJson.name,this.u_imgQuailty.source="roleUI_json.roleUI_quality_"+this.m_heroJson.quality,this.u_imgBg.source=t,this.u_imgBiSha.source=i,-1==this.m_heroBgList.indexOf(t)&&this.m_heroBgList.push(t),-1==this.m_heroBgList.indexOf(i)&&this.m_heroBgList.push(i),this.m_roleDr||(this.m_roleDr=new DragonMovieClip,this.addChildAt(this.m_roleDr,1),this.m_roleDr.y=630,this.m_roleDr.x=.5*this.width),this.m_roleDr.playHero(this.m_heroJson.hero_id)},e.prototype.upHeroData=function(){if(HeroManager.instance.getHeroInfo(e.p_heroId))HeroManager.instance.heroData&&HeroManager.instance.heroData.id==e.p_heroId?(HeroManager.instance.heroData.arms&&(e.p_weapId=HeroManager.instance.heroData.arms),HeroManager.instance.heroData.ornaments&&(e.p_designId=HeroManager.instance.heroData.ornaments)):(e.p_weapId=HeroManager.instance.getWeapByHeaoId(e.p_heroId),e.p_designId=0),this.u_btnSure.visible=!0,this.u_grpPath.visible=!1;else{this.u_btnSure.visible=!1,this.u_grpPath.visible=!0;var t=ItemJson.getData(this.m_itemId);if(t&&t.output_list[0]){var i=FunctionConfigJson.getData(t.output_list[0]);i&&i.item_access?(this.u_txtTips.textFlow=HtmlUtil.setTextFlow(i.item_access),this.u_tipsBg.height=this.u_txtTips.height+20>58?this.u_txtTips.height+20:58):this.u_txtTips.text=""}}},e.prototype.setHeroStar=function(){this.m_heroData=HeroManager.instance.getHeroInfo(e.p_heroId);var t=this.m_heroData?this.m_heroData.star:0,i=HeroStarJson.getData(e.p_heroId,t);if(this.m_starView.setStar(t),this.u_grpItem.x=149,this.u_imgJinduBg.width=174,t>=this.m_heroJson.hero_skill_unlock_star?(this.u_imgBiShaPlay.visible=!0,this.u_imgBiShaLock.visible=!1):(this.u_imgBiShaPlay.visible=!1,this.u_imgBiShaLock.visible=!0),this.m_heroData){if(0==i.star_next)return this.u_grpItem.visible=!0,this.u_itemIcon.visible=!1,this.u_btnUp.visible=!1,this.u_imgJinduBg.width=198,this.u_imgJindu.width=this.m_jinDuW+24,this.u_grpItem.x=125,this.u_txtJindu.text=LanguageJson.getText("l_newRole_hero_max"),void Dispatch.remove(BagManager.EVENT_BAG_UPGRADE+this.m_itemId,this.upItemNum,this);this.m_needNum=i.item_list[1]}else this.m_needNum=this.m_heroJson.unlock_item_list[1];this.upItemNum()},e.prototype.upItemNum=function(){if(this.m_hasNum=BagManager.instance.getNum(this.m_itemId),this.m_heroData){if(this.m_hasNum>=this.m_needNum)return this.u_grpItem.visible=!1,this.u_btnUp.visible=!0,void(this.u_txtUp.text=LanguageJson.getText("l_newRole_hero_btn_upstar"));this.u_grpItem.visible=!0,this.u_itemIcon.visible=!0,this.u_btnUp.visible=!1}else{if(this.m_hasNum>=this.m_needNum)return this.u_grpItem.visible=!1,this.u_btnUp.visible=!0,void(this.u_txtUp.text=LanguageJson.getText("l_newRole_hero_btn_unlock"));this.u_grpItem.visible=!0,this.u_itemIcon.visible=!0,this.u_btnUp.visible=!1}this.u_txtJindu.text=this.m_hasNum+"/"+this.m_needNum,this.u_imgJindu.width=this.m_hasNum>this.m_needNum?this.m_jinDuW:this.m_hasNum/this.m_needNum*this.m_jinDuW
},e.prototype.shangZhenBtn=function(){this.m_heroData&&(e.p_heroId==HeroManager.instance.heroData.id&&e.p_weapId==HeroManager.instance.heroData.arms&&e.p_designId==HeroManager.instance.heroData.ornaments?this.u_btnSure.visible=!1:this.u_btnSure.visible=!0)},e.prototype.onShowAccess=function(){this.m_itemId&&PopupModule.instance.showAccess(this.m_itemId)},e.prototype.removePartEff=function(){this.m_partEff&&(this.m_partEff.destory(),this.m_partEff=null)},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i),this.m_rolePartView&&(this.m_rolePartView.sureHide(),this.m_rolePartView=null),this.removePartEff(),Dispatch.remove(HeroManager.EVENT_HERO_CHANGE,this.upHeroPart,this),Dispatch.remove(HeroManager.EVENT_HERO_UPSTAR,this.upHeroStar,this),Dispatch.remove(RoleWeapRender.EVENT_HERO_WEAP_SELECT,this.shangZhenBtn,this),Dispatch.remove(HeroManager.EVENT_HERO_ADD,this.heroAdd,this),Dispatch.remove(RoleWeapRender.EVENT_HERO_WEAP_PREVIEW,this.changeModel,this),this.m_heroJson&&Dispatch.remove(BagManager.EVENT_BAG_UPGRADE+this.m_itemId,this.upItemNum,this)},e.prototype.sureHide=function(e,i){void 0===e&&(e=null),void 0===i&&(i=null),t.prototype.sureHide.call(this,e,i),this.m_roleDr&&(this.m_roleDr.destory(),this.m_roleDr=null);for(var s in this.m_heroBgList)RES.destroyRes(this.m_heroBgList[s]);this.m_heroBgList=[]},e.p_heroId=0,e.p_weapId=0,e.p_designId=0,e}(UIBase);__reflect(RoleUI.prototype,"RoleUI");var RoleDescPopup=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/roleUI/popup/RoleDescPopupSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_txtBlank.textFlow=LanguageJson.getHtmlTextFlow("l_closePop_tip")},e.prototype.initEvent=function(){t.prototype.initEvent.call(this)},e.prototype.showView=function(e){if(void 0===e&&(e=null),this.checkComplete(this.showView,e)){t.prototype.showView.call(this,e);var i=HeroJson.getData(RoleUI.p_heroId);this.u_txtHeroName.text=i.name,this.u_txtMsg.textFlow=HtmlUtil.setTextFlow(i.desc)}},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i)},e}(PopupBase);__reflect(RoleDescPopup.prototype,"RoleDescPopup");var RoleVideoPopup=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/roleUI/popup/RoleVideoPopupSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_txtBlank.textFlow=LanguageJson.getHtmlTextFlow("l_closePop_tip")},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnPlay,this.onPlay,this)},e.prototype.onPlay=function(t){this.u_imgPlay.visible?(this.m_video.onPlay(),this.u_imgPlay.visible=!1):(this.m_video.onPause(),this.u_imgPlay.visible=!0)},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),this.u_imgPlay.visible=!0,this.m_video||(this.m_video=new RoleVideo),this.addChildAt(this.m_video,2),this.m_video.preLoad())},e.prototype.hide=function(e,i){this.m_video&&(this.m_video.onClose(),DisplayObjectUtils.removeFormParent(this.m_video),this.m_video=null),t.prototype.hide.call(this,e,i)},e}(PopupBase);__reflect(RoleVideoPopup.prototype,"RoleVideoPopup");var RoleWeapRender=function(t){function e(){var e=t.call(this,"resource/eui_skins/roleUI/render/RoleWeapRenderSkin.exml")||this;return e.m_partId=0,e.m_isHave=!1,e}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this),this.touchEnabled=!1},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnClick,this.onWeapShow,this)},e.prototype.onWeapShow=function(t){this.m_isHave?this.m_partId!=RoleUI.p_weapId&&this.m_partId!=RoleUI.p_designId&&(1==this.m_partJson.type?RoleUI.p_weapId=this.m_partId:2==this.m_partJson.type&&(RoleUI.p_designId=this.m_partId),Dispatch.dispatch(e.EVENT_HERO_WEAP_SELECT)):Dispatch.dispatch(e.EVENT_HERO_WEAP_PREVIEW)},e.prototype.dataChanged=function(){if(this.checkComplete(this.dataChanged)){t.prototype.dataChanged.call(this),this.m_partId=this.data,this.m_partJson=HeroPartsJson.getData(this.m_partId);var i=ItemJson.getData(this.m_partJson.item_id);this.u_imgIcon.source=ItemJson.getIconPath(i.id),this.u_txtName.text=i.name,this.u_txtDesc.text=this.m_partJson.conditions_desc,Dispatch.register(HeroManager.EVENT_HERO_ADD_PARTS,this.setWeapData,this),Dispatch.register(e.EVENT_HERO_WEAP_SELECT,this.setSelect,this,!0),this.setWeapData(this.m_partId)}},e.prototype.setWeapData=function(t){t==this.m_partId&&(this.m_isHave=HeroManager.instance.getHasParts(this.m_partId),this.u_imgLock.visible=!this.m_isHave,this.u_txtName.visible=this.m_isHave,this.u_txtDesc.visible=!this.m_isHave,this.u_imgIcon.y=this.m_isHave?25:16)},e.prototype.setSelect=function(){this.m_partId==RoleUI.p_weapId||this.m_partId==RoleUI.p_designId?this.u_imgSelect.visible=!0:this.u_imgSelect.visible=!1},e.prototype.onRemoveStage=function(i){Dispatch.remove(HeroManager.EVENT_HERO_ADD_PARTS,this.setWeapData,this),Dispatch.remove(e.EVENT_HERO_WEAP_SELECT,this.setSelect,this),t.prototype.onRemoveStage.call(this,i)},e.EVENT_HERO_WEAP_SELECT="EVENT_HERO_WEAP_SELECT",e.EVENT_HERO_WEAP_PREVIEW="EVENT_HERO_WEAP_PREVIEW",e}(ItemRendererBase);__reflect(RoleWeapRender.prototype,"RoleWeapRender");var RoleVideo=function(t){function e(){var e=t.call(this)||this;return e.m_video=new egret.Video,e.m_video.x=283,e.m_video.y=175,e.m_video.width=570,e.m_video.height=290,e.m_video.fullscreen=!1,e.addChild(e.m_video),e}return __extends(e,t),e.prototype.preLoad=function(){var t=URIManager.cdn+"assets/icon/hero/bisha/"+RoleUI.p_heroId+".mp4";this.m_video.load(t),this.m_video.once(egret.Event.COMPLETE,this.onLoad,this),this.m_video.once(egret.IOErrorEvent.IO_ERROR,this.onLoadErr,this)},e.prototype.onLoad=function(t){console.log(this.m_video.length)},e.prototype.onLoadErr=function(t){console.log("视频加载失败")},e.prototype.onPlay=function(t){void 0===t&&(t=null),this.m_video.play()},e.prototype.onPause=function(t){void 0===t&&(t=null),this.m_video.pause()},e.prototype.onClose=function(t){void 0===t&&(t=null),this.m_video.close()},e}(egret.DisplayObjectContainer);__reflect(RoleVideo.prototype,"RoleVideo");var RoleWeapView=function(t){function e(){var e=t.call(this)||this;return e.m_layout=new eui.TileLayout,e.m_typeList=new eui.ArrayCollection,e.m_weapList=[],e.touchEnabled=!1,e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/roleUI/view/RoleWeapViewSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.u_weapScroller.horizontalScrollBar=null,this.u_weapScroller.verticalScrollBar=null,this.m_layout.requestedColumnCount=1,this.m_layout.verticalGap=1,this.u_weapList.itemRenderer=RoleWeapRender,this.u_weapList.layout=this.m_layout,this.u_weapList.dataProvider=this.m_typeList},e.prototype.initEvent=function(){this.registerEventClick(this.u_btnClose,this.onClick,this,!0),this.registerEventClick(this.u_btnSelect1,this.onSelect1,this),this.registerEventClick(this.u_btnSelect2,this.onSelect2,this)},e.prototype.onSelect1=function(){1!=this.m_type&&(this.m_type=1,this.changePart())},e.prototype.onSelect2=function(){2!=this.m_type&&(this.m_type=2,this.changePart())},e.prototype.onClick=function(t){this.hideAnimation(),t.stopPropagation(),t.stopImmediatePropagation()},e.prototype.show=function(t){this.checkComplete(this.show,t)&&(this.recoverAllTexture(this,!0),this.m_type=t,this.visible=!0,Dispatch.register(StageManager.EVENT_STAGE_CLICK,this.onStageClick,this),this.setPartData(),this.showAnimation())},e.prototype.setPartData=function(){this.m_heroJson=HeroJson.getData(RoleUI.p_heroId),this.changePart()},e.prototype.changePart=function(t){void 0===t&&(t=null),1==this.m_type?(this.m_weapList=this.m_heroJson.weapon_part_list,this.u_iconSelect1.visible=!0,this.u_iconSelect2.visible=!1,this.u_imgSelect1.source="roleUI_json.roleUI_btn_wq2",this.u_imgSelect2.source="roleUI_json.roleUI_btn_zs1"):(this.m_weapList=this.m_heroJson.ornaments_part_list,this.u_iconSelect1.visible=!1,this.u_iconSelect2.visible=!0,this.u_imgSelect1.source="roleUI_json.roleUI_btn_wq1",this.u_imgSelect2.source="roleUI_json.roleUI_btn_zs2"),this.m_typeList.source=this.m_weapList},e.prototype.showAnimation=function(){this.u_grpPart.x=this.width,this.u_grpPart.alpha=1,TweenLite.killTweensOf(this.u_grpPart),TweenLite.to(this.u_grpPart,.2,{x:0})},e.prototype.hideAnimation=function(){TweenLite.killTweensOf(this.u_grpPart),TweenLite.to(this.u_grpPart,.2,{x:this.width,alpha:0,onComplete:this.hideView.bind(this)}),Dispatch.remove(StageManager.EVENT_STAGE_CLICK,this.onStageClick,this)},e.prototype.onStageClick=function(t){var e=this.localToGlobal(0,0);t.stageX>=e.x&&t.stageX<=e.x+this.width&&t.stageY>=e.y&&t.stageY<=e.y+this.height||this.hideAnimation()},Object.defineProperty(e.prototype,"grpX",{get:function(){return this.u_grpPart.x},set:function(t){this.u_grpPart.x=t},enumerable:!0,configurable:!0}),e.prototype.hideView=function(){this.visible=!1},e.prototype.sureHide=function(){DisplayObjectUtils.removeFormParent(this)},Object.defineProperty(e.prototype,"width",{get:function(){return 301},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 640},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(RoleWeapView.prototype,"RoleWeapView");var StarView=function(t){function e(){var e=t.call(this)||this;return e.m_starWidth=27,e.m_starList=[],e.p_starBj1="commonUI_json.commonUI_star_1",e.p_starBj2="commonUI_json.commonUI_star_bj",e}return __extends(e,t),e.prototype.createStar=function(t){this.m_star=t,this.dispose();for(var e,i=0;t>i;i++)this.m_starList[i]||(e=new eui.Image,this.m_starList[i]=e),this.addChild(this.m_starList[i]);this.setStarPos()},e.prototype.setStar=function(t){for(var e=0;e<this.m_starList.length;e++)t-1>=e?this.m_starList[e].source=this.p_starBj1:this.m_starList[e].source=this.p_starBj2},e.prototype.setStarPos=function(){for(var t=0,e=0;e<this.m_star;e++)this.m_starList[e].x=e*this.starWidth;this.starWidth<27&&(t=27-this.starWidth),this.width=this.m_star*this.starWidth+t},Object.defineProperty(e.prototype,"starWidth",{get:function(){return this.m_starWidth},set:function(t){this.m_starWidth=t,this.setStarPos()},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){for(var t=0;t<this.m_starList.length;t++)DisplayObjectUtils.removeFormParent(this.m_starList[t]);this.m_starList=[]},e}(eui.Component);__reflect(StarView.prototype,"StarView");var RotaryTableUI=function(t){function e(){var e=t.call(this)||this;return e.m_firstRota=-10,e.m_propList=[],e.m_isStart=!1,e.m_zhuanJson=[],e.m_disposeUrlList.push("rotaryTableUI_json"),e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/rotaryTableUI/RotaryTableSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnStart,this.startRota,this,!0)},e.prototype.showView=function(e){if(void 0===e&&(e=null),this.checkComplete(this.showView,e)){t.prototype.showView.call(this,e);var i=e;this.m_targetId=i.award_list[0].id,this.m_targetType=i.special_event_type,this.m_propList=i.award_list[0].prop_list,this.u_gpZhuan.rotation=0,this.m_isStart=!1,this.m_zhuanJson=StaticDataJson.parseStrToList("monster_function_zhuanpan_time");var s=Number(this.m_zhuanJson[0]);DelayCallUtils.delayedCall(s,this.startRota,this)}},e.prototype.startRota=function(){if(!this.m_isStart){DelayCallUtils.killDelayedCallsTo(this.startRota,this),this.m_isStart=!0;var t=MonsterFunctionZhuanpanJson.getData(this.m_targetType,this.m_targetId);if(t){var e=360-(Math.random()*(t.angle_range_list[1]-t.angle_range_list[0])+t.angle_range_list[0]+this.m_firstRota),i=360*(Math.floor(Math.random()*Number(this.m_zhuanJson[2]))+Number(this.m_zhuanJson[1]))+e,s=Math.random()*Number(this.m_zhuanJson[4])+Number(this.m_zhuanJson[3]);TweenLite.to(this.u_gpZhuan,s,{rotation:i,ease:Cubic.easeInOut}),DelayCallUtils.delayedCall(s+1,this.setReceive,this)}}},e.prototype.setReceive=function(){this.close(),FightManager.instance.showPopupAward(11,this.m_propList)},e.prototype.hide=function(e,i){DelayCallUtils.killDelayedCallsTo(this.startRota,this),DelayCallUtils.killDelayedCallsTo(this.setReceive,this),t.prototype.hide.call(this,e,i)},e.prototype.sureHide=function(e,i){void 0===e&&(e=null),void 0===i&&(i=null),t.prototype.sureHide.call(this,e,i)},Object.defineProperty(e.prototype,"isClickBMask",{get:function(){return!1},enumerable:!0,configurable:!0}),e}(PopupBase);__reflect(RotaryTableUI.prototype,"RotaryTableUI");var SceneMainModule=function(t){function e(){var e=t.call(this)||this;return e.m_load_key="scene_load_key",e.p_preLoad=!1,e.m_loadOver=!1,e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.m_instance||(this.m_instance=new e),this.m_instance},enumerable:!0,configurable:!0}),e.prototype.setLoadUI=function(t){if(void 0===t&&(t=!1),this.p_preLoad=t,this.m_loadOver)return void(this.p_preLoad||SceneManager.instance.s_scene_load_scene_tos());RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onPreloadMainUIComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceMainLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceMainProgress,this);var i=[];this.setAddIconUrl(i,e.p_mainBjUrl),this.setAddDragonUrl(i,PublicCon.PATH_SCENE_MAIN+"scene_main"),RES.createGroup(this.m_load_key,i),RES.loadGroup(this.m_load_key)},e.prototype.setAddIconUrl=function(t,e){t.push(e),RES.$addResourceData({name:e,type:RES.ResourceItem.TYPE_IMAGE,url:e})},e.prototype.setAddDragonUrl=function(t,e){var i=e+"_tex.png",s=e+"_tex.json",n=e+"_ske.json";t.push(i),RES.$addResourceData({name:i,type:RES.ResourceItem.TYPE_IMAGE,url:i}),t.push(s),RES.$addResourceData({name:s,type:RES.ResourceItem.TYPE_JSON,url:s}),t.push(n),RES.$addResourceData({name:n,type:RES.ResourceItem.TYPE_JSON,url:n})},e.prototype.onPreloadMainUIComplete=function(t){void 0===t&&(t=null),this.m_loadOver=!0,RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onPreloadMainUIComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceMainLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceMainProgress,this),this.p_preLoad||SceneManager.instance.s_scene_load_scene_tos()},e.prototype.destroyResAll=function(){this.m_loadOver=!1,RES.destroyRes(this.m_load_key)},e.prototype.setEffectBlack=function(t,e,i){void 0===t&&(t=null),void 0===e&&(e=.5),void 0===i&&(i=.4),this.m_effectBlack||(this.m_effectBlack=new GameBgEffectBlack),this.m_effectBlack.stareShow(t,e,i)},e.prototype.setEffectBitmap=function(t,e,i,s){void 0===t&&(t=null),void 0===e&&(e=0),void 0===i&&(i=.4),void 0===s&&(s=.5),this.m_effectBitmap||(this.m_effectBitmap=new GameBgEffectBitmap),this.m_effectBitmap.stareShow(t,e,i,s)},e.prototype.setEffectEasing=function(t,e,i,s){void 0===t&&(t=null),void 0===e&&(e=.5),void 0===i&&(i=.5),void 0===s&&(s=!1),this.m_effectEasing||(this.m_effectEasing=new GameBgEffectEasing),this.m_effectEasing.stareShow(t,e,i,s)},e.prototype.onResourceMainLoadError=function(t){console.warn("popup LoadError："+t.groupName)},e.prototype.onResourceMainProgress=function(t){},e.p_mainBjUrl=PublicCon.PATH_SCENE_MAIN+"scene_main.jpg",e}(egret.HashObject);__reflect(SceneMainModule.prototype,"SceneMainModule");var GameBgEffectBitmap=function(t){function e(){var e=t.call(this)||this;return e.m_bitmapList=[],e.m_bitmapNum=60,e.m_lieshuNum=6,e.m_tweenType=1,e.m_loadTxGrp||(e.m_loadTxGrp=new eui.Group),e.m_bgMenk||(e.m_bgMenk=new eui.Image("commonUI_box"),e.m_bgMenk.scale9Grid=UIModule.instance.getRectangle()),e}return __extends(e,t),e.prototype.stareShow=function(t,e,i,s){if(void 0===t&&(t=null),void 0===e&&(e=0),void 0===i&&(i=1.5),void 0===s&&(s=.12),!this.m_bgMenk||!this.m_bgMenk.parent){this.m_backFunc=t,this.m_moveTime=i,this.m_stayTime=s;var n=StageManager.instance.p_stage,o=StageManager.instance.p_stageWidth,a=StageManager.instance.p_stageHeight;this.m_loadTxGrp.width=o,this.m_loadTxGrp.height=a,this.m_tweenType=e,0==this.m_tweenType&&(this.m_tweenType=Math.ceil(5*Math.random()));for(var r=this.m_bitmapNum/this.m_lieshuNum,_=0;_<this.m_bitmapNum;_++){var h=o/this.m_lieshuNum,l=a/r,c=_%this.m_lieshuNum*h,m=Math.floor(_/this.m_lieshuNum)*l,p=new egret.RenderTexture;p.drawToTexture(StageManager.instance.rootDirec,new egret.Rectangle(c,m,h,l));var u=void 0;switch(this.m_bitmapList[_]?u=this.m_bitmapList[_]:(u=new egret.Bitmap,this.m_bitmapList.push(u)),u.texture=p,u.anchorOffsetX=h/2,u.anchorOffsetY=l/2,u.x=c+h/2,u.y=m+l/2,u.scaleX=1,u.scaleY=1,u.alpha=1,u.rotation=0,this.m_loadTxGrp.addChild(u),this.m_tweenType){case 1:TweenLite.to(u,2*this.m_moveTime,{scaleX:0,scaleY:0,alpha:0,rotation:359,ease:egret.Ease.circIn});break;case 2:var d=-o;_%2||(d=2*o),TweenLite.to(u,2*this.m_moveTime,{x:d,alpha:0,ease:egret.Ease.circIn});break;case 3:TweenLite.to(u,2*this.m_moveTime,{scaleX:.2,scaleY:1,alpha:0,blurFliter:0,ease:egret.Ease.backInOut});break;case 4:TweenLite.to(u,2*this.m_moveTime,{scaleY:0,scaleX:1,alpha:0,ease:egret.Ease.circIn});break;default:TweenLite.to(u,2*this.m_moveTime,{alpha:0,ease:egret.Ease.circIn})}}n.addChild(this.m_bgMenk),n.addChild(this.m_loadTxGrp),this.m_bgMenk.width=o,this.m_bgMenk.height=a,this.m_bgMenk.alpha=0,TweenLite.to(this.m_bgMenk,this.m_moveTime,{alpha:1,onComplete:this.stayGo.bind(this)})}},e.prototype.stayGo=function(){null!=this.m_backFunc&&this.m_backFunc.call(this,[1]),DelayCallUtils.delayedCall(this.m_stayTime,this.boBack,this)},e.prototype.boBack=function(){null!=this.m_backFunc&&this.m_backFunc.call(this,[2]),this.setBitmapBack(),DelayCallUtils.delayedCall(2*this.m_moveTime-.3,this.boSureBack,this)},e.prototype.boSureBack=function(){TweenLite.to(this.m_bgMenk,this.m_moveTime,{alpha:0,onComplete:this.hide.bind(this)})},e.prototype.hide=function(){DisplayObjectUtils.removeFormParent(this.m_bgMenk),DisplayObjectUtils.removeFormParent(this.m_loadTxGrp);for(var t in this.m_bitmapList)DisplayObjectUtils.removeFormParent(this.m_bitmapList[t]),this.m_bitmapList[t].texture=null;null!=this.m_backFunc&&this.m_backFunc.call(this,[3]),this.m_backFunc=null},e.prototype.setBitmapBack=function(){for(var t=StageManager.instance.p_stageWidth,e=StageManager.instance.p_stageHeight,i=this.m_bitmapNum/this.m_lieshuNum,s=0;s<this.m_bitmapNum;s++){var n=t/this.m_lieshuNum,o=e/i,a=s%this.m_lieshuNum*n,r=Math.floor(s/this.m_lieshuNum)*o,_=new egret.RenderTexture;if(_.drawToTexture(StageManager.instance.rootDirec,new egret.Rectangle(a,r,n,o)),this.m_bitmapList[s])switch(this.m_bitmapList[s].texture=_,this.m_tweenType){case 1:TweenLite.to(this.m_bitmapList[s],2*this.m_moveTime,{scaleX:1,scaleY:1,alpha:1,rotation:359});break;case 2:TweenLite.to(this.m_bitmapList[s],2*this.m_moveTime,{x:a+n/2,alpha:1});break;case 3:TweenLite.to(this.m_bitmapList[s],2*this.m_moveTime,{scaleX:1,alpha:1});break;case 4:TweenLite.to(this.m_bitmapList[s],2*this.m_moveTime,{scaleY:1,alpha:1});break;default:TweenLite.to(this.m_bitmapList[s],2*this.m_moveTime,{alpha:1})}}},e}(egret.HashObject);__reflect(GameBgEffectBitmap.prototype,"GameBgEffectBitmap");var GameBgEffectBlack=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.stareShow=function(t,e,i){void 0===t&&(t=null),void 0===e&&(e=.5),void 0===i&&(i=.12),this.m_bgMenk&&this.m_bgMenk.parent||(this.m_backFunc=t,this.m_moveTime=e,this.m_stayTime=i,this.m_bgMenk||(this.m_bgMenk=new eui.Image("commonUI_box"),this.m_bgMenk.alpha=0,this.m_bgMenk.scale9Grid=UIModule.instance.getRectangle()),this.m_bgMenk.width=StageManager.instance.p_stageWidth,this.m_bgMenk.height=StageManager.instance.p_stageHeight,StageManager.instance.loadinglayer.addChild(this.m_bgMenk),this.m_bgmIcon||(this.m_bgmIcon=new eui.Image("commonUI_box"),this.m_bgmIcon.scale9Grid=UIModule.instance.getRectangle()),this.m_bgmIcon.width=StageManager.instance.p_stageWidth,this.m_bgmIcon.height=StageManager.instance.p_stageHeight,this.m_bgmIcon.alpha=0,StageManager.instance.loadinglayer.addChild(this.m_bgmIcon),TweenLite.to(this.m_bgmIcon,this.m_moveTime,{alpha:1,ease:Linear.easeNone,onComplete:this.stayGo.bind(this)}),Dispatch.register(StageManager.EVENT_STAGE_RESIZE,this.stageResize,this))},e.prototype.stayGo=function(){null!=this.m_backFunc&&this.m_backFunc.call(this,[1]),DelayCallUtils.delayedCall(this.m_stayTime,this.boBack,this)},e.prototype.boBack=function(){null!=this.m_backFunc&&this.m_backFunc.call(this,[2]);.5*(StageManager.instance.p_stageWidth-10),.5*(StageManager.instance.p_stageHeight-10);TweenLite.to(this.m_bgmIcon,this.m_moveTime,{alpha:0,ease:Linear.easeNone,onComplete:this.hide.bind(this)})},e.prototype.hide=function(){Dispatch.remove(StageManager.EVENT_STAGE_RESIZE,this.stageResize,this),DisplayObjectUtils.removeFormParent(this.m_bgMenk),DisplayObjectUtils.removeFormParent(this.m_bgmIcon),null!=this.m_backFunc&&this.m_backFunc.call(this,[3]),this.m_backFunc=null},e.prototype.stageResize=function(){this.m_bgMenk.width=StageManager.instance.p_stageWidth,this.m_bgMenk.height=StageManager.instance.p_stageHeight,this.m_bgmIcon.width=StageManager.instance.p_stageWidth,this.m_bgmIcon.height=StageManager.instance.p_stageHeight},e}(egret.HashObject);__reflect(GameBgEffectBlack.prototype,"GameBgEffectBlack");var GameBgEffectEasing=function(t){function e(){var e=t.call(this)||this;return e.m_isOpenEyes=!0,e}return __extends(e,t),e.prototype.stareShow=function(t,e,i,s){if(void 0===t&&(t=null),void 0===e&&(e=.5),void 0===i&&(i=.2),void 0===s&&(s=!1),!this.m_bgmMenk||!this.m_bgmMenk.parent){if(this.m_backFunc=t,this.m_moveTime=e,this.m_stayTime=i,this.m_isOpenEyes=s,this.m_bgmMenk||(this.m_bgmMenk=new eui.Image("commonUI_box"),this.m_bgmMenk.alpha=0,this.m_bgmMenk.scale9Grid=UIModule.instance.getRectangle()),StageManager.instance.loadinglayer.addChild(this.m_bgmMenk),!this.m_iconList){this.m_iconList=[];for(var n=0;5>n;n++){var o;0==n?o=new eui.Image("resource/assets/icon/guide/guide_menk.png"):(o=new eui.Image("resource/assets/icon/guide/guide_zhe.png"),o.scale9Grid=UIModule.instance.getRectangle()),this.m_iconList.push(o)}}this.setDoView(),Dispatch.register(StageManager.EVENT_STAGE_RESIZE,this.stageResize,this,!0)}},e.prototype.setDoView=function(){this.iconBgm.width=2.5*StageManager.instance.p_stageWidth,this.iconBgm.height=2.5*StageManager.instance.p_stageHeight;for(var t=0;t<this.m_iconList.length;t++)StageManager.instance.loadinglayer.addChild(this.m_iconList[t]);TweenLite.to(this.iconBgm,this.m_moveTime,{ease:Linear.easeNone,onUpdate:this.onUpdateBack.bind(this),width:0,height:0,onComplete:this.stayGo.bind(this)})},e.prototype.stayGo=function(){null!=this.m_backFunc&&this.m_backFunc.call(this,[1]),DelayCallUtils.delayedCall(this.m_stayTime,this.boBack,this)},e.prototype.boBack=function(){if(null!=this.m_backFunc&&this.m_backFunc.call(this,[2]),this.m_isOpenEyes){var t=.5*StageManager.instance.p_stageWidth,e=.5*StageManager.instance.p_stageHeight;TweenLite.to(this.iconBgm,this.m_moveTime,{ease:Linear.easeNone,onUpdate:this.onUpdateBack.bind(this),width:t,height:e,onComplete:this.setOpenEyes1.bind(this)})}else this.setOpenEffect()},e.prototype.setOpenEyes1=function(){var t=.3*StageManager.instance.p_stageWidth,e=.3*StageManager.instance.p_stageHeight;TweenLite.to(this.iconBgm,this.m_moveTime,{delay:.12,ease:Linear.easeNone,onUpdate:this.onUpdateBack.bind(this),width:t,height:e,onComplete:this.setOpenEyes2.bind(this)})},e.prototype.setOpenEyes2=function(){var t=.6*StageManager.instance.p_stageWidth,e=.6*StageManager.instance.p_stageHeight;TweenLite.to(this.iconBgm,this.m_moveTime,{delay:.12,ease:Linear.easeNone,onUpdate:this.onUpdateBack.bind(this),width:t,height:e,onComplete:this.setOpenEyes3.bind(this)})},e.prototype.setOpenEyes3=function(){var t=.8*StageManager.instance.p_stageWidth,e=.8*StageManager.instance.p_stageHeight;TweenLite.to(this.iconBgm,this.m_moveTime,{delay:.2,ease:Linear.easeNone,onUpdate:this.onUpdateBack.bind(this),width:t,height:e,onComplete:this.setOpenEffect.bind(this)})},e.prototype.setOpenEffect=function(){var t=2.5*StageManager.instance.p_stageWidth,e=2.5*StageManager.instance.p_stageHeight;TweenLite.to(this.iconBgm,this.m_moveTime,{ease:Linear.easeNone,onUpdate:this.onUpdateBack.bind(this),width:t,height:e,onComplete:this.hide.bind(this)})},e.prototype.hide=function(){Dispatch.remove(StageManager.EVENT_STAGE_RESIZE,this.stageResize,this),DisplayObjectUtils.removeFormParent(this.m_bgmMenk);for(var t=0;t<this.m_iconList.length;t++)DisplayObjectUtils.removeFormParent(this.m_iconList[t]);null!=this.m_backFunc&&this.m_backFunc.call(this,[3]),this.m_backFunc=null},e.prototype.onUpdateBack=function(){this.iconBgm.width=Math.floor(this.iconBgm.width),this.iconBgm.height=Math.floor(this.iconBgm.height),this.iconBgm.x=Math.floor(.5*(StageManager.instance.p_stageWidth-this.iconBgm.width)),this.iconBgm.y=Math.floor(.5*(StageManager.instance.p_stageHeight-this.iconBgm.height)),this.iconBgm.y<=0?this.m_iconList[1].visible=!1:this.setIconData(1,0,0,StageManager.instance.p_stageWidth,this.iconBgm.y+4),this.iconBgm.x<=0?this.m_iconList[2].visible=!1:this.setIconData(2,0,this.iconBgm.y,this.iconBgm.x+3,this.iconBgm.height),this.iconBgm.width>=StageManager.instance.p_stageWidth+5?this.m_iconList[3].visible=!1:this.setIconData(3,this.iconBgm.x+this.iconBgm.width-5,this.iconBgm.y,this.iconBgm.x+10,this.iconBgm.height),this.iconBgm.height>=StageManager.instance.p_stageHeight+3?this.m_iconList[4].visible=!1:this.setIconData(4,0,this.iconBgm.y+this.iconBgm.height-3,StageManager.instance.p_stageWidth,this.iconBgm.y+3)},e.prototype.stageResize=function(){this.m_bgmMenk.width=StageManager.instance.p_stageWidth,this.m_bgmMenk.height=StageManager.instance.p_stageHeight},Object.defineProperty(e.prototype,"iconBgm",{get:function(){return this.m_iconList[0]},enumerable:!0,configurable:!0}),e.prototype.setIconData=function(t,e,i,s,n){this.m_iconList[t].visible=!0,this.m_iconList[t].x=e,this.m_iconList[t].y=i,this.m_iconList[t].width=s,this.m_iconList[t].height=n},e}(egret.HashObject);__reflect(GameBgEffectEasing.prototype,"GameBgEffectEasing");var SceneSelectUI=function(t){function e(){var e=t.call(this)||this;return e.m_layout=new eui.TileLayout,e.m_typeList=new eui.ArrayCollection,e.m_disposeUrlList.push("sceneSelectUI_json"),e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/sceneSelectUI/SceneSelectUISkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.m_showGuideKeyList.push(GuideConfig.guide_render_click),this.u_scrollerItem.width=StageManager.instance.p_stageWidth,this.u_scrollerItem.x=.5*-(StageManager.instance.p_stageWidth-StageManager.MIN_STAGE_WIDTH),this.u_scrollerItem.horizontalScrollBar=null,this.u_scrollerItem.verticalScrollBar=null,this.m_layout.requestedRowCount=1,this.u_listItem.itemRenderer=SceneSelectRender,this.u_listItem.layout=this.m_layout,this.u_listItem.dataProvider=this.m_typeList,this.m_typeList.source=SceneJson.getDataList()},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&t.prototype.showView.call(this,e)},e.prototype.sureHide=function(i,s){void 0===i&&(i=null),void 0===s&&(s=null),t.prototype.sureHide.call(this,i,s);for(var n in e.p_urlList)RES.destroyRes(e.p_urlList[n]);e.p_urlList=[]},e.p_urlList=[],e}(UIBase);__reflect(SceneSelectUI.prototype,"SceneSelectUI");var SceneSelectRender=function(t){function e(){return t.call(this,"resource/eui_skins/sceneSelectUI/render/SceneSelectRenderSkin.exml")||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnClick,this.onClick,this,!0),this.registerEventClick(this.u_btnMore,this.onMorek,this,!0)},e.prototype.onClick=function(t){SceneManager.instance.p_sceneId!=this.m_json.id&&""==SceneModule.instance.isGotoScene(this.m_json.id,!0)&&SceneManager.instance.s_scene_enter_scene_tos(this.m_json.id)},e.prototype.onMorek=function(t){UIModule.instance.showUI(UIConfig.ID_MONSTER_INFO,{c_sceneId:this.m_json.id})},e.prototype.dataChanged=function(){if(this.checkComplete(this.dataChanged)){t.prototype.dataChanged.call(this),this.m_json=this.data,this.setImage(this.u_imgBj,PublicCon.PATH_SCENE_SELECT+this.m_json.id+"_bj.png"),this.setImage(this.u_imgMonster,PublicCon.PATH_SCENE_SELECT+this.m_json.id+"_img.png"),this.setImage(this.u_imgName,PublicCon.PATH_SCENE_SELECT+this.m_json.id+"_name.png"),this.setImage(this.u_imgShow,PublicCon.PATH_SCENE_SELECT+this.m_json.id+"_show.png");for(var e=0;3>e;e++)this["u_imgIcon"+(e+1)].source=ItemJson.getIconPath(this.m_json.drop_look_list[e][0])}},e.prototype.setImage=function(t,e){t.source=null,t.source=e,-1==SceneSelectUI.p_urlList.indexOf(e)&&SceneSelectUI.p_urlList.push(e)},e.prototype.onGuideCheck=function(t){t&&t.c_scene_id==this.m_json.id&&this.onClick(null)},Object.defineProperty(e.prototype,"tweenType",{get:function(){return 2},enumerable:!0,configurable:!0}),e}(ItemRendererBase);__reflect(SceneSelectRender.prototype,"SceneSelectRender");var SevenLoginPage=function(t){function e(){var e=t.call(this)||this;return e.m_slotArr=[],e.m_layout=new eui.TileLayout,e.m_typeList=new eui.ArrayCollection,e.m_rewardList=[],e.m_isSlot=!1,e}return __extends(e,t),e.prototype.isCloseUI=function(){return this.m_isSlot?(FloatTipModule.instance.popTip(LanguageJson.getText("l_sevenDays_slot")),!1):!0},Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/sevenDaysUI/SevenDaysUISkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_scrollerItem.horizontalScrollBar=null,this.u_scrollerItem.verticalScrollBar=null,this.m_layout.requestedRowCount=1,this.m_layout.orientation=eui.TileOrientation.COLUMNS,this.m_layout.horizontalGap=0,this.u_listItem.itemRenderer=SevenLoginRender,this.u_listItem.layout=this.m_layout,this.u_listItem.dataProvider=this.m_typeList,this.initSlotView()},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_startBtn,this.onReward,this,!0),Dispatch.register(SevenLoginManager.SEVENTLOGIN_UPDATE,this.setViewData,this,!0)},e.prototype.onReward=function(t){var i=SevenLoginManager.instance.getStateByDay(e.p_selectIndex);if(1==i)SevenLoginManager.instance.s_seven_login_give_award(e.p_selectIndex);else{var s=LanguageJson.getText("l_sevenDays_next");7==e.p_selectIndex&&2==i&&(s=LanguageJson.getText("l_sevenDays_allReceived")),FloatTipModule.instance.popTip(s)}},e.prototype.awardSuc=function(t,i,s){this.startRoll(),this.m_isSlot=!0,this.touchChildren=!1,Dispatch.dispatch(LuckyDrawManager.EVENT_SEIZING_STATUS,!0),this.m_json=SevenLoginLabaJson.getData(e.p_selectIndex,i),this.m_rewardList=s,DelayCallUtils.delayedCall(1.5,this.endRoll,this)},e.prototype.initSlotView=function(){for(var t=[],e=0;7>e;e++){var i="sevenDaysUI_json.sevenDaysUI_"+e;t.push({img:i,id:e})}for(var s=0;3>s;s++){var n=new SevenSlotView(t);n.width=80,n.height=120,n.x=4+100*s,n.y=0,this.u_slotGrp.addChild(n),this.m_slotArr.push(n)}for(var s=0;3>s;s++)this["u_awd"+s].resetData("num_sevenDays_"),this["u_awd"+s].p_spaceX=-12,this["u_awd"+s].numValue=0},e.prototype.startRoll=function(){var t=this;this.m_slotArr[0].start(),DelayCallUtils.delayedCall(.03,function(){t.m_slotArr[1].start()},this),DelayCallUtils.delayedCall(.06,function(){t.m_slotArr[2].start()
},this)},e.prototype.endRoll=function(){var t=this,e=this.m_json.dice_list;this.m_slotArr[0].stop(e[0]),DelayCallUtils.delayedCall(.5,function(){t.m_slotArr[1].stop(e[1])},this),DelayCallUtils.delayedCall(1,this.updateReward,this)},e.prototype.updateReward=function(){this.m_slotArr[2].stop(this.m_json.dice_list[2]);for(var t=0,e=0,i=0;i<this.m_rewardList.length;i++){var s=this.m_rewardList[i];1==s.type?t=s.value:3==s.type&&(e=s.value)}this.u_awd0.numValue=t,this.u_awd1.numValue=e,this.u_awd2.numValue=t+e,DelayCallUtils.delayedCall(1,this.showRewardPop,this)},e.prototype.showRewardPop=function(){var t=SevenLoginJson.getData(e.p_selectIndex);RewardModule.instance.receiveByList(t.award_list,6,2,this.toNextDay.bind(this)),SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_4004)},e.prototype.toNextDay=function(){var t=this,i=this.localToGlobal(this.u_awd2.x+this.u_awd2.width/2,this.u_awd2.y+this.u_awd2.height/2),s=new FlyNumber;s.showEffect(i,this.u_awd2.numValue),this.u_awd0.numValue=0,this.u_awd1.numValue=0,this.u_awd2.setNumValue(0,2.5),DelayCallUtils.delayedCall(2.5,function(){t.m_isSlot=!1,t.touchChildren=!0,Dispatch.dispatch(LuckyDrawManager.EVENT_SEIZING_STATUS,!1),e.p_selectIndex+=1,e.p_selectIndex>7&&(e.p_selectIndex=7),t.setSelect()},this)},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),Dispatch.register(SevenLoginManager.SEVENTLOGIN_SUCCESS,this.awardSuc,this))},e.prototype.setViewData=function(){var t=[];this.m_index=0;for(var i=1;7>=i;i++)t.push([0,i]),0!=SevenLoginManager.instance.getStateByDay(i)&&(this.m_index+=1);this.m_typeList.source=t;for(var s=-1,i=1;7>=i;i++)if(1==SevenLoginManager.instance.getStateByDay(i)){s=i;break}-1==s?(e.p_selectIndex=this.m_index+1,e.p_selectIndex>=7&&(e.p_selectIndex=7)):e.p_selectIndex=s,this.setSelect()},e.prototype.setSelect=function(){this.m_typeList.refresh();var t=SevenLoginManager.instance.getStateByDay(e.p_selectIndex);1!=t?ObjectUtils.setGrey(this.u_startBtn,!0,!0):ObjectUtils.setGrey(this.u_startBtn,!1,!0)},e.prototype.hide=function(e){void 0===e&&(e=null),t.prototype.hide.call(this,e),Dispatch.remove(SevenLoginManager.SEVENTLOGIN_SUCCESS,this.awardSuc,this),DelayCallUtils.killDelayedCallsTo(this.endRoll,this),DelayCallUtils.killDelayedCallsTo(this.showRewardPop,this),DelayCallUtils.killDelayedCallsTo(this.updateReward,this);for(var i=0;i<this.m_slotArr.length;i++)this.m_slotArr[i].removeTweens()},e.p_selectIndex=1,e}(PageBase);__reflect(SevenLoginPage.prototype,"SevenLoginPage");var SevenLoginRender=function(t){function e(){return t.call(this,"resource/eui_skins/sevenDaysUI/render/SevenDaysRenderSkin.exml")||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this),this.touchEnabled=!1,this.m_itemIcon||(this.m_itemIcon=new ItemIcon,this.m_itemIcon.horizontalCenter=0,this.m_itemIcon.bottom=-5,this.m_itemIcon.scaleX=.6,this.m_itemIcon.scaleY=.6,this.m_itemIcon.p_isShowQuality=!1,this.u_contentGrp.addChild(this.m_itemIcon))},e.prototype.dataChanged=function(){if(this.checkComplete(this.dataChanged)){t.prototype.dataChanged.call(this),this.m_day=this.data[1],this.u_txtDay.textFlow=LanguageJson.getHtmlTextFlow("l_seven_day",[this.m_day]);var e=SevenLoginJson.getData(this.m_day);this.m_itemIcon.setData(e.award_list[0][0],0),this.u_awardLb.text=String(e.award_list[0][1]),this.stateChanged()}},e.prototype.stateChanged=function(){this.u_bgSelect.visible=!1;var t=SevenLoginManager.instance.getStateByDay(this.m_day);switch(this.u_txtDay.textColor=15787184,this.u_awardLb.textColor=15787184,t){case 0:this.m_day==SevenLoginPage.p_selectIndex?(this.u_bgSelect.visible=!0,this.setFloat(!0)):this.setFloat(!1),this.setGrey(!1);break;case 1:this.setFloat(!0),this.setGrey(!1),this.m_day==SevenLoginPage.p_selectIndex&&(this.u_bgSelect.visible=!0);break;case 2:this.u_txtDay.textColor=16777215,this.u_awardLb.textColor=16777215,this.setFloat(!1),this.setGrey(!0)}},e.prototype.setFloat=function(t){this.u_imgBg.visible=t?!1:!0,this.u_bgSelect.visible=t?!0:!1,this.u_contentGrp.y=t?15:22},e.prototype.setGrey=function(t){ObjectUtils.setGrey(this.u_imgBg,t,!0),this.u_imgReceived.visible=t},e}(ItemRendererBase);__reflect(SevenLoginRender.prototype,"SevenLoginRender");var SevenSlotRender=function(t){function e(){return t.call(this,"resource/eui_skins/sevenDaysUI/render/SevenSlotRenderSkin.exml")||this}return __extends(e,t),e.prototype.dataChanged=function(){this.checkComplete(this.dataChanged)&&(t.prototype.dataChanged.call(this),this.u_img.source=this.data.img)},e}(ItemRendererBase);__reflect(SevenSlotRender.prototype,"SevenSlotRender");var FlyNumber=function(){function t(){this.m_randomList=[],this.m_curr=0,this.m_targetP=[]}return t.prototype.setNumList=function(t,e){this.m_randomList=[];for(var i=0,s=Math.floor(e/t),n=0;t>n;n++)if(n!=t-1){var o=5-Math.floor(10*Math.random());s>Math.abs(o)?(i+=s+o,this.m_randomList.push(s+o)):(i+=s,this.m_randomList.push(s))}else e-i>0&&this.m_randomList.push(e-i)},t.prototype.onStartPlay=function(t,e,i){SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_4002),0!=e&&(this.m_curr+=i)},t.prototype.onNextPlay=function(t){TweenLite.to(t,.6,{x:this.m_targetP[0],y:this.m_targetP[1],onComplete:this.onOutPlay.bind(this),onCompleteParams:[t]})},t.prototype.onOutPlay=function(t){t.hide(),t=null},t.prototype.showEffect=function(t,e){this.m_targetP=UIModule.instance.pointGold;var i=8+Math.floor(4*Math.random());this.setNumList(i,e);for(var s=0;s<this.m_randomList.length;s++){var n=new NumberView("num_sevenDays_");n.p_isAnchorOffsetX=!0,n.setMsgString(String(this.m_randomList[s])),UIModule.instance.upUILayer.addChild(n),n.alpha=0,n.y=t.y,n.x=t.x,n.scaleX=n.scaleY=.8,TweenLite.to(n,.5,{delay:.2+.19*s,scaleX:.5,scaleY:.5,y:t.y-150,alpha:1,ease:Circ.easeIn,onStart:this.onStartPlay.bind(this),onStartParams:[n,s,this.m_randomList[s]],onComplete:this.onNextPlay.bind(this),onCompleteParams:[n]})}SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_3003)},t}();__reflect(FlyNumber.prototype,"FlyNumber");var SevenSlotView=function(t){function e(e,i){void 0===e&&(e=[]),void 0===i&&(i=64);var s=t.call(this)||this;return s.m_scroller=new eui.Scroller,s.m_listItem=new eui.List,s.m_mask=new eui.Rect,s.m_dataList=new eui.ArrayCollection,s.m_imgArr=[],s.m_itemHeight=64,s.m_itemGap=0,s.stopId=-1,s.m_imgArr=e.concat([]),s.m_itemHeight=i,s.initData(),s}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.m_mask.width=this.width,this.m_mask.height=this.height,this.m_mask.x=0,this.m_mask.y=0,this.addChild(this.m_mask),this.m_scroller.width=this.width,this.m_scroller.height=this.m_itemHeight*(this.m_imgArr.length-1),this.m_scroller.x=0;var e=this.m_itemHeight<64?this.m_itemHeight:this.m_itemHeight/2;this.m_scroller.y=this.height+e-this.m_scroller.height,this.addChild(this.m_scroller),this.m_scroller.addChild(this.m_listItem),this.m_scroller.mask=this.m_mask,this.m_scroller.viewport=this.m_listItem,this.m_scroller.scrollPolicyH=eui.ScrollPolicy.OFF,this.m_scroller.scrollPolicyV=eui.ScrollPolicy.ON,this.m_scroller.touchEnabled=!1,this.m_scroller.touchChildren=!1;var i=new eui.VerticalLayout;i.gap=this.m_itemGap,this.m_listItem.layout=i,this.m_dataList.source=this.m_imgArr,this.m_listItem.dataProvider=this.m_dataList,this.m_listItem.itemRenderer=this.m_itemHeight<64?MonsterRollRender:SevenSlotRender},e.prototype.initData=function(){var t=this.m_imgArr[this.m_imgArr.length-1];this.m_imgArr.splice(0,0,t)},e.prototype.start=function(){this.scroll_anim()},e.prototype.stop=function(t){this.stopId=t},e.prototype.scroll_anim=function(){var t=this;egret.Tween.removeTweens(this.m_scroller.viewport),egret.Tween.get(this.m_scroller.viewport).to({scrollV:-this.m_itemHeight},40).call(function(){if(t.stopId>=0&&t.m_imgArr[t.m_imgArr.length-4].id==t.stopId)return void(t.stopId=-1);t.m_imgArr.splice(t.m_imgArr.length-1,1);var e=t.m_imgArr[t.m_imgArr.length-1];t.m_imgArr.splice(0,0,e),t.m_dataList.replaceAll(t.m_imgArr),t.m_listItem.dataProvider=t.m_dataList,t.m_scroller.viewport.scrollV=t.m_scroller.viewport.contentHeight-t.m_scroller.viewport.height,t.scroll_anim()})},e.prototype.removeTweens=function(){egret.Tween.removeTweens(this.m_scroller.viewport)},e}(eui.Component);__reflect(SevenSlotView.prototype,"SevenSlotView");var ShareUI=function(t){function e(){var e=t.call(this)||this;return e.m_disposeUrlList.push("shareUI_json"),e.m_currList.push({funcKey:FunctionEnum.PROMOTE_SYS,pageMc:new PromotePage}),e.m_currList.push({funcKey:FunctionEnum.SHARE_SYS,pageMc:new SharePage}),e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/shareUI/ShareUISkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.addChild(this.u_imgCaise),this.m_pageSelect.p_width=164,this.m_pageSelect.p_height=63;var e=[{key:FunctionEnum.PROMOTE_SYS,btnName:"shareUI_btn_640_",posXY:[384,557]},{key:FunctionEnum.SHARE_SYS,btnName:"shareUI_btn_630_",posXY:[588,557]}];this.m_pageSelect.setDataList(e);var i=[{key:FunctionEnum.PROMOTE_SYS,redList:[RedNoticeConfig.RED_PROMOTE],redPosXY:[151,-5]},{key:FunctionEnum.SHARE_SYS,redList:[RedNoticeConfig.RED_SHARE],redPosXY:[151,-5]}];this.m_pageSelect.setRedList(i)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnShare,this.onShare,this,!0)},e.prototype.onShare=function(t){GameManager.instance.callToNative("toAppShare",PlatformFunctionManager.instance.p_shareCode)},e}(UIBase);__reflect(ShareUI.prototype,"ShareUI");var SharePage=function(t){function e(){var e=t.call(this)||this;return e.m_layout=new eui.TileLayout,e.m_typeList=new eui.ArrayCollection,e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/shareUI/page/SharePageSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_scrollerItem.horizontalScrollBar=null,this.u_scrollerItem.verticalScrollBar=this.u_vScrollBar,this.u_vScrollBar.visible=!1,this.u_vScrollBar.autoVisibility=!0,this.m_layout.requestedColumnCount=1,this.u_listItem.itemRenderer=ShareRender,this.u_listItem.layout=this.m_layout,this.u_listItem.dataProvider=this.m_typeList,this.m_dataList=ShareTaskJson.getDataByShareType(ShareTaskTypeEnum.SHARE_TASK),ArrayUtils.setSortArr(this.m_dataList,["order","id"],[0,0])},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.u_scrollerItem.addEventListener(eui.UIEvent.CHANGE_END,this.onComplete,this),this.u_scrollerItem.addEventListener(eui.UIEvent.CHANGE,this.onScroll,this)},e.prototype.showView=function(e){if(void 0===e&&(e=null),this.checkComplete(this.showView,e)){t.prototype.showView.call(this,e);var i=ShareTaskTypeJson.getData(ShareTaskTypeEnum.SHARE_TASK);Dispatch.register(PlatformFunctionManager.EVENT_SHARE_TASK_INFO,this.showList,this),PlatformFunctionManager.instance.s_platform_function_get_share_task_info(i.show_type),this.u_scrollerItem.viewport.scrollV=0,this.setBtnHide()}},e.prototype.showList=function(){this.m_typeList.source=this.m_dataList},e.prototype.hide=function(e){void 0===e&&(e=null),Dispatch.remove(PlatformFunctionManager.EVENT_SHARE_TASK_INFO,this.showList,this),this.u_scrollerItem&&this.u_scrollerItem.stopAnimation(),t.prototype.hide.call(this,e)},e.prototype.onComplete=function(t){this.setBtnHide()},e.prototype.onScroll=function(t){this.u_btnTop.visible=this.u_scrollerItem.viewport.scrollV<=0?!1:!0,this.u_btnBottom.visible=!0;var e=this.u_scrollerItem.viewport.scrollV;e+this.u_scrollerItem.height>=this.u_scrollerItem.viewport.contentHeight&&(e=this.u_scrollerItem.viewport.contentHeight-this.u_scrollerItem.height,this.u_btnBottom.visible=!1);var i=Math.abs(e)/(this.u_scrollerItem.viewport.measuredHeight-this.u_scrollerItem.height);this.u_vScrollBar.thumb.y=i*(this.u_vScrollBar.height-this.u_vScrollBar.thumb.height)},e.prototype.setBtnHide=function(){this.u_btnTop.visible=!1,this.u_btnBottom.visible=!1},e}(PageBase);__reflect(SharePage.prototype,"SharePage");var ShareRender=function(t){function e(){return t.call(this,"resource/eui_skins/shareUI/render/ShareRenderSkin.exml")||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this),this.m_rewardGrop||(this.m_rewardGrop=new RewardGroupUI,this.m_rewardGrop.x=20,this.m_rewardGrop.y=15,this.m_rewardGrop.visualWidth=450,this.m_rewardGrop.spaceX=15,this.addChild(this.m_rewardGrop)),this.u_txtReceive.text=LanguageJson.getText("l_btn_receive")},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnReceive,this.onReceive,this,!0)},e.prototype.onReceive=function(t){void 0===t&&(t=null),this.m_shareData&&1==this.m_shareData.state?PlatformFunctionManager.instance.s_platform_function_get_share_task_award(this.m_data.task_type_id,this.m_data.id):GameManager.instance.callToNative("toAppShare",PlatformFunctionManager.instance.p_shareCode)},e.prototype.dataChanged=function(){this.checkComplete(this.dataChanged)&&(t.prototype.dataChanged.call(this),this.m_data&&this.m_data.id&&Dispatch.remove(PlatformFunctionManager.EVENT_SHARE_TASK_UPDATA+this.m_data.id,this.showData,this),this.m_data=this.data,this.u_txtDesc.textFlow=LanguageJson.getHtmlTextFlow("l_share_func_desc",[this.m_data.need_num]),this.m_rewardGrop.setDataByList(this.m_data.item_list,5),Dispatch.register(PlatformFunctionManager.EVENT_SHARE_TASK_UPDATA+this.m_data.id,this.showData,this,!0))},e.prototype.showData=function(){this.m_shareData=PlatformFunctionManager.instance.getShareTaskData(this.m_data.id),this.m_shareData?0==this.m_shareData.state?(this.u_btnReceive.visible=!0,this.u_receiveRed.visible=!1,this.u_imgReceived.visible=!1,this.u_btnIcon.source="shareUI_json.shareUI_btn_wdc"):1==this.m_shareData.state?(this.u_btnReceive.visible=!0,this.u_receiveRed.visible=!0,this.u_imgReceived.visible=!1,this.u_btnIcon.source="shareUI_json.shareUI_btn_klq"):(this.u_btnReceive.visible=!1,this.u_imgReceived.visible=!0,this.u_btnIcon.source="shareUI_json.shareUI_btn_klq"):(this.u_btnReceive.visible=!0,this.u_receiveRed.visible=!1,this.u_imgReceived.visible=!1,this.u_btnIcon.source="shareUI_json.shareUI_btn_wdc")},e}(ItemRendererBase);__reflect(ShareRender.prototype,"ShareRender");var ShopHallEnum=function(){function t(){}return t.TYPE_DIAMOND=1,t.TYPE_BUYPROP=2,t.TYPE_COIN=3,t.TYPE_VIP=4,t}();__reflect(ShopHallEnum.prototype,"ShopHallEnum");var ShopHallUI=function(t){function e(){var e=t.call(this)||this;return e.m_functionIDList=[ShopHallEnum.TYPE_DIAMOND,ShopHallEnum.TYPE_BUYPROP,ShopHallEnum.TYPE_COIN,ShopHallEnum.TYPE_VIP],e.m_disposeUrlList.push("shopHallUI_json"),e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/shopHallUI/ShopHallUISkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.m_scrollX=this.u_rechargeScroll.x,this.u_rechargeScroll.horizontalScrollBar=null,this.u_rechargeScroll.verticalScrollBar=null,this.onAdaptation(),this.m_diamondView||(this.m_diamondView=new DiamondView),this.m_buyPropView||(this.m_buyPropView=new BuyPropView(ShopTypeEnum.CHARGE_DIAMOND_SHOP)),this.m_buyCoinView||(this.m_buyCoinView=new BuyPropView(ShopTypeEnum.ITEM_SHOP)),this.m_vipView||(this.m_vipView=new VipView)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.u_rechargeScroll.addEventListener(eui.UIEvent.CHANGE,this.onScollChange,this);for(var e=0;e<this.m_functionIDList.length;e++)this.registerEventClick(this["u_btn"+(e+1)],this.onTagClick,this)},e.prototype.showView=function(i){void 0===i&&(i=null),this.checkComplete(this.showView,i)&&(t.prototype.showView.call(this,i),this.u_imgBg.source=null,this.u_imgBg.source="shopHallUI_json.shopHallUI_img_bg",this.u_rechargeScroll.viewport.scrollH=0,this.u_grpShopHall.addChild(this.m_diamondView),this.m_diamondView.show(),this.u_grpShopHall.addChild(this.m_buyPropView),this.m_buyPropView.show(),this.u_grpShopHall.addChild(this.m_buyCoinView),this.m_buyCoinView.show(),this.u_grpShopHall.addChild(this.m_vipView),this.m_vipView.show(),this.setShowList(),i&&i.c_type&&(this.m_type=i.c_type),this.m_type&&this.onTagClick(null),Dispatch.register(e.EVENT_GOTO_VIPLEVEL,this.onGotoBuy,this),Dispatch.register(StageManager.EVENT_STAGE_RESIZE,this.onAdaptation,this))},e.prototype.setShowList=function(){this.m_diamondView.x=0,this.m_diamondView.skin.width=this.m_diamondView.listWidth+20,this.m_diamondView.u_imgBg.width=this.m_diamondView.skin.width,this.m_diamondView.u_grpDiaTil.width=this.m_diamondView.skin.width,this.m_buyPropView.x=this.m_diamondView.x+this.m_diamondView.skin.width+20,this.m_buyPropView.skin.width=this.m_buyPropView.listWidth+20,this.m_buyPropView.u_imgBg.width=this.m_buyPropView.skin.width,this.m_buyPropView.u_grpCoinShop.width=this.m_buyPropView.skin.width,this.m_buyCoinView.x=this.m_buyPropView.x+this.m_buyPropView.skin.width+20,this.m_buyCoinView.skin.width=this.m_buyCoinView.listWidth+20,this.m_buyCoinView.u_imgBg.width=this.m_buyCoinView.skin.width,this.m_buyCoinView.u_grpCoinShop.width=this.m_buyCoinView.skin.width,this.m_vipView.x=this.m_buyCoinView.x+this.m_buyCoinView.skin.width+20,this.m_diamondView.y=this.m_buyPropView.y=this.m_vipView.y=this.m_buyCoinView.y=0},e.prototype.onScollChange=function(t){var e=this.u_rechargeScroll.viewport.scrollH;e>=0&&e<this.m_buyPropView.x&&this.onTagChange(ShopHallEnum.TYPE_DIAMOND),e>=this.m_buyPropView.x&&e<this.m_buyCoinView.x&&this.onTagChange(ShopHallEnum.TYPE_BUYPROP),e>=this.m_buyCoinView.x&&e<this.m_vipView.x&&this.onTagChange(ShopHallEnum.TYPE_COIN),e>=this.u_rechargeScroll.viewport.contentWidth-this.u_rechargeScroll.viewport.width&&this.onTagChange(ShopHallEnum.TYPE_VIP)},e.prototype.onTagChange=function(t){for(var e=1;4>=e;e++)t==e?this["u_imgType"+e].visible=!0:this["u_imgType"+e].visible=!1},e.prototype.onTagClick=function(t){void 0===t&&(t=null),this.u_rechargeScroll.stopAnimation();var e=0;if(t){var i=t.currentTarget.name;e=Number(i.slice(4))}else e=this.m_type;switch(e){case 1:this.onTagChange(ShopHallEnum.TYPE_DIAMOND),this.u_rechargeScroll.viewport.scrollH=0;break;case 2:this.onTagChange(ShopHallEnum.TYPE_BUYPROP),this.u_rechargeScroll.viewport.scrollH=this.m_buyPropView.x;break;case 3:this.onTagChange(ShopHallEnum.TYPE_COIN),this.u_rechargeScroll.viewport.scrollH=this.m_buyCoinView.x;break;case 4:this.onTagChange(ShopHallEnum.TYPE_VIP),this.u_rechargeScroll.viewport.scrollH=this.m_vipView.x+this.m_vipView.width-this.u_rechargeScroll.width}},e.prototype.onGotoBuy=function(){this.onTagChange(ShopHallEnum.TYPE_DIAMOND),this.u_rechargeScroll.viewport.scrollH=0},e.prototype.onAdaptation=function(){if(this.m_curWidth!=StageManager.instance.p_stageWidth){this.m_curWidth=StageManager.instance.p_stageWidth,this.x=0,this.y=.5*(StageManager.instance.p_stageHeight-this.height);var t=.5*(StageManager.MIN_STAGE_WIDTH-StageManager.instance.p_stageWidth);this.u_imgBg.x+=t,this.u_rechargeScroll.x+=t,this.u_rechargeScroll.width+=StageManager.instance.p_stageWidth-StageManager.MIN_STAGE_WIDTH,this.u_btnArray.x+=t,this.u_btnArray.width=StageManager.instance.p_stageWidth;for(var e=0;e<this.m_functionIDList.length;e++){var i=this["u_btn"+(e+1)];i.x=e*(StageManager.instance.p_stageWidth/this.m_functionIDList.length),i.width=StageManager.instance.p_stageWidth/this.m_functionIDList.length,this.removeEventClick(this["u_btn"+(e+1)]),this.registerEventClick(this["u_btn"+(e+1)],this.onTagClick,this)}}},e.prototype.hide=function(i,s){this.m_diamondView.hide(),this.m_buyCoinView.hide(),this.m_buyPropView.hide(),this.m_vipView.hide(),this.u_rechargeScroll.stopAnimation(),Dispatch.remove(e.EVENT_GOTO_VIPLEVEL,this.onGotoBuy,this),Dispatch.remove(StageManager.EVENT_STAGE_RESIZE,this.onAdaptation,this),t.prototype.hide.call(this,i,s)},e.prototype.sureHide=function(i,s){void 0===i&&(i=null),void 0===s&&(s=null),t.prototype.sureHide.call(this,i,s);for(var n in e.p_urlList)RES.destroyRes(e.p_urlList[n]);e.p_urlList=[]},Object.defineProperty(e.prototype,"width",{get:function(){return StageManager.MIN_STAGE_WIDTH},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return StageManager.MIN_STAGE_HEIGHT},enumerable:!0,configurable:!0}),e.EVENT_GOTO_VIPLEVEL="EVENT_GOTO_VIPLEVEL",e.p_urlList=[],e}(UIBase);__reflect(ShopHallUI.prototype,"ShopHallUI");var BuyPropRender=function(t){function e(){return t.call(this,"resource/eui_skins/shopHallUI/render/BuyPropRenderSkin.exml")||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnBuyProp,this.onBuy,this)},e.prototype.onBuy=function(t){if(!SysCommonJson.getData(this.m_shopData.item_list[0][1])||-1==SysCommonManager.instance.getState(this.m_shopData.item_list[0][1])){if(this.m_shopData.buy_limit_list&&this.m_shopData.buy_limit_list.length>0&&"vip_level"==this.m_shopData.buy_limit_list[0]&&PlayerManager.instance.p_playerInfo.vip_level<Number(this.m_shopData.buy_limit_list[1]))return void PopupModule.instance.showTishi(LanguageJson.getText("l_shop_vip_tips_1"),this.sureBuy.bind(this));var e=ShopManager.instance.getShopLimit(this.m_shopData.id);return 0!=this.m_shopData.limit_type&&e>=this.m_shopData.limit?void FloatTipModule.instance.popTipLanguage("l_shop_sell_out_tips",[this.m_itemData.name]):void(this.m_shopData.type==ShopTypeEnum.ITEM_SHOP?PopupModule.instance.showPop(PopupConfig.ID_SHOP_BUY,this.m_shopData):this.m_shopData.type==ShopTypeEnum.CHARGE_DIAMOND_SHOP&&PopupModule.instance.showPop(PopupConfig.ID_SHOP_BUY,this.m_shopData))}},e.prototype.sureBuy=function(){Dispatch.dispatch(ShopHallUI.EVENT_GOTO_VIPLEVEL)},e.prototype.dataChanged=function(){this.checkComplete(this.dataChanged)&&(t.prototype.dataChanged.call(this),this.m_shopData=this.data,this.m_itemData=ItemJson.getData(this.m_shopData.item_list[0][0]),this.u_imgQuality.source="shopHallUI_json.shopHallUI_img_"+this.m_itemData.quality,this.u_imgIcon.source=BagManager.instance.getIconPath(this.m_itemData.id),this.u_txtPropName.text=this.m_itemData.name,this.u_txtPropNum.text="x"+NumberUtil.numberToString(this.m_shopData.item_list[0][1]),this.u_imgBuyIcon.source=BagManager.instance.getIconPath(this.m_shopData.buy_item_list[0][0]),this.u_txtAmount.text=NumberUtil.numberToString(this.m_shopData.buy_item_list[0][1]))},e}(ItemRendererBase);__reflect(BuyPropRender.prototype,"BuyPropRender");var CoinRender=function(t){function e(){return t.call(this,"resource/eui_skins/shopHallUI/render/CoinRenderSkin.exml")||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnBuyCoin,this.onBuy,this)},e.prototype.onBuy=function(t){-1==this.m_coinData.ID?PlayerManager.instance.gotoKefu():ChargeManager.instance.requestRecharge(this.m_coinData.ID,1)},e.prototype.dataChanged=function(){if(this.checkComplete(this.dataChanged))if(t.prototype.dataChanged.call(this),this.m_coinData=this.data,-1==this.m_coinData.ID)this.u_btnBuyCoin.visible=!1,this.u_imgIcon.visible=!1;else{this.u_btnBuyCoin.visible=!0,this.u_imgIcon.visible=!0;var e="resource/assets/icon/recharge/"+this.m_coinData.icon_id+".png";this.u_imgIcon.source=null,this.u_imgIcon.source=e,-1==ShopHallUI.p_urlList.indexOf(e)&&ShopHallUI.p_urlList.push(e),this.u_txtBuyNum.text=HtmlUtil.setText(String(this.m_coinData.diamond)),this.u_txtExp.textFlow=HtmlUtil.setTextFlow(LanguageJson.getText("l_vip_exp")+"+"+NumberUtil.numberToString(this.m_coinData.vip_exp,1)),this.u_txtCash.textFlow=TextUtil.setTextFlow("$"+this.m_coinData.cash)}},e}(ItemRendererBase);__reflect(CoinRender.prototype,"CoinRender");var DiamondRender=function(t){function e(){return t.call(this,"resource/eui_skins/shopHallUI/render/DianmondRenderSkin.exml")||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnBuy,this.onBuy,this)},e.prototype.onBuy=function(t){-1==this.m_diaData.ID?PlayerManager.instance.gotoKefu():ChargeManager.instance.requestRecharge(this.m_diaData.ID,1)},e.prototype.dataChanged=function(){if(this.checkComplete(this.dataChanged))if(t.prototype.dataChanged.call(this),this.m_diaData=this.data,-1==this.m_diaData.ID)this.visible=!1;else{this.visible=!0;var e="resource/assets/icon/recharge/"+this.m_diaData.icon_id+".png";this.u_imgIcon.source=null,this.u_imgIcon.source=e,-1==ShopHallUI.p_urlList.indexOf(e)&&ShopHallUI.p_urlList.push(e),this.u_txtBuyNum.text=HtmlUtil.setText(NumberUtil.numberToString(this.m_diaData.diamond)),this.u_txtExp.textFlow=HtmlUtil.setTextFlow(LanguageJson.getText("l_vip_exp")+"+"+NumberUtil.numberToString(this.m_diaData.vip_exp,1)),this.u_txtCash.textFlow=TextUtil.setTextFlow("$"+this.m_diaData.cash)}},e}(ItemRendererBase);__reflect(DiamondRender.prototype,"DiamondRender");var VipRender=function(t){function e(){return t.call(this,"resource/eui_skins/shopHallUI/render/VipRenderSkin.exml")||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this)},e.prototype.dataChanged=function(){if(this.checkComplete(this.dataChanged)){t.prototype.dataChanged.call(this),this.m_data=this.data,this.u_txtawardName.text=this.m_data[1];var e=PublicCon.PATH_VIPLEVEL_AWARD+this.m_data[0]+".png";this.u_imgIcon.source=null,this.u_imgIcon.source=e,-1==ShopHallUI.p_urlList.indexOf(e)&&ShopHallUI.p_urlList.push(e)}},e}(ItemRendererBase);__reflect(VipRender.prototype,"VipRender");var BuyPropView=function(t){function e(e){var i=t.call(this)||this;return i.m_layout=new eui.TileLayout,i.m_propList=new eui.ArrayCollection,i.m_shopType=e,i.once(egret.Event.COMPLETE,i.onCompleted,i),i.skinName="resource/eui_skins/shopHallUI/view/BuyPropViewSkin.exml",i}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.m_shopType&&this.m_shopType==ShopTypeEnum.ITEM_SHOP&&(this.u_imgIcon.source="shopHallUI_json.shopHallUI_icon_jbsd",this.u_txtCoinShop.text=LanguageJson.getText("l_shop_coin")),this.m_shopType&&this.m_shopType==ShopTypeEnum.CHARGE_DIAMOND_SHOP&&(this.u_imgIcon.source="shopHallUI_json.shopHallUI_icon_sd",this.u_txtCoinShop.text=LanguageJson.getText("l_shop_diamond")),this.m_layout.requestedRowCount=2,this.m_layout.horizontalGap=10,this.m_layout.verticalGap=10,this.u_propList.layout=this.m_layout,this.u_propList.itemRenderer=BuyPropRender,this.u_propList.dataProvider=this.m_propList},e.prototype.initEvent=function(){},e.prototype.show=function(){this.checkComplete(this.show)&&(this.recoverAllTexture(this,!0),this.m_propData=ShopJson.getListByType(this.m_shopType),this.m_propData.length>0&&(this.m_propList.source=this.m_propData),this.m_layout.requestedColumnCount=this.setListCol())},e.prototype.setListCol=function(){return this.m_propData.length%2!=0?Math.round(this.m_propData.length/2):this.m_propData.length/2},e.prototype.hide=function(){DisplayObjectUtils.removeFormParent(this)},Object.defineProperty(e.prototype,"listWidth",{get:function(){return this.u_propList.width},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(BuyPropView.prototype,"BuyPropView");var CoinView=function(t){function e(){var e=t.call(this)||this;return e.m_layout=new eui.TileLayout,e.m_coinList=new eui.ArrayCollection,e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/shopHallUI/view/CoinViewSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.u_txtCoin.text=LanguageJson.getText("l_vip_coin"),this.m_layout.requestedRowCount=2,this.m_layout.horizontalGap=10,this.m_layout.verticalGap=10,this.u_coinList.layout=this.m_layout,this.u_coinList.itemRenderer=CoinRender,this.u_coinList.dataProvider=this.m_coinList},e.prototype.initEvent=function(){},e.prototype.show=function(){for(var t=ChargeManager.instance.p_charge_list,e=[],i=0;i<t.length;i++){var s=RechargeJson.getData(t[i].id);s&&4==s.recharge_type&&e.push(s)}if(ArrayUtils.setSortArr(e,["idx_ord"],[0]),1==URIManager.is_native_pay&&0==URIManager.is_reviewing){var s=new RechargeJson;s.ID=-1,e.push(s)}this.m_coinList.source=e,ClientLogManager.instance.s_client_log_client_log(ClientLogEnum.CHARGE_BUTTON_TIMES)},e.prototype.hide=function(){DisplayObjectUtils.removeFormParent(this)},Object.defineProperty(e.prototype,"listWidth",{get:function(){return this.u_coinList.width},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(CoinView.prototype,"CoinView");var DiamondView=function(t){function e(){var e=t.call(this)||this;return e.m_layout=new eui.TileLayout,e.m_diaList=new eui.ArrayCollection,e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/shopHallUI/view/DiamondViewSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.u_txtDiamond.text=LanguageJson.getText("l_vip_diamond"),this.m_layout.requestedRowCount=2,this.m_layout.horizontalGap=10,this.m_layout.verticalGap=10,this.u_diamondList.layout=this.m_layout,this.u_diamondList.itemRenderer=DiamondRender,this.u_diamondList.dataProvider=this.m_diaList},e.prototype.initEvent=function(){},e.prototype.show=function(){if(this.checkComplete(this.show)){this.recoverAllTexture(this,!0);var t=ChargeManager.instance.p_charge_list;this.m_list=[];for(var e=0;e<t.length;e++){var i=RechargeJson.getData(t[e].id);i&&0==i.recharge_type&&this.m_list.push(i)}if(ArrayUtils.setSortArr(this.m_list,["idx_ord"],[0]),this.m_layout.requestedColumnCount=this.setListCol(),1==URIManager.is_native_pay&&0==URIManager.is_reviewing){var i=new RechargeJson;i.ID=-1,this.m_list.push(i)}this.m_diaList.source=this.m_list,ClientLogManager.instance.s_client_log_client_log(ClientLogEnum.CHARGE_BUTTON_TIMES)}},e.prototype.setListCol=function(){return this.m_list.length%2!=0?Math.round(this.m_list.length/2):this.m_list.length/2},e.prototype.hide=function(){DisplayObjectUtils.removeFormParent(this)},Object.defineProperty(e.prototype,"listWidth",{get:function(){return this.u_diamondList.width},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(DiamondView.prototype,"DiamondView");var VipView=function(t){function e(){var e=t.call(this)||this;return e.m_maxPro=380,e.m_vipArray=[],e.m_award=[],e.m_layout=new eui.TileLayout,e.m_awardList=new eui.ArrayCollection,e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/shopHallUI/view/VipViewSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.m_vipNumber||(this.m_vipNumber=new NumberView("shopHallUI_json.shopHallUI_",80,-8),this.m_vipNumber.x=0,this.m_vipNumber.y=0,this.m_vipNumber.scaleX=this.m_vipNumber.scaleX=.8),this.u_grpVip.addChild(this.m_vipNumber),this.m_maNa=Number(StaticDataJson.getData("recharge_ratio").data),this.u_awardScroll.touchEnabled=!1,this.u_awardScroll.horizontalScrollBar=null,this.u_awardScroll.verticalScrollBar=null,this.m_layout.requestedColumnCount=4,this.m_layout.horizontalGap=5,this.m_layout.verticalGap=5,this.u_awardList.layout=this.m_layout,this.u_awardList.itemRenderer=VipRender,this.u_awardList.dataProvider=this.m_awardList},e.prototype.initEvent=function(){this.registerEventClick(this.u_btnLeft,this.onLeft,this,!0),this.registerEventClick(this.u_btnRight,this.onRight,this,!0)},e.prototype.onLeft=function(t){if(1==this.m_selectVip)var e=VipLevelJson.getData(this.m_selectVip);
else var e=VipLevelJson.getData(this.m_selectVip-1);e&&(this.m_selectVip--,this.setInfo())},e.prototype.onRight=function(t){if(VipLevelJson.getHighestVip()!=this.m_selectVip+1){var e=VipLevelJson.getData(this.m_selectVip+1);if(e){if(1==e.is_show&&VipManager.instance.vip_data.vip_level<e.level)return;this.m_selectVip++,this.setInfo()}}},e.prototype.show=function(){this.checkComplete(this.show)&&(this.recoverAllTexture(this,!0),this.u_txtMsg.visible=!0,Dispatch.register(VipManager.EVENT_VIP_GET_AWARD,this.showInfo,this,!0))},e.prototype.showInfo=function(){this.showProgress(),this.m_selectVip=VipManager.instance.vip_data.vip_level,this.setInfo()},e.prototype.showProgress=function(){var t=VipManager.instance.vip_data.vip_level,e=VipManager.instance.vip_data.vip_exp,i=(VipLevelJson.getData(t),VipLevelJson.getData(t+1));this.m_vipNumber.numValue=t,i?(this.u_txtjinDu.text=HtmlUtil.setText(e+"/"+i.exp),this.u_imgjinDu.width=e/i.exp*this.m_maxPro):(this.u_txtjinDu.text=HtmlUtil.setText(e+"/"+LanguageJson.getText("l_bag_max")),this.u_imgjinDu.width=this.m_maxPro)},e.prototype.setInfo=function(){this.m_award=[],this.u_awardScroll.viewport.scrollV=0,this.m_selectVipPriv=this.m_selectVip+1;var t;if(this.m_selectVipPriv>VipLevelJson.getHighestVip()?(this.m_selectVip--,t=VipLevelJson.getData(VipLevelJson.getHighestVip())):t=VipLevelJson.getData(this.m_selectVipPriv),t&&t.level>0){if(t.icon_list.length>0&&t.desc)for(var e=t.desc.split("|"),i=0;i<t.icon_list.length;i++){var s=[];s[0]=Number(t.icon_list[i]),s[1]=e[i],this.m_award.push(s)}this.m_awardList.source=this.m_award,this.u_txtVipPriv.text=LanguageJson.getHtmlText("l_vip_privilege",[t.level]);var n=VipLevelJson.getData(VipManager.instance.vip_data.vip_level+1);if(n)if(this.m_selectVip<=VipManager.instance.vip_data.vip_level){var o=(n.exp-VipManager.instance.vip_data.vip_exp)/this.m_maNa;this.u_txtMsg.textFlow=LanguageJson.getHtmlTextFlow("l_vip_msg",[o,n.level])}else{var a=(t.exp-VipManager.instance.vip_data.vip_exp)/this.m_maNa;this.u_txtMsg.textFlow=LanguageJson.getHtmlTextFlow("l_vip_msg",[a,t.level])}else this.u_txtMsg.visible=!1}},e.prototype.setBtnState=function(){var t=VipLevelJson.getData(this.m_selectVip-1),e=VipLevelJson.getData(this.m_selectVip+1);t?this.u_btnLeft.visible=!0:this.u_btnLeft.visible=!1,e?(this.u_btnRight.visible=!0,1==e.is_show&&VipManager.instance.vip_data.vip_level<e.level&&(this.u_btnRight.visible=!1)):this.u_btnRight.visible=!1},e.prototype.hide=function(){DisplayObjectUtils.removeFormParent(this),Dispatch.remove(VipManager.EVENT_VIP_GET_AWARD,this.showInfo,this)},e}(ComponentBase);__reflect(VipView.prototype,"VipView");var ShopBuyPopup=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/shopUI/popup/ShopBuyPopupSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.m_shopBuyView||(this.m_shopBuyView=new ShopBuyView,this.addChild(this.m_shopBuyView),this.m_shopBuyView.x=.5*(this.width-this.m_shopBuyView.width)+15,this.m_shopBuyView.y=125),this.u_txtBlank.textFlow=LanguageJson.getHtmlTextFlow("l_closePop_tip")},e.prototype.initEvent=function(){t.prototype.initEvent.call(this)},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),this.m_shopBuyView.show(e))},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i)},e}(PopupBase);__reflect(ShopBuyPopup.prototype,"ShopBuyPopup");var ShopBuyView=function(t){function e(e){void 0===e&&(e=!0);var i=t.call(this)||this;return i.m_isShop=!0,i.p_isFromAccess=!1,i.m_isShop=e,i.once(egret.Event.COMPLETE,i.onCompleted,i),i.skinName="resource/eui_skins/shopUI/view/ShopBuyViewSkin.exml",i}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.m_itemIcon||(this.m_itemIcon=new ItemIcon,this.m_itemIcon.scaleX=.8,this.m_itemIcon.scaleY=.8,this.addChildAt(this.m_itemIcon,0),this.m_itemIcon.x=82,this.m_itemIcon.y=86),GameManager.instance.isShield?(this.u_btnRecharge.visible=!1,this.u_btnBuy.x=237):(this.u_btnRecharge.visible=!0,this.u_btnBuy.x=323),this.m_isShop||(this.u_mcName.y=50),this.u_textSelling.text=LanguageJson.getText("l_shop_selling_price"),this.u_txtTotal.text=LanguageJson.getText("l_shop_total_price"),this.setAdaptive(this.u_imgSell,this.u_textSelling,this.u_imgPrice,this.u_txtPrice),this.setAdaptive(this.u_imgTotal,this.u_txtTotal,this.u_imgPriceCount,this.u_txtPriceCount)},e.prototype.initEvent=function(){this.registerEventClick(this.u_btnBuy,this.onBuy,this,!0),this.registerEventClick(this.u_btnReduc,this.onChangeNum,this,!0),this.registerEventClick(this.u_btnReducTen,this.onChangeNum,this,!0),this.registerEventClick(this.u_btnAdd,this.onChangeNum,this,!0),this.registerEventClick(this.u_btnAddTen,this.onChangeNum,this,!0),this.registerEventClick(this.u_btnRecharge,this.onRecharge,this,!0),this.addEventListener(egret.TouchEvent.REMOVED_FROM_STAGE,this.onRemoveStage,this),this.addEventListener(egret.TouchEvent.ADDED_TO_STAGE,this.onAddStage,this)},e.prototype.onAddStage=function(t){Dispatch.register(ShopManager.SHOP_BUY_SUCCESS,this.buySuccess,this)},e.prototype.onRemoveStage=function(t){Dispatch.remove(ShopManager.SHOP_BUY_SUCCESS,this.buySuccess,this)},e.prototype.onRecharge=function(t){PopupModule.instance.hidePop(PopupConfig.ID_ITEM_ACCESS),PopupModule.instance.hidePop(PopupConfig.ID_SHOP_BUY),this.p_isFromAccess?UIModule.instance.showUI(UIConfig.ID_CHARGE,{c_type:ShopHallEnum.TYPE_DIAMOND}):Dispatch.dispatch(ShopHallUI.EVENT_GOTO_VIPLEVEL)},e.prototype.onBuy=function(t){if(!SysCommonJson.getData(this.m_json.item_list[0][1])||-1==SysCommonManager.instance.getState(this.m_json.item_list[0][1])){var e=ShopManager.instance.getShopLimit(this.m_json.id);return 0!=this.m_json.limit_type&&e>=this.m_json.limit?void FloatTipModule.instance.popTipLanguage("l_shop_sell_out_tips",[this.m_itemIcon.itemJson.name]):this.m_timesId>0&&TimesManager.instance.getTimesById(this.m_timesId)<=0?void FloatTipModule.instance.popTipLanguage("l_shop_add_times_byvip"):void ShopManager.instance.s_shop_shop_item(this.m_json.id,this.m_count)}},e.prototype.buySuccess=function(t,e){this.m_json&&this.m_json.id==t&&(ItemFloatModule.instance.floatItem(this.m_itemIcon),FloatTipModule.instance.popTipLanguage("l_shop_buy_success",[this.m_itemIcon.itemJson.name]),SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_1015),this.setSetState())},e.prototype.onChangeNum=function(t){switch(t.$currentTarget){case this.u_btnReducTen:this.m_count>10?this.m_count-=10:this.m_count>1&&(this.m_count=1);break;case this.u_btnReduc:this.m_count>1&&(this.m_count-=1);break;case this.u_btnAdd:this.m_count<this.m_countAll&&(this.m_count+=1);break;case this.u_btnAddTen:this.m_count<this.m_countAll-10?this.m_count+=10:this.m_count<this.m_countAll&&(this.m_count=this.m_countAll)}this.onSetButton(),this.setBuyCount()},e.prototype.onSetButton=function(){this.u_btnReduc_Gray.visible=!1,this.u_btnReducTen_Gray.visible=!1,this.u_btnAdd_Gray.visible=!1,this.u_btnAddTen_Gray.visible=!1,this.u_btnReduc.visible=!0,this.u_btnReducTen.visible=!0,this.u_btnAdd.visible=!0,this.u_btnAddTen.visible=!0,this.m_count<=1&&(this.u_btnReduc_Gray.visible=!0,this.u_btnReduc.visible=!1),this.m_count<=10&&(this.u_btnReducTen_Gray.visible=!0,this.u_btnReducTen.visible=!1),this.m_count>=this.m_countAll&&(this.u_btnAdd_Gray.visible=!0,this.u_btnAdd.visible=!1),this.m_count+10>this.m_countAll&&(this.u_btnAddTen_Gray.visible=!0,this.u_btnAddTen.visible=!1)},e.prototype.setBuyCount=function(){this.m_price=this.m_json.buy_item_list[0][1],this.u_txtCount.text=this.m_count.toString(),this.u_txtPrice.text=this.m_price.toString(),this.u_txtPriceCount.text=NumberUtil.numberDecimalism(this.m_count*this.m_price),this.m_isShop&&(this.m_itemIcon.countMsg=NumberUtil.numberToString(this.m_count*this.m_json.item_list[0][1]))},e.prototype.show=function(t,e){if(void 0===e&&(e=0),this.checkComplete(this.show,t,e)){this.m_json=t,this.m_count=1,this.m_timesId=e,this.m_isShop?this.m_itemIcon.setData(this.m_json.item_list[0][0]):this.m_itemIcon.setData(this.m_json.item_list[0][0],0);var i=BagManager.instance.getIconPath(this.m_json.buy_item_list[0][0]);this.u_imgPrice.source=i,this.u_imgPriceCount.source=i,this.setSetState(),this.m_timesId>0&&Dispatch.register(TimesManager.EVENT_TIEMS_UPDATE+this.m_timesId,this.setSetState,this)}},e.prototype.setSetState=function(){var t="";if(ObjectUtils.setGrey(this.u_btnBuy,!1),this.m_countAll=0==this.maxCount?1:this.maxCount,this.u_txtName.text=this.m_itemIcon.itemJson.name,SysCommonJson.getData(this.m_json.item_list[0][1])&&-1!=SysCommonManager.instance.getState(this.m_json.item_list[0][1]))ObjectUtils.setGrey(this.u_btnBuy),this.m_countAll=1,t=LanguageJson.getText("l_shop_sell_out"),this.u_txtName.textFlow=TextUtil.setTextFlow(this.m_itemIcon.itemJson.name+TextUtil.setText(t,2724096));else if(0!=this.m_json.limit_type){var e=ShopManager.instance.getShopLimit(this.m_json.id);if(e>=this.m_json.limit)ObjectUtils.setGrey(this.u_btnBuy),this.m_countAll=1,t=LanguageJson.getText("l_shop_sell_out"),this.u_txtName.textFlow=TextUtil.setTextFlow(this.m_itemIcon.itemJson.name+TextUtil.setText(t,2724096));else{var i=ShopManager.instance.getShopLimit(this.m_json.id);t=LanguageJson.getHtmlText("l_shop_sell_limit",[this.m_json.limit-i]),this.m_countAll=this.m_json.limit-i>this.m_countAll?this.m_countAll:this.m_json.limit-i,this.u_txtName.textFlow=TextUtil.setTextFlowColor(this.m_itemIcon.itemJson.name+TextUtil.setText(t,2724096),15787184)}}if(this.m_timesId>0){var s=TimesManager.instance.getTimesById(this.m_timesId);0>=s?(ObjectUtils.setGrey(this.u_btnBuy),this.m_countAll=1,t=LanguageJson.getText("l_shop_vip_buy_times"),this.u_txtName.textFlow=TextUtil.setTextFlow(this.m_itemIcon.itemJson.name+TextUtil.setText(t,2724096))):this.m_countAll=s}0==this.maxCount&&ObjectUtils.setGrey(this.u_btnBuy),this.m_count>this.m_countAll&&(this.m_count=this.m_countAll),this.onSetButton(),this.setBuyCount()},e.prototype.setAdaptive=function(t,e,i,s){t.width=t.width-e.textWidth+32,t.x=e.textWidth+e.x+8,i.x=e.textWidth+e.x+8,s.x=i.width+i.x},Object.defineProperty(e.prototype,"maxCount",{get:function(){var t=BagManager.instance.getNum(this.m_json.buy_item_list[0][0]),e=this.m_json.buy_item_list[0][1];return Math.floor(t/e)},enumerable:!0,configurable:!0}),e.prototype.hide=function(){this.checkComplete(this.hide)&&(Dispatch.remove(TimesManager.EVENT_TIEMS_UPDATE+this.m_timesId,this.setSetState,this),DisplayObjectUtils.removeFormParent(this))},Object.defineProperty(e.prototype,"width",{get:function(){return 600},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 275},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(ShopBuyView.prototype,"ShopBuyView");var SignInPage=function(t){function e(){var e=t.call(this)||this;return e.m_layout=new eui.TileLayout,e.m_typeList=new eui.ArrayCollection,e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/signInUI/SignInUISkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_scrollerItem.horizontalScrollBar=null,this.u_scrollerItem.verticalScrollBar=null,this.m_layout.requestedColumnCount=6,this.m_layout.horizontalGap=10,this.m_layout.verticalGap=10,this.u_listItem.itemRenderer=SignInRender,this.u_listItem.layout=this.m_layout,this.u_listItem.dataProvider=this.m_typeList;for(var e=[],i=1;30>=i;i++)e.push(i);this.m_typeList.source=e},e.prototype.initEvent=function(){t.prototype.initEvent.call(this)},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),Dispatch.register(EverydaySignManager.EVERYDAY_SIGN_DAY,this.setItemNum,this,!0),Dispatch.register(EverydaySignManager.EVERYDAY_SIGN_ALL,this.setItemNum,this))},e.prototype.setItemNum=function(t){if(void 0===t&&(t=0),EverydaySignManager.instance.isBuQian){var e=TimesManager.instance.getItemBuyTimes(TimesEnum.VIP_EVERYDAY_TIMES);ItemJson.getName(e[0])}},e.prototype.openVIP=function(t){var e=TimesJson.getData(TimesEnum.VIP_EVERYDAY_TIMES);e&&e.vip_max_add_id>0&&UIModule.instance.showUI(UIConfig.ID_VIP)},e.prototype.hide=function(e){void 0===e&&(e=null),t.prototype.hide.call(this,e),Dispatch.remove(EverydaySignManager.EVERYDAY_SIGN_DAY,this.setItemNum,this),Dispatch.remove(EverydaySignManager.EVERYDAY_SIGN_ALL,this.setItemNum,this)},e}(PageBase);__reflect(SignInPage.prototype,"SignInPage");var WelfareUI=function(t){function e(){var e=t.call(this)||this;return e.m_disposeUrlList.push("sevenDaysUI_json","welfareUI_json","luckyDrawUI_json","signInUI_json","drawCardUI_json"),SevenLoginManager.instance.isReceiveFinish||e.m_currList.push({funcKey:FunctionEnum.SEVEN_LOGIN_SYS,pageMc:new SevenLoginPage}),e.m_currList.push({funcKey:FunctionEnum.EVERYDAY_SIGN_SYS,pageMc:new SignInPage},{funcKey:FunctionEnum.DUOBAO_SYS,pageMc:new LuckyDrawUI},{funcKey:FunctionEnum.CHOUKA_SYS,pageMc:new DrawCardPage}),e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/welfareUI/WelfareUISkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this);var e=[];SevenLoginManager.instance.isReceiveFinish||e.push({key:FunctionEnum.SEVEN_LOGIN_SYS,btnNameBj:"welfareUI_btnBg_",posXY:[]}),e.push({key:FunctionEnum.EVERYDAY_SIGN_SYS,btnNameBj:"welfareUI_btnBg_",posXY:[]},{key:FunctionEnum.DUOBAO_SYS,btnNameBj:"welfareUI_btnBg_",posXY:[]},{key:FunctionEnum.CHOUKA_SYS,btnNameBj:"welfareUI_btnBg_",posXY:[]});for(var i=[114,184,254,324],s=0;s<e.length;s++)e[s].posXY=[48,i[s]];var n=[{key:FunctionEnum.SEVEN_LOGIN_SYS,redList:[RedNoticeConfig.RED_SEVEN_LOGIN],redPosXY:[129,5]},{key:FunctionEnum.EVERYDAY_SIGN_SYS,redList:[RedNoticeConfig.RED_SIGN_IN],redPosXY:[129,5]},{key:FunctionEnum.DUOBAO_SYS,redList:[RedNoticeConfig.RED_LUCKY_DRAW],redPosXY:[129,5]},{key:FunctionEnum.CHOUKA_SYS,redList:[RedNoticeConfig.RED_CHOU_KA],redPosXY:[129,5]}];this.m_pageSelect.setDataList(e,"l_page_name_list"),this.m_pageSelect.setRedList(n),this.addChild(this.m_pageContent)},e.prototype.setSelectPage=function(e){t.prototype.setSelectPage.call(this,e)},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),Dispatch.register(LuckyDrawManager.EVENT_SEIZING_STATUS,this.changeState,this))},e.prototype.sureHide=function(e,i){void 0===i&&(i=null),t.prototype.sureHide.call(this,e,i),Dispatch.remove(LuckyDrawManager.EVENT_SEIZING_STATUS,this.changeState,this)},e.prototype.changeState=function(t){this.touchChildren=!t},e}(UIBase);__reflect(WelfareUI.prototype,"WelfareUI");var SignInRender=function(t){function e(){return t.call(this,"resource/eui_skins/signInUI/render/SignInRenderSkin.exml")||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this),this.touchEnabled=!1,this.m_icon||(this.m_icon=new ItemIcon,this.addChildAt(this.m_icon,1),this.m_icon.horizontalCenter=0,this.m_icon.bottom=-7),this.m_icon.p_isShowQuality=!1,this.u_btnClick.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),Dispatch.register(EverydaySignManager.EVERYDAY_SIGN_DAY,this.signInSuccess,this),Dispatch.register(EverydaySignManager.EVERYDAY_SIGN_ALL,this.setSignIn,this)},e.prototype.onRemoveStage=function(e){t.prototype.onRemoveStage.call(this,e),this.m_icon&&this.m_icon.hide()},e.prototype.onAddStage=function(e){t.prototype.onAddStage.call(this,e),this.m_icon&&(this.addChildAt(this.m_icon,1),this.m_icon.p_isShowQuality=!1),this.m_vo&&this.m_icon.setData(this.m_vo.award_list[0][0],0)},e.prototype.onClick=function(t){-1==EverydaySignManager.instance.today_list.indexOf(this.m_vo.today)&&(EverydaySignManager.instance.day==this.m_vo.today?this.signIn():this.m_vo.today<EverydaySignManager.instance.day&&TimesManager.instance.addTimesPopup(TimesEnum.VIP_EVERYDAY_TIMES,"l_times_tips_6",!1,this.signIn.bind(this)))},e.prototype.signIn=function(){EverydaySignManager.instance.s_everyday_sign_everyday_sign(this.m_vo.today)},e.prototype.dataChanged=function(){if(this.checkComplete(this.dataChanged)){t.prototype.dataChanged.call(this),this.m_idx=this.data,this.m_vo=EverydaySignJson.getData(EverydaySignManager.instance.round,this.m_idx),this.u_txtDay.textFlow=LanguageJson.getHtmlTextFlow("l_seven_day",[this.m_idx]),this.m_icon.setData(this.m_vo.award_list[0][0],0);var e=NumberUtil.numberToString(this.m_vo.award_list[0][1]);this.u_txtSignInCount.textFlow=TextUtil.setTextFlow(e),this.m_vo.vip_multiple_list&&this.m_vo.vip_multiple_list.length>0?this.u_imgMulti.visible=!0:this.u_imgMulti.visible=!1,this.setSignIn()}},e.prototype.signInSuccess=function(t){this.m_vo&&this.m_vo.today==t&&(ItemFloatModule.instance.floatItem(this.m_icon),this.setSignIn())},e.prototype.setSignIn=function(){this.m_vo&&(this.setGrey(!1),this.u_imgResign.visible=!1,this.u_receivedGrp.visible=!1,this.u_btnClick.visible=!1,this.u_ImgSignInBg.source="signInUI_json.signInUI_tab1",EverydaySignManager.instance.today_list.indexOf(this.m_vo.today)>-1?(this.u_receivedGrp.visible=!0,this.setGrey(!1)):EverydaySignManager.instance.day==this.m_vo.today?(this.u_btnClick.visible=!0,this.u_ImgSignInBg.source="signInUI_json.signInUI_tab2",this.setGrey(!1)):this.m_vo.today<EverydaySignManager.instance.day&&(this.u_imgResign.visible=!0,this.u_btnClick.visible=!0,this.setGrey(!0)))},e.prototype.setGrey=function(t){ObjectUtils.setGrey(this.u_ImgSignInBg,t,!0)},Object.defineProperty(e.prototype,"width",{get:function(){return 132},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 159},enumerable:!0,configurable:!0}),e}(ItemRendererBase);__reflect(SignInRender.prototype,"SignInRender");var SoloPlayerUI=function(t){function e(){var e=t.call(this)||this;return e.m_currList.push({funcKey:FunctionEnum.BRAVE_ONE_SYS_LIST,pageMc:new SoloRoomList}),e.m_currList.push({funcKey:FunctionEnum.BRAVE_ONE_SYS_LIST_CREATE,pageMc:new SoloCreateRoom}),e}return __extends(e,t),e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),Dispatch.register(BraveOneManager.EVENT_CREATE_BRAVE_ROOM,this.changePage,this))},e.prototype.changePage=function(){},e.prototype.sureHide=function(e,i){void 0===i&&(i=null),t.prototype.sureHide.call(this,e,i),Dispatch.remove(BraveOneManager.EVENT_CREATE_BRAVE_ROOM,this.changePage,this)},e.prototype.isCloseUI=function(){if(BraveOneManager.instance.p_realId>0){var t=LanguageJson.getText("l_multi_leave_1"),e=LanguageJson.getText("l_btn_yes"),i=LanguageJson.getText("l_btn_no");return PopupModule.instance.showTishi(t,this.sureClose.bind(this),null,e,i),!1}return!0},e.prototype.sureClose=function(t){1==t&&BraveOneManager.instance.s_brave_one_clean()},e.prototype.checkPageFunc=function(t){return t==FunctionEnum.BRAVE_ONE_SYS_LIST_CREATE&&BraveOneManager.instance.p_realId>0?!1:!0},e}(UIBase);__reflect(SoloPlayerUI.prototype,"SoloPlayerUI");var SoloCreateRoom=function(t){function e(){var e=t.call(this)||this;return e.m_layout=new eui.TileLayout,e.m_list=new eui.ArrayCollection,e.m_page=1,e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/soloCreateUI/SoloCreateRoomUISkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_txtCreate.text=LanguageJson.getText("l_btn_ok"),this.u_scrollItem.horizontalScrollBar=null,this.u_scrollItem.verticalScrollBar=null,this.m_layout.requestedColumnCount=1,this.u_itemList.itemRenderer=SoloCaptialRender,this.u_itemList.layout=this.m_layout,this.u_itemList.dataProvider=this.m_list},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnCreate,this.onCreate,this),this.registerEventClick(this.u_btnJoinOne,this.onJoin,this),this.registerEventClick(this.u_btnJoinTwo,this.onJoin,this),this.registerEventClick(this.u_btnCapital1,this.onCapital,this),this.registerEventClick(this.u_btnCapital2,this.onCapital,this),this.registerEventClick(this.u_btnCapital3,this.onCapital,this)},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),this.playerInfo=PlayerManager.instance.p_playerInfo,this.u_imgOne.source="",this.u_imgTwo.source="",this.onColorChange(this.m_page),this.chooseCapital(this.m_page),Dispatch.register(BraveOneManager.EVENT_CHOOSE_CAP_COST,this.onCapList,this))},e.prototype.onJoin=function(t){var e=t.currentTarget.name,i=Number(e.slice(7,8));switch(i){case 1:this.m_posid=1,this.u_imgOne.source=PublicCon.PATH_PERSONAL_ICON+this.playerInfo.player_other_data.head_id+".png",this.u_imgTwo.source="";break;case 2:this.m_posid=2,this.u_imgTwo.source=PublicCon.PATH_PERSONAL_ICON+this.playerInfo.player_other_data.head_id+".png",this.u_imgOne.source=""}},e.prototype.onCapital=function(t){var e=t.currentTarget.name,i=Number(e.slice(6,7));this.onColorChange(i),this.chooseCapital(this.m_page)},e.prototype.onColorChange=function(t){switch(t){case 1:this.m_page=1,this.u_txtCapital1.textColor=ColorJson.green,this.u_txtCapital2.textColor=ColorJson.getColorNum(ColorEnum.C_WHITE),this.u_txtCapital3.textColor=ColorJson.getColorNum(ColorEnum.C_WHITE);break;case 2:this.m_page=2,this.u_txtCapital2.textColor=ColorJson.green,this.u_txtCapital1.textColor=ColorJson.getColorNum(ColorEnum.C_WHITE),this.u_txtCapital3.textColor=ColorJson.getColorNum(ColorEnum.C_WHITE);break;case 3:this.m_page=3,this.u_txtCapital3.textColor=ColorJson.green,this.u_txtCapital1.textColor=ColorJson.getColorNum(ColorEnum.C_WHITE),this.u_txtCapital2.textColor=ColorJson.getColorNum(ColorEnum.C_WHITE)}},e.prototype.chooseCapital=function(t){this.m_misList=MissionBraveOneJson.getDataByTip(t),ArrayUtils.setSortArr(this.m_misList,["id"],[0]),this.m_misList[0]&&(BraveOneManager.instance.p_missionId=this.m_misList[0].id),this.m_list.source=this.m_misList,this.onCapList()},e.prototype.onCapList=function(){BraveOneManager.instance.p_missionId&&(this.m_chooseList=MissionBraveOneJson.getData(BraveOneManager.instance.p_missionId))},e.prototype.onCreate=function(t){if(this.m_posid&&this.m_chooseList){if(""!=BagManager.instance.checkCondition(this.m_chooseList.enter_conditions_list,!0))return;if(BagManager.instance.isEnoughProp(this.m_chooseList,!0))return void FloatTipModule.instance.popTipLanguage("l_game_tips_11");BraveOneManager.instance.s_brave_one_create(this.m_chooseList.id,this.m_posid)}return this.m_posid?this.m_chooseList?void 0:void FloatTipModule.instance.popTip("No magnification selected"):void FloatTipModule.instance.popTip("No location selected")},e.prototype.hide=function(e){void 0===e&&(e=null),t.prototype.hide.call(this),Dispatch.remove(BraveOneManager.EVENT_CHOOSE_CAP_COST,this.onCapList,this)},e}(PageBase);__reflect(SoloCreateRoom.prototype,"SoloCreateRoom");var SoloRoomList=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this)},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),Dispatch.register(BraveOneManager.EVENT_ENTER_BRAVE_ROOM,this.onMatchResult,this,!0))},e.prototype.onMatchResult=function(){this.m_playerData=PlayerManager.instance.p_playerInfo,BraveOneManager.instance.m_braveData&&BraveOneManager.instance.p_realId>0?(this.m_soloRoomView||(this.m_soloRoomView=new SoloRoomView,this.m_soloRoomView.x=0,this.m_soloRoomView.y=0),this.addChild(this.m_soloRoomView),this.m_playerData.player_id==BraveOneManager.instance.m_braveData.modelHeadFigure.player_id?this.m_soloRoomView.show(BraveOneManager.instance.m_braveData):this.m_soloRoomView.show(BraveOneManager.instance.m_braveData,this.m_playerData),this.m_soloRoomListView&&this.m_soloRoomListView.hide()):(this.m_soloRoomListView||(this.m_soloRoomListView=new SoloRoomListView,this.m_soloRoomListView.x=0,this.m_soloRoomListView.y=0),this.addChild(this.m_soloRoomListView),this.m_soloRoomListView.show(),this.m_soloRoomView&&this.m_soloRoomView.hide())},e.prototype.hide=function(e){void 0===e&&(e=null),Dispatch.remove(BraveOneManager.EVENT_ENTER_BRAVE_ROOM,this.onMatchResult,this),this.m_soloRoomListView&&this.m_soloRoomListView.hide(),this.m_soloRoomView&&this.m_soloRoomView.hide(),t.prototype.hide.call(this)},Object.defineProperty(e.prototype,"width",{get:function(){return 640},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 1136},enumerable:!0,configurable:!0}),e}(PageBase);__reflect(SoloRoomList.prototype,"SoloRoomList");var SoloWaitPopup=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/soloPlayerUI/popup/SoloWaitPopupSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.m_numberView||(this.m_numberView=new NumberView("num_c_time_",0,-10),this.u_numGrp.addChild(this.m_numberView),this.m_numberView.horizontalCenter=0,this.m_numberView.verticalCenter=2)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this)},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),e&&e.missionId&&(this.m_missionId=e.missionId),this.m_numberView.numValue=9,this.m_num=this.m_numberView.numValue,TimeManager.instance.doLoop(this.onCountDown,this,1e3))},e.prototype.onCountDown=function(){return this.m_num<=0?(TimeManager.instance.clearTimer(this.onCountDown,this),void this.onChallenge()):void this.m_num--},e.prototype.onChallenge=function(){PopupModule.instance.hidePopAll(),SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_1014),MissionManager.instance.s_mission_challenge_mission(MissionTypeEnum.BRAVE_ONE_SYS,this.m_missionId)},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i),TimeManager.instance.clearTimer(this.onCountDown,this)},Object.defineProperty(e.prototype,"isClickBMask",{get:function(){return!1},enumerable:!0,configurable:!0}),e}(PopupBase);__reflect(SoloWaitPopup.prototype,"SoloWaitPopup");var SoloCaptialRender=function(t){function e(){return t.call(this,"resource/eui_skins/soloCreateUI/render/SoloCapitalListRenderSkin.exml")||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChoose,this)},e.prototype.onChoose=function(t){this.m_capData.id!=BraveOneManager.instance.p_missionId&&(BraveOneManager.instance.p_missionId=this.m_capData.id,Dispatch.dispatch(BraveOneManager.EVENT_CHOOSE_CAP_COST))},e.prototype.dataChanged=function(){if(this.checkComplete(this.dataChanged)){t.prototype.dataChanged.call(this),this.m_capData=this.data;var e=BagManager.instance.getIconPath(this.m_capData.cost_list[0][0]);this.u_iconCost.source=e;var i=BagManager.instance.getIconPath(this.m_capData.win_list[0][0]);this.u_iconWin.source=i,this.u_txtCost.text=String(this.m_capData.cost_list[0][2]),this.u_txtWin.text=String(this.m_capData.win_list[0][2]),Dispatch.register(BraveOneManager.EVENT_CHOOSE_CAP_COST,this.setState,this,!0)}},e.prototype.setState=function(){this.m_capData.id==BraveOneManager.instance.p_missionId?this.u_backImg.source="commonsUI_json.commonUI_box_3":this.u_backImg.source="commonsUI_json.commonUI_box_2"},e.prototype.onRemoveStage=function(e){t.prototype.onRemoveStage.call(this,e),Dispatch.remove(BraveOneManager.EVENT_CHOOSE_CAP_COST,this.setState,this)},e}(ItemRendererBase);__reflect(SoloCaptialRender.prototype,"SoloCaptialRender");var SoloRoomRender=function(t){function e(){return t.call(this,"resource/eui_skins/soloPlayerUI/render/SoloRoomRenderSkin.exml")||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnJoin1,this.onJoin,this),this.registerEventClick(this.u_btnJoin2,this.onJoin,this)},e.prototype.onJoin=function(t){""==BagManager.instance.checkCondition(this.p_braveOneJsonData.enter_conditions_list,!0)&&BraveOneManager.instance.s_brave_one_enter(this.m_braveOneData.realId)},e.prototype.dataChanged=function(){if(this.checkComplete(this.dataChanged)){t.prototype.dataChanged.call(this),this.m_braveOneData=this.data;var e=PublicCon.PATH_PERSONAL_ICON+this.m_braveOneData.modelHeadFigure.head_id+".png";this.p_braveOneJsonData=MissionBraveOneJson.getData(this.m_braveOneData.id);var i=String(this.p_braveOneJsonData.cost_list[0][2]);switch(this.m_braveOneData.pos_id){case 1:this.u_img1.visible=!0,this.u_btnJoin2.visible=!0,this.u_img1.source=e,this.u_txtMana1.text=i;break;case 2:this.u_img2.visible=!0,this.u_btnJoin1.visible=!0,this.u_img2.source=e,this.u_txtMana2.text=i}}},e}(ItemRendererBase);__reflect(SoloRoomRender.prototype,"SoloRoomRender");var SoloRoomListView=function(t){function e(){var e=t.call(this)||this;return e.m_layout=new eui.TileLayout,e.m_roomList=new eui.ArrayCollection,e.p_page=1,e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/soloPlayerUI/SoloRoomListUISkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.u_txtMatch.text=LanguageJson.getText("l_btn_match"),this.u_scrollItem.horizontalScrollBar=null,this.u_scrollItem.verticalScrollBar=null,this.m_layout.requestedColumnCount=1,this.u_itemList.itemRenderer=SoloRoomRender,this.u_itemList.layout=this.m_layout,this.u_itemList.dataProvider=this.m_roomList},e.prototype.initEvent=function(){this.registerEventClick(this.u_btnCapital1,this.onCapital,this),this.registerEventClick(this.u_btnCapital2,this.onCapital,this),this.registerEventClick(this.u_btnCapital3,this.onCapital,this),this.registerEventClick(this.u_btnMatch,this.onMatch,this)},e.prototype.show=function(t){void 0===t&&(t=null),this.checkComplete(this.show,t)&&(this.recoverAllTexture(this,!0),Dispatch.register(BraveOneManager.EVENT_GET_BRAVE_INFO,this.onBraveInfo,this),this.onColorChange(this.p_page),BraveOneManager.instance.s_brave_one_get_info_list(this.p_page),TimeManager.instance.doLoop(this.upData,this,3e5,!1))},e.prototype.upData=function(){BraveOneManager.instance.s_brave_one_get_info_list(this.p_page)},e.prototype.onBraveInfo=function(t){ArrayUtils.setSortArr(t,["id"],[0]),this.m_roomList.source=t,this.u_imgNone.visible=t.length>0?!1:!0},e.prototype.onCapital=function(t){var e=t.currentTarget.name,i=Number(e.slice(6,7));this.p_page=i,this.onColorChange(this.p_page),BraveOneManager.instance.s_brave_one_get_info_list(this.p_page)},e.prototype.onColorChange=function(t){switch(t){case 1:this.u_txtCapital1.textColor=ColorJson.green,this.u_txtCapital2.textColor=ColorJson.getColorNum(ColorEnum.C_WHITE),this.u_txtCapital3.textColor=ColorJson.getColorNum(ColorEnum.C_WHITE);break;case 2:this.u_txtCapital2.textColor=ColorJson.green,this.u_txtCapital1.textColor=ColorJson.getColorNum(ColorEnum.C_WHITE),this.u_txtCapital3.textColor=ColorJson.getColorNum(ColorEnum.C_WHITE);break;case 3:this.u_txtCapital3.textColor=ColorJson.green,this.u_txtCapital2.textColor=ColorJson.getColorNum(ColorEnum.C_WHITE),this.u_txtCapital1.textColor=ColorJson.getColorNum(ColorEnum.C_WHITE)}},e.prototype.onMatch=function(t){},e.prototype.hide=function(){DisplayObjectUtils.removeFormParent(this),Dispatch.remove(BraveOneManager.EVENT_GET_BRAVE_INFO,this.onBraveInfo,this),TimeManager.instance.clearTimer(this.upData,this)
},Object.defineProperty(e.prototype,"width",{get:function(){return 640},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 1136},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(SoloRoomListView.prototype,"SoloRoomListView");var SoloRoomView=function(t){function e(){var e=t.call(this)||this;return e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/soloPlayerUI/SoloRoomUISkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){},e.prototype.initEvent=function(){},e.prototype.onNotice=function(t){t&&(1==t.pos_id?(this.u_img1.source=PublicCon.PATH_PERSONAL_ICON+t.modelHeadFigure.head_id+".png",this.u_txtMana1.text=this.p_mana):2==t.pos_id&&(this.u_img2.source=PublicCon.PATH_PERSONAL_ICON+t.modelHeadFigure.head_id+".png",this.u_txtMana2.text=this.p_mana))},e.prototype.show=function(t,e){if(void 0===t&&(t=null),void 0===e&&(e=null),this.checkComplete(this.show,t,e)){this.recoverAllTexture(this,!0),Dispatch.register(BraveOneManager.EVENT_NOTICE_FIGHT_SCENE,this.onNotice,this),this.u_img1.source="",this.u_img2.source="",this.u_txtMana1.text="",this.u_txtMana2.text="",this.m_playerData=e,this.m_braveOneData=t,this.m_braveOneData&&(this.m_braveOneJsonData=MissionBraveOneJson.getData(this.m_braveOneData.id)),this.p_mana=String(this.m_braveOneJsonData.cost_list[0][2]);var i=PublicCon.PATH_PERSONAL_ICON+this.m_braveOneData.modelHeadFigure.head_id+".png";if(this.m_playerData)var s=PublicCon.PATH_PERSONAL_ICON+this.m_playerData.player_other_data.head_id+".png";this.m_braveOneData&&(1==this.m_braveOneData.pos_id&&(this.u_img1.source=i,this.u_txtMana1.text=this.p_mana,this.m_playerData&&(this.u_img2.source=s,this.u_txtMana2.text=this.p_mana)),2==this.m_braveOneData.pos_id&&(this.u_img2.source=i,this.u_txtMana2.text=this.p_mana,this.m_playerData&&(this.u_img1.source=s,this.u_txtMana1.text=this.p_mana)))}},e.prototype.hide=function(){DisplayObjectUtils.removeFormParent(this),Dispatch.remove(BraveOneManager.EVENT_NOTICE_FIGHT_SCENE,this.onNotice,this)},Object.defineProperty(e.prototype,"width",{get:function(){return 640},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 1136},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(SoloRoomView.prototype,"SoloRoomView");var SysNoticeView=function(t){function e(){var e=t.call(this)||this;return e.m_scroller=new eui.Scroller,e.m_list=new eui.List,e.m_datas=[1,2,3,4,5,6],e.m_arrCollection=new eui.ArrayCollection,e.m_timer=new egret.Timer(500,0),e.onCompleted(),e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.m_scroller.width=this.width,this.m_scroller.height=this.height,this.m_scroller.x=0,this.m_scroller.y=0,this.addChild(this.m_scroller),this.m_scroller.addChild(this.m_list),this.m_scroller.viewport=this.m_list,this.m_scroller.scrollPolicyH=eui.ScrollPolicy.OFF,this.m_scroller.scrollPolicyV=eui.ScrollPolicy.ON,this.m_scroller.touchEnabled=!1,this.m_scroller.touchChildren=!1;var t=new eui.VerticalLayout;t.gap=5,this.m_list.layout=t,this.m_arrCollection.source=this.m_datas,this.m_list.dataProvider=this.m_arrCollection,this.m_list.itemRenderer=TextRender},e.prototype.initEvent=function(){var t=this;this.m_timer.addEventListener(egret.TimerEvent.TIMER,function(){var e=t.m_scroller.viewport.scrollV;e>=t.m_scroller.viewport.contentHeight-t.m_scroller.height?t.m_scroller.viewport.scrollV=0:(e+=5,TweenLite.to(t.m_scroller.viewport,.2,{scrollV:e}))},this)},e.prototype.show=function(){this.checkComplete(this.show)&&(this.x=0,this.y=180,UIModule.instance.downUILayer1.addChild(this),this.m_timer.start())},e.prototype.hide=function(){this.checkComplete(this.hide)&&(this.m_timer.stop(),DisplayObjectUtils.removeFormParent(this))},Object.defineProperty(e.prototype,"height",{get:function(){return 70},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return 350},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(SysNoticeView.prototype,"SysNoticeView");var TextRender=function(t){function e(){var e=t.call(this)||this;return e.m_txtLb=new eui.Label,e.touchChildren=!1,e.m_txtLb.textColor=16777215,e.m_txtLb.size=16,e.m_txtLb.stroke=1,e.m_txtLb.strokeColor=0,e.m_txtLb.text="[系统] 玩家昵称 击杀了BOSS 排名上升 1",e.addChild(e.m_txtLb),e.m_txtLb.x=5,e.m_txtLb.y=2,e}return __extends(e,t),e.prototype.dataChanged=function(){},Object.defineProperty(e.prototype,"height",{get:function(){return 20},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return 350},enumerable:!0,configurable:!0}),e}(eui.ItemRenderer);__reflect(TextRender.prototype,"TextRender");var TaskPage=function(t){function e(){var e=t.call(this)||this;return e.m_taskViewList=[],e.m_disposeUrlList.push("taskUI_json"),e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/taskUI/TaskMainUISkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_scrollItem.horizontalScrollBar=null,this.u_scrollItem.verticalScrollBar=this.u_vsItem,this.u_vsItem.visible=!1,this.u_vsItem.autoVisibility=!0;var e=.5*(StageManager.MIN_STAGE_WIDTH-StageManager.instance.p_stageWidth);this.u_scrollItem.x+=e/2,this.u_imgMask.width=StageManager.instance.p_stageWidth},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.u_scrollItem.addEventListener(eui.UIEvent.CHANGE_END,this.onComplete,this),this.u_scrollItem.addEventListener(eui.UIEvent.CHANGE,this.onSilde,this)},e.prototype.onComplete=function(t){this.u_btnTop.visible=!1,this.u_btnBottom.visible=!1},e.prototype.onSilde=function(t){var e=this.u_scrollItem.viewport.scrollV<=0?!1:!0,i=this.u_scrollItem.viewport.scrollV+this.u_scrollItem.height>=this.u_scrollItem.viewport.contentHeight?!1:!0;e!=this.u_btnTop.visible&&(this.u_btnTop.visible=e),i!=this.u_btnBottom.visible&&(this.u_btnBottom.visible=i);var s=this.u_scrollItem.verticalScrollBar.height-this.u_scrollItem.verticalScrollBar.thumb.height;this.u_scrollItem.verticalScrollBar.thumb.y=this.u_scrollItem.viewport.scrollV/(this.u_scrollItem.viewport.contentHeight-this.u_scrollItem.height)*s,this.u_scrollItem.verticalScrollBar.thumb.y<0&&(this.u_scrollItem.verticalScrollBar.thumb.y=0),this.u_scrollItem.verticalScrollBar.thumb.y>s&&(this.u_scrollItem.verticalScrollBar.thumb.y=s)},e.prototype.selectOpenShow=function(t,e){if(e)for(var i in this.m_taskViewList)this.m_taskViewList[i].m_taskId!=t&&this.m_taskViewList[i].showType&&this.m_taskViewList[i].setHideView();this.setListPos(!0,t)},e.prototype.showView=function(e){if(void 0===e&&(e=null),this.checkComplete(this.showView,e)){t.prototype.showView.call(this,e),this.u_imgMask.touchEnabled=!1,this.m_taskList=TaskJson.getTaskList(),this.u_scrollItem.viewport.scrollV=0,Dispatch.register(TaskView.EVENT_TASK_VIEW_SELECT,this.selectOpenShow,this);for(var i=0;i<this.m_taskList.length;i++){var s;this.m_taskViewList[i]?s=this.m_taskViewList[i]:(s=new TaskView,this.m_taskViewList[i]=s,this.u_grpItem.addChild(s)),i==this.m_taskViewList.length-1?s.setMainViewData(this.m_taskList[i].id,this.setListPos.bind(this)):s.setMainViewData(this.m_taskList[i].id,null)}this.u_btnTop.visible=!1,this.u_btnBottom.visible=!1}},e.prototype.setListPos=function(t,e){void 0===t&&(t=!1),void 0===e&&(e=-1),-1==e&&TaskManager.instance.p_task_data&&(e=TaskManager.instance.p_task_data.task_id);for(var i=0,s=0,n=0;n<this.m_taskViewList.length;n++){var o=this.m_taskViewList[n];o.setYalue(s,t),o.m_taskId==e&&(i=s),s=o.roy+o.height}if(this.u_grpItem.height=s,i>0){var a=s-i-this.u_scrollItem.height;0>=a&&(i+=a),0>=i&&(i=0),TweenLite.to(this.u_scrollItem.viewport,.2,{scrollV:i})}},e.prototype.hide=function(e){void 0===e&&(e=null),Dispatch.remove(TaskView.EVENT_TASK_VIEW_SELECT,this.selectOpenShow,this);for(var i=0;i<this.m_taskViewList.length;i++)this.m_taskViewList[i].hide();t.prototype.hide.call(this)},e}(PageBase);__reflect(TaskPage.prototype,"TaskPage");var TaskReceiveView=function(t){function e(){var e=t.call(this)||this;return e.m_progress_max=416,e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/taskUI/view/TaskReceiveViewSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.rewardGroup||(this.rewardGroup=new RewardGroupUI,this.rewardGroup.scaleX=this.rewardGroup.scaleY=.9,this.rewardGroup.x=463,this.rewardGroup.y=25,this.addChild(this.rewardGroup))},e.prototype.initEvent=function(){this.registerEventClick(this.u_imgReceive,this.onReceive,this,!0)},e.prototype.onReceive=function(t){if(this.m_taskData&&(1==this.m_taskData.status&&TaskManager.instance.s_task_get_award(),0==this.m_taskData.status&&this.m_json.function_config_id>0)){if(PopupModule.instance.hidePopAll(),UIModule.instance.hideAllUI(),SceneManager.instance.p_sceneType==SceneTypeEnum.WORLD_SCENE&&this.m_json.function_config_id==FunctionConfigEnum.SCENE_SCELECT)return;FunctionManager.instance.executeFunction(this.m_json.function_config_id)}},e.prototype.show=function(t){if(this.checkComplete(this.show,t)&&(this.m_curTaskId=null,this.m_taskData=null,this.m_json=TaskJson.getData(t),this.m_curTaskId=t,this.m_json)){this.u_taskName.text=this.m_json.content_desc,this.u_txtDesc.text=this.m_json.desc,Dispatch.register(TaskManager.EVENT_MAIN_TASK_UPGRADE,this.onTaskUpdate,this,!0);var e=RewardJson.getData(this.m_json.award_id);e&&this.rewardGroup.setDataByList(e.random_reward_list,3)}},e.prototype.onTaskUpdate=function(){this.m_taskData=TaskManager.instance.p_task_data;var t=TaskJson.getData(this.m_taskData.task_id);return 2==this.m_taskData.status&&0==t.next_task?(this.m_num=this.m_json.content_list[this.m_json.content_list.length-1],this.u_txtJd.text=this.m_num+"/"+this.m_num,this.u_imgJd2.visible=!0,this.u_imgJd2.width=this.u_imgJd1.width,this.u_imgReceive.source="taskUI_json.taskUI_btn_ylq",void(this.u_imgReceive.touchEnabled=!1)):void(this.m_taskData&&(this.m_curTaskId==TaskManager.instance.p_task_data.task_id?(this.m_num=Number(this.m_taskData.num),this.u_txtJd.text=this.m_num+"/"+this.m_json.content_list[this.m_json.content_list.length-1],this.u_imgJd2.visible=!0,this.u_imgJd2.width=this.m_num/this.m_json.content_list[1]*this.m_progress_max,this.m_taskData.num==this.m_json.content_list[this.m_json.content_list.length-1]?(this.u_imgReceive.source="taskUI_json.taskUI_btn_klq",this.u_imgReceive.touchEnabled=!0):(this.u_imgReceive.source="taskUI_json.taskUI_btn_qw",this.u_imgReceive.touchEnabled=!0)):this.m_curTaskId<TaskManager.instance.p_task_data.task_id?(this.m_num=this.m_json.content_list[this.m_json.content_list.length-1],this.u_txtJd.text=this.m_num+"/"+this.m_num,this.u_imgJd2.visible=!0,this.u_imgJd2.width=this.u_imgJd1.width,this.u_imgReceive.source="taskUI_json.taskUI_btn_ylq",this.u_imgReceive.touchEnabled=!1):this.m_curTaskId>TaskManager.instance.p_task_data.task_id&&(this.m_num=0,this.u_txtJd.text=this.m_num+"/"+this.m_json.content_list[this.m_json.content_list.length-1],this.u_imgJd2.visible=!1,this.u_imgReceive.source="taskUI_json.taskUI_btn_qw2",this.u_imgReceive.touchEnabled=!1)))},e.prototype.hide=function(){Dispatch.remove(TaskManager.EVENT_MAIN_TASK_UPGRADE,this.onTaskUpdate,this)},e}(ComponentBase);__reflect(TaskReceiveView.prototype,"TaskReceiveView");var TaskView=function(t){function e(){var e=t.call(this)||this;return e.m_isShow=!1,e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/taskUI/view/TaskViewSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.touchEnabled=!1,this.u_txtName.touchEnabled=!1},e.prototype.initEvent=function(){this.registerEventClick(this.u_btnSpare,this.onShow,this)},e.prototype.onShow=function(t){TweenLite.killTweensOf(this.u_grpContent),this.m_isShow?this.setHideView():(this.m_isShow=!0,this.u_grpContent.visible=!0,this.skin.height=this.height,TweenLite.to(this.u_grpContent,.11,{scaleY:1,alpha:1,onComplete:this.setShowChange.bind(this)})),Dispatch.dispatch(e.EVENT_TASK_VIEW_SELECT,this.m_taskId,this.m_isShow)},e.prototype.setHideView=function(){this.m_isShow=!1,this.skin.height=this.height,TweenLite.to(this.u_grpContent,.11,{scaleY:0,alpha:0,onComplete:this.setShowChange.bind(this)})},e.prototype.setMainViewData=function(t,e){if(void 0===e&&(e=null),this.checkComplete(this.setMainViewData,t,e)){this.m_isShow=!1,this.m_taskId=t,this.m_json=TaskJson.getData(t),this.skin.height=this.height;var i=PublicCon.PATH_TASK+this.m_taskId+".png";this.u_imgBg.source=null,this.u_imgBg.source=i,this.taskReceiveView||(this.taskReceiveView=new TaskReceiveView,this.taskReceiveView.x=0,this.taskReceiveView.y=0),this.u_grpContent.addChild(this.taskReceiveView),this.taskReceiveView.show(this.m_taskId),this.setShowChange(),null!=e&&e.call(!1,this.m_taskId),-1==CardBookUI.p_taskUrlList.indexOf(i)&&CardBookUI.p_taskUrlList.push(i),Dispatch.register(TaskManager.EVENT_MAIN_STATE_UPGRADE,this.onTaskChange,this,!0)}},e.prototype.onTaskChange=function(){var t=TaskManager.instance.p_task_data.task_id,e=TaskJson.getData(t);return 0==e.next_task&&2==TaskManager.instance.p_task_data.status?(this.u_txtName.textFlow=TextUtil.setTextFlow(this.m_json.title+"（"+LanguageJson.getText("l_task_complete")+"）"),void ObjectUtils.setGrey(this,!0,!0)):void(this.m_taskId<t?(this.u_txtName.textFlow=TextUtil.setTextFlow(this.m_json.title+"（"+LanguageJson.getText("l_task_complete")+"）"),ObjectUtils.setGrey(this,!0,!0)):this.m_taskId>t?(this.u_txtName.text=this.m_json.title+"（"+LanguageJson.getText("l_task_noactive")+"）",ObjectUtils.setGrey(this,!0,!0)):(TaskManager.instance.p_task_data.num==this.m_json.content_list[this.m_json.content_list.length-1]?this.u_txtName.textFlow=TextUtil.setTextFlowColor(this.m_json.title+TextUtil.setText("（"+LanguageJson.getText("l_task_complete")+"）",4648506),16514003):(this.u_txtName.textFlow=TextUtil.setTextFlowColor(this.m_json.title+TextUtil.setText("（"+LanguageJson.getText("l_task_ongoing")+"）",16374053),16514003),ObjectUtils.setGrey(this,!1,!1)),this.onShow(null)))},e.prototype.setShowChange=function(){this.m_isShow?(this.u_grpContent.alpha=1,this.u_grpContent.visible=!0,this.u_grpContent.scaleY=1):(this.u_grpContent.alpha=0,this.u_grpContent.visible=!1,this.u_grpContent.scaleY=0)},e.prototype.setYalue=function(t,e){void 0===e&&(e=!1),this.m_roy=t,e?TweenLite.to(this,.11,{y:t}):this.y=t},Object.defineProperty(e.prototype,"roy",{get:function(){return this.m_roy},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showType",{get:function(){return this.m_isShow},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.m_isShow?92+this.u_grpContent.height:92},enumerable:!0,configurable:!0}),e.prototype.hide=function(){Dispatch.remove(TaskManager.EVENT_MAIN_STATE_UPGRADE,this.onTaskChange,this),this.taskReceiveView.hide()},e.EVENT_TASK_VIEW_SELECT="EVENT_TASK_VIEW_SELECT",e}(ComponentBase);__reflect(TaskView.prototype,"TaskView");var TurnTableUI=function(t){function e(){var e=t.call(this)||this;return e.m_showList=[],e.m_showId=0,e.m_speed=0,e.m_costList1=[],e.m_costList2=[],e.m_time=0,e.m_itemList=[],e.m_step=36,e.m_isMove=!1,e.m_moveZhiArray=[],e.m_disposeUrlList.push("turntableUI_json"),e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/turnTableUI/TurntableUISkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this);for(var e=TurntableJson.getTurntableList(),i=0;i<e.length;i++){var s=new ItemIcon;s.x=this["u_imgBlade"+(i+1)].x-34.4,s.y=this["u_imgBlade"+(i+1)].y-34.4,this.addChildAt(s,i+2),this.m_itemList.push(s),s.setData(e[i].award_list[0][0],e[i].award_list[0][1]),s.scaleX=s.scaleY=.8}this.m_costList1=StaticDataJson.parseStrToList("turntable_1_times"),this.m_costList2=StaticDataJson.parseStrToList("turntable_10_times"),this.u_txtExpend1.text=LanguageJson.getHtmlText("l_turntable_expend"),this.u_txtExpend1.textColor=1==this.m_costList1[0][1]?15988205:16774322,this.u_txtCost1.text=this.m_costList1[0][2],this.u_imgIcon1.source=BagManager.instance.getIconPath(this.m_costList1[0][0]),this.u_txtExpend2.text=LanguageJson.getHtmlText("l_turntable_expend"),this.u_txtExpend2.textColor=1==this.m_costList1[0][1]?15988205:16774322,this.u_txtCost2.text=this.m_costList2[0][2],this.u_imgIcon2.source=BagManager.instance.getIconPath(this.m_costList2[0][0])},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnOnce,this.onDrawOnce,this,!0),this.registerEventClick(this.u_btnTen,this.onDrawTen,this,!0),this.registerEventClick(this.u_btnClose,this.onClick,this,!0),this.registerEventClick(this.u_btnReward,this.onExpReward,this)},e.prototype.onClick=function(t){void 0===t&&(t=null),this.m_isMove||this.close()},e.prototype.onExpReward=function(t){return void 0===t&&(t=null),TurnTableManager.instance.p_drawExp<TurnTableManager.instance.p_drawExpMax?void FloatTipModule.instance.popTipLanguage("l_turntable_tips2"):void TurnTableManager.instance.s_trun_table_get_award()},e.prototype.onDrawOnce=function(t){return void 0===t&&(t=null),this.m_isMove?void 0:BagManager.instance.isEnoughProp([this.m_costList1[0][0],this.m_costList1[0][1],this.m_costList1[0][2]],!1)?void TurnTableManager.instance.s_trun_table_draw(1):void FloatTipModule.instance.popTipLanguage("l_game_tips_11")},e.prototype.onDrawTen=function(t){return void 0===t&&(t=null),this.m_isMove?void 0:BagManager.instance.isEnoughProp([this.m_costList2[0][0],this.m_costList2[0][1],this.m_costList2[0][2]],!1)?void TurnTableManager.instance.s_trun_table_draw(10):void FloatTipModule.instance.popTipLanguage("l_game_tips_11")},e.prototype.starRoll=function(t){this.m_isMove=!0,this.isItemClick(!this.m_isMove),this.m_showList=TurnTableManager.instance.p_showList.concat([]),1==t?(this.m_speed=25,this.showDrawOnce()):(this.m_speed=20,this.showDrawTen())},e.prototype.isItemClick=function(t){for(var e=0;e<this.m_itemList.length;e++)this.m_itemList[e].p_isShowTip=t},e.prototype.showDrawOnce=function(){if(0!=this.m_showList.length){for(var t=1;10>=t;t++)this["u_imgBlade"+t].alpha=0,TweenLite.killTweensOf(this["u_imgBlade"+t]);this.m_showId=this.m_showList.shift(),this.m_moveZhiArray=this.setspeed(720+(this.m_showId-1)*this.m_step,.12,1.04),TimeManager.instance.doLoop(this.setTimeMove,this,this.m_speed)}},e.prototype.showDrawTen=function(){if(0!=this.m_showList.length){for(var t=1;10>=t;t++)this["u_imgBlade"+t].alpha=0,TweenLite.killTweensOf(this["u_imgBlade"+t]);this.m_showId=this.m_showList.pop(),this.m_moveZhiArray=this.setspeed(7200+(this.m_showId-1)*this.m_step+18,18,1),TimeManager.instance.doLoop(this.setTimeMoveTen,this,this.m_speed),DelayCallUtils.delayedCall(.2,this.flyIcon,this)}},e.prototype.setTimeMove=function(){this.u_imgJiantou.rotation=this.m_moveZhiArray.pop(),this.u_imgJiantou.rotation>0?this.setFilt(Math.floor(Math.abs((this.u_imgJiantou.rotation+this.m_step/2)%360)/this.m_step)):this.setFilt(Math.floor(Math.abs((this.u_imgJiantou.rotation+360+this.m_step/2)%360)/this.m_step)),0==this.m_moveZhiArray.length&&(this.flyIcon(),this.receiveItem())},e.prototype.setTimeMoveTen=function(){this.u_imgJiantou.rotation=this.m_moveZhiArray.pop(),this.u_imgJiantou.rotation>0?this.setFilt(Math.floor(Math.abs((this.u_imgJiantou.rotation+this.m_step/2)%360)/this.m_step)):this.setFilt(Math.floor(Math.abs((this.u_imgJiantou.rotation+360+this.m_step/2)%360)/this.m_step)),0==this.m_moveZhiArray.length&&this.receiveItem2()},e.prototype.setFilt=function(t){this["u_imgBlade"+(t+1)]&&TweenLite.to(this["u_imgBlade"+(t+1)],.2,{alpha:1,onComplete:this.setAlpha.bind(this),onCompleteParams:[t]})},e.prototype.setAlpha=function(t){this["u_imgBlade"+(t+1)]&&TweenLite.to(this["u_imgBlade"+(t+1)],.2,{alpha:0})},e.prototype.setspeed=function(t,e,i){for(var s=[],n=e,o=t;o>0;)n*=i,o-=n,o>0&&s.push(o);return s},e.prototype.receiveItem=function(){TimeManager.instance.clearTimer(this.setTimeMove,this),this.m_isMove=!1,this.isItemClick(!this.m_isMove),this.doBreatheTip()},e.prototype.receiveItem2=function(){TimeManager.instance.clearTimer(this.setTimeMoveTen,this),this.m_isMove=!1,this.isItemClick(this.m_isMove),this.doBreatheTip()},e.prototype.flyIcon=function(){this.m_bgmMenk||(this.m_bgmMenk=new eui.Image("commonUI_box"),this.m_bgmMenk.alpha=.6,this.m_bgmMenk.scale9Grid=UIModule.instance.getRectangle(),this.m_bgmMenk.width=StageManager.instance.p_stageWidth,this.m_bgmMenk.height=StageManager.instance.p_stageHeight),StageManager.instance.popUplayer.addChild(this.m_bgmMenk);for(var t=TurnTableManager.instance.p_showList,i=0;i<t.length;i++){var s;s=e.p_poorList.length>0?e.p_poorList.shift():new TurnRewardMC,s.alpha=0,TweenLite.to(s,.2,{alpha:1,delay:.01+.7*i,onComplete:this.showReward.bind(this),onCompleteParams:[s,t[i],i,t.length]})}},e.prototype.showReward=function(t,e,i,s){i==s-1?t.show(e,i,this.hideMask.bind(this)):t.show(e,i)},e.prototype.hideMask=function(){DisplayObjectUtils.removeFormParent(this.m_bgmMenk)},e.prototype.showView=function(e){if(void 0===e&&(e=null),this.checkComplete(this.showView,e)){t.prototype.showView.call(this,e),Dispatch.register(TurnTableManager.EVENT_TURNTABLE_DRAW_SUCCESS,this.starRoll,this),Dispatch.register(TurnTableManager.EVENT_TURNTABLE_EXP_UPDATA,this.setJindu,this,!0),Dispatch.register(BagManager.EVENT_BAG_UPGRADE+1,this.setTxtColor,this,!0),Dispatch.register(BagManager.EVENT_BAG_UPGRADE+2,this.setTxtColor,this,!0);for(var i=0;10>i;i++)this["u_imgBlade"+(i+1)].alpha=0;this.m_isMove=!1,this.isItemClick(!this.m_isMove),this.doBreatheTip(),this.resetTime()}},e.prototype.doBreatheTip=function(){this.parent&&this["u_imgBlade"+this.m_showId]&&(0==this["u_imgBlade"+this.m_showId].alpha?TweenLite.to(this["u_imgBlade"+this.m_showId],.6,{alpha:1,onComplete:this.doBreatheTip.bind(this)}):TweenLite.to(this["u_imgBlade"+this.m_showId],.6,{alpha:0,onComplete:this.doBreatheTip.bind(this)}))},e.prototype.setJindu=function(t){void 0===t&&(t=!1),this.u_imgJindu.width=TurnTableManager.instance.p_drawExp/TurnTableManager.instance.p_drawExpMax*250,this.u_txtJindu.text=TurnTableManager.instance.p_drawExp+"/"+TurnTableManager.instance.p_drawExpMax,t&&this.resetTime(),this.setRed()},e.prototype.setRed=function(){this.u_imgRed.visible=TurnTableManager.instance.p_drawExp>=TurnTableManager.instance.p_drawExpMax},e.prototype.setTxtColor=function(){BagManager.instance.isEnoughProp([this.m_costList1[0][0],this.m_costList1[0][1],this.m_costList1[0][2]],!1)?this.u_txtCost1.textColor=1==this.m_costList1[0][1]?15988205:16774322:this.u_txtCost1.textColor=ColorJson.red,BagManager.instance.isEnoughProp([this.m_costList2[0][0],this.m_costList2[0][1],this.m_costList2[0][2]],!1)?this.u_txtCost2.textColor=1==this.m_costList2[0][1]?15988205:16774322:this.u_txtCost2.textColor=ColorJson.red},e.prototype.resetTime=function(){this.m_time=TimeUtil.showTime(2),this.m_time-ServerTimeManager.instance.timer>0&&TimeManager.instance.doLoop(this.refreshTime,this,1e3)},e.prototype.refreshTime=function(){var t=this.m_time-ServerTimeManager.instance.timer;return 0>=t?(TimeManager.instance.clearTimer(this.refreshTime,this),void(this.u_txtTime.textFlow=TextUtil.setTextFlowColor(LanguageJson.getText("l_pagoda_wait"),1100546))):void(this.u_txtTime.textFlow=TextUtil.setTextFlow(LanguageJson.getText("l_pagoda_time")+TextUtil.setText(TimeUtil.getSpliceTime(t),1100546)))},e.prototype.hide=function(e,i){this.m_isMove=!1,this["u_imgBlade"+this.m_showId]&&TweenLite.killTweensOf(this["u_imgBlade"+this.m_showId]),Dispatch.remove(TurnTableManager.EVENT_TURNTABLE_DRAW_SUCCESS,this.starRoll,this),Dispatch.remove(TurnTableManager.EVENT_TURNTABLE_EXP_UPDATA,this.setJindu,this),Dispatch.remove(BagManager.EVENT_BAG_UPGRADE+1,this.setTxtColor,this),Dispatch.remove(BagManager.EVENT_BAG_UPGRADE+2,this.setTxtColor,this),t.prototype.hide.call(this,e,i)},Object.defineProperty(e.prototype,"isClickBMask",{get:function(){return!1},enumerable:!0,configurable:!0}),e.EVENT_TURNTABLE_ITEM_FLY="EVENT_TURNTABLE_ITEM_FLY",e.p_poorList=[],e}(PopupBase);__reflect(TurnTableUI.prototype,"TurnTableUI");var TurnReward=function(t){function e(){var e=t.call(this)||this;return e.m_showId=0,e.m_idx=0,e.m_posXYList=[],e.touchEnabled=!1,e.once(egret.Event.COMPLETE,e.onCompleted,e),e.skinName="resource/eui_skins/turnTableUI/view/TurnRewardSkin.exml",e}return __extends(e,t),e.prototype.onCompleted=function(){this.initView(),this.initEvent(),t.prototype.onCompleted.call(this)},e.prototype.initView=function(){this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2},e.prototype.initEvent=function(){},e.prototype.show=function(t,e){this.checkComplete(this.show,t,e)&&(Dispatch.register(TurnTableUI.EVENT_TURNTABLE_ITEM_FLY,this.startFly,this),this.alpha=1,this.m_showId=t,this.m_idx=e,this.m_item||(this.m_item=new ItemIcon),this.m_item.x=138,this.m_item.y=164,this.addChild(this.m_item),this.m_item.visible=!0,this.u_grpItem.visible=!0,this.m_json=TurntableJson.getData(this.m_showId),this.u_imgTitle.y=TurnTableManager.instance.p_showList.length>1?-120:0,this.m_item.setData(this.m_json.award_list[0][0],this.m_json.award_list[0][1]),TweenLite.to(this,.5,{y:this.y-200,onComplete:this.onPlayComplete.bind(this)}))},e.prototype.onPlayComplete=function(){var t=TurnTableManager.instance.p_showList.length>1?.3:.5;DelayCallUtils.delayedCall(t,this.onPlayHide,this)},e.prototype.onPlayHide=function(){var t;TurnTableManager.instance.p_showList.length>1?(this.m_posXYList=[[this.u_item.x-200,this.u_item.y+43-250],[this.u_item.x-100,this.u_item.y+43-250],[this.u_item.x,this.u_item.y+43-250],[this.u_item.x+100,this.u_item.y+43-250],[this.u_item.x+200,this.u_item.y+43-250],[this.u_item.x-200,this.u_item.y+43+100],[this.u_item.x-100,this.u_item.y+43+100],[this.u_item.x,this.u_item.y+43+100],[this.u_item.x+100,this.u_item.y+43+100],[this.u_item.x+200,this.u_item.y+43+100]],this.u_grpItem.visible=!1,t=this.getPoint(),TweenLite.to(this,.25,{x:t.x,y:t.y,onComplete:this.sendMsg.bind(this)})):(this.m_item.visible=!1,t=this.u_item.parent.localToGlobal(this.u_item.x,this.u_item.y+43),ItemFloatModule.instance.flyItem([this.m_json.award_list[0][0],this.m_json.award_list[0][1],this.m_json.award_list[0][2]],[t.x,t.y],null,0,!0,.4,!0,this.scaleX))},e.prototype.sendMsg=function(){this.m_idx==TurnTableManager.instance.p_showList.length-1&&Dispatch.dispatch(TurnTableUI.EVENT_TURNTABLE_ITEM_FLY)},e.prototype.startFly=function(){TweenLite.to(this,.25,{delay:.1*this.m_idx+.12,x:StageManager.instance.p_stageWidth/2,y:StageManager.instance.p_stageHeight/2-164,onComplete:this.hideReward.bind(this)})},e.prototype.hideReward=function(){this.m_item.visible=!1;var t=this.u_item.parent.localToGlobal(this.u_item.x,this.u_item.y+43);ItemFloatModule.instance.flyItem([this.m_json.award_list[0][0],this.m_json.award_list[0][1],this.m_json.award_list[0][2]],[t.x,t.y],null,0,!0,.4,!0,this.scaleX)},e.prototype.getPoint=function(){return this.u_item.parent.localToGlobal(this.m_posXYList[this.m_idx][0],this.m_posXYList[this.m_idx][1])},e.prototype.hide=function(){DisplayObjectUtils.removeFormParent(this),Dispatch.remove(TurnTableUI.EVENT_TURNTABLE_ITEM_FLY,this.startFly,this)},Object.defineProperty(e.prototype,"width",{get:function(){return 357},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 250},enumerable:!0,configurable:!0}),e}(ComponentBase);__reflect(TurnReward.prototype,"TurnReward");var TurnRewardMC=function(t){function e(){var e=t.call(this)||this;return e.m_showId=0,e.m_idx=0,e}return __extends(e,t),e.prototype.show=function(t,e,i){void 0===i&&(i=null),this.m_funcBack=i,this.m_showId=t,this.m_idx=e,StageManager.instance.popUplayer.addChild(this),this.m_floaExplode||(this.m_floaExplode=new EffectMovieClip,this.m_floaExplode.x=StageManager.instance.p_stageWidth/2,this.m_floaExplode.y=StageManager.instance.p_stageHeight/2-78,this.m_floaExplode.setMC(PublicCon.PATH_EFFECT_MONSTER+"gaoExplode")),this.addChild(this.m_floaExplode),this.m_floaExplode.play(12,1),this.m_TurnReward||(this.m_TurnReward=new TurnReward),this.m_TurnReward.alpha=0,this.m_floaExplode.scaleX=1+.08*e,this.m_floaExplode.scaleY=1+.08*e,DelayCallUtils.delayedCall(.3,this.showMc,this)},e.prototype.showMc=function(){SoundMoude.instance.playSoundEffect(SoundEnum.EFFECT_SOUND_4002),this.m_TurnReward.x=StageManager.instance.p_stageWidth/2,this.m_TurnReward.y=StageManager.instance.p_stageHeight/2+35,this.m_TurnReward.show(this.m_showId,this.m_idx),this.addChildAt(this.m_TurnReward,1),this.m_TurnReward.scaleX=.3,this.m_TurnReward.scaleY=.3,TweenLite.to(this.m_TurnReward,.4,{scaleX:1,scaleY:1});var t=TurnTableManager.instance.p_showList.length>1?10-this.m_idx+2:1.2;DelayCallUtils.delayedCall(t,this.hide,this)},e.prototype.hide=function(){this.m_TurnReward&&this.m_TurnReward.hide(),this.m_floaExplode&&(this.m_floaExplode.destory(),this.m_floaExplode=null),DelayCallUtils.killDelayedCallsTo(this.hide,this),DelayCallUtils.killDelayedCallsTo(this.showMc,this),DisplayObjectUtils.removeFormParent(this),TurnTableUI.p_poorList.push(this),null!=this.m_funcBack&&this.m_funcBack(),this.m_funcBack=null},e}(egret.DisplayObjectContainer);__reflect(TurnRewardMC.prototype,"TurnRewardMC");var VipUI=function(t){function e(){var e=t.call(this)||this;return e.m_maxProg=303,e.m_disposeUrlList.push("vipUI_json"),e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/vipUI/VipUISkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_txtTips.text=LanguageJson.getHtmlText("l_vip_rechange_msg"),this.u_txtTips.width=this.u_txtTips.textWidth+30,this.u_tipBg.width=this.u_txtTips.textWidth+100,this.m_ratio=Number(StaticDataJson.getData("recharge_ratio").data)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnLeft,this.onLeftHandle,this,!0),this.registerEventClick(this.u_btnRight,this.onRightHandle,this,!0),this.registerEventClick(this.u_btnRecharge,this.onRecharge,this,!0),this.registerEventClick(this.u_btnReceive,this.onReceive,this,!0)},e.prototype.onRecharge=function(t){UIModule.instance.showUI(UIConfig.ID_CHARGE)},e.prototype.onReceive=function(t){var e=VipManager.instance.getVipAwardState(this.m_selectVip);1==e&&VipManager.instance.s_vip_get_vip_award(this.m_selectVip)},e.prototype.onLeftHandle=function(t){var e=VipLevelJson.getData(this.m_selectVip-1);e&&(this.m_selectVip--,this.upPrivilegeInfo())},e.prototype.onRightHandle=function(t){var e=VipLevelJson.getData(this.m_selectVip+1);if(e){if(1==e.is_show&&VipManager.instance.vip_data.vip_level<e.level)return;this.m_selectVip++,this.upPrivilegeInfo()}},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),this.m_selectVip=VipManager.instance.getSelectVip(),e&&e.c_selectVip&&(this.m_selectVip=e.c_selectVip),Dispatch.register(VipManager.EVENT_VIP_GET_AWARD,this.showDataInfo,this,!0),ClientLogManager.instance.s_client_log_client_log(ClientLogEnum.VIP_BUTTON_TIMES))},e.prototype.showDataInfo=function(){this.showVipProgress(),this.upPrivilegeInfo()},e.prototype.showVipProgress=function(){var t=VipManager.instance.vip_data.vip_level,e=VipManager.instance.vip_data.vip_exp,i=(VipLevelJson.getData(t),VipLevelJson.getData(t+1));this.u_txtVip.text=LanguageJson.getText("l_vip_vip")+t,i?(this.u_txtProgress.text=e+"/"+i.exp,this.u_imgJindu.width=e/i.exp*this.m_maxProg):(this.u_txtProgress.text=e+"/"+LanguageJson.getText("l_bag_max"),this.u_imgJindu.width=this.m_maxProg)
},e.prototype.upPrivilegeInfo=function(){var t=VipLevelJson.getData(this.m_selectVip),e=VipManager.instance.getVipAwardState(this.m_selectVip);if(this.u_btnReceive.visible=1==e?!0:!1,this.u_imgReceived.visible=2==e?!0:!1,this.m_selectVip>VipManager.instance.vip_data.vip_level){var i=(t.exp-VipManager.instance.vip_data.vip_exp)/this.m_ratio;this.u_txtMsg.textFlow=LanguageJson.getHtmlTextFlow("l_vip_msg",[i,t.level])}else 1==e?this.u_txtMsg.textFlow=LanguageJson.getHtmlTextFlow("l_vip_can_receive"):2==e&&(this.u_txtMsg.textFlow=LanguageJson.getHtmlTextFlow("l_vip_have_received"));this.u_txtPrivilege.text=LanguageJson.getText("l_vip_vip")+t.level+LanguageJson.getText("l_vip_privilege"),this.u_txtDesc.textFlow=HtmlUtil.setTextFlow(t.desc);var s=t.item_list[0][1];SysCommonJson.getData(s);this.upBtnState()},e.prototype.upBtnState=function(){var t=VipLevelJson.getData(this.m_selectVip-1),e=VipLevelJson.getData(this.m_selectVip+1);t?this.u_btnLeft.visible=!0:this.u_btnLeft.visible=!1,e?(this.u_btnRight.visible=!0,1==e.is_show&&VipManager.instance.vip_data.vip_level<e.level&&(this.u_btnRight.visible=!1)):this.u_btnRight.visible=!1},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i),Dispatch.remove(VipManager.EVENT_VIP_GET_AWARD,this.showDataInfo,this)},e}(UIBase);__reflect(VipUI.prototype,"VipUI");var WelcomeUI=function(t){function e(){var e=t.call(this)||this;return e.m_time=7,e.m_guideId=-1,e.m_disposeUrlList.push("welcomeUI_json"),e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/welcomeUI/WelcomeUISkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){this.m_effectOpenType=1,this.m_effectCloseType=2,this.touchEnabled=!1,StaticDataJson.getData("init_guide_welcome")&&(this.m_guideId=Number(StaticDataJson.getData("init_guide_welcome").data)),this.m_rewardGrop||(this.m_rewardGrop=new RewardGroupUI,this.m_rewardGrop.spaceX=15,this.m_rewardGrop.horizontalCenter=90,this.m_rewardGrop.y=393,this.m_rewardGrop.setGroupFormat(3),this.m_rewardGrop.stopTap()),this.addChild(this.m_rewardGrop),this.m_rewardGrop.setDataByRewardId(Number(StaticDataJson.getData("init_reward").data)),GuideModule.instance.registerGuide(this.m_guideId,1)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.setCloseBtn(this.u_btnClick)},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),this.m_time=7,TimeManager.instance.doLoop(this.timeDo,this))},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i),PopupModule.instance.hidePopAll(),TimeManager.instance.clearTimer(this.timeDo,this),GuideModule.instance.startGuide(this.m_guideId),ItemFloatModule.instance.floatRewardGroup(this.m_rewardGrop)},e.prototype.sureHide=function(e,i){void 0===e&&(e=null),void 0===i&&(i=null),t.prototype.sureHide.call(this,e,i),RES.destroyRes("preloadCreate")},e.prototype.timeDo=function(){this.m_time<=0&&this.close(),this.u_txtTime.text=this.m_time+"s",this.m_time-=1},Object.defineProperty(e.prototype,"width",{get:function(){return 640},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 700},enumerable:!0,configurable:!0}),e}(PopupBase);__reflect(WelcomeUI.prototype,"WelcomeUI");var WithdrawalUI=function(t){function e(){var e=t.call(this)||this;return e.m_layout=new eui.TileLayout,e.m_typeList=new eui.ArrayCollection,e.m_disposeUrlList.push("withdrawalUI_json"),e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/withdrawalUI/WithdrawalUISkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_scrollerItem.horizontalScrollBar=null,this.u_scrollerItem.verticalScrollBar=null,this.m_layout.requestedColumnCount=1,this.u_listItem.itemRenderer=WithdrawalRender,this.u_listItem.layout=this.m_layout,this.u_listItem.dataProvider=this.m_typeList},e.prototype.initEvent=function(){t.prototype.initEvent.call(this)},e.prototype.showView=function(e){void 0===e&&(e=null),this.checkComplete(this.showView,e)&&(t.prototype.showView.call(this,e),Dispatch.register(AchievementManager.EVENT_ACHIEVE_RESET_LIST,this.upList,this,!0))},e.prototype.upList=function(){this.m_time=TimeUtil.showTime(2),TimeManager.instance.doLoop(this.timeDo,this),this.m_typeList.source=AchievementManager.instance.getWithdrawalList()},e.prototype.timeDo=function(){var t=this.m_time-ServerTimeManager.instance.timer;return 0>t?void(this.m_time=this.m_time+86400):void(this.u_txtTime.textFlow=TextUtil.setTextFlow(LanguageJson.getText("l_missiom_time")+": "+TextUtil.setText(TimeUtil.getSpliceTime2(t),1703682)))},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i),TimeManager.instance.clearTimer(this.timeDo,this),Dispatch.remove(AchievementManager.EVENT_ACHIEVE_RESET_LIST,this.upList,this)},e}(UIBase);__reflect(WithdrawalUI.prototype,"WithdrawalUI");var WithdrawalPopup=function(t){function e(){var e=t.call(this)||this;return e.m_layout=new eui.TileLayout,e.m_typeList=new eui.ArrayCollection,e.m_disposeUrlList.push("recycleUI_json"),e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/withdrawalUI/popup/WithdrawalPopupSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_scrollerItem.horizontalScrollBar=null,this.u_scrollerItem.verticalScrollBar=null,this.m_layout.requestedColumnCount=3,this.m_layout.horizontalGap=15,this.m_layout.verticalGap=30,this.u_listItem.itemRenderer=WithdrawalSelect,this.u_listItem.layout=this.m_layout,this.u_listItem.dataProvider=this.m_typeList,this.u_txtTitle.text=LanguageJson.getHtmlText("l_recycle_title"),this.u_txtHistory.text=LanguageJson.getHtmlText("l_recycle_history"),this.u_txtHave.text=LanguageJson.getHtmlText("l_recycle_youhave"),this.u_txtRecycle.text=LanguageJson.getHtmlText("l_recycle_draw"),this.u_txtIcon.text=LanguageJson.getHtmlText("l_game_unit_dollar"),TextUtil.setLink(this.u_txtHistory),this.m_ratio=Number(StaticDataJson.getData("recharge_ratio").data),this.m_idList=DrawMoneyJson.getDrawMoneyIdList(),this.u_imgBg.height=StageManager.instance.p_stageHeight+20,this.u_imgBg2.height+=StageManager.instance.p_stageHeight-StageManager.MIN_STAGE_HEIGHT,this.u_btnRecycle.y=StageManager.instance.p_stageHeight-140},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.setCloseBtn(this.u_btnClose),this.registerEventClick(this.u_btnRecord,this.onRecord,this),this.registerEventClick(this.u_btnRecycle,this.onRecycle,this,!0)},e.prototype.onRecord=function(t){void 0===t&&(t=null),WithdrawManager.instance.s_shop_withdraw_history()},e.prototype.onRecycle=function(t){void 0===t&&(t=null);var i=DrawMoneyJson.getData(e.p_selectId);if(FunctionManager.instance.getOpenFuncId(FunctionEnum.DRAW_MONEY,!0))return this.m_times<=0?void FloatTipModule.instance.popTipLanguage("l_recycle_tips_3"):BagManager.instance.gold<i.money?void FloatTipModule.instance.popTipLanguage("l_game_tips_20"):void WithdrawManager.instance.s_shop_withdraw(e.p_selectId)},e.prototype.showView=function(i){void 0===i&&(i=null),this.checkComplete(this.showView,i)&&(t.prototype.showView.call(this,i),e.p_selectId=this.m_idList[0],this.m_typeList.source=this.m_idList,ObjectUtils.setGrey(this.u_btnRecycle,!1),FunctionManager.instance.getOpenFuncId(FunctionEnum.DRAW_MONEY)||ObjectUtils.setGrey(this.u_btnRecycle,!0,!0),Dispatch.register(BagManager.EVENT_BAG_UPGRADE+1,this.setMoney,this,!0),Dispatch.register(TimesManager.EVENT_TIEMS_UPDATE+TimesEnum.DRAW_MONEY,this.setTimes,this,!0))},e.prototype.setMoney=function(){this.u_txtMoney.text=BagManager.instance.gold/this.m_ratio+""},e.prototype.setTimes=function(){var t=PlayerManager.instance.p_playerInfo.vip_level;this.m_times=TimesManager.instance.getTimesById(TimesEnum.DRAW_MONEY),this.u_txtTimes.textFlow=LanguageJson.getHtmlTextFlow("l_recycle_times",[t,this.m_times])},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i),Dispatch.remove(BagManager.EVENT_BAG_UPGRADE+1,this.setMoney,this),Dispatch.remove(TimesManager.EVENT_TIEMS_UPDATE+TimesEnum.DRAW_MONEY,this.setTimes,this)},Object.defineProperty(e.prototype,"height",{get:function(){return StageManager.instance.p_stageHeight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isClickBMask",{get:function(){return!1},enumerable:!0,configurable:!0}),e}(PopupBase);__reflect(WithdrawalPopup.prototype,"WithdrawalPopup");var WithdrawalRecordPop=function(t){function e(){var e=t.call(this)||this;return e.m_layout=new eui.TileLayout,e.m_typeList=new eui.ArrayCollection,e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/withdrawalUI/popup/WithdrawalRecordPopSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_scrollerItem.horizontalScrollBar=null,this.u_scrollerItem.verticalScrollBar=null,this.m_layout.requestedColumnCount=1,this.m_layout.verticalGap=15,this.u_listItem.itemRenderer=WithdrawalRecRender,this.u_listItem.layout=this.m_layout,this.u_listItem.dataProvider=this.m_typeList,this.u_txtTitle.text=LanguageJson.getHtmlText("l_recycle_history"),this.u_imgBg.height=this.height+20,this.u_scrollerItem.height=this.height-this.u_scrollerItem.y+20},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.setCloseBtn(this.u_btnClose)},e.prototype.showView=function(e){if(void 0===e&&(e=null),this.checkComplete(this.showView,e)){t.prototype.showView.call(this,e);var i=e;ArrayUtils.setSortArr(i,["time"],[1]),this.m_typeList.source=i}},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i)},Object.defineProperty(e.prototype,"height",{get:function(){return StageManager.instance.p_stageHeight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isClickBMask",{get:function(){return!1},enumerable:!0,configurable:!0}),e}(PopupBase);__reflect(WithdrawalRecordPop.prototype,"WithdrawalRecordPop");var WithdrawalResultPop=function(t){function e(){var e=t.call(this)||this;return e.m_time=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"skinNameUrl",{get:function(){return"resource/eui_skins/withdrawalUI/popup/WithdrawalResultSkin.exml"},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.u_txtTitle.text=LanguageJson.getText("l_btn_cue")},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.setCloseBtn(this.u_btnOK)},e.prototype.showView=function(e){if(void 0===e&&(e=null),this.checkComplete(this.showView,e)){t.prototype.showView.call(this,e);var i=e.status;0==i?this.u_txtMsg.textFlow=LanguageJson.getHtmlTextFlow("l_recycle_tips_5"):1==i?this.u_txtMsg.textFlow=LanguageJson.getHtmlTextFlow("l_recycle_tips_6"):2==i&&(this.u_txtMsg.textFlow=LanguageJson.getHtmlTextFlow("l_recycle_tips_7")),this.startTimeDo()}},e.prototype.startTimeDo=function(){this.m_time=10,TimeManager.instance.doLoop(this.refreshTime,this,1e3)},e.prototype.refreshTime=function(){return this.u_txtOK.text=LanguageJson.getText("l_btn_ok")+"("+this.m_time+")",this.m_time<=0?(TimeManager.instance.clearTimer(this.refreshTime,this),void this.close()):void this.m_time--},e.prototype.hide=function(e,i){t.prototype.hide.call(this,e,i),TimeManager.instance.clearTimer(this.refreshTime,this)},e}(PopupBase);__reflect(WithdrawalResultPop.prototype,"WithdrawalResultPop");var WithdrawalRecRender=function(t){function e(){return t.call(this,"resource/eui_skins/withdrawalUI/render/WithdrawalRecRenderSkin.exml")||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this)},e.prototype.dataChanged=function(){if(this.checkComplete(this.dataChanged)){t.prototype.dataChanged.call(this),this.m_data=this.data,this.u_txtTime.text=TimeUtil.getTampTimeByUnix(Number(this.m_data.time),"yyyy-m-d"),this.u_imgState.source="recycleUI_json.recycleUI_state"+this.m_data.status;var e=DrawMoneyJson.getData(this.m_data.id);e&&(0==this.m_data.status?this.u_txtMoney.text="+"+LanguageJson.getText("l_game_unit_dollar")+e.money:this.u_txtMoney.text="-"+LanguageJson.getText("l_game_unit_dollar")+e.money)}},e}(ItemRendererBase);__reflect(WithdrawalRecRender.prototype,"WithdrawalRecRender");var WithdrawalRender=function(t){function e(){var e=t.call(this,"resource/eui_skins/withdrawalUI/render/WithdrawalRenderSkin.exml")||this;return e.m_jindu_max=130,e}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this),this.touchEnabled=!1,this.u_txtTishi.textFlow=LanguageJson.getHtmlTextFlow("l_game_tips_25")},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this.u_btnGo,this.onGo,this,!0)},e.prototype.onGo=function(t){1==this.m_data.state?AchievementManager.instance.s_achievement_get_award(AchievementManager.instance.p_WithdrawalType):0==this.m_data.state?4==this.m_json.id?WithdrawManager.instance.s_shop_withdraw(1):FunctionManager.instance.executeFunction(this.m_json.function_config_id):FloatTipModule.instance.popTipLanguage("l_game_tips_5")},e.prototype.dataChanged=function(){if(this.checkComplete(this.dataChanged)){t.prototype.dataChanged.call(this),this.m_data&&(Dispatch.remove(AchievementManager.EVENT_ACHIEVE_DATA_UPDATE+AchievementManager.instance.p_WithdrawalType+"_"+this.m_data.taskId,this.flyIcon,this),Dispatch.remove(AchievementManager.EVENT_ACHIEVE_DATA_UPDATE+AchievementManager.instance.p_WithdrawalType,this.upData,this)),this.m_data=this.data,this.m_json=AchievementJson.getData(AchievementManager.instance.p_WithdrawalType,this.m_data.taskId),Dispatch.register(AchievementManager.EVENT_ACHIEVE_DATA_UPDATE+AchievementManager.instance.p_WithdrawalType+"_"+this.m_data.taskId,this.flyIcon,this),Dispatch.register(AchievementManager.EVENT_ACHIEVE_DATA_UPDATE+AchievementManager.instance.p_WithdrawalType,this.upData,this),this.m_json.withdrawal_type&&2==this.m_json.withdrawal_type?this.u_imgBg.source="withdrawalUI_json.withdrawalUI_di_2":this.u_imgBg.source="withdrawalUI_json.withdrawalUI_di_1",this.u_txtName.text=this.m_json.name;var e=this.m_json.award_list[0];this.u_imgIcon.source=BagManager.instance.getIconPath(e[0]),GameManager.instance.isShield?this.u_txtNum.text=e[2]:this.u_txtNum.text=""+e[2]/1e3,this.upData(!1,this.m_data.taskId)}},e.prototype.upData=function(t,e){if(e==this.m_data.taskId){this.u_imgReceived.visible=!1,this.u_btnGo.visible=!1,ObjectUtils.setGrey(this,!1),this.removeEff();var i=AchievementManager.instance.getAchieveDataByType(AchievementManager.instance.p_WithdrawalType);i&&i.id==this.m_data.taskId&&(this.m_data.state=i.state,this.u_btnGo.visible=!0),2==this.m_data.state?(this.u_imgReceived.visible=!0,ObjectUtils.setGrey(this)):1==this.m_data.state?(this.u_imgGo.source="commonsUI_json.commonsUI_btn_2",this.u_txtGo.text=LanguageJson.getText("l_btn_receive"),this.u_imgRed.visible=!0,this.m_taskEffect||(this.m_taskEffect=new EffectMovieClip,this.m_taskEffect.touchChildren=!1,this.m_taskEffect.touchEnabled=!1,this.m_taskEffect.blendMode=egret.BlendMode.ADD,this.m_taskEffect.setMC("resource/assets/uiEffect/task/withdrawal"),this.m_taskEffect.x=278,this.m_taskEffect.y=70),this.addChild(this.m_taskEffect),this.m_taskEffect.play()):(this.u_imgGo.source="commonsUI_json.commonsUI_btn_1",this.u_imgRed.visible=!1,this.m_json.function_config_id>0?this.u_txtGo.text=LanguageJson.getText("l_btn_go"):this.u_txtGo.text=LanguageJson.getText("l_btn_receive"));var i=AchievementManager.instance.getAchieveDataByType(AchievementManager.instance.p_WithdrawalType);if(i&&i.id==this.m_data.taskId){var s,n=Number(i.value),o=this.m_json.approach_list[this.m_json.approach_list.length-1];n>=o?(n=o,s=1703682):s=ColorJson.red,this.u_txtName.textFlow=TextUtil.setTextFlow(this.m_json.name+"  ("+TextUtil.setText(n+"",s)+"/"+o+")")}}},e.prototype.flyIcon=function(){var t=this.localToGlobal(160,60),e=this.m_json.award_list[0][0],i=this.m_json.award_list[0][1];i=Math.ceil(i/10),10>=i&&(i=10),i>40&&(i=40),FlyResModule.instance.playResEffect([t.x,t.y],BagManager.instance.getPointByItem(e,!0),e,i)},e.prototype.removeEff=function(){this.m_taskEffect&&(this.m_taskEffect.destory(),this.m_taskEffect=null)},e.prototype.onRemoveStage=function(e){t.prototype.onRemoveStage.call(this,e),this.removeEff(),Dispatch.remove(AchievementManager.EVENT_ACHIEVE_DATA_UPDATE+AchievementManager.instance.p_WithdrawalType+"_"+this.m_data.taskId,this.flyIcon,this),Dispatch.remove(AchievementManager.EVENT_ACHIEVE_DATA_UPDATE+AchievementManager.instance.p_WithdrawalType,this.upData,this)},e}(ItemRendererBase);__reflect(WithdrawalRender.prototype,"WithdrawalRender");var WithdrawalSelect=function(t){function e(){return t.call(this,"resource/eui_skins/withdrawalUI/render/WithdrawalSelectSkin.exml")||this}return __extends(e,t),e.prototype.initView=function(){t.prototype.initView.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.registerEventClick(this,this.onClick,this)},e.prototype.onClick=function(t){void 0===t&&(t=null),this.m_data.id!=WithdrawalPopup.p_selectId&&(WithdrawalPopup.p_selectId=this.m_data.id,Dispatch.dispatch(e.EVENT_WITHDRAWAL_DANGWEI_SELECT))},e.prototype.dataChanged=function(){this.checkComplete(this.dataChanged)&&(t.prototype.dataChanged.call(this),this.m_data=DrawMoneyJson.getData(this.data),this.u_txtNum.text=LanguageJson.getHtmlText("l_game_unit_yuan",[this.m_data.money]),Dispatch.register(e.EVENT_WITHDRAWAL_DANGWEI_SELECT,this.upSelect,this,!0))},e.prototype.upSelect=function(){this.m_data.id==WithdrawalPopup.p_selectId?(this.u_txtNum.textColor=16777215,this.u_imgBg.source="recycleUI_json.recycleUI_di_2"):(this.u_txtNum.textColor=10987431,this.u_imgBg.source="recycleUI_json.recycleUI_di_1")},e.EVENT_WITHDRAWAL_DANGWEI_SELECT="EVENT_WITHDRAWAL_DANGWEI_SELECT",e}(ItemRendererBase);__reflect(WithdrawalSelect.prototype,"WithdrawalSelect");